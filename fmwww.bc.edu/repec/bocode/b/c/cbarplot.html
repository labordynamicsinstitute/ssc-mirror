<pre>
-------------------------------------------------------------------------------
help for <b>cbarplot</b>
-------------------------------------------------------------------------------
<p>
<b><u>Centred bar plots of absolute or relative frequencies</u></b> 
<p>
        <b>cbarplot</b> <i>yvar</i> [<i>xvar</i>] [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [ <b>,</b> [ <b><u>perc</u></b><b>ent</b>
                 <b><u>perc</u></b><b>ent(</b><i>varname</i><b>)</b> ] <b>yasis</b> <b>xasis</b> <b>format(</b><i>format</i><b>)</b> <b><u>vert</u></b><b>ical</b> <b>by(</b>
                 by_option<b>)</b> <b><u>rbar</u></b><b>opts(</b><i>rbar_options</i><b>)</b> <i>scatter_options</i> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>cbarplot</b> shows absolute or relative frequencies of <i>yvar</i> as centred bar
    plots. If <i>xvar</i> is specified, a bar plot is shown for each distinct value
    of <i>xvar</i>.
<p>
    By default, each variable is mapped on the fly to an integer variable
    with values 1 up, but with value labels reflecting the input data, and
    each bar plot has horizontal bars with absolute or relative frequencies
    shown as marker labels.
<p>
    <b>fweight</b>s, <b>aweight</b>s, <b>iweight</b>s and <b>pweight</b>s may be specified.
<p>
<p>
<b><u>Remarks</u></b> 
<p>
    Centred bar plots are often used in archaeology to show frequencies of
    different kinds of artefact at different levels or ages, sometimes under
    the title of battleship curves or battleship diagrams (e.g. Doran and
    Hodson 1975, pp.278-280; Renfrew and Bahn 1991, pp.107-108).
<p>
    This command will not draw e.g. population pyramids in which each
    age-group is subdivided by sex. See help on twoway_bar.
<p>
<p>
<b><u>Options</u></b> 
<p>
    <b>percent</b> specifies that frequencies are to be shown as percents of the
        total.
<p>
    <b>percent(</b><i>varlist</i><b>)</b> specifies that frequencies are to be shown as percents
        of the totals for the categories of <i>varlist</i>.  <i>varlist</i> may only
        include one or more of <i>yvar</i>, <i>xvar</i> or a variable specified in the <b>by()</b>
        option.
<p>
        These two percent options may not be combined.
<p>
    <b>yasis</b> specifies that the values of <i>yvar</i> should be treated as is.
        Usually, but not necessarily, <i>yvar</i> should be discrete or already
        binned in some sense.  Either way, the default bar width of 0.95 may
        now need changing.
<p>
    <b>xasis</b> specifies that the values of <i>xvar</i> should be treated as is.
        Usually, but not necessarily, <i>xvar</i> should be discrete or already
        binned in some sense.  Either way, the default bar width of 0.95 may
        now need changing.
<p>
    <b>format(</b><i>format</i><b>)</b> specifies a format for the marker labels. By default the
        format is %2.1f, unless all values in the marker labels are integers
        in which case the default is %2.0f. See help on format if desired.
<p>
    <b>by()</b> specifies that different graphs be shown for distinct values of the
        variable specified. See help on by_option for more detail.
<p>
    <b>vertical</b> specifies that bars are to be drawn vertically. Changing from
        the default horizontal to vertical will usually imply changing the
        order of <i>yvar</i> and <i>xvar</i>.
<p>
    <b>rbaropts(</b><i>rbar_options</i><b>)</b> are options of twoway rbar.  The defaults include
        <b>blcolor(blue) bfcolor(none) barw(0.95)</b>.
<p>
    <i>scatter_options</i> are options of twoway scatter.  The defaults include
        <b>mlabpos(0) mlabcolor(blue)</b>.  Note that setting <b>mlabcolor(bg)</b> would
        blank out the marker labels.
<p>
<p>
<b><u>Examples</u></b>
<p>
    (data from Doran and Hodson 1975, p.259)
<p>
    <b>. clear</b>
    <b>. input levels freqcores freqblanks freqtools</b>
    <b>25 21 32 70</b>
    <b>24 36 52 115</b>
    <b>23 126 650 549</b>
    <b>22 159 2342 1633</b>
    <b>21 75 487 511</b>
    <b>20 176 1090 912</b>
    <b>19 132 713 578</b>
    <b>18 46 374 266</b>
    <b>17 550 6182 1541</b>
    <b>16 76 846 349</b>
    <b>15 17 182 51</b>
    <b>14 4 51 14</b>
    <b>13 29 228 130</b>
    <b>12 135 2227 729</b>
    <b>. end</b>
    <b>. reshape long freq, i(levels) j(kind) string</b>
    <b>. cbarplot levels kind [fw=freq]</b>
    <b>. cbarplot levels kind [fw=freq], percent(levels)</b>
    <b>. cbarplot levels kind [fw=freq], percent(levels) mlabsize(*.6)</b>
    <b>. cbarplot levels kind [fw=freq], percent(levels) mlabcolor(bg)</b>
        <b>rbaropts(bfcolor(blue))</b>
    <b>. cbarplot levels [fw=freq], by(kind, row(1)) percent(levels)</b>
        <b>mlabcolor(bg) rbaropts(bfcolor(blue))</b>
    <b>. cbarplot levels [fw=freq], by(kind, row(1)) percent(levels)</b>
        <b>mlabcolor(bg) rbaropts(bfcolor(blue)) ysc(reverse)</b>
<p>
<p>
<b><u>Author</u></b>
<p>
    Nicholas J. Cox, Durham University
    n.j.cox@durham.ac.uk
<p>
         
<b><u>Acknowledgments</u></b> 
<p>
    Philip B. Ender drew this kind of graph to my attention and provided
    helpful comments.
<p>
<p>
<b><u>References</u></b> 
<p>
    Doran, J.E. and Hodson, F.R. 1975.  <i>Mathematics and computers in</i>
        <i>archaeology.</i>  Edinburgh: Edinburgh University Press.
<p>
    Renfrew, C. and Bahn, P. 1991.  <i>Archaeology: Theories, methods and</i>
        <i>practice.</i>  London: Thames and Hudson.
<p>
<p>
<b><u>Also see</u></b>
<p>
    On-line:  help for twoway rbar; catplot (if installed); tabplot (if
        installed)
<p>
</pre>