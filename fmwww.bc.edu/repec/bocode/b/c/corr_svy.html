<pre>
-------------------------------------------------------------------------------
help for <b>corr_svy</b>
-------------------------------------------------------------------------------
<p>
<b><u>Correlation tables for survey data</u></b>
<p>
        <b>corr_svy</b> <i>varlist</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>str</u></b><b>ata(</b><i>varname</i><b>)</b>
               <b>psu(</b><i>varname</i><b>)</b> <b>fpc(</b><i>varname</i><b>)</b> <b><u>sub</u></b><b>pop(</b><i>varname</i><b>)</b> <b>pw</b> <b><u>o</u></b><b>bs</b> <b>sig</b> <b><u>p</u></b><b>rint(</b><i>#</i><b>)</b>
               <b><u>st</u></b><b>ar(</b><i>#</i><b>)</b> ]
<p>
<p>
<b>pweight</b>s are allowed; see help weights.
<p>
Warning:  Use of <b>if</b> or <b>in</b> restrictions will not produce correct variance
estimates for subpopulations in many cases.  To compute estimates for
subpopulations, use the <b>subpop()</b> option.
<p>
<p>
<b><u>Description</u></b>
<p>
<b>corr_svy</b> displays the correlation matrix for varlist.  Optional significance
levels are calculated, based on survey-based variance estimates for the
correlations.
<p>
It allows any or all of the following:  probability sampling weights,
stratification, and clustering.  The <b>subpop()</b> option will give estimates for a
single subpopulation.  For a general discussion of various aspects of survey
designs, including multistage designs, see <b>[U] 30 Overview of survey</b>
<b>estimation</b>.
<p>
To describe strata and PSUs of your data and to handle the error message
"stratum with only one PSU detected", see help svydes.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>strata()</b>, <b>psu()</b>, and <b>fpc()</b> are described in <b>svyset</b>; see help svyset.
<p>
<b>subpop(</b><i>varname</i><b>)</b> specifies that estimates be computed for the single
    subpopulation defined by the observations for which <i>varname</i>~=0.  Typically,
    <i>varname</i>=1 defines the subpopulation and <i>varname</i>=0 indicates observations
    not belonging to the subpopulation.  For observations whose subpopulation
    status is uncertain, <i>varname</i> should be set to missing.
<p>
<b>obs</b> requests that the number of observations for each correlation be displayed.
    This only makes sense in conjunction with the <b>pw</b> option, but can be
    specified regardless.
<p>
<b>pw</b> specifies that pairwise correlations be calculated and displayed.
<p>
<b>sig</b> requests that the significance level of the coefficients be displayed.
<p>
<b>obs</b> requests that the number of observations for each correlation be displayed.
    This only makes sense in conjunction with the <b>pw</b> option, but can be
    specified regardless.
<p>
<b>star(</b><i>#</i><b>)</b> specifies the significance level of coefficients to be starred.
    star(5) would star all coefficients significant at the 5% level or better.
<p>
<b>print(</b><i>#</i><b>)</b> specifies the significance level of correlation coefficients to be
    printed.  Coefficients with larger significance levels are left blank.
    print(10) would list only coefficients significant at the 10% level or
    better.
<p>
<p>
<b><u>Example</u></b>
<p>
        . svyset pweight leadwt
        . svyset strata stratid
        . svyset psu psuid
<p>
        . corr_svy loglead age female region2-region4, obs sig
<p>
<p>
<b><u>Saved Results</u></b>
<p>
<b>corr_svy</b> saves in r() the following, about the final correlation calculated:
<p>
        r(N)   The number of observations
        r(p)   The p-level
        r(rho) The estimated rho
<p>
<p>
<b><u>Methods and formulae</u></b>
<p>
Calculations are based on the methods explained by Bill Sribney in a post to
the Statalist, and reproduced in this Stata FAQ: 
http://www.stata.com/support/faqs/stat/survey.html.
<p>
Point estimates are calculated by correlate, with aweights.
<p>
With simple random sampling, the p-value from a linear regression of Y on X (or
X on Y) is exactly the same as a p-value for Pearson's correlation coefficient
for a simple random sample under the assumption of normality of the population.
With survey variance estimates, however, the p-value for the slope of the
regression of Y on X is NOT the same as the p-value for the regression of X on
Y, unlike the case for the OLS regression estimator.  So, <b>corr_svy</b> obtains the
p-values from both regressions and displays the conservative (i.e. larger) of
the two.
<p>
<p>
<b><u>Author</u></b>
<p>
        Nick Winter
        Cornell University
        nw53@cornell.edu
<p>
</pre>