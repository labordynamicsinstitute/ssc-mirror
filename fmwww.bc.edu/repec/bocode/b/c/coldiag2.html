<pre>
-------------------------------------------------------------------------------
help for <b>coldiag2</b> and <b>prnt_cx</b>                                    John Hendrickx
-------------------------------------------------------------------------------
<p>
<b><u>coldiag2</u></b>
<p>
        <b>coldiag2</b> [<b>,</b> <b><u>f</u></b><b>ull</b> <b><u>nos</u></b><b>cale</b> <b><u>c</u></b><b>orr</b> <b><u>e</u></b><b>igenval</b> <b>w</b>(<i>integer</i>) <b>d</b>(<i>integer</i>)] <b><u>fo</u></b><b>rce</b>
                           <b><u>fu</u></b><b>zz</b>(<i>real</i>) <b><u>c</u></b><b>har</b>(<i>string</i>) <b><u>s</u></b><b>pace</b>(<i>integer</i>)
<p>
or
<p>
        <b>coldiag2</b> <i>varlist</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>nof</u></b><b>ull</b> <b><u>nos</u></b><b>cale</b> <b><u>c</u></b><b>orr</b> <b><u>nocon</u></b><b>stant</b>
                           <b><u>e</u></b><b>igenval</b> <b>w</b>(<i>integer</i>) <b>d</b>(<i>integer</i>) <b><u>fo</u></b><b>rce</b> <b><u>fu</u></b><b>zz</b>(<i>real</i>)
                           <b><u>c</u></b><b>har</b>(<i>string</i>) <b><u>s</u></b><b>pace</b>(<i>integer</i>) ]
<p>
<p>
<b><u>prnt_cx</u></b>
<p>
        <b>prnt_cx</b> [<b>,</b> <b><u>m</u></b><b>atname</b>(<i>matrix</i>) <b>w</b>(<i>integer</i>) <b>d</b>(<i>integer</i>) <b><u>fo</u></b><b>rce</b> <b><u>fu</u></b><b>zz</b>(<i>real</i>)
                           <b><u>c</u></b><b>har</b>(<i>string</i>) <b><u>s</u></b><b>pace</b>(<i>integer</i>)
<p>
<p>
<b><u>Description</u></b>
<p>
Note: <b>coldiag2</b> is an updated version of coldiag by Joseph Harkness. Note that
the lastest version has slightly different defaults:
<p>
* a constant term is added to the <i>varlist</i>
* the full output with variance decomposition proportions is printed
<p>
Use "<b>coldiag2 </b><i>varlist</i><b>, nofull noconstant</b>" for backward compatibility with
<b>coldiag</b>.
<p>
<b>coldiag2</b> is an implementation of the regression collinearity diagnostic
procedures found in Belsley, Kuh, and Welsch (1980). These procedures examine
the "conditioning" of the matrix of independent variables.
<p>
In the first syntax form, <b>coldiag2</b> is used as a post-estimation command after
an estimation procedure such as regress.  Collinearity diagnostics are based on
the interrelationships among the independent variables so they are appropriate
for models other than linear regression. <b>coldiag2</b> uses the sample selected by
any <b>if</b> or <b>in</b> options in that command and will include an intercept according to
the model that was estimated.
<p>
In the second syntax form, a <i>varlist</i> is specified. <b>if</b> or <b>in</b> options can be used
to restrict the sample. Missing values will be deleted listwise. By default, an
intercept term will be added to the <i>varlist</i>; this can be suppressed using the
<b>noconstant</b> option.
<p>
<b>prnt_cx</b> is called by <b>coldiag2</b> to print the condition indexes and
variance-decompostion proportions. It can also be run after <b>coldiag2</b> to print
the variance decomposition proportions using different options. Note that
<b>coldiag2</b> will usually be fast enough to simply rerun the command with different
options, unless the dataset is very largen and a large number of independent
variables are used.
<p>
<b><u>Options</u></b>
<p>
<b>nofull</b> By default, <b>coldiag2</b> prints the condition number and variance
    decomposition proportions. Use <b>nofull</b> to produce only the condition number.
<p>
<b>noscale</b> does not scale each column vector to unit length. (This scaling is
    recommended by Belsley et al)
<p>
<b>corr</b> calculates collinearity diagnostics based on a correlation matrix.
<p>
<b>noconstant</b> does not add an intercept term to the <i>varlist</i>.
<p>
<b>eigenval</b> prints the eigenvalues of the SSCP matrix. Default is <b>noeigenval</b>.
<p>
<b>w</b> specifies the width for printing the result. Default is 12.
<p>
<b>d</b> specifies the decimal places for printing the result. Default is 2.
<p>
<b>force</b> By default, the widest variable name determines column printing and the
    value of <b>w</b> is ignored. Use the <b>force</b> option to abbreviate the column labels
    and obtain compact columns.  Note that values of <b>w</b> less than 5 revert to 5.
<p>
<b>fuzz</b> If set, variance-decomposition proportions less than <i>fuzz</i> are printed as a
    "." or optionally by the character specified in the <b>char</b> option. The
    default is 0 for <b>coldiag2</b>, i.e. all values are printed. The default is .3
    for <b>prnt_cx</b>.
<p>
<b>char</b> Used in conjuction with the fuzz option. Specify an alternative character
    to be printed. Default is "."
<p>
<b>space</b> Specify the number of spaces between columns. Default is 2.
<p>
<b>matname</b> (<b>prnt_cx</b> only) If <b>prnt_cx</b> is run after <b>coldiag2</b> it will automatically
    obtain the matrix of condition indexes and variance decomposition
    proportions. In rare instances, this matrix can be specified manually using
    the <b>matname</b> option.  The first column of <i>matrix</i> should contain the
    condition indexes, the other columns should contain variance-decomposition
    proportions.
<p>
<b><u>Remarks</u></b>
<p>
<b>coldiag2</b> first computes the condition number of the matrix. If this number is
"large" (Belsley et al suggest 30 or higher), then there may be collinearity
problems.
<p>
The condition number is the largest condition index. Unless the <b>nofull</b> option
is specified, <b>coldiag2</b> lists the singular values in the first column of the
table under the heading "Variance-Decomposition Proportions". All "large"
condition indexes may be worth investigating.
<p>
The variance-decomposition proportions can be used to identify the source of
collinearity problems indicated by large singular values.  If a large condition
index is associated two or more variables with "large" variance decomposition
portions, these variables may be causing collinearity problems. Belsley et al
suggest that a "large" portion is 50 percent or more.
<p>
<b><u>Example</u></b>
<p>
. use auto
(1978 Automobile Data)
<p>
. coldiag2 price mpg headroom trunk weight length turn displacement gear_ratio 
&gt; foreign
<p>
Condition number using scaled variables =       118.78
<p>
Condition Indexes and Variance-Decomposition Proportions
<p>
condition
    index        _cons        price          mpg     headroom        trunk
1    1.00         0.00         0.00         0.00         0.00         0.00
2    3.32         0.00         0.00         0.00         0.00         0.00
3    6.56         0.00         0.15         0.02         0.00         0.00
4   10.53         0.00         0.20         0.04         0.12         0.08
5   16.38         0.00         0.44         0.01         0.11         0.11
6   18.88         0.00         0.03         0.09         0.53         0.25
7   21.64         0.00         0.00         0.26         0.21         0.43
8   43.87         0.00         0.02         0.33         0.01         0.04
9   59.24         0.05         0.08         0.06         0.00         0.00
10  82.48         0.36         0.00         0.11         0.01         0.00
11 118.78         0.58         0.08         0.08         0.01         0.09
<p>
condition
    index       weight       length         turn displacement   gear_ratio
1    1.00         0.00         0.00         0.00         0.00         0.00
2    3.32         0.00         0.00         0.00         0.00         0.00
3    6.56         0.00         0.00         0.00         0.01         0.00
4   10.53         0.00         0.00         0.00         0.00         0.00
5   16.38         0.00         0.00         0.00         0.26         0.00
6   18.88         0.00         0.00         0.00         0.10         0.01
7   21.64         0.01         0.00         0.00         0.14         0.02
8   43.87         0.19         0.01         0.01         0.45         0.47
9   59.24         0.33         0.00         0.35         0.01         0.34
10  82.48         0.03         0.13         0.63         0.01         0.16
11 118.78         0.44         0.86         0.00         0.01         0.01
<p>
condition
    index      foreign
1    1.00         0.00
2    3.32         0.20
3    6.56         0.08
4   10.53         0.14
5   16.38         0.30
6   18.88         0.00
7   21.64         0.03
8   43.87         0.22
9   59.24         0.01
10  82.48         0.01
11 118.78         0.00
<p>
<p>
<p>
. prnt_cx, force w(8)
<p>
Condition Indexes and Variance-Decomposition Proportions
<p>
condition
    index    _cons    price      mpg headroom    trunk   weight   length     tu
&gt; rn
1    1.00      .        .        .        .        .        .        .        .
2    3.32      .        .        .        .        .        .        .        .
3    6.56      .        .        .        .        .        .        .        .
4   10.53      .        .        .        .        .        .        .        .
5   16.38      .       0.44      .        .        .        .        .        .
6   18.88      .        .        .       0.53      .        .        .        .
7   21.64      .        .        .        .       0.43      .        .        .
8   43.87      .        .       0.33      .        .        .        .        .
9   59.24      .        .        .        .        .       0.33      .       0.
&gt; 35
10  82.48     0.36      .        .        .        .        .        .       0.
&gt; 63
11 118.78     0.58      .        .        .        .       0.44     0.86      .
<p>
condition
    index displa~t gear_r~o  foreign
1    1.00      .        .        .
2    3.32      .        .        .
3    6.56      .        .        .
4   10.53      .        .        .
5   16.38      .        .       0.30
6   18.88      .        .        .
7   21.64      .        .        .
8   43.87     0.45     0.47      .
9   59.24      .       0.34      .
10  82.48      .        .        .
11 118.78      .        .        .
<p>
Variance Decomposition Proportions less than .3 have been printed as "."
<p>
The condition number of 118.78 is fairly large. Examination of the last row of
the table of variance decomposition proportions shows that values associated
with <b>length</b> (.86), the <b>intercept</b> (.58), and <b>weight</b> (.44) are fairly high. The
strong linear relationships among these three variables is the major source of
collinearity in this data.
<p>
In addition, condition indexes 8, 9 and 10 should be considered high (43.87,
59.24, and 82.48 respectively). Condition index number 10 (82.48) can be
attributed to strong inter-relationships between the <b>intercept</b> (.36) and <b>turn</b>
(.63). Condition index number 9 (59.24) is attributable to <b>weight</b> (.33), <b>turn</b>
(.35), and <b>gear_ratio</b> (.34). Condition index number 8 (43.87) is attributable
to <b>mpg</b> (.33), <b>displacement</b> (.45) and <b>gear_ratio</b> (.47).
<p>
<b><u>Remarks</u></b>
<p>
This program is an updated version of coldiag by Joseph Harkness. The main
difference is that <b>coldiag</b> calculates the singular value decomposition of <b>X</b>,
the matrix of scaled variables in <i>varlist</i>, whereas <b>coldiag2</b> calculates the
eigenvectors and eigenvalues of <b>X</b>'<b>X</b>.  Because <b>coldiag</b> reads <b>X</b> into memory, the
number of cases it can handle are limited by matsize (maximum 800 for
intercooled Stata, 11,000 for Stata/SE). <b>coldiag2</b> uses matrix accum to
calculate <b>X</b>'<b>X</b> and can therefore handle larger datasets.
<p>
Belsley argues strongly against mean-centering the data. Use of the <b>corr</b> option
is equivalent to a conditioning analysis of standardized variables with mean 0
and sd 1 and thus goes against this advice.
<p>
<b>coldiag2</b> uses the Stata command <b>_getrhs</b> to obtain a list of independent
variables when used as a post-estimation command. This should work with any
estimation procedure. This will usually be appropriate. If in doubt, an
alternative could be to try perturb, available from SSC. <b>perturb</b> evaluates
collinearity by adding random noise to selected variables and assessing the
impact on parameter stability. <b>perturb</b> is also suitable for use with
categorical variables as well.
<p>
<b><u>Saved results</u></b>
<p>
<b>r(pi)</b>
    A matrix of variance-decomposition proportions
<p>
<b>r(cx)</b>
    A matrix of condition indexes.
<p>
<b>r(v)</b>
    A matrix containing the eigenvalues of the SSCP matrix.
<p>
<b><u>References</u></b>
<p>
D. Belsley, E. Kuh, and R. Welsch (1980).  <i>Regression Diagnostics</i>.  Wiley.
<p>
Belsley, D.A. (1991).  <i>Conditioning diagnostics, collinearity and weak data in</i>
    <i>regression</i>.  New York: John Wiley &amp; Sons.
<p>
Direct comments to: John Hendrickx
<p>
<b>coldiag2</b> is available at SSC-IDEAS.  Use findit <b>coldiag2</b> to locate the latest
version.
<p>
collin, coldiag, and perturb are also available from SSC. Click on a name to
install or use <b>ssc install</b>
<p>
<b><u>Also see</u></b>
On-line: help for vif, collin, coldiag, perturb
<p>
</pre>