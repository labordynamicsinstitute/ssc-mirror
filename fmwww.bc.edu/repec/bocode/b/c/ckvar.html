<pre>
<b>help ckvar</b> 
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>ckvar</b> - Data Validation (or Scoring) using Rules
<p>
<b><u>Syntax</u></b>
<p>
        <b>ckvar</b> [<i>varlist</i>], [ { <b><u>val</u></b><b>id</b> | <b><u>sc</u></b><b>ore</b> } <b>key(</b><i>varlist</i><b>)</b> <b><u>markd</u></b><b>up(</b><i>newvar</i><b>)</b>
                <b><u>nov</u></b><b>ars</b> <b>keepgoing</b> <b>brief</b> <b>progress</b> <b>stub(</b><i>str</i><b>)</b> <b>droplabels</b>
                <b>nopreserve</b> <b>loud</b> ]
<p>
<b><u>Description</u></b>
<p>
    <b>ckvar</b> is a utility command which can be used to validate or score values
    of variables.  It does this by reading the validation or scoring rules
    from characteristics which are attached to the variables themselves,
    instead of relying on external do or ado files.  <b>ckvar</b> can also be used
    to check for duplicate observations based on a key, and can mark groups
    of duplicated keys.
<p>
    This help file explains the syntax of the <b>ckvar</b> command itself.
<p>
    To see how to set or edit the rules used by <b>ckvar</b>, look at the help for 
    ckvaredit. (No knowledge of characteristics is needed.)
<p>
    To see an overview of the purpose of <b>ckvar</b>, please look here.
<p>
    To see the details of how <b>ckvar</b> is implemented, and what charateristics
    it uses to validate or score a dataset, please look here.
<p>
<b><u>Options</u></b>
<p>
    <b>valid</b> and <b>score</b> tell whether to run validation (i.e. error-checking)
        routines or scoring routines associated with the specified variables.
        Only one can be specified. The <b>valid</b> option is the default. When
        validatating, a new variable will be produced for each variable which
        has at least one error; all observations are either valid or invalid.
        When scoring, a new score variable will be produced for every
        variable scored, and there is no assumption of just two possible
        outcomes.
<p>
    <b>key</b> allows checking for observations with duplicate keys.  The <i>varlist</i>
        here defines the variable(s) which together are supposed to define
        unique identifiers for the observations of the dataset (in database
        terms: the fields which define the key). These variables must already
        exist.
<p>
    <b>markdup</b> allows unique marking of groups of duplicate observations so that
        they can be investigated more easily.  The variable name given here
        must be that of a new variable.  After the duplicate check has been
        run, this variable contains a 0 for observations which are not part
        of a group of duplicates and non-negative integer for each
        observation which is part of a group of duplicates.  Each group has
        its own number to make the comparisons easier.
<p>
    <b>novars</b> may be specified together with <b>key</b> if all that is desired were a
        check for duplicates. Specifying this option will ignore all
        validation routines.
<p>
    <b>keepgoing</b> tells <b>ckvar</b> to keep running, even if programming errors are
        encountered. This can be used to find all problematic characteristics
        at once. All variables that can be checked are checked.  All
        variables with fatal errors are noted.
<p>
    <b>brief</b> shortens the validation table produced after the variables are
        checked by eliminating rows for variables which either are completely
        valid or which do not get validated.  This is intended for those
        concentrating on tracking down errors rather than documenting their
        existence.
<p>
    <b>progress</b> echos the name of each variable as it is being validated or
        scored. This is useful for detecting runaway processes, though it
        clutters the screen when checking datasets with many variables.
<p>
    <b>stub</b> overrides the usual stub for the characteristics used by <b>ckvar</b>. By
        default, validation routines use characteristics starting with <b>valid</b>,
        while scoring routines use characteristics starting with <b>score</b>. The
        <b>stub</b> option is intended to allow multiple possible scoring routines
        on the same dataset.
<p>
    <b>droplabels</b> instructs <b>ckvar</b> to drop value labels associated with variables
        generated when checking errors. This would be very rarely used,
        except when debugging validation or scoring routines.
<p>
    <b>nopreserve</b> prevents the dataset from being preserved before running
        <b>ckvar</b>. By default, the dataset is preserved so that if there are
        problems with the validation or scoring, it is returned to its
        pristine state, without any extra variables. If the data set is
        large, <b>nopreserve</b> can save time.
<p>
    <b>loud</b> causes output from the underlying dochar program to be echoed to the
        screen. Its only use is for debugging.
<p>
<b><u>Examples</u></b>
<p>
    <b>. ckvar</b>
        checks all the variables which have validation routines, generating
            indicator variables for variables which have bad data. If there
            are any errors, the total number of errors will be stored in a
            variable called <b>error__total</b>.
<p>
    <b>. ckvar, score</b>
        does the same, but scores all the variables, generating one score
            variable for every variable which has a scoring routine. In this
            case the total will be stored in a variable called <b>score__total</b>.
<p>
    <b>. ckvar this that theOther</b>
        checks the three variables <b>this</b>, <b>that</b>, and <b>theOther</b> for errors. If
            there are errors, the total count of errors for each observation
            is put into the new variable <b>error__total</b>.
<p>
    <b>. ckvar, key(ssn date_of_visit) markdup(duplicates)</b>
        runs all the validation routines and checks to see if there are any
            observations which have the same combination of <b>ssn</b> and
            <b>date_of_visit</b>. If there are any duplicates, the variable
            <b>duplicates</b> will mark groups of duplicates with different numbers.
            Finally, if there are any errors, the total number of errors
            found in each observation will be stored in the (new) variable
            <b>error__total</b>
<p>
    <b>. ckvar, key(ssn date_of_visit) markdup(duplicates) novars</b>
        checks only to see if there are any observations which have both the
            same <b>ssn</b> and the same <b>date_of_visit</b>. Once again, if there are any
            duplicates, the variable <b>duplicates</b> will mark groups of
            duplicates with different numbers. Finally, the <b>novars</b> option
            states that no error checking or scoring is to be done in this
            case.
<p>
<b><u>Notes</u></b>
<p>
    You do not need any understanding of characteristics to use <b>ckvar</b>, even
    if you need very complicated rules.  <b>ckvaredit</b> provides a dialog box
    which allows the rules to be entered and edited in a natural fashion.  
    <b>ckvardo</b> allows the rules to be dumped into a do file for application to
    another dataset.  If you are, however interested in understanding the
    naming conventions for the characteristics, look at <b>ckchar</b>.  If you are
    truly masochistic, and would like to see how to program complicated rules
    by hand, first look at <b>dochar</b>, and then at <b>docharprog</b>.
<p>
<b><u>Author</u></b>
<p>
    Bill Rising, StataCorp
    email: brising@stata.com
    web: http://homepage.mac.com/brising
</pre>