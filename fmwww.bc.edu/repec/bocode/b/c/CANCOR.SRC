PROCEDURE CANCOR K1 K2 CORMAT* CANCOR.SRC COMPUTES CANONICAL CORRELATIONS BETWEEN TWO DATA* SETS. THE FIRST SET HAS K1 VARIABLES AND THE SECOND HAS K2* VARIABLES (1 < K1 <= K2). CORMAT IS THE CORRELATION MATRIX* FOR ALL THE VARIABLES. CORMAT HAS K1+K2 ROWS AND COLUMNS AND* MUST BE COMPUTED IN THE PROGRAM THAT INVOKES CANCOR.SRC.* (TYPICALLY CORMAT WOULD BE COMPUTED USING THE CMOMENT* COMMAND WITH THE OPTION CORR. IN THAT CASE, CORMAT = %CMOM.)** CANCOR.SRC THEN CALCULATES THE LINEAR COMBINATION OF EACH SET* WHICH MAXIMIZES THE SQUARED CORRELATION BETWEEN THE SETS.* THIS PROCESS IS REPEATED K1 TIMES SINCE THERE CAN BE AS MANY* AS K1 "CANONICAL VARIATES" LINKING THE TWO DATA SETS.** HYPOTHESIS TESTS AND APPLICATIONS USING CANONICAL CORRELATION* MAY BE FOUND IN STATISTICS TEXTBOOKS SUCH AS** Hair, Joseph F. Jr. et al. (1998). Multivariate Data Analysis,* Fifth edition. Prentice Hall. Chapter 8.** Rencher, Alvin C. (1995). Methods of Multivariate Analysis,* Wiley. Chapter 11.*TYPE INTEGER K1 K2TYPE SYMM CORMATLOCAL SYMM SPP SQQ ELOCAL RECT SPQ DLOCAL INTEGER I JLOCAL REAL ZLOCAL VECT PC QCDIM SPP(K1,K1) SQQ(K2,K2) SPQ(K1,K2)DIM D(K1,K1) E(K1,K1) PC(K1) QC(K2)DO I = 1,K1DO J = 1,K1COMPUTE SPP(I,J) = CORMAT(I,J)END DO JDO J = 1,K2COMPUTE SPQ(I,J) = CORMAT(I,K1+J)END DO JEND DO IDO I = 1,K2DO J = 1,K2COMPUTE SQQ(I,J) = CORMAT(K1+I,K1+J)END DO JEND DO IEIGEN SPP G HDO J = 1,K1COMPUTE Z = 1.0/SQRT(G(J))DO I = 1,K1COMPUTE H(I,J) = H(I,J)*ZEND DO IEND DO JCOMPUTE E = TR(H)*SPQ*INV(SQQ)*TR(SPQ)*HEIGEN E A BCOMPUTE D = H*BDO J = 1,K1COMPUTE Z = 1.0/SQRT(A(J))DO I = 1,K1COMPUTE PC(I) = D(I,J)END DO ICOMPUTE QC = INV(SQQ)*TR(SPQ)*PCCOMPUTE QC = Z*QCDISPLAY '   'DISPLAY '         CANONICAL CORRELATION' JDISPLAY 'SQUARED CORRELATION COEFFICIENT = ' A(J)DISPLAY '  'DISPLAY 'COEFFICIENTS FOR THE FIRST DATA SET:'WRITE PCDISPLAY 'COEFFICIENTS FOR THE SECOND DATA SET:'WRITE QCEND DO JEND CANCOR