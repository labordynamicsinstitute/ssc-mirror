<pre>
-------------------------------------------------------------------------------
help for <b>cprplot2</b>, <b>cprplots2</b>
-------------------------------------------------------------------------------
<p>
<b><u>Graph component-plus-residual plots for transformed regressors</u></b>
<p>
        <b>cprplot2</b> <i>varlist</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>retr</u></b><b>ansform(</b><i>exp</i><b>)</b>
                <b><u>yretr</u></b><b>ansform(</b><i>exp</i><b>)</b> <b>rlopts(</b><i>cline_options</i><b>)</b> <b><u>low</u></b><b>ess</b>
                <b>lsopts(</b><i>lowess_options</i><b>)</b> <b><u>msp</u></b><b>line</b> <b>msopts(</b><i>mspline_options</i><b>)</b> <b><u>lp</u></b><b>oly</b>
                <b>lpopts(</b><i>lpoly_options</i><b>)</b> <b>plot(</b><i>plot</i><b>)</b> <i>scatter_options</i>
                <i>twoway_options</i> ]
<p>
        <b>cprplots2</b> <i>vargroups</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>retr</u></b><b>ansform(</b><i>explist</i><b>)</b>
                <b><u>yretr</u></b><b>ansform(</b><i>explist</i><b>)</b> <b>rlopts(</b><i>cline_options</i><b>)</b> <b><u>low</u></b><b>ess</b>
                <b>lsopts(</b><i>lowess_options</i><b>)</b> <b><u>msp</u></b><b>line</b> <b>msopts(</b><i>mspline_options</i><b>)</b> <b><u>lp</u></b><b>oly</b>
                <b>lpopts(</b><i>lpoly_options</i><b>)</b> <i>scatter_options</i> <i>combine_options</i> ]
<p>
    where <i>vargroups</i> is
<p>
        "<i>varlist</i>" "<i>varlist</i>" ...
<p>
    and <i>explist</i> is
<p>
        "<i>exp</i>" "<i>exp</i>" ...
<p>
<p>
    <b>cprplot2</b> and <b>cprplots2</b> are for use after <b>regress</b> and <b>anova</b>; see help 
    regress and anova.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>cprplot2</b> is a variation of official Stata's <b>cprplot</b> (see help cprplot)
    and is used for graphing component-plus-residual plots (a.k.a. partial
    residual plots). There are three main additional features (compared to
    <b>cprplot</b>):
<p>
    (1) The partial residuals (and the "partial" predictions that are used to
        draw the reference line) can be computed taking into account multiple
        variables (the <i>varlist</i>). These adjusted values are then plotted
        against the <i>first</i> variable in <i>varlist</i>. <b>cprplot2</b> can therefore be used
        to produce a single component-plus-residual plot for a variable that
        enters the model repeatedly via different transformations (for
        example, polynomials). Note that all variables in <i>varlist</i> must be
        independent variables currently included in the model.
<p>
    (2) Regressors entering the model via a univariate transformation can be
        re-transformed before drawing the plots using the <b>retransform()</b>
        option. It is thus possible to display the plots using the original
        units of the regressors. Naturally, the reference line (i.e. the line
        representing the predictions from the model being estimated) will be
        curved in the re-transformed plot. Moreover, it is possible to
        re-transform the-right hand side of the equation, i.e. the partial
        residuals, using the <b>yretransform()</b> option. This may be useful for
        models with a transformed dependent variable.
<p>
    (3) The <b>cprplots2</b> command offers the possibility of quickly displaying
        several component-plus-residual plots in a single image. If <i>vargroups</i>
        is omitted, component-plus-residual plots are graphed for all
        independent variables in the model. <b>cprplots2</b> is implemented as a
        wrapper for <b>cprplot2</b> and supports features (1) and (2) discussed
        above.
<p>
    <b>cprplot2</b> only uses observations that are in the estimation sample. Use <b>if</b>
    and <b>in</b> to further restrict the sample.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>retransform(</b><i>exp</i><b>)</b> specifies that the regressor used in the graph be
        transformed through the application of <i>exp</i> (see help exp). Use <b>@</b> as a
        placeholder for the regressor in <i>exp</i>. For example, assume that the
        regressor has been centered for the purpose of model estimation and
        that the sample mean of the regressor is 21.2973. To use the original
        scale of the regressor in the plot, specify <b>retransform(@+21.2973)</b>.
        If <i>exp</i> does not contain <b>@</b>, <b>@</b> is appended to the end of <i>exp</i> in
        parentheses. Thus, say, <b>retransform(exp)</b> is equivalent to
        <b>retransform(exp(@))</b>.
<p>
        If you use <b>retransform()</b> with <b>cprplots2</b>, specify either a single <i>exp</i>
        (enclosed in double quotes if containing blanks) to be applied to all
        plots or a list of <i>exp</i>s to be applied one after another to the
        individual plots. Enclose individual <i>exp</i>s that contain blanks with
        double quotes. Type <b>""</b> to indicate that no transformation be applied
        to a certain plot. Example: <b>retransform("" "1/@" "")</b>.
<p>
    <b>yretransform(</b><i>exp</i><b>)</b> specifies that the partial residuals (and the "partial"
        predictions which are used to draw the reference line) be
        transformed. See the <b>retransform()</b> option above.
<p>
    <b>rlopts(</b><i>cline_options</i><b>)</b> affect the rendition of the reference curve; see
        help cline_options.
<p>
    <b>lowess</b> adds a lowess smooth of the plotted points in order to assist in
        detecting nonlinearities.
<p>
    <b>lsopts(</b><i>lowess_options</i><b>)</b> affect the rendition of the lowess smooth; see
        help twoway_lowess.  Specifying <b>lsopts()</b> implies the <b>lowess</b> option.
<p>
    <b>mspline</b> adds a median spline of the plotted points in order to assist in
        detecting nonlinearities.
<p>
    <b>msopts(</b><i>mspline_options</i><b>)</b> affect the rendition of the median spline smooth;
        see help twoway_mspline.  Specifying <b>msopts()</b> implies the <b>mspline</b>
        option.
<p>
    <b>lpoly</b> adds a local polynomial smooth of the plotted points in order to
        assist in detecting nonlinearities. Stata 10 is required.
<p>
    <b>lpopts(</b><i>lpoly_options</i><b>)</b> affect the rendition of the local polynomial
        smooth; see help twoway_lpoly.  Specifying <b>lpopts()</b> implies the <b>lpoly</b>
        option.  Stata 10 is required.
<p>
    <b>plot(</b><i>plot</i><b>)</b> provides a way to add other plots to the generated graph; see
        help plot_option.
<p>
    <i>scatter_options</i> affect the rendition of the plotted points; see help 
        scatter.
<p>
    <i>twoway_options</i> are any of the options documented in help twoway_options
        excluding <b>by()</b>.  These include options for titling the graph (see
        help title_options) and options for saving the graph to disk (see
        help saving_option).
<p>
    <i>combine_options</i> are any of the options documented in help graph_combine.
        These include options for titling the graph (see help title_options)
        and options for saving the graph to disk (see help saving_option).
<p>
<p>
<b><u>Examples</u></b>
<p>
        . sysuse auto
        . generate mpg2 = mpg^2
        . generate mpg3 = mpg^3
        . regress price weight mpg mpg2 mpg3
        . cprplot2 mpg mpg2 mpg3
        . cprplots2 weight "mpg mpg2 mpg3"
        
<p>
        . generate lnmpg = ln(mpg)
        . regress price weight lnmpg
        . cprplot2 lnmpg, retransform(exp(@))
        . cprplots2 weight lnmpg, retransform("" "exp(@)")
        
<p>
        . gen lnweight = ln(weight)
        . reg lnweight mpg
        . cprplots2 mpg mpg , yretransform("" "exp(@)")
        
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jann@soz.gess.ethz.ch
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[R] regress</b>,
             <b>[R] regression diagnostics</b>
<p>
</pre>