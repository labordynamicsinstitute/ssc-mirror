<pre>
<b>help calibest</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>calibest</b> --   Estimates proportions and means after survey data have been
                    calibrated to population totals
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>calibest</b> <i>varlist</i> , <b><u>mar</u></b><b>ginals</b>(<i>varlist</i>) <b><u>sel</u></b><b>wt</b>(<i>varname</i>) <b><u>calib</u></b><b>wt</b>(<i>varname</i>)
                  <b>psu</b>(<i>psu</i>) <b><u>meth</u></b><b>od</b>(<i>method</i>) [<i>options</i>]
<p>
<p>
    <i>options</i>                         Description
    -------------------------------------------------------------------------
    <i>Required</i>
      <b><u>sel</u></b><b>wt(</b><i>varname</i><b>)</b>                is the selection weight
      <b><u>calib</u></b><b>wt(</b><i>varname</i><b>)</b>              is the calibration weight
      <b><u>mar</u></b><b>ginals(</b><i>varlist</i><b>)</b>            are the variables that were used in the
                                      calibration
      <b>psu(</b><i>psu</i><b>)</b>                      is the primary sampling unit (or _n if
                                      simple random sampling was used)
      <b><u>meth</u></b><b>od(</b><i>method</i><b>)</b>                specifies the estimation method
<p>
    <i>Options</i>
      <b><u>des</u></b><b>ign(</b><i>design</i><b>)</b>                specifies the design options used in the
                                      sampling design
    -------------------------------------------------------------------------
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>calibest</b> estimates means or proportions of survey data after selection
    weights have been calibrated to population totals using, for example, one
    of methods 1 or 2 of Deville and Särndal (1992). It can be regarded as a
    generalisation of Stata's post-stratification estimation commands.
<p>
    The selection weight, <i>selwt</i>, the calibrated weight, <i>calibwt</i>, the
    variables used in the calibration, <i>marginals</i>, the primary sampling unit,
    <i>psu</i>, and the method to be used (means or proportions) must all be
    specified. Sampling design options can also be specified.
<p>
    The output includes estimates, asymptotic standard errors and 95%
    confidence intervals. The asymptotic standard errors and confidence
    intervals are calculated using methods based on Särndal, Swensson, and
    Wretman (1992) and are valid if the sample size is large.  They are
    asymptotically valid regardless of which calibration method is used.
<p>
<b><u>Options</u></b>
<p>
    <b><u>meth</u></b><b>od(</b><i>method</i><b>)</b> specifies the estimation method.  Options are <i>mean</i> or
        <i>prop</i>.
<p>
    <b><u>des</u></b><b>ign(</b><i>design</i><b>)</b> specifies the design options used in the sampling design.
        Standard Stata syntax to define strata, secondary sampling units or
        finite population corrections can be included.
<p>
<p>
<p>
<b><u>Also see</u></b>
<p>
    The program <b>calibrate</b> can calculate the calibration weights to be used in
    the estimation. See also <b>svyset</b>, which can be used when calibrating to a
    single categorical variable.
<p>
<p>
<p>
<b><u>Example 1</u></b>
<p>
    Demonstrate on the <b>multistage</b> dataset.
<p>
        <b>. use http://www.stata-press.com/data/r9/multistage</b>
<p>
    The population consists of 8,000,000 high school seniors. If we were
    estimating the mean weight of high school seniors and the distribution of
    sex and race using selection weight only, we would use the design options
    given in the Stata manual.
<p>
        <b>. svyset county [pweight=sampwgt], strata(state) fpc(ncounties) ||</b>
            <b>school, fpc(nschools)</b>
        <b>. svy: mean weight</b>
        <b>. svy: prop sex race</b>
<p>
    To estimate the same quantities using the calibration weights we need
    information about population totals. Suppose it is known that the
    population is 50% male and 50% female, and contains 7,000,000 white
    seniors. First create calibration weights.  Start by converting the
    categorical variables <b>sex</b> and <b>race</b> into binary indicator variables.
<p>
        <b>. tab sex, gen(isex)</b>
        <b>. tab race, gen(irace)</b>
<p>
    Make a row matrix of popultaion totals (male, female, white).
<p>
        <b>. matrix M=[4000000, 4000000, 7000000]</b>
<p>
    Now calibrate (creating a calibration weight wt1). We use linear
    calibration.
<p>
        <b>. calibrate , marginals(isex1 isex2 irace1) poptot(M)</b>
            <b>entrywt(sampwgt) exitwt(wt1)</b>
<p>
    Estimation using <b>calibest</b>:
<p>
        <b>. calibest weight, method(mean) selwt(sampwgt) calibwt(wt1)</b>
            <b>marginals(isex1 isex2 irace1) psu(county) design(strata(state)</b>
            <b>fpc(ncounties) || school, fpc(nschools))</b>
        <b>. calibest sex race, method(prop) selwt(sampwgt) calibwt(wt1)</b>
            <b>marginals(isex1 isex2 irace1) psu(county) design(strata(state)</b>
            <b>fpc(ncounties) || school, fpc(nschools))</b>
<p>
<b><u>Example 2 (Post-stratification)</u></b>
<p>
    The special case where we are post-stratifying (calibrating to a single
    categorical variable) can be dealt with using the post-stratification
    option of <b>svyset</b>, but <b>calibest</b> should give the same result. To
    illustrate, we post-stratify to sex (4,000,000 male and 4,000,000
    female).
<p>
        <b>. gen sextot=4000000</b>
        <b>. svyset county [pweight=sampwgt], strata(state) fpc(ncounties) ||</b>
            <b>school, fpc(nschools) poststrata(sex) postweight(sextot)</b>
        <b>. svy: mean weight</b>
        <b>. svy: prop sex race</b>
<p>
<p>
    The same results can be obtained using <b>calibest</b>.
<p>
        <b>. matrix M=[4000000, 4000000]</b>
        <b>. calibrate , marginals(isex1 isex2) poptot(M) entrywt(sampwgt)</b>
            <b>exitwt(wt2)</b>
        <b>. calibest weight, method(mean) selwt(sampwgt) calibwt(wt2)</b>
            <b>marginals(isex1 isex2) psu(county) design(strata(state)</b>
            <b>fpc(ncounties) || school, fpc(nschools))</b>
        <b>. calibest sex race, method(prop) selwt(sampwgt) calibwt(wt2)</b>
            <b>marginals(isex1 isex2) psu(county) design(strata(state)</b>
            <b>fpc(ncounties) || school, fpc(nschools))</b>
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>calibest</b> with <b>method=</b><i>mean</i> saves the following matrices in <b>r()</b>.
    (<b>method=</b><i>prop</i> does not save anything):
<p>
    Matrices       
      <b>r(meff)</b>             column matrix of mis-specification effect (one row
                            for each dependent variable)
      <b>r(rmat)</b>             results matirx with one row for each dependent
                            variable and four columns: (estimate, SE, lower
                            and upper 95% confidence limits)
<p>
<p>
<b><u>References</u></b>
<p>
    Deville, J.-C., and C.-E. Särndal.  1992.  Calibration estimators in
        survey sampling.  <i>Journal of the American Statistical Association</i> 87:
        376-382.
<p>
    Särndal, C.-E., and S. Lundström.  2005.  <i>Estimation in Surveys with</i>
        <i>Nonresponse</i>.  New York, Wiley.
<p>
    Särndal, C.-E., B. Swensson, and J. H. Wretman 1992. <i>Model Assisted</i>
        <i>Survey Sampling</i>.  New York: Springer-Verlag.
<p>
<p>
<b><u>Author</u></b>
<p>
    John D'Souza
    National Centre for Social Research
    London, England, UK
    John.D'Souza@natcen.ac.uk
<p>
<p>
</pre>