<pre>
-------------------------------------------------------------------------------
help for <b>brrtab</b>
-------------------------------------------------------------------------------
<p>
<b><u>Two-way tables for survey data, with balance repeated replication (BRR) based s</u></b>
<b><u>&gt; tandard errors</u></b>
<p>
    <b>brrtab</b> <i>varname1</i> <i>varname2</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [ <b>,</b>
<p>
    [survey design options]
<p>
           <b><u>brrw</u></b><b>eight(</b><i>varlist</i><b>)</b> <b>fay(</b><i>#</i><b>)</b> <b>dof(</b><i>#</i><b>)</b>
<p>
    [tabulate options]
<p>
           <b>tab(</b><i>varname</i><b>)</b> <b><u>miss</u></b><b>ing</b>
<p>
    [display items]
<p>
           <b><u>cel</u></b><b>l</b> <b><u>cou</u></b><b>nt</b> <b>row</b> <b><u>col</u></b><b>umn</b> <b>obs</b> <b>se</b> <b>ci</b> <b>deff</b> <b>deft</b>
<p>
    [display options]
<p>
           [ <b><u>prop</u></b><b>ortion</b> | <b><u>per</u></b><b>cent</b> ] <b><u>nolab</u></b><b>el</b> <b><u>nomarg</u></b><b>inals</b> <b><u>for</u></b><b>mat(%</b><i>fmt</i><b>)</b> <b><u>vert</u></b><b>ical</b>
           <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>
<p>
    [statistic options]
<p>
           <b><u>pea</u></b><b>rson</b> <b>lr</b> <b><u>nul</u></b><b>l</b> <b>wald</b> <b>llwald</b> <b><u>noadj</u></b><b>ust</b> ]
<p>
<p>
<b>pweight</b>s are allowed; see help weights.  They may be specified with the
command, or by the svyset pweight command.
<p>
A set of replicate weights are required.  They may be specified through the
<b>brrweight</b> option; they need not be respecified for subsequent brr-based
commands.
<p>
<b>brrtab</b> typed without arguments redisplays previous results.  Any of the
"display items", "display options", or "statistic options" can be specified
when redisplaying with the following exception: <b>wald</b> must be specified at run
time.
<p>
<p>
<b><u>Description</u></b>
<p>
<b>brrmodel</b> produces two-way tabulations with tests for independence for complex
survey data.  The method of balanced repeated replication (BRR) is used, in
conjunction with a set of user-specified replicate weights, to estimate
(co)variances of estimates.  This is an alternate method to the Taylor series
linearization methods used by Stata's svy-based commands.
<p>
Except for the different method of variance calculation, <b>brrtab</b> has identical
syntax as svytab.  Point estimates are the same as those from svytab; standard
errors and tests of independence are different.
<p>
{strong}This is a beta test version of the command.  As far as I know,
everything works as it should, but use at your own risk.  Currently, finite
population correction factors (FPC) are not supported.
<p>
<p>
<b><u>Options unique to brrweight</u></b>
<p>
<b>brrweight()</b> specifies the list of variables that contain the replicate weights
    for the dataset.  The standard errors for the model are based on the
    variation in the estimates generated across the various weights.
<p>
    A set of <b>brrweights</b> is required for the analysis.  Once the brrweights are
    specified they are stored as a characteristic of the dataset and need not
    be respecified in subsequent commands.
<p>
<b>fay()</b> specifies the k value that should be used for weighting the estimates,
    based on Fay's method.  The default is zero, meaning that simple averaging
    will be used.  As with the replicate weights, the value for fay() is stored
    as a characteristic of the dataset once it is specified, and need not be
    re-specified in subsequent commands.
<p>
<b>dof()</b> specifies the degrees of freedom for the analysis.  By default, it is
    equal to the number of replications.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . brrtab agegrp gender [pw=wgt] , brrw(brrw*)
        . brrtab, se ci deff                 [redisplay std. err., etc.]
        . brrtab, count column obs           [redisplay counts, etc.]
<p>
        . brrtab agegrp gender, count se     [compute std. err. of counts]
        . brrtab, count ci                   [redisplay CI of counts]
<p>
        . brrtab agegrp gender, wald         [compute Wald test]
        . brrtab, pearson lr                 [redisplay <b>pearson</b> and <b>lr</b> tests]
<p>
        . brrtab agegrp gender, tab(income)  [gives income proportions by
                                             <b>agegrp</b> and <b>gender</b>]
<p>
<p>
<b><u>Saved Results</u></b>
<p>
<b>brrtab</b> generates the same saved results as <b>svytab</b>.
<p>
Note that e(cmd) is set to "svytab" in order to allow post-tabulation tests to 
&gt; function correctly.
<p>
<p>
<b><u>Methods and formulae</u></b>
<p>
Point estimates are calculated using aweights, and are identical to those
produced by Stata's svytab.  The (co)variance matrix of the estimates is formed
by calculating
<p>
                   G    
                V = c * SUM [ (B - B(i))(B - B(i))' ]
                  i=1
<p>
where B a vector of the estimated cell contents based on the full sample
weights, B(i) is the estimated vector using the i'th set of replicate weights,
G is the number of replicates, and c is a constant defined as:
<p>
         1 / G            for standard BRR (i.e. fay==0), or
<p>
         1 / (G*(1-k)^2)  for Fay's method.
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
<b>brrtab</b> consists largely of the ado file code from official Stata's <b>svytab</b>
command, version 1.1.6, modified to calculate (co)variances differently.  I
would like to thank Bobby Gutierrez at StataCorp for advice on implementation
of BRR.
<p>
<p>
<b><u>Author</u></b>
<p>
        Nick Winter
        Cornell University
        nw53@cornell.edu
<p>
</pre>