<pre>
-------------------------------------------------------------------------------
<b> help</b> for tabxml
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
<b>tabxml</b> - Save results in XML format for use in <i>Microsoft Excel</i> and
OpenOffice <i> Calc</i>
<p>
<b><u>Syntax</u></b>
<p>
<b>tabxml</b> [<b>,</b> <i>options</i>]
<p>
<p>
<a name="options"></a>    <i>options</i>                      Description
    -------------------------------------------------------------------------
    variables
      <b>dv</b>(<i>varname</i>)                dependent variable
      <b>ivd</b>(<i>varlist</i>)               independent discrete variables
      <b>ivc</b>(<i>varlist</i>)               independent continuous variables
      <b>split</b>(<i>varname</i>)             split data into subgroups
<p>
    Output
      <b>save</b>(<i>string</i>)               name of the output file
      <b>options</b>(<i>varlist</i>)           select output for independent variables
      <b>order</b>(<i>varlist</i>)             order of independent variables
      <b>display</b>                    display output
<p>
    Conditions
      <b>cond</b>(<i>string</i>)               condition - modifies total population size
      <b>subcond</b>(<i>string</i>)            sub condition - creates a sub population
<p>
    Table Formatting
      <b>percent</b>(<i>string</i>)            select percent type for discrete variables
      <b>tformat</b>(<i>string</i>)            select decimal places for output
      <b>justify</b>(<i>string</i>)            data alignment
      <b>rotate</b>(<i>string</i>)             rotate dependent variable labels
      <b>labrown</b>(<i>string</i>)            determines the way the 'n' counts are
                                   displayed for the independent variables
      <b>labcoln</b>(<i>string</i>)            determines the way the 'n' counts are
                                   displayed for the dependent variable
      <b>bold</b>                       make independent variable names bold
      <b>olines</b>                     omit lines between independent variables
      <b>otab</b>                       omit indentations from indepedent variable
                                   labels
      <b>sp</b>                         show the % symbol for all percents
      <b>chi2</b>                       display chi2 statistic for all independent
                                   variables
      <b>chidec</b>(<i>integer</i>)            number of decimal places for chi2 statistic
      <b>pval</b>                       display p-value for all independent
                                   variables
      <b>pdec</b>(<i>integer</i>)              number of decimal places for p-value
<p>
    Excel/Calc Paths
      <b>excelpath</b>(<i>string</i>)           select directory for Excel
      <b>calcpath</b>(<i>string</i>)            select directory for Calc
<p>
    svy options
      <b>osvy</b>                        data is not svy
<p>
<b><u>Description</u></b>
<p>
<b>tabxml</b> export Stata output directly into an XML file that could be opened with
<i>Microsoft Excel</i> or OpenOffice <i> Calc</i>. The program is relatively flexible and 
produces journal quality tables in <i>Microsoft Excel</i> or OpenOffice <i> Calc</i>; and 
allows users to apply different formats to the elements of the output table and
&gt;  
essentially do everything <i>Microsoft Excel</i> or OpenOffice <i> Calc</i> can do in terms 
of formatting from within Stata as oppose to using an external package like LaT
&gt; ex. A key 
feature includes displaying trailing zeros after decimal places.
<p>
<b>tabxml</b> can create formatted tables of frequencies and/or percents for discrete 
independent variables, means and standard errors / confidence intervals for con
&gt; tinuous 
independent variables. Two-way tables can be ceated by selecting a dependent va
&gt; riable. 
Multiple independent variables are permitted.  
<p>
<b><u>Options</u></b>
<p>
<a name="output"></a>        +--------+
    ----+ Output +-----------------------------------------------------------
<p>
<b>save(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b> specifies a name for XML file where tables are outputted. 
Files are saved in a folder named "Excel" which is created (if missing) in the 
&gt; current
directory. If save(["]filename["]) is omitted, the output will be saved in tab_
&gt; out.xml 
located in the current working directory.
<p>
<b>options</b>(<i>varlist</i>)} modify output type for discrete and continuous independent 
variables. Output type options for discrete independent variables include (n) d
&gt; isplayed 
"n" or (per) displayed "per". Note default output is "n (per)". Output type opt
&gt; ions for 
continuous independent variables include (mean) displayed "mean", or (mean ci) 
&gt; displayed 
"mean (CI)". Note default output is "n (SE)". If <b>split</b> is specified option(noto
&gt; tal) 
only outputs the subgroups of <b>split</b> and omits the totals.
<p>
<b>order</b>(<i>varlist</i>)} rearrange order of independent variables. Default order of 
independent variables is ivd(<i>varlist</i>) followed by ivc(<i>varlist</i>). To rearrange 
the order of the independent variables write the <i>varlist</i> of discrete independen
&gt; t
variables and continuous independent variables in the order you wish them to ap
&gt; pear.  
  
<b>display</b> displays the output in Stata.
<p>
<p>
        +------------+
    ----+ Conditions +-------------------------------------------------------
<p>
<b>cond</b>(<i>string</i>) reduces the population size of the dataset to meet the condition. 
For example cond(panel==1) reduces the populations size such that the variable 
&gt; panel
equals one.
<p>
<b>subcond</b>(<i>string</i>) creates a sub population of the total population. 
For example subcond(age&gt;30) creates a sub population such that the age of the 
respondents is greater than 30. 
<p>
<p>
        +------------------+
    ----+ Table Formatting +-------------------------------------------------
<p>
<b>percent</b>(<i>string</i>) tables for independent discrete variables can be either row 
or column (col) percents. Default is column percents.
<p>
<b>tformat</b>(<i>string</i>) modify the number of decimal places for table percents for disc
&gt; rete
independent variables; and means, confidence intervals and standard errors for 
&gt; continuous 
independent variables. Default is two decimal places. 
<p>
<b>justify</b>(<i>string</i>) justify the output of the data. Left (l), right (r) and centre 
&gt; (c) 
justify. Default justify is left align.
<p>
<b>rotate</b>(<i>string</i>) rotate the variable labels of the dependent variable. For exampl
&gt; e, 
<b>rotate(</b><i>60</i><b>)</b> produces a pleasing effect. Default is horizontal variable names.
<p>
<b>labrown</b>(<i>string</i>) if this option is specified counts are now included in the 
variable labels of the independent variables. For example, <b>label(</b><i>n</i><b>=)</b> produces 
the variable label followed by (n=#) where # is the count.
<p>
<b>labcoln</b>(<i>string</i>) if this option is specified counts are now included in the vari
&gt; able labels
of the dependent variable. For example, <b>label(</b><i>n</i><b>=)</b> produces the variable label f
&gt; ollowed by
(n=#) where # is the count.  
<p>
<b>bold</b> makes the independent variable names bold face. 
<p>
<b>olines</b> omit lines between independent variables.
<p>
<b>otab</b> omit indentations from indepedent variable lables.
<p>
<b>sp</b> show the % symbol for all percents.
<p>
<b>chi2</b> display chi2 statistic for all independent variables.
<p>
<b>chidec</b>(<i>integer</i>) number of decimal places for chi2 statistic. Default is 2 decim
&gt; al 
places.
<p>
<b>pval</b> display p-value for all independent variables.
<p>
<b>pdec</b>(<i>integer</i>) number of decimal places for p-value. Default is 2 decimal 
places.
<p>
<p>
        +------------------+
    ----+ Excel/Calc Paths +-------------------------------------------------
<p>
<b>excelpath</b>(<i>string</i>) select the full directory for Excel to open the file from Sta
&gt; ta. 
Default is "C:/Program Files/Microsoft Office/office*". Where * represents the 
&gt; current 
version of office. This option is particulary useful when Office is not on the 
&gt; C:\ drive.
<p>
<b>calcpath</b>(<i>string</i>) select the full directory for Calc to open the file from Stata
&gt; . 
Default is "C:/Program Files/OpenOffice*/program". Where * represents the curre
&gt; nt 
version of OpenOffice. This option is particulary useful when OpenOffice is not
&gt;  on 
the C:\ drive.
<p>
<p>
        +-------------+
    ----+ svy options +------------------------------------------------------
<p>
<b>osvy</b> data is not svy. No survey characteristics are set
<p>
<b><u>Examples</u></b>
<p>
The following uses the sample data set multistage. To access this dataset and d
&gt; eclare 
the dataset is survey data use the following code:
<p>
      <b>.use http://www.stata-press.com/data/r10/multistage</b>
 
      <b>.svyset county [pw=sampwgt], strata(state) fpc(ncounties) || school,</b>
                    <b>fpc(nschools)</b>
 
<p>
        +--------------+
    ----+ Basic Syntax +-----------------------------------------------------
<p>
      <b>.tabxml, dv(county) ivd(race) ivc(weight)</b>
 
<p>
In this example, <b>tabxml</b> display a cross tab of county against the discrete 
independent variable race and the continuous independent variable weight in tha
&gt; t 
specific order. Variable labels for independent variables have indentations and
&gt;  
there are lines between each independent variable. The output for the discrete 
independent variables is "n (per)", similarily the output for the continuous 
independent variable is "mean (SE)". The percents are column percents and "per"
&gt; , 
"mean" and "SE" are all rounded to two decimal places. All data is left aligned
&gt; . 
The file is saved as "tab_out.xml". The output is omitted in Stata. 
<p>
<i>Extensions:</i> options <b>split percent tformat save subcond justify</b>
<p>
      <b>.tabxml, dv(county) ivd(race) split(sex) save(temp) tf(1)</b>
                    <b>subcond(weight&gt;200) justify(r)</b>
<p>
In this example, <b>tabxml</b> display a cross tab of county against the discrete 
independent variable race split by sex (female, male and total are the subgroup
&gt; s) 
for the sub population where the weight is greater than 200lbs. Variable labels
&gt;  for 
independent variables have indentations and there are lines between either side
&gt;  
of the independent variable. The output for the discrete independent variable i
&gt; s 
"n (per)". The "per" is rounded to one decimal place. All data is right aligned
&gt; . 
The file is saved as "temp.xml". The output is omitted in Stata. 
<p>
<i>Extensions:</i> options <b>options order display bold olines otab</b>
<p>
      <b>.tabxml, dv(county) ivd(race) ivc(weight) split(sex) cond(height&gt;=400)</b>
                    <b>order(weight race) options(n mean nototal) display bold</b>
                    <b>olines otab</b>
<p>
In this example, <b>tabxml</b> display a cross tab of county against the continuous 
independent variable weight and the discrete independent variable race in that 
specific order split by sex (female and male are the subgroups). The dataset is
&gt;  
reduced where race equals one (white). Variable labels for independent variable
&gt; s 
do not have indentations and there are no lines between each independent variab
&gt; le. 
The independent variable names are bolded. The output for the discrete independ
&gt; ent 
variables is "n", similarily the output for the continuous independent variable
&gt;  
is "mean". The percents are col percents and "per", "mean" are all rounded to t
&gt; wo 
decimal place. All data is left aligned. The file is saved as "tab_out.xml". 
The output is omitted in Stata. 
<p>
<i>Extensions:</i> options <b>pval chi2 pdec sp label options excelpath</b>
<p>
      <b>.tabxml, dv(county) ivd(race) options(per) display pval pdec(3) chi2 sp</b>
                    <b>labrown(sample count=)</b>
<p>
In this example, <b>tabxml</b> display a cross tab of county against the discrete 
independent variable race. Variable labels for the independent variable have 
indentations and there are lines either side of the  independent variable. The 
independent variable name is not bolded. The output for the discrete independen
&gt; t 
variable is "per". The percents are col percents and "per" are rounded to two 
decimal places. The percents are followed the % symbol. All data is left aligne
&gt; d. 
The file is saved as "tab_out.xml". The independet variable labels are followed
&gt;  
by (sample count=#). The p-val statistic is displayed and rounded to 3 decimal 
places. The chi2 statistic is displayed and rounded to 2 decimal places. The ou
&gt; tput 
is displayed in Stata.  
<p>
<b><u>Authors</u></b>
<p>
    Richard Ryall ARCSHS (Australian Research Centre in Sex, Health and
    Society)
    Email: R.Ryall@latrobe.edu.au
<p>
    Jason Ferris ARCSHS (Australian Research Centre in Sex, Health and
    Society)
    Email: J.Ferris@latrobe.edu.au
<p>
<p>
<p>
<p>
<p>
</pre>