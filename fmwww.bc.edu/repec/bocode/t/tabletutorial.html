<pre>
    ---------------------------------------------------------------
<p>
    <b>Tutorial:</b>
<p>
    <b>Automated table generation and reporting with Stata</b>
<p>
    ---------------------------------------------------------------
<p>
<p>
    Ben Jann, ETH Zurich, jannb@ethz.ch
<p>
    November 2008
<p>
<p>
<p>
    Required user packages:
<p>
        - <b>mat2txt</b>   <i>&lt;install&gt;</i>
        - <b>estwrite</b>  <i>&lt;install&gt;</i>
        - <b>estout</b>    <i>&lt;install&gt;</i>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                            <i>&lt;PDF version&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="outline"></a><p>
    <b>Outline</b>
<p>
<p>
      o Introduction
<p>
      o Part 1: Low-level results processing
<p>
        - How to access results from Stata routines
        - Getting things out of Stata: The <b>file</b> command
        - Wrappers
<p>
      o Part 2: Handling model estimation results
<p>
        - Results from "estimation" commands are special
        - Archiving models
        - Tabulating estimation results
<p>
      o Part 3: Automatic reporting
<p>
        - Automation
        - Example with LaTeX
        - Example with MS Word and Excel
<p>
<p>
    <i>&lt;next&gt;</i>                                                    <i>&lt;top&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="intro"></a><p>
    <b>Introduction I</b>
<p>
    Statistical software packages are good at analyzing data, 
    but they are often weak when it comes to reporting.
<p>
<p>
      o Output from statistical routines contains all sorts of
        details that are valuable to the researcher but are not
        so important for reporting.
<p>
<p>
        <b>=&gt; you have to select relevant results</b>
<p>
<p>
<p>
      o Output from statistical routines sometimes contains 
        results that are not well suited for interpretation or 
        for presentation to a non-expert audience.
<p>
<p>
        <b>=&gt; you have to transform results</b>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="intro2"></a><p>
    <b>Introduction II</b>
<p>
      o Output from statistical routines is often not well 
        formatted for presentation.
<p>
<p>
        <b>=&gt; you have to rearrange and reformat results</b>
<p>
<p>
<p>
      o Various software packages might be used for further
        processing of results and for reporting.
<p>
<p>
        <b>=&gt; you have to transfer results to specific file formats</b>
<p>
<p>
<p>
      o You might need to re-use results for other reports or
        extract additional results at a later point in time.
<p>
<p>
        <b>=&gt; you have to archive results</b>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="intro3"></a><p>
    <b>Introduction III</b>
<p>
<p>
<p>
    +--------------+
    |  <b>TWO MAXIMS</b>  |
    +--------------+
<p>
<p>
<p>
    <b>1) Never Copy/Paste results by hand</b>
<p>
    You will almost surely make tons of mistakes!
<p>
<p>
<p>
    <b>2) Do everything only once</b>
<p>
    It is simply a waste of time to do things more than once.
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="intro4"></a><p>
    <b>Introduction IV</b>
<p>
<p>
      o These two goals can be reached by <b>automation</b>.
<p>
<p>
      o Automation has its <b>price</b>:
<p>
        - initial investment of time and effort
<p>
        - reduced flexibility
<p>
<p>
      o However, personally I find that automation almost always 
        pays off.
<p>
<p>
      o For example, although you are convinced that you do the
        tables in your research paper only once, you'll find 
        yourself doing them over, and over, and over, ...
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="intro5"></a><p>
    <b>Introduction V</b>
<p>
<p>
      o Furthermore, automation increases <b>quality</b>:
<p>
        - no copy/paste errors
<p>
        - errors and possible improvements are often detected after 
          everything is done; in a non-automated settings there are 
          high barriers against correcting such errors or 
          implementing the improvements
<p>
        - the lack of flexibility leads to standardization (which 
          is usually positive, but can sometimes also hinder 
          innovation)
<p>
        - automation makes research more replicable
<p>
<p>
      o Moreover, good tools can lower the costs of automation
        dramatically.
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="intro6"></a><p>
    <b>Introduction VI</b>
<p>
<p>
      o Of course, there are also exceptions where automation might 
        not be worth the effort.
<p>
<p>
      o Examples:
<p>
        - slides for presentations that are only used once or twice
<p>
        - numbers in text body (trick: only cite approximate 
          values)
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1"></a><p>
    <b>Part 1: Low-level results processing</b>
<p>
<p>
      o How to access results from Stata routines
<p>
      o Getting things out of Stata: The <b>file</b> command
<p>
      o Wrappers
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1a"></a><p>
    <b>Accessing results in Stata I</b>
<p>
      o A prerequisite for automation is that the results from
        statistical routines can be accessed by the user.
<p>
<p>
      o In Stata, most commands return their results in <b>r()</b> or <b>e()</b>
        (see <b>return</b>).
<p>
        - <b>r()</b> is used by "general" commands such as <b>summarize</b>
        - <b>e()</b> is used by "estimation" commands such as <b>regress</b>
<p>
<p>
      o Returned are:
<p>
        - string scalars
        - numeric scalars
        - numeric matrices
<p>
        - For example, estimation commands return the number of 
          observations in <b>e(N)</b>, the name of the command in <b>e(cmd)</b>, 
          and the coefficients vector and the variance matrix in 
          <b>e(b)</b> and <b>e(V)</b>.
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1a2"></a><p>
    <b>Accessing results in Stata II</b>
<p>
<p>
      o Use <b>return list</b> or <b>ereturn list</b> to find out about available 
        returns. Use <b>matrix list</b> to see the contents of a returned 
        matrix.
<p>
INCLUDE help tabletutorial_1
        <i>&lt;run&gt;</i>
<p>
INCLUDE help tabletutorial_2
        <i>&lt;run&gt;</i>
<p>
<p>
      o Use <b>matrix list</b> to see the contents of a returned matrix.
<p>
INCLUDE help tabletutorial_3
        <i>&lt;run&gt;</i>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1a3"></a><p>
    <b>Accessing results in Stata III</b>
<p>
<p>
      o You can use the <b>e()</b> and <b>r()</b> scalars and matrices more or 
        less as you would use any other scalar or matrix, although 
        it is often advisable to first copy the results into 
        regular macros, scalars, or matrices (see <b>macro</b>, <b>scalar</b>,
        and <b>matrix</b>).
<p>
<p>
      o Examples:
<p>
<p>
INCLUDE help tabletutorial_4
        <i>&lt;run&gt;</i>
<p>
<p>
INCLUDE help tabletutorial_5
        <i>&lt;run&gt;</i>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1a4"></a><p>
    <b>Accessing results in Stata IV</b>
<p>
      o Example with matrices:
<p>
INCLUDE help tabletutorial_6
        <i>&lt;run&gt;</i>
<p>
INCLUDE help tabletutorial_7
        <i>&lt;run&gt;</i>
<p>
<p>
      o Note that coefficients and standard errors can also be 
        accessed as <b>_b[]</b> and <b>_se[]</b>:
<p>
INCLUDE help tabletutorial_8
        <i>&lt;run&gt;</i>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1b"></a><p>
    <b>Getting things out of Stata: The file command I</b>
<p>
<p>
      o The <b>file</b> command is used in Stata to write to (or read 
        from) a file on disk.
<p>
      o Use <b>file</b> to produce custom output files.
<p>
      o <b>file</b> is a low level command. It just writes plain text, 
        line by line. You have to do all formatting yourself.
<p>
      o <b>file</b> may appear a bit clumsy: You have to
<p>
          <b>file open</b> <i>handle</i> <b>using</b> <i>filename</i>, <b>write</b> /*initialize*/
<p>
          <b>file write</b> <i>handle</i> <i>...</i>                  /*write*/
          <i>...</i>
<p>
          <b>file close</b> <i>handle</i>                      /*done*/
<p>
      o However, <b>file</b> can produce any desired output.
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1b2"></a><p>
    <b>Getting things out of Stata: The file command II</b>
<p>
<p>
      o Example: Write a tab delimited file containing descriptive
        statistics
<p>
<p>
INCLUDE help tabletutorial_9
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1b3"></a><p>
    <b>Getting things out of Stata: The file command III</b>
<p>
<p>
      o This can easily be turned into a program:
<p>
INCLUDE help tabletutorial_11
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1b4"></a><p>
    <b>Getting things out of Stata: The file command IV</b>
<p>
      o Or let's do HTML:
<p>
INCLUDE help tabletutorial_12
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part1c"></a><p>
    <b>Wrappers</b>
<p>
<p>
      o Of course you do not have to write a new program for
        everything.
<p>
<p>
      o Check the SSC Archive to find out whether anything already
        exists that serves your needs (see <b>findit</b> and <b>ssc</b>).
<p>
<p>
      o For example, <b>mat2txt</b> can be used to write a matrix to a
        tab-delimited file:
<p>
INCLUDE help tabletutorial_13
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2"></a><p>
    <b>Part 2: Handling model estimation results</b>
<p>
<p>
      o Results from "estimation" commands are special
<p>
      o Archiving models
<p>
      o Tabulating estimation results
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2a"></a><p>
    <b>Results from "estimation" commands are special</b>
<p>
<p>
      o Results from e-class commands are special because they
        share a common structure:
<p>
        - a coefficients vector: <b>e(b)</b>
<p>
        - and a variance matrix: <b>e(V)</b>
<p>
<p>
      o There is, to some degree, a consensus/common practice of
        how to design tables containing model estimation results.
<p>
<p>
      o Many models are estimated, usually, and estimation may be 
        computationally intensive so that archiving the results is 
        an issue.
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2b"></a><p>
    <b>Archiving models I</b>
<p>
<p>
      o A good approach is to keep model estimation and reporting 
        two separate processes.
<p>
      o This requires that model estimates are stored for later
        tabulation.
<p>
      o Estimating a new model replaces the <b>e()</b>-returns of a 
        previous model. However, the results can be stored in 
        memory under a specific name using <b>estimates store</b> or the 
        <b>eststo</b> user command.
<p>
      o In Stata 10, it is also possible to save the results of a 
        model on disk using <b>estimates save</b>.
<p>
      o A problem with <b>estimates save</b> is that it can only store one 
        model at the time (i.e. each model is saved in a separate 
        file). However, the <b>estwrite</b> user command overcomes this 
        problem.
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2b2"></a><p>
    <b>Archiving models II</b>
<p>
<p>
      o Example:
<p>
INCLUDE help tabletutorial_14
        <i>&lt;run&gt;</i>
<p>
INCLUDE help tabletutorial_15
        <i>&lt;run&gt;</i>
<p>
<p>
      o Two weeks later:
<p>
INCLUDE help tabletutorial_16
        <i>&lt;run&gt;</i>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c"></a><p>
    <b>Tabulating estimation results I</b>
<p>
      o Various commands exists to compile and export tables of 
        model estimates. <b>estout</b> is one of them. Others are <b>outreg</b> 
        (John Luke Gallup), <b>outreg2</b> (Roy Wada), <b>xml_tab</b> (Lokshin &amp;
        Sajaia), <b>outtex</b> (Antoine Terracol), <b>est2tex</b> (Marc 
        Muendler), <b>mktab</b> (Nicholas Winter), <b>parmest</b> (Roger Newson), 
        of which all have their pros and cons.
<p>
<p>
      o The <b>estout</b> package contains four commands:
<p>
        <b>esttab</b>: User-friendly command to produce publication-style 
        regression tables for screen display or in various export 
        formats such as such as CSV, RTF, HTML, or LaTeX.
<p>
        <b>estout</b>: Generic program to compile regression tables (the 
        engine behind <b>esttab</b>).
<p>
        <b>estadd</b>: Program to add extra results (such as e.g., beta
        coefficients) to <b>e()</b> so that they can be tabulated.
<p>
        <b>eststo</b>: Improved version of <b>estimates store</b>.
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c2"></a><p>
    <b>Tabulating estimation results II</b>
<p>
<p>
      o <b>esttab</b> and <b>estout</b> are very flexible and can produce all 
        sorts of regression tables.
<p>
<p>
      o I will only show a few basic examples here. Many more
        examples can be found at the following website:
<p>
            http://repec.org/bocode/e/estout
<p>
<p>
      o The basic procedure is to store a number of models and 
        then apply <b>esttab</b> (or <b>estout</b>) to tabulate them:
<p>
INCLUDE help tabletutorial_17
        <i>&lt;run&gt;</i>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c3"></a><p>
    <b>Tabulating estimation results III</b>
<p>
<p>
      o <b>esttab</b> can either display the table in Stata's results
        window or export it to a file on disk using one of several
        formats, such as
<p>
        - <b>fixed</b>: fixed-format ASCII
<p>
        - <b>tab</b>: tab-delimited ASCII
<p>
        - <b>csv</b>: CSV (Comma Separated Value format) for use with 
          MS Excel
<p>
        - <b>rtf</b>: Rich Text Format for use with word processors
<p>
        - <b>tex</b>: LaTeX format
<p>
        - ...
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c4"></a><p>
    <b>Tabulating estimation results IV</b>
<p>
<p>
      o Use with MS Excel: <b>csv</b> or <b>scsv</b>
<p>
INCLUDE help tabletutorial_18
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
INCLUDE help tabletutorial_19
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
        (The <b>scsv</b> format uses a semi-colon as delimiter which is
        appropriate for certain language versions of Excel.)
<p>
<p>
      o Use the <b>plain</b> option if you intend to do additional 
        computations in MS Excel:
<p>
INCLUDE help tabletutorial_20
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
        (No XML support. Sorry.)
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c5"></a><p>
    <b>Tabulating estimation results V</b>
<p>
<p>
      o Use with MS Word: <b>rtf</b>
<p>
INCLUDE help tabletutorial_21
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
      o Appending is possible. Furthermore, use <b>varwidth(#)</b> and 
        <b>modelwidth(#)</b> to change column widths:
<p>
INCLUDE help tabletutorial_21b
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
      o Including RTF literals:
<p>
INCLUDE help tabletutorial_21c
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
INCLUDE help tabletutorial_21d
        <i>&lt;run&gt;</i>  <i>&lt;show&gt;</i>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c6"></a><p>
    <b>Tabulating estimation results VI</b>
<p>
<p>
      o Use with LaTeX: <b>tex</b>
<p>
INCLUDE help tabletutorial_22
        <i>&lt;run&gt;</i>
      
        For a preview, click
        
            <i>&lt;texify&gt;</i>
                
        to compile the file (LaTeX required) and then 
        
            <i>&lt;show PDF&gt;</i>
<p>
        to view the result. If <i>&lt;texify&gt;</i> does not work, click
         
            <i>&lt;show PDF from web&gt;</i>
        
        to download and view a precompiled version. 
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c7"></a><p>
    <b>Tabulating estimation results VII</b>
<p>
<p>
      o Improved LaTeX table using the <i>booktabs</i> package:
<p>
INCLUDE help tabletutorial_24
        <i>&lt;run&gt;</i>
                <i>&lt;texify&gt;</i>  <i>&lt;show PDF&gt;</i>  <i>&lt;show PDF from web&gt;</i>
<p>
<p>
      o Improved LaTeX table using the <i>dcolumn</i> package:
<p>
INCLUDE help tabletutorial_25
        <i>&lt;run&gt;</i>
                <i>&lt;texify&gt;</i>  <i>&lt;show PDF&gt;</i>  <i>&lt;show PDF from web&gt;</i>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c8"></a><p>
    <b>Tabulating estimation results VIII</b>
<p>
<p>
      o Advanced LaTeX example
<p>
INCLUDE help tabletutorial_26
        <i>&lt;run&gt;</i>
                <i>&lt;texify&gt;</i>  <i>&lt;show PDF&gt;</i>  <i>&lt;show PDF from web&gt;</i>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part2c9"></a><p>
    <b>Tabulating estimation results IX</b>
<p>
<p>
      o <b>esttab</b> can be used to tabulate any results, not just
        regression models, as long as they are posted in <b>e()</b> in an
        appropriate way.
<p>
<p>
      o Example: descriptives table
<p>
INCLUDE help tabletutorial_27
        <i>&lt;run&gt;</i>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3"></a><p>
    <b>Part 3: Automatic reporting</b>
<p>
<p>
      o Automation
<p>
      o Example with LaTeX
      
      o Example with MS Word and Excel
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3a"></a><p>
    <b>Automation</b>
<p>
<p>
      o Automatic reporting means that results and information on
        formatting should be separated.
<p>
<p>
      o It has to be possible to replace the data without losing
        the formatting.
<p>
<p>
      o The usual approach is to maintain a hand-edited master 
        file that structures the document and sets the formatting 
        etc. and then dynamically link the files containing 
        results into this file.
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3b"></a><p>
    <b>Example with LaTeX I</b>
<p>
<p>
      o Step 1: Set up a master file
<p>
INCLUDE help tabletutorial_28
        <i>&lt;run&gt;</i>
<p>
        (Of course you would, usually, set up a master file in a 
        text editor, not in Stata.)
        
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3b2"></a><p>
    <b>Example with LaTeX II</b>
<p>
<p>
      o Step 2: Generate table files
<p>
INCLUDE help tabletutorial_29
        <i>&lt;run&gt;</i>
<p>
<p>
      o Step 3: Compile the document
<p>
        <i>&lt;texify&gt;</i>  <i>&lt;show PDF&gt;</i>  <i>&lt;show PDF from web&gt;</i>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3b3"></a><p>
    <b>Example with LaTeX III</b>
<p>
<p>
      o You can now easily replace the tables and recompile the 
        document
<p>
INCLUDE help tabletutorial_31
        <i>&lt;run&gt;</i>
<p>
            <i>&lt;texify&gt;</i>  <i>&lt;show PDF&gt;</i>  <i>&lt;show PDF from web&gt;</i>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3c"></a><p>
    <b>Example with MS Word and Excel I</b>
<p>
<p>
      o Such automation does not seem to be easily possible with
        MS Word.
<p>
<p>
      o However, you can link data files into Excel and then
        dynamically link Excel tables into Word.
<p>
<p>
      o Step 1: Generate results files in tab-delimited format
<p>
INCLUDE help tabletutorial_32
        <i>&lt;run&gt;</i>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3c2"></a><p>
    <b>Example with MS Word and Excel II</b>
<p>
<p>
      o Step 2: Link data into Excel ("Data" &gt; "Import External 
        Data" &gt; "Import Data..."; locate and select the 
        "_example.txt" file; go through the "Text Import Wizard" 
        and click "Finish"; on the last dialog, called "Import 
        Data", click "Properties...", uncheck "Prompt for file 
        name on refresh" and check "Refresh data on file open", 
        possibly uncheck "Adjust column width").
        
<p>
      o Step 3: Format the table in Excel.
<p>
<p>
      o Step 4: Mark and copy the table in Excel and, in Word, 
        paste the table as an Excel object ("Edit" &gt; "Paste 
        Special..."; make sure to select "Paste link").
<p>
<p>
      o Save the Excel and Word documents.
<p>
<p>
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="part3c3"></a><p>
    <b>Example with MS Word and Excel III</b>
<p>
<p>
      o You can now replace the results files ...
<p>
INCLUDE help tabletutorial_33
        <i>&lt;run&gt;</i>
<p>
      o ... open the Excel file and click "Enable automatic 
        refresh" ...
        
      o ... open the Word document, mark the section containing 
        the table, and hit "F9" ("Edit" &gt; "Update Link") to
        update the table.
<p>
        (The default settings can be changed so that updating 
        occurs automatically when opening the file: "Tools" &gt; 
        "Options" &gt; "General" &gt; check "Update automatic links 
        at open") 
<p>
    <i>&lt;next&gt;</i>                                               <i>&lt;overview&gt;</i>
    ---------------------------------------------------------------
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
    ---------------------------------------------------------------
<a name="end"></a><p>
    <b>End of tutorial</b>
<p>
<p>
      o Clean-up: erase working files
<p>
INCLUDE help tabletutorial_cleanup
        <i>&lt;run&gt;</i>
<p>
<p>
<p>
<p>
<p>
    <i>&lt;top&gt;</i>
    ---------------------------------------------------------------
</pre>