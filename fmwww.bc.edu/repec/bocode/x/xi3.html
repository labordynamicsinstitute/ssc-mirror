<pre>
-------------------------------------------------------------------------------
help for <b>xi3</b>
-------------------------------------------------------------------------------
<p>
<b><u>Interaction expansion, enhanced</u></b>
<p>
The <b>xi3</b> command is the same as the <b>xi</b> command, except that it allows 3 way
interactions, any combination of continuous and categorical variables, and
performs additional coding schemes beyond indicator coding, and can create
codings that allow for testing simple contrasts and simple effects.  Its syntax
is much like the <b>xi</b> command.
<p>
        <b>xi3</b> [<b>,</b> <b><u>pre</u></b><b>fix(</b><i>string</i><b>)</b>] <i>term(s)</i>
<p>
        <b>xi3</b> [<b>,</b> <b><u>pre</u></b><b>fix(</b><i>string</i><b>)</b>] <b>:</b>  <i>any_stata_command</i> <i>varlist_with_terms</i> <i>...</i>
<p>
where a term is a mixture of continuous (Con) and categorical (Cat) variables
of the form:
<p>
        Main Effects
        Con                 <i>varname</i>
        Cat                 <b>prefix.</b><i>varname</i>
<p>
        Two Way Interactions
        Cat by Cat          <b>prefix.</b><i>varname1</i><b>*prefix.</b><i>varname2</i>
        Cat by Con          <b>prefix.</b><i>varname1</i><b>*</b><i>varname2</i>
        Con by Cat          <i>varname1</i><b>*prefix.</b><i>varname2</i>
        Con by Con          <i>varname1</i><b>*</b><i>varname2</i>
<p>
        Three Way Interactions
        Cat by Cat by Cat   <b>prefix.</b><i>varname1</i><b>*prefix.</b><i>varname2</i><b>*prefix.</b><i>varname3</i>
        Cat by Cat by Con   <b>prefix.</b><i>varname1</i><b>*prefix.</b><i>varname2</i><b>*</b><i>varname3</i>
           ...
        Con by Con by Con   <i>varname1</i><b>*</b><i>varname2</i><b>*</b><i>varname3</i>
<p>
and you can also request simple effects for two way interactions using the <b>@</b>
operator
<p>
        Cat by Cat          <b>prefix.</b><i>varname1</i><b>@prefix.</b><i>varname2</i>
        Con by Cat          <i>varname1</i><b>@prefix.</b><i>varname2</i>
<p>
<b>Additional Coding Schemes</b>
<p>
The <b>xi3</b> command allows additional prefixes beyond <b>i.</b><i>varname</i>.  These prefixes
create a number of additional coding schemes, as described below.
<p>
Please note: Starting with version 1.0 (April 7, 2003) the prefixes s, d, and f
have been replaced with g, e, and a (respectively).  This now permits the s.,
d. and f. prefixes to be used as time series operators reflecting seasonal
differences, backward differencing, and forward differencing (respectively).
<p>
     <b>i.</b>varname - Indicator (dummy) coding: compares each level to the omitted
                 group
     <b>c.</b>varname - Centered indicator (dummy) coding
     <b>g.</b>varname - reference Group coding: compares each level to a reference
                 group
     <b>e.</b>varname - Effect coding: deviations from the grand mean
     <b>h.</b>varname - Helmert coding:  compares levels of a variable with the mean
                 of subsequent levels
     <b>r.</b>varname - Reverse Helmert coding: compares levels of a variable with the
                 mean of previous levels
     <b>a.</b>varname - Adjacent differences:  each level vs. the next level
     <b>b.</b>varname - Backward adjacent differences: each level vs. the previous
                 level
     <b>o.</b>varname - Orthogonal polynomial contrasts u.varname - User defined
                 coding scheme
<p>
<b>Omitted Categories for Additional Coding Schemes</b>
<p>
The <b>refgroup</b> command is included with <b>xi3</b> to allow you to select the reference
group (also called the omitted category).  This is simply a shorthand for using
char <i>varname</i>[omit] <i>#</i>.  The syntax of <b>refgroup</b> is
<p>
        <b>refgroup</b> <i>varname</i> <b>#</b>
<p>
The following describes how omitted categories are handled using each coding
scheme.
<p>
     <b>Indicator coding</b>.  The choice of the omitted category works just like the
     original <b>xi</b> program, i.e. the first category is omitted unless you use
     char <i>varname</i>[omit] <i>#</i> or char _dta[omit] "prevalent" (see help xi for more
     information).  Note that char _dta[omit] "prevalent" is ignored for all of
     the other other coding schemes.
<p>
<p>
<p>
     <b>Simple and Deviation coding</b>.  By default, the first category is the
     omitted category and you can use char <i>varname</i>[omit] <i>#</i> to choose a
     different level to be omitted.
<p>
     <b>Helmert and Forward Difference coding</b>. For these coding schemes the last
     category is always omitted (because the last category cannot be compared
     to subsequent categories.
<p>
     <b>Reverse Helmert and Backward Difference coding</b>. For these coding schemes
     the first category is always omitted (because the first category cannot be
     compared to prior categories.
<p>
     <b>Orthogonal Polynomial coding</b>. The kth level is omitted.
<p>
     <b>User Defined coding</b>.  The user defines <i>k-1</i> contrasts to be tested, as
     described in the section Creating User Defined Coding below.
<p>
<b>Creating User Defined Coding</b>
<p>
It may be easiest to describe user defined coding via an example.  Say you have
a variable <b>ses</b> with 3 levels, and you wish to form 2 comparisons.  The first
will compare level 1 with levels 2 and 3, and the second will compare levels 1
and 3.  The comparison coefficients for these two comparisons would be.
<p>
     comparison 1: 1 -.5 -.5
     comparison 2: 1 0 -1
<p>
You indicate these comparisions like this
<p>
     . char ses[user] (1 -.5 -.5 \ 1 0 -1)
<p>
<b>Simple Comparisons and Simple Effects</b>
<p>
Say you wanted to specify <b>deviation</b> contrasts on <b>varname1</b> at each level of
<b>varname2</b>, along with <b>simple</b> contrasts on <b>varname2</b>.  You can use <b>@</b> like this to
request that coding.
<p>
     d.varname1@s.varname2
<p>
For example to perform <b>forward difference</b> conrasts on <b>ses</b> at each level of
<b>female</b> and <b>simple</b> coding on female, you could type
<p>
     . xi3 f.ses@s.female
<p>
The terms that would be created are listed below along with their
interpretation.
<p>
<b>_Ises_1</b>            ses(1 vs. 2)
<b>_Ises_2</b>            ses(2 vs. 3)
<b>_Ifemale_1</b>         female(1 vs. 0)
<b>_IsesWfem_1_1</b>      ses(1 vs. 2) @ female==0
<b>_IsesWfem_2_1</b>      ses(2 vs. 3) @ female==0
<b>_IsesWfem_1_2</b>      ses(1 vs. 2) @ female==1
<b>_IsesWfem_2_2</b>      ses(2 vs. 3) @ female==1
<p>
As you see, the lower order effects <b>_Ises_1 _Ises_1</b> and <b>_Ifemale_1</b> are created
as though you had used an interaction.  But the terms<b> _IsesWfem_1_1</b>
<b>_IsesWfem_2_1 _IsesWfem_1_2</b> and <b>_IsesWfem_2_2</b> reflect simple effects of <b>ses</b> at
the levels of <b>female</b>.  For example<b> _IsesWfem_1_1</b> is the effect of low ses vs.
middle ses for males, and<b> _IsesWfem_1_2</b> is the effect of middle ses vs. high
ses for males.
<p>
If you wanted to form the simple effect of <b>ses</b> for males, you would use the
<b>test</b> command to test <b>_IsesWfem_1_1</b> and <b>_IsesWfem_1_2</b>, for example
<p>
     . test _IsesWfem_1_1 _IsesWfem_1_2
<p>
Note that when you use <b>xi3</b> to create the coding scheme, it creates both the
main effects for <b>female</b> and for <b>ses</b> and for the simple contrasts of <b>ses</b> at each
level of <b>female</b>.  However, if you include all of these terms in an estimation
model, it will be overparameterized.  Instead, you wish to drop, in this
example, the main effect of <b>ses</b> since that effect is also contrained in the
simple effects.  When you use <b>xi3</b> with a command, it automatically drops the
<b>ses</b> main effects, although those variables are created, see example below.
<p>
     . xi3 : regress write f.ses@s.female
<p>
f.ses             _Ises_1-3           (naturally coded; _Ises_3 omitted)
s.female          _Ifemale_0-1        (naturally coded; _Ifemale_0 omitted)
f.ses@s.female    _IsesWfem_#_#       (simple effects of ses at female)
<p>
      Source |       SS       df       MS              Number of obs =     200
-------------+------------------------------           F(  5,   194) =    5.67
       Model |  2278.24419     5  455.648837           Prob &gt; F      =  0.0001
    Residual |  15600.6308   194  80.4156228           R-squared     =  0.1274
-------------+------------------------------           Adj R-squared =  0.1049
       Total |   17878.875   199   89.843593           Root MSE      =  8.9675
<p>
------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _Ifemale_1 |   5.566752   1.366513     4.07   0.000     2.871622    8.261882
_IsesWfe~1_1 |  -2.953191   2.659325    -1.11   0.268    -8.198093     2.29171
_IsesWfe~2_1 |  -3.308877   2.117528    -1.56   0.120    -7.485208    .8674534
_IsesWfe~1_2 |      -1.75   2.046537    -0.86   0.394    -5.786318    2.286318
_IsesWfe~2_2 |  -4.715517   2.109094    -2.24   0.027    -8.875215   -.5558195
       _cons |   52.45513   .6832567    76.77   0.000     51.10756    53.80269
------------------------------------------------------------------------------
<p>
Having done this test, we can test the simple effects of <b>ses</b> for
males like this.
<p>
     . test _IsesWfem_1_1 _IsesWfem_2_1
<p>
 ( 1)  _IsesWfem_1_1 = 0.0
 ( 2)  _IsesWfem_2_1 = 0.0
<p>
       F(  2,   194) =    2.61
            Prob &gt; F =    0.0765
<p>
<p>
and the simple effects of <b>ses</b> for females like this.
<p>
     . test _IsesWfem_1_2 _IsesWfem_2_2
<p>
 ( 1)  _IsesWfem_1_2 = 0.0
 ( 2)  _IsesWfem_2_2 = 0.0
<p>
       F(  2,   194) =    4.25
            Prob &gt; F =    0.0157
<p>
<p>
<b><u>Also see</u></b>
<p>
 Manual:  <b>[U] 23 Estimation and post-estimation commands</b>,
          <b>[R] xi</b>
On-line:  help for est, postest
</pre>