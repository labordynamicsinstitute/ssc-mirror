<pre>
<b>help xls2dta</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
     <b>xls2dta</b> -- Save Excel files as Stata datasets
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>xls2dta</b> [<i>extvarlist</i>] [<b>using</b> <i>filename</i>] [<b>,</b> <i>options</i>]
<p>
<p>
     where <i>filename</i> specifies the Excel file/s to be converted to Stata
     datasets. If <i>filename</i> is not specified, it defaults to the current working
     directory. See Remarks.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>xls2dta</b> converts Excel files to Stata datasets using <b>import excel</b>. Names
    for Stata datasets are derived from the names of the Excel files (see
    Remarks). The program is a convenient tool to import and convert more
    than one Excel file and/or worksheet at a time.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b><u>sa</u></b><b>ve(</b><i>dirc</i><b>)</b> specifies the directory to store Stata datasets.  Default <i>dirc</i>
        is the current working directory (<b>/Volumes/fmwww0/RePEc/bocode/x</b>).
        Double quotes may be omitted.
<p>
    <b><u>allsh</u></b><b>eets</b>[<b>(</b><i>numlist</i> | [<b>"</b>]<i>pattern</i>[<b>"</b>] <i>...</i><b>)</b>] saves all worksheets in the
        Excel files as Stata datasets. If <b>foo.xls</b> contains three sheets,
        <b>Sheet1</b>, <b>Sheet2</b> and<b> Sheet3</b>, Stata datasets <b>foo_Sheet1.dta</b>,
        <b>foo_Sheet2.dta</b> and <b>foo_Sheet3.dta</b> will be saved. If specified, only
        worksheets <i>numlist</i>, or worksheets matching <i>patterns</i> (see strmatch)
        are converted.
<p>
    <b>replace</b> allows Stata datasets to be replaced if they already exist.
<p>
    <i>import excel options</i> are options allowed with <b>import excel</b>. Option
        <b><u>sh</u></b><b>eet(</b><i>"sheetname"</i><b>)</b> may not be combined with <b>allsheets</b>. Option
        <b><u>desc</u></b><b>ribe</b> may not be combined with any other option. Option <b>clear</b> is
        ignored.
<p>
    <b><u>respect</u></b><b>case</b> specifies that <b>xls2dta</b> respect case in <i>filename</i> (Windows
        only). Uppercase characters in <i>filename</i> imply <b>respectcase</b>. See
        extended macro function dir.
<p>
    <b>nostop</b> prevents <b>xls2dta</b> from stopping if one of the internal calls to
        <b>import excel</b> returns an error. This option should rarely be
        specified.
<p>
    <b>mkdir</b>[<b>(</b><b><u>pub</u></b><b>lic)</b>] creates new directory <i>dirc</i>, as specified in <b>save</b> (see 
        mkdir).
<p>
<a name="r"></a><p>
<b><u>Remarks</u></b>
<p>
    In <i>filename</i> one specific file, or more than one file in a directory may
    be specified.
<p>
    Specifying
<p>
        <b>. xls2dta using c:/myxlsfiles/foo.xls</b>
<p>
    converts (the first sheet of) <b>foo.xls</b> to <b>foo.dta</b> and saves it in the
    current working directory.
<p>
    If <b>c:/myxlsfiles</b> contains more than one <b>.xls</b> file, we can convert all of
    them to Stata datasets typing
<p>
        <b>. xls2dta using c:/myxlsfiles/*.xls</b>
<p>
    To convert all <b>.xls</b> and <b>.xlsx</b> files in <b>c:/myxlsfiles</b>, we would type
<p>
        <b>. xls2dta using c:/myxlsfiles</b>
<p>
    If <b>foo.xls</b> contains more than one worksheet, and we want to convert all
    worksheets to Stata datasets, we type
<p>
        <b>. xls2dta using c:/myxlsfiles/foo.xls ,allsheets</b>
<p>
    To only convert worksheets starting with <b>Sheet</b>, we specify
<p>
        <b>. xls2dta using c:/myxlsfiles/foo.xls ,allsheets(Sheet*)</b>
<p>
<p>
<b><u>Example</u></b>
<p>
        <b>. xls2dta using c:/myxlsfiles ,save(c:/mydtafiles)</b>
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>xls2dta</b> saves the following in <b>r()</b>:
<p>
    Macros
      <b>r(n_dta)</b>       number of saved <b>.dta</b> files
      <b>r(dta_</b><i>#</i><b>)</b>       filename of <b>.dta</b> file <i>#</i>
<p>
<p>
<b><u>Author</u></b>
<p>
    Daniel Klein, University of Kassel, klein.daniel.81@gmail.com
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online: import excel, extended functions, foreach, mkdir
<p>
    if installed: xls2stata
</pre>