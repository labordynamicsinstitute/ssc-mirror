<pre>
<b> help xtsur</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>xtsur</b> --        One-way random effect estimation of seemingly-unrelated
                      regressions (SUR) in unbalanced panel data set
<p>
<b><u>Syntax</u></b>
<p>
    Basic syntax
<p>
        <b>xtsur (</b><i>depvar1</i> <i>varlist1</i><b>)</b> <b>(</b><i>depvar2</i> <i>varlist2</i><b>)</b> <i>...</i><b>(</b><i>depvarN</i> <i>varlistN</i><b>)</b> [<b>if</b>
                <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b><u>one</u></b><b>step</b> <b><u>multi</u></b><b>step</b> <b><u>tol</u></b><b>erance(</b><i>real</i>
                <i>1e-6</i><b>)</b>]
<p>
    Full syntax
<p>
        <b>xtsur</b> <b>(</b>[<i>eqname1</i><b>:</b>]<i>depvar1a</i> [<i>depvar1b</i> <i>...</i><b>=</b>]<i>varlist1</i> <b>)</b>
              <b>(</b>[<i>eqname2</i><b>:</b>]<i>depvar2a</i> [<i>depvar2b</i> <i>...</i><b>=</b>]<i>varlist2</i> <b>)</b>
              <i>...</i>
              <b>(</b>[<i>eqnameN</i><b>:</b>]<i>depvarNa</i> [<i>depvarNb</i> <i>...</i><b>=</b>]<i>varlistN</i> <b>)</b>
              [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b><u>one</u></b><b>step</b> <b><u>multi</u></b><b>step</b>
              <b><u>tol</u></b><b>erance(</b><i>real 1e-6</i><b>)</b>]
<p>
<b><u>Description</u></b>
<p>
    <b>xtsur</b> fits a many-equation seemingly-unrelated regression (SUR) model of
    the <i>y1</i> variable on the <i>x1</i> variables and the <i>y2</i> variable on the <i>x1</i> or <i>x2</i>
    variables and etc..., using random effect estimators in the context of
    unbalanced panel data.  The approach for this command is based on
    constructing a multistep (stepwise) algorithm using Generalized Least
    Squares (GLS) and the Maximum Likelihood (ML) procedures. The method is
    originally developed by Erik Biorn (JoE).
<p>
    In order to run this command, <b>tsset</b> must be run to set the panel variable
    and time variable; see help tsset.
<p>
    Consider the system of G equation model:
<p>
    y_git = x_git * b_g + u_git      i=1,...,N;    t=1,...,Ti;    g=1,...,G
    u_git = v_gi + e_git,
<p>
    where
<p>
    v_gi are unobserved individual-level effects in the <i>g</i>th equation;
<p>
    e_git are the observation-specific errors in the <i>g</i>th equation;
<p>
    x_git is a vector of strictly exogenous covariates (ones dependent on
            neither current nor past e_git) in the <i>g</i>th equation;
<p>
    b_g are vectors of parameters to be estimated in the <i>g</i>th equation;
<p>
    Observations in the unbalanced data set are observed in at least one and
    at most P periods, and let N_p denotes the number of individuals observed
    in p periods, where p = 1,...,P. Hence, we can rearranged the unbalaned
    data set in the way that the N_1 individuals observed once come first,
    the N_2 individuals observed twice come second, N_3 individuals observed
    three times come third, and etc. In this way, we can consider the set of
    N_1 individuals as a cross section, and the sets of N_p individuals where
    p = 2,...,P as balanced panels.
<p>
    For each <i>g</i>th equation in the system, we can write the model as follows.
    Here, t is a sequence index, not a time index.
<p>
    y_git = x_git * b_g + v_gi + e_git      i=1,...,N;    t=1,...,Ti;   
            g=1,...,G
<p>
    Observations in the unbalanced panel are rearranged into P balanced
    panels. In each balanced panel, all observations are observed with the
    same number of periods. Therefore, the model can be rewritten for each p
    in P:
<p>
    y_i(p) = x_i(p) * b + e_p # v_i + e_i(p)
<p>
    where
<p>
    e_p is vector of ones (p x 1);
    # is the Kronecker direct product.
<p>
    Using the overall within-individual and between-individual covariation
    matrices, Biorn (2004) derived the unbiased estimators of sigma_v and
    sigma_e for each balanced panel. Using those estimated covariance
    matrices, the GLS problem is considered by minimizing the usual sandwich
    form with respect to parameter estimates. We then obtain the beta GLS
    estimator (bGLS_p) for the individuals observed p times. The overall GLS
    estimator can be shown to be the function of bGLS_p and their variances
    V(bGLS_p) for p = 1,...,P. Please see Biorn (2004) for details.
<p>
    In order to get the efficient estimator of the SUR system, the multistep
    (stepwise) Maximum Likelihood estimation is implemented.  The multistep
    is the problem of two sub-problems: (a) maximizing the log likelihood
    with respect to beta parameters for given sigma_v and sigma_e, which is
    the same as the GLS part above, and (b) maximizing the log likelihood
    with respect to sigma_v and sigma_e for given beta parameters. The
    multistep algorithm jointly solves (a) and (b), and it will stop until
    convergence of the overall estimates.
<p>
    For details of the estimation procedures and simulations for this
    command, <b>xtsur</b>, please refer to Minh Nguyen and Hoa Nguyen (2010).
<p>
<b><u>Options</u></b>
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, in percent, for confidence
        intervals of the coefficients; see help level. The default is 95.
<p>
    <b>multistep</b> implements the multi-step algorithm where the estimated
        parameters are repeated until convergence from the multi-step ML and
        GLS procedures.
<p>
    <b>onestep</b> implements the one-step algorithm where an overall GLS estimate
        is obtained. The default method is <b>multistep</b>.
<p>
    <b>tolerance(#)</b> sets the convergence tolerance. The default tolerance is
        1e-6.
<p>
<b><u>Return values</u></b>
<p>
   Scalars
       <b>e(N)</b>         number of complete observations in unbalanced panel data
       <b>e(T)</b>         maximum number of time periods observed
       <b>e(k_eq)</b>      number of equations
       <b>e(N_g)</b>       number of unique units in groups
       <b>e(g_min)</b>     minumum number of panels
       <b>e(g_max)</b>     maximum number of panels
       <b>e(tol)</b>       convergence tolerance
       <b>e(cilevel)</b>   confidence interval level
<p>
   Macros
       <b>e(cmd)</b>       name of the command
       <b>e(cmdline)</b>   full command typed
       <b>e(method)</b>    estimation method
       <b>e(title)</b>     title of regression
       <b>e(version)</b>   version of the command
       <b>e(properties)</b>properties of estimation
       <b>e(eqnames)</b>   equation names
       <b>e(depvar)</b>    dependent variables
       <b>e(exog)</b>      exogenous variables
       <b>e(endog)</b>     endogenous variables
       <b>e(tvar)</b>      time variable
       <b>e(ivar)</b>      ID variable
<p>
   Matrices
       <b>e(b)</b>         estimated parameters
       <b>e(V)</b>         variance-covariance of estimated parameters
       <b>e(sigma_u)</b>   variance-covariance of random effects
       <b>e(sigma_e)</b>   variance-covariance of error terms
       <b>r(xtsur)</b>     structure of the unbalanced panel dataset
<p>
   Functions
       <b>e(sample)</b>    sample used in estimation
<p>
<b><u>Examples</u></b>
<p>
    SUR model with 3 equations
    <b>. use example.dta, clear</b>
    <b>. xtsur (y1 x1 x2 x3 x4) (y2 x4 x6 x7) (y3 x7 x9)</b>
    <b>. xtsur (y1 y2 y3 = x1 x2 x3 x4 x6 x7 x9), onestep</b>
    <b>. xtsur (y1 y2 = x1 x2 x3 x4 x6) (y3 x6 x7 x9)</b>
<p>
    SUR model with 2 global equation names
    <b>. global eqn1 (y1 x1 x2 x3)</b>
    <b>. global eqn2 (y2 x4 x6 x7)</b>
    <b>. xtsur $eqn1 $eqn2</b>
<p>
    <b>. xtsur (equname1: y1 x2 x3 x4) (equname2: y2 x3 x4)</b>
<p>
    <b>. global eqn1 (equname1: y1 x2 x3 x4)</b>
    <b>. global eqn2 (equname2: y2 x3 x4)</b>
    <b>. xtsur $eqn1 $eqn2</b>
<p>
<b><u>References</u></b>
<p>
    Erik Biorn. 2004.  Regression system for unbalanced panel data: a
        stepwise maximum likelihood procedure. <i>Journal of Econometrics</i> 122:
        281-91.
    Minh Nguyen and Hoa Nguyen. 2010. Stata module: Estimation of system of
        regression equations with unbalanced panel data and random effects.
        Working Paper.
 
<p>
<b><u>Acknowledgements</u></b>
<p>
    We would like to thank numerous people for their comments and
    suggestions. Among them are Brian Poi, Kit Baum and one anonymous
    reviewer. We also thank all users who feedback had led to steady
    improvement in <b>xtsur</b>.
<p>
<b><u>Author</u></b>
<p>
    Minh Cong Nguyen
    Enterprise Analysis Unit
    The World Bank, 2009
    mnguyen3@worldbank.org
<p>
    Hoa Bao Nguyen
    Ph.D. Candidate
    Economics Department
    Michigan State University
    East Lansing, MI
    Email: nguye147@msu.edu
<p>
<b><u>Version</u></b>
<p>
    This is version 1.0.4 released December 11, 2009.
</pre>