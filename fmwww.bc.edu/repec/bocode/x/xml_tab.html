<pre>
<b>help xml_tab</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
        <b>xml_tab</b> -- Save results in XML format
<p>
<p>
<b><u>Syntax</u></b>
<p>
      <b>xml_tab</b> [<i>namelist</i>] [<b>,</b> <i>options</i>]
<p>
    where <i>namelist</i> is a list of stored estimations or matrices; see 
    <b>estimates</b>. A <i>namelist</i> comprises one or more specifications, separated by
    spaces. A specification can be a name of a stored estimation or a matrix
    name. <b>xml_tab</b> will output the estimation coefficients and one of the
    three statistics (standard errors, t-ratio, or p-values).
<p>
    For estimation results <b>xml_tab</b> has enough information to calculate
    significance levels itself but if a matrix to be outputted, <b>xml_tab</b> looks
    also for <i>matname</i>_STARS matrix that must be of same size as <i>matname</i> and
    contain values 0,1,2 or 3 denoting significance levels.  See option <b>stars</b>
    for more details.
<p>
<a name="extended"></a>    The stored estimation could be also specified in an extended form with
    parameters.
<p>
      <b>xml_tab</b> [<i>estname1(stat11 stat12, eform_option)</i> [<i>estname2(stat21 stat22)</i>
                [...]]] [<b>,</b> <i>options</i>]
<p>
    where <i>estname</i> is a name of the stored estimation, and <i>stat1</i> and <i>stat2</i> are
    the names of matrixes stored in <b>e()</b>. Specification <b>estname(</b><i>b V</i><b>)</b> is
    identical to <b>estname</b>. You can access the names of the stored matrixes
    with <b>ereturn list</b>. See examples;
<p>
    The extended form specification is useful when accessing non-standard
    statistics, for example, when outputting marginal effects of the
    parameters after e.g., <b>mfx</b>, <b>dprobit</b>. The extended form could also be used
    when outputting the results in exponentiated forms after commands such as
    <b>streg</b>, <b>stcox</b>, <b>st</b>, etc.
<p>
    Note that you may enclose <i>filename</i> in double quotes and must do so if
    <i>filename</i> contains blanks or other special characters.
<p>
<a name="options"></a>    <i>options</i>                      Description
    -------------------------------------------------------------------------
    Output
      <b>save(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b>       name and path for the output file
      <b>replace</b>                    overwrite existing <i>filename</i>
      <b>append</b>                     if workbook <i>filename</i> exists, add a new
                                   sheet, otherwise create a new workbook
      <b><u>sh</u></b><b>eet(</b><i>name </i>[<b>,</b><i> sh_opts</i>]<b>)</b>    worksheet where the table is outputted
<p>
         <b><u>col</u></b><b>or(</b><i>#</i><b>)</b>                specify tab color for a worksheet
         <b><u>nog</u></b><b>ridlines</b>             hide gridlines on a worksheet
<p>
<p>
      <b><u>savem</u></b><b>at(</b><i>name </i>[<b>,</b><i> sm_opts</i>]<b>)</b>  save estimates to a matrix
<p>
         <b>replace</b>                 if matrix <i>name</i> already exists replace
                                       it. The default is to append
         <b>exit</b>                    after writing the matrix exit <b>xml_tab</b>
                                       without creating an output file
<p>
      <b>mv(</b><i>mvspec</i><b>)</b>                 change missing values to string or numeric
                                   values.
<p>
    Statistics
      <b>sd</b>                         show estimated coefficients and standard
                                   deviations (default)
      <b><u>ts</u></b><b>tat</b>                      show estimated coefficients and t-statistic
      <b><u>pv</u></b><b>alue</b>                     show estimated coefficients and p-value
      <b><u>stat</u></b><b>s(</b><i>scalarlist</i><b>)</b>          report <i>scalarlist</i> statistics in the table
      <b><u>star</u></b><b>s(</b><i>starspec</i><b>)</b>            controls significance levels and symbols
      <b><u>noadj</u></b><b>ust</b>                   report not adjusted t-statistics
      <i>eform_option</i>               display exponentiated coefficients. see 
                                   eform_option;
<p>
    Table Layout
      <b><u>b</u></b><b>elow</b>                      show standard deviation (t-statistics or
                                   p-values) under the estimates
      <b><u>nobr</u></b><b>ackets</b>                 remove brackets around standard deviation
                                   (t-statistics or p-values)
      <b><u>r</u></b><b>ight</b>                      show standard deviation (t-statistics or
                                   p-values) next to the estimates (default)
      <b><u>lo</u></b><b>ng</b>                       long output table style
      <b><u>wi</u></b><b>de</b>                       wide output table style (default)
      <b>keep(</b><i>keeplist</i><b>)</b>             report <i>keeplist</i> rows
      <b>drop(</b><i>droplist</i><b>)</b>             drop <i>droplist</i> rows from the table
      <b><u>eq</u></b><b>uations(</b><i>matchlist</i><b>)</b>       match the equations of the models according
                                   to <i>matchlist</i>
<p>
    Table Formatting
      <b><u>f</u></b><b>ormat(</b><i>string</i><b>)</b>             description of the output table format
      <b><u>l</u></b><b>ines(</b><i>string</i><b>)</b>              rows to be underlined
      <b><u>nol</u></b><b>abel</b>                    display variable names instead of labels
      <b><u>c</u></b><b>onstant(</b><i>string</i><b>)</b>           specifies label for the constant
      <b><u>rb</u></b><b>lanks(</b><i>string</i><b>)</b>            add rows to the table
      <b><u>cb</u></b><b>lanks(</b><i>cblist</i><b>)</b>            add blank columns to the table
      <b><u>cw</u></b><b>idth(</b><i>cwlist</i><b>)</b>             modify column widths
      <b><u>tb</u></b><b>lanks(</b><i>#</i><b>)</b>                 add blank rows at the top of the table
      <b><u>t</u></b><b>itle(</b><i>string</i><b>)</b>              table title
      <b><u>rn</u></b><b>ames(</b><i>string</i><b>)</b>             custom row names
      <b><u>cn</u></b><b>ames(</b><i>string</i><b>)</b>             custom column names
      <b><u>ce</u></b><b>q(</b><i>string</i><b>)</b>                custom column equation names (super-titles)
      <b><u>note</u></b><b>s(</b><i>string</i><b>)</b>              add notes to the end of the table
      <b>font(</b><i>string</i><b>)</b>               specifies font for a worksheet
      <b><u>sty</u></b><b>le(</b><i>stylename</i><b>)</b>           predefined format styles for output
<p>
    System options
      <b><u>ex</u></b><b>celpath(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b>  specifies the location of the <i>MS Excel</i>
                                   executable
      <b><u>cal</u></b><b>cpath(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b>   specifies the location of the <i>OO Calc</i>
                                   executable
      <b><u>noi</u></b><b>sily</b>                    displays the complete list of options
                                   applied to the table
      <b>updateopts</b>                 forces the options file update
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>xml_tab</b> saves Stata output directly into XML file that could be opened
    with <i>Microsoft Excel</i> or <i>OpenOffice Calc</i>. The program is relatively
    flexible and produces print-ready tables in <i>Excel</i> or <i>Calc</i>.  <b>xml_tab</b>
    allows users to apply different formats to the elements of the output
    table and essentially do everything <i>MS Excel</i> or <i>OO Calc</i> can do in terms
    of formatting from within Stata.
<p>
    <b>xml_tab</b> can create formatted tables of coefficients, standard errors, t-
    and p- values, summary statistics, etc., after any Stata estimation
    command that saves its results in <b>e()</b>. The program allows saving the
    results of a single estimation or a matrix into a table, combining
    several stored estimations or matrixes into one table, and outputting
    several tables into the different sheets of XML workbook.
<p>
    Calling <b>xml_tab</b> without any arguments saves the results of last
    estimation command into file <i>stata_out.xml</i> located in the current work
    directory. After the XML file is saved <b>xml_tab</b> can create links in the
    Stata Results window. Clicking on a link opens the output table in <i>MS</i>
    <i>Excel</i> or <i>OO Calc</i>.  See system options for details.
<p>
    <b>xml_tab</b> can combine multiple estimations saved using <b>estimates store</b>
    command. The example of outputting multiple estimates into one table
    might look as follows:
<p>
      <b>.sysuse auto</b>
<p>
      <b>.regress price rep78 length mpg</b>
<p>
      <b>.estimates store reg1</b>
<p>
      <b>.regress price rep78 length mpg turn if foreign==1</b>
<p>
      <b>.estimates store reg2</b>
<p>
      <b>.xml_tab reg1 reg2</b>
<p>
    In this very simple example, the estimates from the first regression are
    saved under the name <b>reg1</b>. The specification of the second regression
    contains one extra variable and the sample for the estimation is
    constrained.  The estimates from the second regression are saved under
    the name <b>reg2</b>. <b>xml_tab</b> creates an output table containing five columns.
    The first column contains the names of the variables used in either
    regression. The second and the fourth columns contains the estimated
    coefficients of the first and the second regression, and the standard
    errors of the coefficients are outputted in columns 3 and 5.
<p>
    <b>xml_tab</b> has many additional options to control the outputted statistics,
    formatting and a general layout of the output tables. Please read the
    description of these options below and have a look at our examples.
<p>
<b><u>Options</u></b>
<p>
<a name="output"></a>        +--------+
    ----+ Output +-----------------------------------------------------------
<p>
    <b>save(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b> specifies a name for XML file where tables are
        outputted. If <b>save(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b> is omitted, the output will be
        saved in <b>stata_out.xml</b> located in the current working directory. Use
        <b>append</b> and <b>replace</b> options to instruct <b>xml_tab</b> to append a table into
        the new worksheet of the existing file or to replace the existing
        file.
<p>
        Alternatively, the output file name can be specified with the <b>using</b>
        syntax. Instead of <b>save()</b> users can write:
<p>
            <b>.xml_tab using c:\tmp\xml_out.xml, *</b>
<p>
<p>
    <b>replace</b> permits to overwrite the existing XML file.
<p>
    <b>append</b> if XML file already exists, a new sheet will be added to it where
        the output table will be saved.  Otherwise the new file will contain
        one sheet with the output.
<p>
    <b>NOTE:</b> You need to close XML file opened in Excel or Calc for <b>xml_tab</b> to
        save new tables there. If XML file is still opened, <b>xml_tab</b> reports
        an error message: file can not be saved at this location.
<p>
    <b>sheet(</b><i>name</i><b>)</b> You can output several tables into the different sheets of
        XML file (workbook). Excel or Calc files could contain multiple
        worksheets within a single document (workbook). <b>sheet()</b> option
        specifies the name for the new sheet where the table will be
        outputted. If not specified, a worksheet named <i>Sheet1</i> will be added.
<p>
        A valid Excel worksheet name must have no more than 31 characters.
        The worksheet name cannot contain any of the following: : \ / ? * [
        or ] and can not be left blank.
<p>
    <b>savemat(</b><i>name</i><b>)</b> saves estimation results in a matrix. If <i>name</i> exists and
        option <b>replace</b> was not used then additional rows will be appended to
        that matrix. In this case number of columns in the existing matrix
        and the one to be appended must be the same. The output matrix will
        contain estimates and standard errors (t-statistics, p-values) in a
        form determined by table layout options. Significance level info will
        be saved/appended to <i>name</i>_STARS matrix, see exporting a matrix
        example.
<p>
    <b>mv(</b><i>#</i>|<i>mvc</i><b>=</b><i>#</i> [<b>\</b> <i>mvc</i><b>=</b><i>#</i>...] [<b>\</b> <b>else=</b><i>#</i>]<b>)</b> specifies the new values (string or
        numeric) to which the missing values ate to be changed.
<p>
        <b>mv(</b><i>str</i><b>)</b> specifies that all types of missing values be changed to <i>str</i>.
<p>
        <b>mv(</b><i>mvc</i><b>=</b><i>str</i><b>)</b> specifies that occurrences of missing-value code <i>mvc</i> be
        changed to <i>str</i>.  Multiple transformation rules may be specified,
        separated by a backward slash <b>\</b>.  The list may be terminated by the
        special rule <b>else=</b><i>str</i>, specifying that all types of missing values
        not yet transformed be set to <i>str</i>.
<p>
        For example: <b>mv("")</b>, <b>mv(.n="N.A." \ .d="(dropped)" \ else="")</b>
<p>
        back to top
<p>
<p>
<a name="statistics"></a>        +------------+
    ----+ Statistics +-------------------------------------------------------
<p>
    <b>sd</b>, <b>tstat</b> and <b>pvalue</b> control what statistic will be outputted together
        with the estimated coefficient.  If option <b>sd</b> is specified, the
        standard errors of the estimated coefficients are outputted.
        Specifying <b><u>ts</u></b><b>tat</b> produces a table of coefficients and the
        t-statistics. <b><u>pv</u></b><b>alues</b> outputs the probability that the true value of
        the estimated coefficient is zero.
<p>
        Only one option can be specified. If no options are specified <b>sd</b> the
        standard deviations are outputted.
<p>
    <b>stats(</b><i>scalarlist</i><b>)</b> specifies one or more statistics (scalars) to be
        displayed in the table. The statistics specified in <b>stats</b> are
        outputted at the end of the table and could be the number of
        observation stats(N); adjusted R2 for a regression <b>stats</b>(r2_a); value
        of log-likelihood <b>stats</b>(ll) and any statistics that are saved in e()
        scalars after estimation routines. See <b>ereturn</b>.
<p>
        In addition <i>scalarlist</i> may contain the following statistics:
<p>
            <b>aic</b>         Akaike's information criterion
            <b>bic</b>         Schwarz's information criterion
            <b>rank</b>        rank of <b>e(V)</b> - number of free parameters in model
<p>
        If several estimations are combined in one table the specified
        statistics will be displayed for each estimation.
<p>
    <b>stars(</b><i>starspec</i><b>)</b> specifies the significance level(s) and the symbol(s) for
        the coefficients to be marked in the output table. The simple syntax
        for <b>starspec</b> may contain up to three numbers separated by spaces
        corresponding to significance levels denoted by one, two and three
        stars. If <b>numlist</b> is just one number, the coefficients with the
        p-value less than that number will be marked by a star. For example,
        option <b>stars(</b><i>0</i>.<i>1</i><b>)</b> will mark with one star all the coefficients with
        p-value less than 0.1. If two values are specified in the <b>numlist</b>,
        <b>xml_tab</b> will mark with one star the coefficients with p-values that
        are less or equal to the first value and grater than the second
        value. Coefficients with p-values less than the second value will be
        marked by two starts. For example, specifying {opt stars(0.1 0.05)}
        will put one star on coefficients with pvalues in the range from 0.1
        to 0.5 and put two stars on the coefficients with p-value less than
        0.5.
<p>
        The extended syntax allows selecting the symbols to mark the
        significance leves. In this case, {bf starspec} consist of up to
        three symbol/number pairs. The symbol could by one or several
        characters and the number indicates the significance level similar to
        the simple syntax described above.
<p>
        By default, <b>xml_tab</b> output tables with the following <b>star</b>
        specification: <b>star(</b><i>0</i>.<i>1 0</i>.<i>05 0</i>.<i>01</i><b>)</b>.  Alternatively, this option could
        be specified in the extended syntax as <b>star(*</b><i> 0</i>.<i>1 </i><b>**</b><i> 0</i>.<i>05 </i><b>***</b><i> 0</i>.<i>01</i><b>)</b>.
        Note that any symbol or a combination of several symbols cold be used
        instead of * in this specification. Specifying 0 in the numlist would
        suppress stars on the table: <b>star(</b><i>0</i><b>)</b>.
<p>
    <b>noadjust</b> is used when outputting some transformations of the estimated
        coefficients (i.e. marginal effects). By default, <b>xml_tab</b> calculates
        t-statistics as f(b)/sd_f(b). But if <b>noadjust</b> is specified then
        t-stat=b/sd_b will be reported and used for p-values and significance
        calculations.
<p>
    <i>eform_option</i> when this option is specified the coefficients and the
        standard errors (t-statistics and p-values) for <u>all</u> estimation
        results will be reported in exponentiated form. To transform only
        some of the estimation results, the extended syntax can be used. For
        example,
<p>
            <b>.xml_tab reg streg(, hr) prob, replace</b>
<p>
        outputs unmodified coefficients and standard errors for esimations
        <i>reg</i> and <i>prob</i>, but exponentiated (Hazard ratio) coefficients and
        modified standard errors for the estimation <i>streg</i> (displaying 'Haz
        Ratio' as a title).
<p>
        back to top
<p>
<p>
<a name="tablelayout"></a>        +--------------+
    ----+ Table Layout +-----------------------------------------------------
<p>
    <b>below</b> and <b>right</b> control whether the standard deviation, t-statistic or
        p-values (see sd tstat pvalue) will be placed to the right or below
        the coefficients. <b>right</b> is used by default.
<p>
        For example: if <b>right</b> is specified the element of the output table
        will look like:
<p>
             <b>0.123 </b><i>0.456</i>
<p>
        if <b>below</b> is specified the element of the output table will look like:
<p>
             <b>0.123</b>
            <i>(0.456)</i>
<p>
    <b>nobrackets</b> removes brackets around standard deviations (t-statistics or
        p-values), which is the default format when <b>below</b> is used.
<p>
    <b>long</b> and <b>wide</b> produce "long version" or "wide version" of output table.
        <b>wide</b> specifies that the individual equations from multiple-equation
        models (e.g., mlogit, biprobit, heckman) to be placed in separate
        columns.  Summary statistics will be reported under the first
        equation if <b>wide</b> is specified. This is a default option.
<p>
        For example if a dependent variable with three categories is fitted
        with <b>mlogit</b> using 10 exogenous variables, specifying <b>wide</b> option
        would result in a 12x5 table. The first column of this table contains
        variable labels/names, the second and third columns contain the
        estimated coefficients and a standard errors for the first equation,
        and the fourth and fifth columns contain the estimated coefficients
        and a standard errors for the second equation.
<p>
        Alternatively, specifying option <b>long</b> places the equations of the
        multiple-equation estimation below one another in a single column.
<p>
    <b>keep(</b><i>keeplist</i><b>)</b> specifies the coefficients (and their order) to be
        included in the table. A <i>keeplist</i> comprises one or more
        specifications, separated by a space: a variable name (e.g., price),
        and equation name (e.g., mean:), or a full name (e.g., mean:price).
<p>
        Using <b>keep</b> in a multiple-equation or in multiple-estimation tables
        would output only variables specified in the <i>keeplist</i>. If some of the
        equations/estimations contain no variables in <i>keeplist</i>, these
        equations will not be outputted.
<p>
        If you want to keep some variables only in selected equations, make
        sure you specify the correct names for the equations. <b>xml_tab</b> uses
        the name of a dependent variable as an equation name. <b>keep</b> will
        output statistics for the variables in <i>keeplist</i> in all
        estimation/equations with identical names (same dependent variable).
<p>
    <b>drop(</b><i>droplist</i><b>)</b> identifies the coefficients to be dropped from the table.
        A <i>droplist</i> comprises one or more specifications, separated by spaces.
        A specification can be either a variable name (e.g. price), an
        equation name followed by a colon (e.g. mean:), or a full name (e.g.
        mean:price).
<p>
        <b>drop(</b><i>droplist</i><b>)</b> option could be useful if a user wants to suppress the
        output of coefficients for some variables. For example, if the
        empirical specification includes several regional dummies, one might
        want to create the output tables without the coefficients on these
        dummies. If regional dummies are named reg1,...,reg12, specifying
        <b>drop(</b><i>reg</i><b>*)</b> will suppress the output of the coefficients on these
        dummies in the table.
<p>
        In the multi-equation estimations (e.g., <b>heckman</b>, <b>heckprobit</b>)
        sometimes you might want to suppress the output of the coefficients
        for first stage equation. This could be done by specifying
        <b>drop(</b>select:<b>)</b>, where select is the name of the first stage equation.
        See more example of using <b>drop()</b> option in Examples section.
<p>
        Characters * and ? can be used for variable names in the <i>keeplist</i> and
        <i>droplist</i>. The * character indicates to match one or more characters
        and the ? character matches a single character. All variables
        matching the pattern will be a included in the lists.
<p>
        <b>.xml_tab, droop(region_*)</b>
        <b>.xml_tab, droop(region_?)</b>
<p>
        In this example, the first command will suppress the output of
        coefficients for variables region_1-region_15, but the second one
        will output just suppress the coefficients for region_1-region_9,
        because only the one digit(character) was allowed by ?.
<p>
        If both <b>keep()</b> and <b>drop()</b> are specified, <b>keep</b> will be applied first.
<p>
    <b>equations(</b><i>matchlist</i><b>)</b> specifies how the equations of the models in
        <i>namelist</i> are to be matched. This option works exactly the same way as
        <b>equations</b> in <b>estimates table</b>; see estimates_options for details.
<p>
        back to top
<p>
<p>
<a name="tableformating"></a>        +------------------+
    ----+ Table Formatting +-------------------------------------------------
<p>
    <b>format(</b><i>flist</i><b>)</b> specifies a list containing the formatting information for
        each cell of an XML table. The format of each cell is defined by a
        formatting string. A formatting string consists of five
        alpha-numerical symbols in the order specified bellow:
<p>
<p>
          Cell type : (S|s) - string, (N|n) - numeric
          Vertical alignment: (T|t|1) - Top , (C|c|2) - Center, (B|b|3) - Botto
&gt; m
          Horizontal alignment: (L|l|1) - Left, (C|c|2) - Center, (R|r|3) - Rig
&gt; ht
          Font style: (R|r|0) - Regular, (B|b|1)- Bold, (I|i|2) - Italic, (O|o|
&gt; 3) - Bold Italic, (U|u|4) - Underline
          Decimal places : 0-9 defining number of digits after the decimal
<p>
        The order of codes in the formatting string is important. The
        formatting string can contain a mixture of alpha-numerical symbols.
        Upper and lower-case character and numerical codes can be used
        interchangably. For example, a formatting string can look like N2210,
        NCCI2, nT1R0, sccb0 etc.
<p>
<p>
        The formatting for a table of size nxm is described as a list of
        codes for table's columns. That list has a form:
<p>
        <b>((F_00 F_01...F_0n) (F_10 F_11...F1_n) ... (F_n0 F_n1...F_mn))</b>
<p>
        Format lists for the different columns are enclosed in parenthesis
        and separated by a space. The first format list (F_00 F_01...F_0n)
        defines format for the rownames (e.g. variable names). The list (F_k0
        F_k1...F_kn) describes formatting of cells of the <i>k</i>-th column; the
        F_k0 defines the format for the <i>k</i>-th column's header (e.g. coeff.
        std.err.).
<p>
        If the dimensions of the formatting list are smaller than the
        dimensions of the output table, the formatting will be extended for
        the remaining rows/columns. If just one formatting code is specified
        as in <b>format((</b><i>S2110</i><b>))</b> (string, centered vertically, left justified,
        in bold, with 0 decimal places), that format will be applied to each
        cell of the output table (including variable names and column
        headers). If two codes are specified as in <b>format((</b><i>S2110</i><b>)</b><i> </i><b>(</b><i>N2230</i><b>))</b>,
        the column with variables names will be formatted using S2110 format
        and all other columns in the table will be formatted with N2230.
        Specifying three codes (<b>format((</b><i>S2110</i><b>)</b><i> </i><b>(</b><i>NCCI0</i><b>)</b><i> </i><b>(</b><i>N2211</i><b>))</b>) will apply
        format S2110 to the column of variable names; format N2230 to all odd
        numerical columns; and format N2211 to all even numerical columns of
        the table.
<p>
        Similarly, is <b>k+1</b> formatting codes are specified the first format
        will be applied to the column of the variable/row names and remaining
        <b>k</b> formats will be applied repeatedly to every group of k columns of
        the table.  By specifying more than one formatting code for a column
        you can control the formatting of every cell in a column.
<p>
        Analogously to the extension rule for the column formats, the first
        code of the list will be applied to the column header and the next
        codes will be used repeatedly for the cells of a column. For example,
        format((S2110) (SCCB0 N2302 N2322)) outputs the variable names with
        format S2110, the headers for each numerical column with format S2210
        format; every odd row has a format N2302 (right justified with 2
        decimals) and every even row is formatted with N2322 (italic with 2
        decimals).
<p>
        See <b>styles</b> for an alternative way of specifying the formatting of the
        output table.
<p>
    <b>lines(</b><i>string</i><b>)</b> will draw the bottom borderline in the cells with the
        listed variables. <i>string</i> is list of paired parameters. The first
        parameter specifies the variable name (or row number) and the second
        parameter a line style.  The line style can be a number from 0 to 13
        that corresponds to the line styles defined below. In addition,
        specifying <b>SCOL_NAMES</b>, <b>COL_NAMES</b> and <b>LAST_ROW</b> instead of variable
        names <b>xml_tab</b> will draw lines under equation names (<b>SCOL_NAMES</b>),
        statistic titles (e.g., coeff. std.error) <b>COL_NAMES</b> or under the last
        row of table (<b>LAST_ROW</b>).
<p>
        <i>Line #</i> <i>Style</i>
<p>
            <b>#</b>       <i>Style</i>
<p>
            <b>0</b>       None
            <b>1</b>       Continuous hairline
            <b>2</b>       Continuous thin
            <b>3</b>       Continuous medium
            <b>4</b>       Continuous thick
            <b>5</b>       Dot thin
            <b>6</b>       DashDotDot thin
            <b>7</b>       DashDotDot medium
            <b>8</b>       DashDot thin
            <b>9</b>       DashDot medium
            <b>10</b>      Dash thin
            <b>11</b>      Dash medium
            <b>12</b>      SlantDashDot thin
            <b>13</b>      Double thick
<p>
        For example, <b>lines(COL_NAMES 1 turn 1 LAST_ROW 13)</b> draws a single
        line under the captions (e.g., coeff std.err), a single line under
        the variable <i>turn</i>, and draw a double line under the last raw of the
        table.
<p>
    <b>nolabel</b> by default, variable labels will be displayed as row names in the
        output table. If <b>nolabel</b> is specified, variable names will be
        displayed in the output table. This option is ignored when outputting
        matrixes.
<p>
    <b>constant(</b><i>string</i><b>)</b> controls the label for the constant term. The default in
        Stata is <b>_cons</b>, but if specified, <i>string</i> will be displayed instead.
<p>
    <b>rblanks(</b><i>varname </i>[<i>text</i>]<i> </i>[<i>format</i>]<b>,</b><i> </i>[<i>varname </i>[<i>text</i>]<i> </i>[<i>format</i>]]<b>,</b><i> </i>[...]<b>)</b>
        inserts an empty row or text after the specified rows (<i>varname</i>) in
        the output table. For each inserted row <b>xml_tab</b> expects variable name
        <i>varname</i> after which an empty row or text should be added, the text
        itself <i>text</i>, and format for a new cell <i>format</i>. Multiple rows are
        separated by comma. Also see <b>format</b>.
<p>
        For example, <b>rblanks</b>(turn "this text after turn" S2210, headroom "and
        this one below headroom") will add vertically and horizontally
        centered "<b>this text after turn</b>" below data row for variable called
        <i>turn</i> (if found) and "and this one below headroom" after variable
        headroom using the same format as for headroom.
<p>
        In addition, specifying <b>SCOL_NAMES</b>, <b>COL_NAMES</b> and <b>LAST_ROW</b> instead of
        variable names <b>xml_tab</b> will add a row under equation names
        (<b>SCOL_NAMES</b>), statistic titles (e.g., coeff. std.error) <b>COL_NAMES</b> or
        under the last row of table (<b>LAST_ROW</b>).
<p>
    <b>cblanks(</b><i>Equations</i>|<i>numlist</i><b>)</b> inserts an empty column after each column
        specified in the<i> numlist</i>. The numbering of the numeric columns in the
        output table starts from 1, For example, <b>cblanks(</b><i>2 4</i><b>)</b> inserts an
        empty column after the second and the fourth columns of the output
        table. Column with the row names is number 0. If keyword <i>Equations</i>
        (abbreviation allowed) is used then blank column will be added after
        every equation (group of columns having the same column equation
        value).
<p>
    <b>cwidth(</b><i>string</i><b>)</b> controls the column withs in Excel worksheet. <i>string</i> is
        list of paired parameters.  The first parameter specifies the column
        number (0 being the row names column) or keyword <i>Equations</i> and the
        second parameter a column width. You can specify a column width of 0
        to 255. This value represents the number of characters that can be
        displayed in a cell that is formatted with the standard font. If the
        column width is set to 0, the column is hidden. <b>cwidth</b> is evaluated
        after the <b>cblanks</b> option so additional blank columns (if any) should
        be taken into consideration when determining column numbering.
<p>
    <b>tblanks(</b><i>#</i><b>)</b> inserts <i>#</i> rows at the beginning of an Excel sheet. The output
        table shifts down by # rows.
<p>
    <b>title(</b><i>string</i><b>)</b> specifies the title for the table. The <i>string</i> is inserted
        at the top of table. Example:
<p>
        <b>.xml_tab *, title("Table 1.1")</b>
<p>
    <b>rnames(</b><i>string</i><b>)</b>, <b>cnames(</b><i>string</i><b>)</b> and <b>ceq(</b><i>string</i><b>)</b> modify default row/column
        names as well as column equation names (super-titles) for the output
        matrix/estimation result. <i>string</i> should contain as many words as
        rows/columns in the output. To specify a name containing spaces it
        must be included in quotes. Table formating options <b>long</b>, <b>below</b>,
        <b>keep()</b>, <b>drop()</b>, <b>rblanks()</b> and <b>cblanks()</b> will be applied before the
        <b>rnames()</b>, <b>cnames(</b><i>string</i><b>)</b> and <b>ceq(</b><i>string</i><b>)</b>.
<p>
    <b>notes(</b>[<i>#</i>]<i> line1 </i>[<b>,</b><i> </i>[<i>#</i>]<i> line2 </i>[<b>,</b><i> </i>...]]<b>)</b> adds one or more lines of text at
        the end of the table. Lines are separated by commas. If first word
        (after comma) of a line specification is numeric then the note will
        be shifted down by <i>#</i> rows, otherwise it will be written imediately
        after the previous output row.
<p>
    <b>font(</b><i>"FontName" </i>[<i>Fontsize</i>]<b>)</b> specifies the font for the output table in a
        particular sheet of the workbook. The <i>FontName</i> is a font name
        enclosed in quotes; an optional argument <i>FontSize</i> is the size of the
        font. Example:
<p>
        <b>.xml_tab *, font("Arial Narrow" 12)</b>
<p>
        If no <b>font</b> is specified, the defualt font is used. When a new sheet
        is added to the existing workbook and <b>font</b> is specified, that <b>font</b>
        will be applied only to the table in this new sheet. So, each sheet
        in the workbook can use differnt fonts.
<p>
    <b>nogridlines</b> hides gridlines on a worksheet. The default in Excel is to
        display gridlines. This option affects only the on-screen appearance,
        these lines are not printed.
<p>
    <b>style(</b><i>stylename</i><b>)</b> specifies layouts and formatting for the output table
        from predefined list of styles. These predefined styles are stored in
        the <b>xml_tab_options.txt</b>. If file is missing it will be recreated.
        There are several preset styles: default, S1, S2. user-defined styles
        can be added to the file. If neither <b>style</b> nor <b>format</b> was specified,
        the program creates output with <b>style(</b>default<b>)</b>.
<p>
        <b>styles</b> in <b>xml_tab</b> are just sets of options that are written in file
        <i>xml_tab_options.txt</i> located in the directory where <b>xml_tab</b> is
        installed. Each <b>style</b> is recorded on the separate line. You can
        define your own styles by modifying file <i>xml_tab_options.txt</i>. The
        syntax for the styles consist of the style name, equal sign, and the
        set of options corresponding to that particular style. To create a
        style, add a new line in the file <i>xml_tab_options.txt</i> and define your
        style. For example:
<p>
        <b>MYTABLES=sd right replace wide font("Arial Narrow" 12) sheet(Table 1)</b>
<p>
        You can instruct <b>xml_tab</b> to use this style by specifying:
<p>
        <b>xml_tab *, style(mytables)</b>
<p>
        This command will create a table using the set of options defined in
        <b>style(</b><i>mytables</i><b>)</b>. In other words, the previous command is equivalent
        to:
<p>
        <b>xml_tab *, sd right replace wide font("Arial Narrow" 12) sheet(Table</b>
                    <b>1)</b>
<p>
        User-specified options supersede any options defined in style. You
        can check the complete set of options associated with a particular
        style by using option <b>noisily</b>.
<p>
        back to top
<p>
<p>
<a name="system"></a>        +---------------------------------------+
    ----+ System requirements and other options +----------------------------
<p>
    <b>xml_tab</b> is designed for Stata Version 8.0 and later. The XML files
    generated by <b>xml_tab</b> could be opened with 2003 or later versions of
    <i>Microsoft Excel</i> and <i>OpenOffice Calc 2.0</i> under Windows OS. It might be
    possible to open XML files with <i>MS Excel 2002</i>. The XML format is not
    supported by <i>MS Excel 2000</i> and earlier.
<p>
    We have not tested the compatibility of XML output generated by<b> xml_tab</b>
    with <i>OpenOffice Calc</i> or <i>Microsoft Excel</i> running under Macintosh, UNIX, or
    Linux OS. We would be thankful for the comments from the users running
    Stata on these platforms about any problems they encounter with using
    <b>xml_tab</b>.
<p>
    <b>xml_tab</b> will try to locate either <i>MS Excel</i> or <i>OO Calc</i> on your computer
    and if found, will create a link in the results window clicking on which
    will automatically open the output. You can explicitly specify where
    should<b> xml_tab</b> look for <i>Excel</i> or <i>Calc</i> if the programs are installed not
    in their default locations (you will need to do it just once). If neither
    of two programs was found or Stata runs in "console" or "batch" modes, no
    link will be created but <b>xml_tab</b> will still generate the output file.
<p>
    <b><u>ex</u></b><b>celpath(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b>, <b><u>cal</u></b><b>cpath(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b> tells <b>xml_tab</b> where
        to find Excel and/or Calc executables, for example:
<p>
        <b>.xml_tab, excelpath("D:\My programs\MS Excel\excel.exe")</b>
<p>
        <b>.xml_tab, calcpath("D:\My programs\OpenOffice.org\scalc.exe")</b>
<p>
<p>
    <b><u>noi</u></b><b>sily</b> displays the complete list of options applied to the table. This
        option could be useful whey using <b>style</b> in order to see all options
        associated with a particular style.
<p>
    <b>updateopts</b> is used to recreate the options file. if<b> xml_tab_options.txt</b>
        is missing, it will be created automatically, otherwise <b>updateopts</b>
        can be specified to overwrite the existing options file with the one
        containing the default styles.
<p>
    <b>which xml_tab</b> displays the version and location of <b>xml_tab</b> installed on
        the computer. The latest version of the program can be installed in
        Stata by typing:
<p>
        <b>.adoupdate xml_tab, update</b>
<p>
        back to top
<p>
<p>
<p>
<b><u>Examples</u></b>
<p>
        +--------------+
    ----+ Introduction +-----------------------------------------------------
<p>
    In all our examples we use stored estimates and matrixes defined by the
    code below:
<p>
      <b>.sysuse auto, clear</b>
<p>
      <b>.regress price mpg headroom trunk if foreign==0</b>
<p>
      <b>.estimates store reg1</b>
<p>
      <b>.regress price mpg headroom trunk turn if foreign==1</b>
<p>
      <b>.estimates store reg2, title(Only foreign cars)</b>
<p>
      <b>.heckman mpg weight length, sel(foreign = length displ) nolog</b>
<p>
      <b>.estimates store heck1, title(Selection model)</b>
<p>
    In the above code we use datafile <b>auto.dta</b>. We run a regression and save
    the results of this regression into the stored estimate <i>reg1</i>. We then run
    another regression with a different specification and save the results in
    the estimate <i>reg2</i> giving this estimate a title. Then we estimate <b>heckman</b>
    selection model. We store the estimates from this model to <i>heck1</i>.
<p>
        +--------------+
    ----+ Basic syntax +-----------------------------------------------------
<p>
<p>
      <b>.xml_tab reg1 reg2, replace stats(r2_a) title("price regressions by car</b>
                    <b>type")</b>
<p>
    In this example, <b>xml_tab</b> merges the estimates of two regression <i>reg1</i> and
    <i>reg2</i> forming a table with five columns. The first column contains the
    variable names; the second column contains the estimated coefficients
    from the first regression; the third column contains the standard errors
    for the coefficients from the first regression; the estimated
    coefficients and the standard errors from the second regression are
    placed in the fourth and fifth columns of the output table.
<p>
    In addition to the coefficients and standard errors <b>xml_tab</b> also outputs
    the adjusted R2 for each regression at the bottom of the output table
    (option <b>stat(</b><i>r2_a</i><b>)</b>. With option <b>title(</b><i>"price regressions by car type"</i><b>)</b>
    <b>xml_tab</b> is instructed to place a text "Price regression by car type" on
    the top of output table. The numerical values in the table are formatted
    with a default format: both the a coefficients and the standard errors
    have three decimal places, standard errors are placed to the right from
    the coefficients and italicized.
<p>
    The table is outputted into the file <i>stata_out.xml</i> located in the current
    Stata directory.
<p>
<p>
    <i>Extensions:</i> options <b>below, tstat, save, sheet</b>
<p>
      <b>.xml_tab reg1 reg2 using "c:\my documents\table1", tstat below</b>
                    <b>sheet("Table 2") stats(N r2_a)</b>
<p>
    <b>save()</b> saves the XML file as <i>c:\my documents\table1.xml</i>. The output table
    is placed in the sheet of XML workbook with the name <i>Table 2</i>. Specifying
    <b>tstat</b> outputs the estimation coefficients and the corresponding
    t-statistics. Option <b>below</b> places t-statistics in parenthesis under the
    coefficients.
<p>
<a name="exampledk"></a>    <i>Extensions:</i> options <b>append, drop/keep</b>
<p>
      <b>.xml_tab heck1 using "c:\my documents\table1", pvalue right</b>
                    <b>drop(length) sheet("Heckman") stats(ll) append</b>
<p>
    This command saves the estimation results from <b>heckman</b>. Option <b>append</b>
    adds a new sheet "Heckman" to XML file used in the previous example and
    outputs there the estimated coefficients and p-values for the binary and
    continuous parts of the ML Heckman estimation. Option <b>drop(</b><i>length</i><b>)</b>
    suppresses the output of the estimated coefficient for <i>length</i>. <b>stats(</b><i>ll</i><b>)</b>
    reports log-likelihood value for the system at the bottom of the table.
<p>
    To suppress the output of the binary part of the ML Heckman estimation
    (loosely speaking to supers the output of the first stage equation), we
    insert the equation name as a parameter: <b>drop(</b>foreign:<b>)</b>.
<p>
<p>
    <i>Extensions:</i> options <b>long and wide</b>
<p>
    By default, <b>xml_tab</b> outputs the results of multiple-equation estimations
    into separate columns for each equation.  For example, the table formed
    in the last example consists of five columns: column with the variable
    names, two columns with the coefficients and p-values from the first
    stage equation, and two columns with the second stage equation estimates.
    To output the coefficients from both equations into one column, specify
    option <b>long</b>:
<p>
      <b>.xml_tab heck1 using "c:\my documents\table1", long pvalue right</b>
                    <b>sheet("Heckman_long") stats(ll) append</b>
<p>
    Note that the code above will keep two previous tables saved in sheets
    <i>Table 1</i> and <i>Heckman</i> in the file <i>c:\my documents\table1</i>. <b>xml_tab</b> will add
    a new sheet <i>Heckman_long</i> to the workbook and output the results in long
    specification into this sheet.
<p>
<p>
        +--------------------+
    ----+ Print ready tables +-----------------------------------------------
<p>
    <b>xml_tab</b> allows to create print-ready tables from within Stata. Several
    options control the look of the output table.
<p>
    Subcategories of variables could be conveniently separated using
    <b>rblanks()</b> option. The example below inserts an empty row after variable
    <b>mpg</b> and puts a heading in italic into this row:
<p>
      <b>.xml_tab reg1 reg2, replace stats(r2_a) rblanks(mpg "Interior</b>
                    <b>Dimensions" S2220)</b>
<p>
    To separate the results of two regressions, use option <b>cblanks()</b> that
    insert an empty column after the columns specified as argument of this
    option. The code below inserts an empty column after the third column
    (standard errors of the first regressions).
<p>
      <b>.xml_tab reg1 reg2, replace stats(r2_a) cblanks(3)</b>
<p>
    Option <b>line()</b> allows to underline rows of the table. To underline the
    last row of the output table with a double line use the following syntax:
<p>
      <b>.xml_tab reg1 reg2, replace stats(r2_a) line(LAST_ROW 13)</b>
<p>
    To underline the row with coefficient <b>mpg</b> with a single line and to
    underline the last row of the table with a double line use:
<p>
      <b>.xml_tab reg1 reg2, replace stats(r2_a) line(LAST_ROW 13 mpg 1)</b>
<p>
<a name="exampleme"></a>        +------------------+
    ----+ Marginal effects +-------------------------------------------------
<p>
    You have to use a non-standard specification in order to create tables of
    marginal effects, elasticities, and other statistics generated by <b>mfx</b>, 
    <b>dprobit</b>, and <b>dlogit</b>. Suppose we want to generate a table of marginal
    effects after <b>heckman</b> estimation.
<p>
      <b>.heckman mpg weight length, sel(foreign = length displ) nolog</b>
      <b>.mfx, predict(xb)</b>
      <b>.estimates store heck_mfx, title(Heckman marginals)</b>
<p>
    Now, if we want to output, for example, the marginal effects from this
    estimation we write:
<p>
      <b>.xml_tab heck_mfx(Xmfx_dydx Xmfx_se_dydx), replace</b>
<p>
    To output the marginal effects and the standard errors after <b>dprobit</b> you
    would specify <i>(dfdx se_dfdx)</i> statistics.
<p>
    Note that now we specify the names of matrixes with corresponding
    statistics parenthesis with the name of the stored estimates. You can
    check the names of the matrixes with stored statistics using <b>ereturn</b>
    <b>list</b>.
<p>
<a name="matrices"></a>        +--------------------+
    ----+ Exporting a matrix +-----------------------------------------------
<p>
    <b>xml_tab</b> can also output any matrix in Stata memory. You can apply most of
    the options of <b>xml_tab</b> to control the layout and the formatting of the
    matrix output. You can create custom tables forming the matrixes of
    results and outputting them with <b>xml_tab</b>. <b>tabstatmat</b> is a useful command
    to save various summary statistics into matrixes. The example below
    outputs matrix <b>M</b> with a custom format into the default XML file.
<p>
      <b>.matrix M = 1, 2 \ 3, 4</b>
      <b>.matrix M_STARS = 0, 2 \ 3, 1</b>
      <b>.xml_tab M, format((S2210, S2100, S2100), (S2210, N2301, N2301),</b>
                    <b>(S2230, N2321, N2321))</b>
<p>
    Since matrix <b>M_STARS</b> exists, output table will contain significance stars
    based on default levels and symbols. Thus, the output table will have a
    form:
<p>
                <b>c1</b>      <b>c2</b>
        r1        1.0     <i>2.1</i>**
        r2        3.0*    <i>4.1</i>***
<p>
<p>
<p>
    Another example demonstrates how to create and output a simple table of
    the means:
<p>
      <b>.tabstat price mpg rep78 headroom trunk weight length, by(foreign) save</b>
      <b>.tabstatmat A</b>
      <b>.matrix TAB=A'</b>
<p>
      <b>.xml_tab TAB, replace</b>
<p>
    <b>tabstat</b> generates a table of means for the list of variables categorized
    by <b>foreigh</b>. <b>tabstatmat</b> saves the resutls to matrix A. This matrix has
    tree rows for Domestic, Foreign and Total. In the columns of matrix A are
    the means for the listed variables. We save the transpose matrix A into
    another matrix TAB. <b>xml_tab</b> ouptuts the matrix into the default XML file.
<p>
    You can see more examples of using <b>xml_tab</b> in <b>xml_tab_example.do</b>.
<p>
<p>
<b><u>Authors</u></b>
<p>
    Zurab Sajaia, zsajaia@worldbank.org
<p>
    Michael Lokshin, mlokshin@worldbank.org
<p>
    econ.worldbank.org/programs/poverty/toolkit
<p>
    Development Economics Research Group,
<p>
    The World Bank, 2006
<p>
<b><u>Acknowledgement</u></b>
<p>
    While the concept of <b>xml_tab</b> is original, we borrowed some functionality
    ideas from such programs as <b>estout</b> by Ben Jann, <b>outreg</b> by John Luke
    Gallup, <b>outreg2</b> by Roy Wada, <b>modltbl</b> by John H. Tyler, <b>mktab</b> by Nicholas
    Winter, <b>outtex</b> by Antoine Terracol, or <b>est2tex</b> by Marc Muendler.
<p>
<b><u>Also see</u></b>
<p>
    Online: <b>xmlsave</b>, <b>estimates</b>, <b>matrix</b>, <b>which</b>
</pre>