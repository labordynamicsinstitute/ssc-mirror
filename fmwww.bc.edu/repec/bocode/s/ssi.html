<pre>
<b>help ssi</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>ssi</b> -- Sample size and power calculation for balanced two-group
           randomized controlled trials (including non-inferiority and
           equivalence trials)
<p>
<b><u>Syntax</u></b>
<p>
        <b>ssi</b> #1 #2 [, <i>options</i>]
<p>
<p>
    <i>options</i>               Description
    -------------------------------------------------------------------------
    Main
      <b><u>sd</u></b><b>1(</b><i>#</i><b>)</b>              standard deviation of sample 1
      <b>sd2(</b><i>#</i><b>)</b>              standard deviation of sample 2
<p>
    Options
      <b><u>a</u></b><b>lpha(</b><i>#</i><b>)</b>            significance level of test; default is <b>alpha(0.05)</b>
      <b><u>p</u></b><b>ower(</b><i>#</i><b>)</b>            power of test; default is <b>power(0.80)</b>
      <b>n(</b><i>#</i><b>)</b>                number of patients in each group (used when
                            calculating power)
      <b><u>l</u></b><b>oss(</b><i>#</i><b>)</b>             percentage of total sample expected to be lost to
                            follow-up
      <b>c1(</b><i>#</i><b>)</b>               percentage of sample 1 expected to crossover to
                            sample 2
      <b>c2(</b><i>#</i><b>)</b>               percentage of sample 2 expected to crossover to
                            sample 1
      <b><u>non</u></b><b>inferiority</b>      use if trial design is non-inferiority
      <b><u>equ</u></b><b>ivalence</b>         use if trial design is equivalence
    -------------------------------------------------------------------------
<p>
<b><u>Description</u></b>
<p>
    <b>ssi</b> is meant to be used by investigators needing sample size estimation
    for prospective randomized controlled trials (RCTs). Although Stata ships
    with a sample size estimation command (sampsi), it is not designed to
    estimate trial sizes for non-inferiority or equivalence trials.
<p>
    <b>ssi</b> allows the estimation of sample size for two <i>balanced</i> (i.e. the same
    sample size for each group) groups for trials whose primary outcomes are
    either proportions or means.
<p>
    If <b><u>sd</u></b><b>1(</b><i>#</i><b>)</b> (with or without <b>sd2(</b><i>#</i><b>)</b>) is specified, <b>ssi</b> assumes a comparison
    of means; otherwise, it assumes a comparison of proportions. <b>ssi</b> is an
    immediate command, and all of its arguments are numbers; see immed.
<p>
<p>
<b><u>Details on Syntax</u></b>
<p>
    <b><u>Proportions</u></b>
    1. Two-sample comparison of proportions
        <b>For sample size calculation</b>: The <i>postulated</i> values of the two
        proportions are <i>#1</i> and <i>#2</i>.
        <b>For power calculation</b>: The <i>observed</i> values of the two proportions are
        <i>#1</i> and <i>#2</i>, and the per-group sample size is entered as <i>n(#)</i>.
<p>
    2. Non-inferiority &amp; equivalence trial design (see remarks)
        <b>For sample size calculation</b>: The overall percentage of successes to
        be expected if the treatments are equivalent (or non-inferior) is <i>#1</i>,
        and the "delta" (minimal important difference to detect) is <i>#2</i>.
        Option <b><u>non</u></b><b>inferiority</b> or <b><u>equ</u></b><b>ivalence</b> must also be used.
        <b>For power calculation</b>: The observed proportion of successes in the
        comparator group is <i>#1</i>, the desired minimal important clinical
        difference (delta) is <i>#2</i>, and the per-group sample size is entered as
        <i>n(#)</i>.  Option <b><u>non</u></b><b>inferiority</b> or <b><u>equ</u></b><b>ivalence</b> must also be used.
<p>
    <b><u>Means</u></b>
    1. Two-sample comparison of means
        <b>For sample size calculation</b>: The <i>postulated</i> values of the means are
        <i>#1</i> and <i>#2</i>, and the postulated standard deviations are <b>sd1(#)</b> and,
        optionally, <b>sd2(#)</b>.
        <b>For power calculation</b>: The <i>observed</i> values of the means are <i>#1</i> and
        <i>#2</i>, the <i>actual</i> standard deviations are <b>sd1(#)</b> and <b>sd2(#)</b>, and the
        per-group sample size is entered as <i>n(#)</i>.
<p>
    2. Non-inferiority or equivalence trial design (see remarks)
        <b>For sample size calculation</b>: The <i>postulated</i> values of the means in
        the two groups are <i>#1</i> and <i>#2</i>, (i.e. the minimal important detectable
        difference [delta] is the difference between the two postulated
        means) and the postulated standard deviation (assumed to be the same
        for each group) is entered as <b>sd1(#)</b>.  Option <b><u>non</u></b><b>inferiority</b> or
        <b><u>equ</u></b><b>ivalence</b> must also be used.
        <b>For power calculation</b>: The value of the observed mean in the
        comparator group is entered as <i>#1</i>, the mean of the other group that
        reflects the desired minimal important clinical difference (delta) is
        entered as <i>#2</i> (i.e. the difference between #1 and #2 is the desired
        delta), the standard deviation of the groups is entered as <b>sd1(#)</b>
        (enter an average value if the two SDs are not the same), and the
        per-group sample size is entered as <i>n(#)</i>. Option <b><u>non</u></b><b>inferiority</b> or
        <b><u>equ</u></b><b>ivalence</b> must also be used.
<p>
<b><u>Options</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>sd1(</b><i>#</i><b>)</b> and <b>sd2(</b><i>#</i><b>)</b> are the standard deviations of population 1 and
        population 2, respectively. One or both must be specified when doing
        a comparison of means. If only <b>sd1(</b><i>#</i><b>)</b> is specified, <b>ssi</b> assumes that
        <b>sd2(</b><i>#</i><b>)</b> = <b>sd1(</b><i>#</i><b>)</b>.  If neither <b>sd1(</b><i>#</i><b>)</b> nor <b>sd2(</b><i>#</i><b>)</b> is specified, <b>ssi</b>
        assumes a test of proportions.
<p>
        +---------+
    ----+ Options +----------------------------------------------------------
<p>
    <b><u>a</u></b><b>lpha(</b><i>#</i><b>)</b> is the significance level of the test.  The default is
        <b>alpha(0.05)</b>.
<p>
    <b><u>p</u></b><b>ower(</b><i>#</i><b>)</b> is the power of the test (= 1 - beta). The default is
        <b>power(0.80)</b>.
        (Note that the default value of 0.80 constitutes a difference from
        the Stata <b>sampsi</b> command.
<p>
    <b>n(</b><i>#</i><b>)</b> is used to calculate power (i.e. if any <b>n</b> is specified, sample size
        will not be calculated, and the <b>power(</b><i>#</i><b>)</b> parameter is ignored). <b>n</b> is
        the number of patients in each group.  <b>n</b> in each group must be equal.
        (If they are not equal, enter the average size of each group as <b>n</b>.)
<p>
    <b><u>l</u></b><b>oss(</b><i>#</i><b>)</b> is the percentage of patients of in the total sample who are
        expected to be lost to follow-up. For example, if 15% of patients in
        a trial are lost to follow-up, the total sample size needs to be
        increased to accommodate the reduction in power that occurs with the
        loss to follow-up. e.g. <b>loss(15)</b>
<p>
    <b>c1(</b><i>#</i><b>)</b> is the percentage of patients of sample 1 expected to crossover to
        sample 2 during the trial. For example, if 5% of patients in one arm
        of a trial crossed over to the other group, the total sample size
        needs to be increased to accommodate the reduction in power that
        occurs with the crossover. e.g. <b>c1(5)</b>
<p>
    <b>c2(</b><i>#</i><b>)</b> is the percentage of patients of sample 2 expected to crossover to
        sample 1 during the trial. See <b>c1(#)</b> above for details.
<p>
    <b><u>non</u></b><b>inferiority</b> indicates that you wish to calculate a sample size or
        power for a non-inferiority trial. (see remarks).
<p>
    <b><u>equ</u></b><b>ivalence</b> indicates that you wish to calculate a sample size or power
        for an equivalence trial. (see remarks).
<p>
<a name="remarks"></a><b><u>Remarks and Background Information</u></b>
<p>
        +--------------------+
    ----+ Equivalence Trials +-----------------------------------------------
<p>
    Normally, the null hypothesis for a test statistic is that the two groups
    tested represent different samples from the same population (i.e. there
    is no significant difference between the groups). However, with
    equivalence and non-inferiority trial designs, the null hypothesis is the
    opposite: that the two groups <b>are</b> in fact different.
<p>
    The graph below, adapted from Jones B (see References), demonstrates the
    confidence interval approach to equivalence testing. Once a <b>delta</b> has
    been pre-selected, the CI of the difference between treatments is
    visualized along the horizontal axis. In an infinitely large trial with
    infinitely narrow CIs, if the two treatments are really equivalent, then
    the difference will be 0.
<p>
    If the CI of the difference between treatments lies completely within
    [-delta to +delta], then the proposed treatment can be considered to be
    equivalent to the comparator. However, as stated by Jones B,
<p>
               "It is important to emphasise that absolute equivalence can
               never be demonstrated:  it is possible only to assert that
               the true difference is unlikely to be outside a range which
               depends on the size of the trial, the results of the trial,
               and the specified probabilities of error. If we have
               predefined a range of equivalence as an interval from -delta
               to +delta we can then simply check whether the confidence
               interval centred on the observed difference lies entirely
               between -delta and +delta. If it does, equivalence is
               demonstrated; if it does not, there is still room for
               doubt." (see References).
<p>
    (<b>Note: if the graph below looks strange, re-size your Viewer window so it</b>
    <b>is wider.</b>}
<p>
<p>
             |                   |		     |			|    Not equivalent
   	     |			 |		     |			|  &lt;&lt;-------------&gt;&gt;
	     |                   |		     |		  Uncertain
   	     |			 |		     |	      &lt;&lt;--------+-------&gt;&gt;
	     |			 |		     |	  Equivalent	|
   	     |			 |		     | &lt;&lt;------------&gt;&gt; |
	     |			 |		 Equivalent		|
  	     |			 | 	    &lt;&lt;-------+---------&gt;&gt;	|
	     |   		 |     Equivalent    |			|
   	     |			 |  &lt;&lt;------------&gt;&gt; |			|
	     |		     Uncertain		     |			|
   	     |		&lt;&lt;-------+--------&gt;&gt;	     |	                |
	     |	 Not equivalent	 |		     |			|
   	     + &lt;&lt;-------------&gt;&gt; |		     |			|
	     |			 |		 Uncertain		|
    	     +      &lt;&lt;-----------+-------------------+------------------+---------
&gt; --&gt;&gt;
	     |			 |		     |			|
             |                   |		     |                  |                  
&gt;        
             |                   |                   |                  |
             +-------------------+-------------------+------------------+------
&gt; ------------+
			     - delta		     0		    + delta
					Observed treatment difference
<p>
<p>
        +------------------------+
    ----+ Non-Inferiority Trials +-------------------------------------------
<p>
    If we are only interested in ensuring that a proposed treatment (say, a
    new antibiotic) is <b>not worse</b> than a certain comparator, we can use a
    non-inferiority approach, where we are only interested in a one-sided
    difference. The approach is to first pre-define the smallest level of
    inferiority of the proposed treatment (delta), which, if surpassed, would
    be a clinically unacceptable difference. If the CI of the difference
    between treatments lies completely on one side of delta (in the more
    favourable direction for the new treatment), then the proposed treatment
    can be considered to be non-inferior to the comparator. Examples are
    found in the graph below.
<p>
    (<b>Note: if the graph below looks strange, re-size your Viewer window so it</b>
    <b>is wider.</b>}
<p>
    Note: text on graph refers to how the new treatment fares compared to the
    standard treatment.  Example 1 is clearly worse, as its CI lies
    completely to the "bad" side of delta. Examples 2 and 8 are uncertain,
    since their CIs cross both delta and zero. Examples 3 and 4 meet the
    criteria for non-inferiority. Examples 5, 6, and 7 meet the criteria, and
    they also are <b>superior</b> to the comparator, since their CIs exclude no
    treatment effect in a favourable direction.
<p>
<p>
  1                              		     |			|        Worse
   	     			 		     |			|  &lt;&lt;-------------&gt;&gt;
  2	                        		     |		   Uncertain
   	     			 		     |	      &lt;&lt;--------+-------&gt;&gt;
  3	     			 		     |	 Non-inferior	|
   	     			 		     | &lt;&lt;------------&gt;&gt; |
  4	     			 		 Non-inferior		|
  	     			  	    &lt;&lt;-------+---------&gt;&gt;	|
  5	        		      Non-inferior   |			|
   	     			   &lt;&lt;------------&gt;&gt;  |			|
  6	     		     Non-inferior	     |			|
   	     		&lt;&lt;---------------&gt;&gt;	     |	                |
  7	     	 Non-inferior	 		     |			|
   	      &lt;&lt;-------------&gt;&gt; 		     |			|
  8	     			 		 Uncertain		|
    	             &lt;&lt;------------------------------+------------------+---------
&gt; --&gt;&gt;
	     			 		     |			|
                                		     |                  |                    
&gt;      
                                                     |                  |
             +---------+---------+---------+---------+--------+---------+------
&gt; ---+--------+
			     			     0		      delta
			New treatment better			New treatment worse
					Observed treatment difference
<p>
<p>
<b><u>Examples</u></b>
<p>
        +-------------+
    ----+ Proportions +------------------------------------------------------
<p>
    1. <b>Two-sample comparison of proportions.</b> The post-operative myocardial
        infarction rate as a baseline is 5.4% (0.054 as a proportion), and a
        new treatment is hypothesized to reduce mortality by half to 2.7%
        (0.027). Calculate the required sample size with a power of 80% and
        an alpha of 5%.
<p>
        <b>. ssi 0.054 0.027</b>
<p>
    2. <b>Non-inferiority trial design.</b> A new antibiotic was tested against
        penicillin for erysipelas. The primary outcome was the clinical cure
        rate. For the sample size calculation, the investigators assumed the
        proportion cured in both arms would be 85% (pi = 0.85). They
        considered that a difference in cure rate as large as 10%<i> in favour</i>
        <i>of penicillin</i> would still allow the new antibiotic to be non-inferior
        (delta = 0.1). Calculate the sample size based on 90% power to
        confirm non-inferiority and a one-sided confidence level of 97.5%.
<p>
        <b>. ssi 0.85 0.10, alpha(0.025) power(0.9) noninferiority</b>
<p>
    3. <b>Equivalence trial design.</b> Using the same example as above, the
        investigators thought that the new antibiotic could also be <i>better</i>
        than penicillin, but they were not sure, therefore they wanted to
        allow for a two-sided test. Therefore, performing an equivalence
        trial allows them to calculate two-sided confidence intervals. They
        relax their significance assumption to a more conventional alpha of
        0.05.
<p>
        <b>. ssi 0.85 0.1, p(0.9) equivalence</b>
<p>
    4. <b>Power Analysis.</b> You read a paper comparing candesartan to ramipril for
        hypertensive patients that compared mortality rates at one year. In
        the candesartan group 2% of people died by one year, and in the
        ramipril group 4% died by one year. 400 patients were studied in each
        group.  What power did the authors have to state that there was no
        difference between groups?
<p>
        <b>. ssi 0.04 0.02, n(400)</b>
<p>
        +-------+
    ----+ Means +------------------------------------------------------------
<p>
    1. <b>Two-sample comparison of means.</b> Serum troponin T in the medication arm
        was 2.55 (SD=2.12) while in the cardiac surgery arm troponin T was
        3.94 (SD=2.8). Calculate the required sample size with a power of
        80%, alpha of 5%, and an expected loss of followup of 5% of the total
        sample.
<p>
        <b>. ssi 2.55 3.94, sd1(2.12) sd2(2.8) loss(5)</b>
<p>
    2. <b>Same as #1</b>, except no loss to followup occurred, but 2% of each group
        crossed over into the other group, thereby reducing power.
<p>
        <b>. ssi 2.55 3.94, sd1(2.12) sd2(2.8) c1(2) c2(2)</b>
<p>
    3. <b>Non-inferiority trial design.</b> A new inhaler for asthma will be
        considered non-inferior to the standard treatment if it does not
        reduce the morning peak expiratory flow rate by more than 25 l/min
        (from a baseline of 450 l/min to 425 l/min). Previous data suggests
        that the SD in the trial population will be approximately 40 l/min.
        Calculate the required sample size with a power of 80% using a
        significance level of 2.5% (alpha = 0.025).  (Keep in mind that the
        absolute values of the baseline and changed measurements do not
        matter:  only the change and SD are important. This example could
        just have easily used the range 250 l/min to 225 l/min and obtained
        exactly the same result.)
<p>
        <b>. ssi 450 425, sd1(40) a(0.025) non</b>
<p>
    4. <b>Equivalence trial design.</b> Using the same values as the previous
        example, except this time, we are interested to know if the new
        inhaler is <i>equivalent</i>. We say the new inhaler will be deemed to be
        equivalent if the morning peak expiratory flow rate is within +/- 25
        l/min of the standard inhaler. Since the absolute values do not
        matter, we will use 25 and 0 as our values for <b>#1</b> and <b>#2</b> (their order
        also does not matter). The expected SD is the same (40 l/min).
        Significance of 5% and power of 80%.
<p>
        <b>. ssi 25 0, sd(40) equ</b>
<p>
    5. <b>Power Analysis.</b> A new anaesthetic is thought to have superior
        pharmacologic preconditioning efficacy than the old anaesthetic. The
        average peak postoperative serum troponin T was 2.32 (SD=2.01) in the
        group anaesthetized with the old anaesthetic, while those patients
        anaesthetized with the new anaesthetic had an average peak
        postoperative troponin T of 1.75 (SD=1.52).  100 patients were
        studied in each group. What power did the researchers have to state
        that there was no difference between the two anaesthetics in terms of
        peak postoperative troponin T levels?
<p>
        <b>. ssi 2.32 1.75, sd1(2.01) sd2(1.52) n(100)</b>
<p>
<a name="references"></a><p>
<b><u>References:</u></b>
<p>
    1) Jones B, Jarvis P, Lewis JA, Ebbutt AF. Trials to assess equivalence:
    the importance of rigorous methods. BMJ 1996;313:36-9.  (i: British
    Medical Journal link, ii: PDF)
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>ssi</b> saves the following in <b>r()</b> (some values are not presented when power
    is calculated):
<p>
    Scalars             
<p>
      <b>r(power)</b>            entered or calculated power
      <b>r(adj_ss)</b>           adjusted sample size (for loss of follow-up and/or
                            crossovers)
      <b>r(per_group_size)</b>   sample size for each of the two groups
      <b>r(ss)</b>               total sample size
<p>
<p>
<b><u>Author Information:</u></b>
<p>
    Philip M Jones, MD FRCPC
    Department of Anesthesiology &amp; Perioperative Medicine
    Faculty of Medicine &amp; Dentistry
    University of Western Ontario
    London, Ontario, Canada
    pjones8@uwo.ca
<p>
<b><u>Change Log:</u></b>
<p>
    <b>14 May 2010</b> - Version 1.0.0
<p>
        Initial version published.
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[R] sampsi</b>
<p>
      Help:  sampsi
</pre>