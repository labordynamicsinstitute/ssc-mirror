<pre>
<b>help stpm2cm</b> 
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>stpm2cm</b> -
               Postestimation command for <b>stpm2</b> models to estimate crude and
               net mortality after fitting a relative survival model
<p>
<p>
<b><u>Syntax</u></b>
<p>
<p>
        <b>stpm2cm</b> using {filename} [<b>,</b> <i>options</i>]
<p>
<p>
<a name="options"></a>    <i>options</i>                        Description
    -------------------------------------------------------------------------
      <b>at(</b><i>varlist</i><b>)</b>                  specifies covariate pattern for
                                     prediction}
      <b>mergeby(</b><i>varlist</i><b>)</b>             specifies the variables to merge with the
                                     population mortality file.
      <b><u>diaga</u></b><b>ge(</b><i>#</i><b>)</b>                   gives age at diagnosis
      <b><u>diagy</u></b><b>ear(</b><i>#</i><b>)</b>                  gives year at diagnosis
      <b>sex(</b><i>#</i><b>)</b>                       gives coding for sex required in
                                     population mortality file
      <b><u>atta</u></b><b>ge(</b><i>varname</i><b>)</b>              specifies the variable containing attained
                                     age (i.e., age at the time of follow-up)
      <b><u>atty</u></b><b>ear(</b><i>varname</i><b>)</b>             specifies the variable containing attained
                                     year (i.e., year at the time of
                                     follow-up)
      <b><u>maxa</u></b><b>ge</b>                       maxium age in popmort file
      <b><u>n</u></b><b>obs</b>                         specifies the number of observations (of
                                     time) to predict for (default 1000).
                                     Observations are evenly spread between
                                     the minimum and maximum value of
                                     follow-up time.
      <b>ci</b>                           calculate confidence intervals
      <b>maxt(</b><i>#</i><b>)</b>                      the maximum value of follow up time
      <b>stub(</b><i>stub</i><b>)</b>                   the stub name for calculation of new
                                     variables
      <b>tgen(</b><i>newvarname</i><b>)</b>             name of variable for generated follow-up
                                     time.
      <b>mergegen(</b><i>varname # </i>...<b>)</b>      values of other merge variables required
                                     for the population mortality file
<p>
<b><u>Description</u></b>
<p>
    <b>stpm2cm</b> calculates crude and net mortality after fitting an <b>stpm2</b> model.
    It is a postestimation command and requires that an <b>stpm2</b> has been
    fitted. The expected survival/mortality is required for calculation of
    the crude probabilities of death due to other causes and the <b>strs</b> command
    is used for this. <b>strs</b> can be obtained from Paul Dickman's webpage
    (http://www.pauldickman.com/rsmodel/stata_colon/).  Note that <b>stpm2cm</b>
    does a prediction for an individual with a particular covariate pattern
    (specified with the <b>at()</b> option).  You must also specify the age, sex and
    calendar year the prediction is for in the population mortality file.
<p>
<b><u>Options</u></b>
<p>
    <b>at(</b><i>varlist</i><b>)</b> gives the covariates values for the prediction. All
        covariates in the model must be specified. For example<b> at(age 60 sex</b>
        <b>1)</b>
<p>
    <b>mergby(</b><i>varlist</i><b>)</b> specifies the variables by which the file of general
        population survival probabilities is sorted. See strs
<p>
    <b><u>diaga</u></b><b>ge(</b><i>#</i><b>)</b> age of subject at diagnosis for prediction. Note that this
        must be specified even if age has been modelled as a categorical
        covariate.
<p>
    <b><u>diagy</u></b><b>ear(</b><i>#</i><b>)</b> year of diagnosis of subject.
<p>
    <b>sex(</b><i>#</i><b>)</b> coding for sex prediction is for. This needs to match that in the
        population mortality file.
<p>
    <b><u>atta</u></b><b>ge(</b><i>varname</i><b>)</b> specifies the variable containing attained age (i.e., age
        at the time of follow-up). This needs to match the variable in the
        population mortality file
<p>
    <b><u>atty</u></b><b>ear(</b><i>varname</i><b>)</b> specifies the variable containing attained calendar
        year. This needs to match the variable in the population mortality
        file
<p>
    <b><u>maxa</u></b><b>ge</b> maxium age in population mortality file
<p>
    <b><u>n</u></b><b>obs</b> specifies the number of observations (of time) to predict for
        (default 1000). Observations are evenly spread between the minimum
        and maximum value of follow-up time.
<p>
    <b>ci</b> calculate confidence intervals
<p>
    <b>maxt(</b><i>#</i><b>)</b> the maximum value of follow up time
<p>
    <b>stub(</b><i>stub</i><b>)</b> the stub name for calculation of the new variables. The
        following variables are created: <i>stub</i><b>_d</b> - crude probability of death
        due to disease, <i>stub</i><b>_o</b> - crude probability of death due to other
        causes, <i>stub</i><b>_all</b> - probability of death (all causes), <i>stub</i><b>_lambda</b> -
        excess mortality rate, <i>stub</i><b>_lambda</b> - expected mortality rate,
        <i>stub</i><b>_St_star</b> - Expected survival, <i>stub</i><b>_s_all</b> - overall survival.
<p>
    <b>tgen(</b><i>newvarname</i><b>)</b> name of variable for generated follow-up time.
<p>
    <b>mergegen(</b><i>varname # </i>...<b>)</b> values of other merge variables required for the
        population mortality file. This is used when there are additional
        variables in the population mortality file. For example, region or
        socio-economic group.
<p>
<p>
-------------------------------------------------------------------------------
<b><u>Example</u></b>
<p>
<p>
    <b>stpm2 agegrp2-agegrp4, scale(hazard) bhazard(rate) df(5) ///</b>
        <b>tvc(agegrp2-agegrp4) dftvc(3)</b>
    <b>stpm2cm using popmort, at(agegrp2 0 agegrp3 0 agegrp4 0) ///</b>
        <b>mergeby(_year sex _age) ///</b>
        <b>diagage(40) diagyear(1985) ///</b>
        <b>sex(1) stub(cm1) nobs(1000) ///</b>
        <b>tgen(cm1_t)</b>
<p>
<p>
<b><u>Author</u></b>
<p>
    Paul Lambert, University of Leicester, UK.  paul.lambert@leicester.ac.uk
<p>
<p>
<b><u>References</u></b>
<p>
Lambert PC, Dickman PW, Nelson CP, Royston P. Estimating the crude probability 
&gt; of
death due to cancer and other causes using relative survival models. <i>Statistics</i>
<i>&gt;  in Medicine</i>
2010;29:885-895.
<p>
<b><u>Also see</u></b>
<p>
    Online:  <b>[ST] stpm2 postestimation</b>; <b>[ST] stset</b>, stpm
</pre>