<pre>
-------------------------------------------------------------------------------
help for <b>shufflevar</b>
-------------------------------------------------------------------------------
<p>
<b><u>Randomly shuffle variables</u></b> 
<p>
        <b>shufflevar</b> <i>varlist</i>[,<b> Joint DROPold cluster</b>(<i>varname</i>)]
<p>
<p>
<b><u>Description</u></b> 
<p>
    <b>shufflevar</b> takes <i>varlist</i> and either jointly or for each variable shuffles
    <i>varlist</i> relative to the rest of the dataset. This means any association
    between <i>varlist</i> and the rest of the dataset will be random.  Much like 
    bootstrap or the Quadratic Assignment Procedure (QAP), one can build a
    distribution of results out of randomness to serve as a baseline against
    which to compare empirical results, especially for overall model-fit or
    clustering measures.
<p>
<b><u>Remarks</u></b> 
<p>
    The program is intended for situations where it is hard to model error
    formally, either because the parameter is exotic or because the
    application violates the parameter's assumptions. For instance, the
    algorithm has been used by Fernandez et. al. and Zuckerman to interpret
    network data, the author wrote this implementation for use in
    interpreting st frailty models with widely varying cluster sizes, and
    others have suggested using the metric for adjacency matrices in spatial
    analysis.
<p>
    Much like bsample, the <b>shufflevar</b> command is only really useful when
    worked into a forvalues loop or program that records the results of each
    iteration using postfile. See the example code below to see how to
    construct the loop.
<p>
    To avoid confusion with the actual data, the shuffled variables are
    renamed <i>varname</i>_shuffled.
<p>
    This command is an implementation of an algorithm used in two papers that
    used it to measure network issues:
<p>
    Fernandez, Roberto M., Emilio J. Castilla, and Paul Moore. 2000. "Social
    Capital at Work: Networks and Employment at a Phone Center." <i>American</i>
    <i>Journal of Sociology</i> 105:1288-1356.
<p>
    Zuckerman, Ezra W. 2005. "Typecasting and Generalism in Firm and Market:
    Career-Based Career Concentration in the Feature Film Industry,
    1935-1995." <i>Research in the Sociology of Organizations</i> 23:173-216.
<p>
<b><u>Options</u></b> 
 
    <b>joint</b> specifies that <i>varlist</i> will be keep their actual relations to one
        another even as they are shuffled relative to the rest of the
        variables.  If <b>joint</b> is omitted, each variable in the <i>varlist</i> will be
        shuffled separately.
<p>
    <b>dropold</b> specifies that the original sort order versions of <i>varlist</i> will
        be dropped.
<p>
    <b>cluster</b>(<i>varname</i>) specifies that shuffling will occur by <i>varname</i>.
<p>
<b><u>Examples</u></b>
<p>
    <b>. sysuse auto, clear</b>
    <b>. regress price weight</b>
    <b>. local obs_r2=`e(r2)'</b>
    <b>. tempname memhold</b>
    <b>. tempfile results</b>
    <b>. postfile `memhold' r2 using "`results'"</b>
    <b>. forvalues i=1/100 {</b>
    <b>.  shufflevar weight, cluster(foreign)</b>
    <b>.  quietly regress price weight_shuffled</b>
    <b>.  post `memhold' (`e(r2)')</b>
    <b>. </b>}
    <b>. postclose `memhold'</b>
    <b>. use "`results'", clear</b>
    <b>. sum r2</b>
    <b>. disp "The observed R^2 of " `obs_r2' " is "</b>
        <b>(`obs_r2'-`r(mean)')/`r(sd)' " sigmas out on the" _newline</b>
        <b>"distribution of shuffled R^2s."</b>
<p>
<p>
<b><u>Author</u></b>
<p>
    Gabriel Rossman, UCLA
    rossman@soc.ucla.edu
<p>
<b><u>Also see</u></b>
<p>
    On-line:  help for bsample, help for forvalues, help for postfile, help
             for program, help for permute
<p>
</pre>