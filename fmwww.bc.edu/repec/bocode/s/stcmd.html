<pre>
-------------------------------------------------------------------------------
help for <b>stcmd</b>, <b>inputst</b>, <b>outputst</b> and <b>outputstold</b>                (Roger Newson)
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Running the Stat/Transfer command from inside Stata</u></b>
<p>
        <b>stcmd</b> [ <i>filetype1</i> ] <i>infilename</i><b>.</b><i>ext1</i> [ <i>filetype2</i> ] <i>outfilename</i><b>.</b><i>ext2</i> [
                     <i>switches</i> ]
<p>
        <b>stcmd</b> <i>command_filename</i><b>.stcmd</b>
<p>
        <b>inputst</b> [ <i>filetype</i> ] <i>infilename</i><b>.</b><i>ext</i> [ <i>switches</i> ]
<p>
        <b>outputst</b> [ <i>filetype</i> ] <i>outfilename</i><b>.</b><i>ext</i> [ <i>switches</i> ]
<p>
        <b>outputstold</b> [ <i>filetype</i> ] <i>outfilename</i><b>.</b><i>ext</i> [ <i>switches</i> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>stcmd</b> calls the Stat/Transfer command <b>st</b> to convert the data file
    <i>infilename.ext1</i> to a new data file <i>outfilename.ext2</i>, or to obey the
    commands in the Stat/Transfer command file <i>command_filename</i><b>.stcmd</b>.
    <b>inputst</b> inputs into the memory a Stata-converted version of the data file
    <i>infilename.ext</i>, overwriting any existing dataset.  <b>outputst</b> outputs a
    converted version of the Stata dataset in memory to the data file
    <i>outfilename.ext</i>.  <b>outputstold</b> is an alternative version of <b>outputst</b>, for
    use if the user's version of Stat/Transfer is not advanced enough to read
    datasets in the format of the user's version of Stata.  File types are
    determined by <i>filetype</i>, <i>filetype1</i> and/or <i>filetype2</i>, if present, and by
    Stat/Transfer from the extensions <i>ext</i>, <i>ext1</i> and/or <i>ext2</i> otherwise.  File
    names containing spaces must be given in quotes.  <b>stcmd</b>, <b>inputst</b> or
    <b>outputst</b> output a running commentary on the transfer process (including
    the Stat/Transfer command to be submitted) to the Stata log or Results
    window, unless the user uses the <b>quietly</b> prefix.
<p>
<p>
<b><u>Switches for use with  </u></b><b><u>stcmd</u></b><b><u>, </u></b><b><u>inputst</u></b><b><u>, </u></b><b><u>outputst</u></b><b><u> and </u></b><b><u>outputstold</u></b>
<p>
    These are prefixed by <b>/</b> under Windows and by <b>-</b> under Unix.  A list of
    these switches can be found in the Stat/Transfer manual for the user's
    installation.  The Windows switches for Version 9 of Stat/Transfer are as
    follows:
<p>
    <b>/o-</b> specifies that Stat/Transfer will not optimize the output data set to
        be as small as possible (as Stat/Transfer does by default).
<p>
    <b>/oc</b> specifies that Stat/Transfer will optimize the output data set to be
        as small as possible, and automatically drop constant or missing
        variables.
<p>
    <b>/od</b> specifies that Stat/Transfer will optimize the output data set to be
        as small as possible, but produce double precision variables where
        appropriate.
<p>
    <b>/ocd</b> specifies that Stat/Transfer will optimize the output data set to be
        as small as possible, and automatically drop constant or missing
        variables, but produce double precision variables where appropriate.
<p>
    <b>/q</b> specifies that Stat/Transfer will execute quietly, producing no
        messages, with the exception of error messages and warnings that a
        file is about to be overwritten.
<p>
    <b>/r</b>[<i>page</i><b>!</b>]<i>coor</i> specifies a worksheet range, limited to page <i>page</i> and
        coordinates specified by <i>coor</i>, in an input worksheet file.  The
        coordinates specify a top left and bottom right cell in the
        worksheet.  For instance, <b>/r2!b5:e75</b> specifies that the data are on
        page 2 of the input file, between the top left cell <b>b5</b> and the bottom
        right cell <b>e75</b>.
<p>
    <b>/s</b> will turn on messages and leave the Stat/Transfer window open until
        the return key is pressed.  This may be useful if Stat/Transfer
        appears not to be working.
<p>
    <b>/t</b><i>tablename</i> is used in order to specify a table (or worksheet) within a
        data source containing multiple tables (or worksheets).
<p>
    <b>/v</b><i>version_number</i> specifies that Stat/Transfer will write the output
        dataset in the version of the appropriate format specified by the
        <i>version_number</i>, which should be a positive integer.  If this switch
        is not specified, then Stat/Transfer writes the output dataset in the
        latest version of the appropriate format.
<p>
    <b>/y</b> specifies that <i>outfilename</i><b>.</b><i>ext</i> will be overwritten, if it already
        exists.  (If <b>/y</b> is not specified, then Stat/Transfer consults the
        user before overwriting files.)
<p>
<p>
<b><u>Remarks</u></b>
<p>
    Stat/Transfer can be installed on Microsoft Windows, MacOS, and some Unix
    platforms.  It is available from Stata Corporation and developed by
    Circle Systems.
<p>
    <b>inputst</b>, <b>outputst</b> and <b>outputstold</b> call <b>stcmd</b>, which in turn calls the
    Stat/Transfer <b>st</b> command.  For a list of file types and standard
    extensions used by Stat/Transfer, see the Stat/Transfer manual or on-line
    help.
<p>
    <b>inputst</b>, <b>outputst</b> and <b>outputstold</b> all use temporary Stata datafiles to
    pass the data in the memory to and from Stat/Transfer.  These temporary
    Stata datafiles are automatically deleted when <b>inputst</b> and <b>outputst</b>
    finish execution.  In the case of <b>outputstold</b>, the temporary Stata
    datafile is written using <b>saveold</b>, and will be in the format of an
    earlier Stata version, which may be recognized by out-of-date versions of
    Stat/Transfer.  If the user does not use the <b>quietly</b> prefix, then <b>inputst</b>
    and <b>outputst</b> give a running commentary to the user on the creation of
    these temporary Stata datafiles, and on their use as input or output by
    Stata and Stat/Transfer.  This is done in order to inform the user of the
    state of progress of the transfer, in case the transfer is not completed
    successfully.  The <b>/s</b> or <b>-s</b> switch mentioned above, may also be useful,
    if Stat/Transfer does not appear to be working.
<p>
<a name="stcmd_technote"></a><b><u>Technical notes</u></b>
<p>
    The path for the Stat/Transfer <b>st</b> command varies from system to system.
    <b>stcmd</b> assumes that this path is simply <b>st</b>, unless the global macro
    <b>StatTransfer_path</b> is evaluated, in which case <b>stcmd</b> assumes that the path
    is equal to the value of that macro.  Therefore, if the directory
    containing Stat/Transfer is on the user's default path, then the user
    need not set a value for the global macro <b>StatTransfer_path</b>.  Otherwise,
    the user should set a value for the global macro <b>StatTransfer_path</b>.  This
    is probably done most easily by inserting a line into the user's profile
    do-file to initialize this global macro every time the user starts Stata.
    For instance, under Windows, if the user's profile do-file contains the
    line
<p>
        <b>. global StatTransfer_path `"c:\Program Files\StatTransfer10\st.exe"'</b>
<p>
    and the <b>st</b> program of Stat/Transfer, in the user's system, has path
    <b>"c:\Program Files\StatTransfer10\st.exe"</b>, then <b>stcmd</b> will find the <b>st</b>
    command of Stat/Transfer correctly on that path.
<p>
    Note that, when the user upgrades to a new version of Stat/Transfer, the
    upgrade creates a new directory, containing the new version of <b>st.exe</b>.
    Therefore, when Stat/Transfer is upgraded, either the user's default
    directory search path should be altered, or the line of code in the
    user's profile do-file setting the global macro <b>StatTransfer_path</b> should
    be altered.
<p>
    The user may also find, after a Stat/Transfer upgrade, that the <b>stcmd</b>
    package has been downgraded to Stata Version 6.  This is because the
    Stat/Transfer installation program may install the Stata Version 6
    version of Stat/Transfer in the user's <b>PERSONAL</b> directory (see help for 
    <b>adopath</b>).  This installation in the <b>PERSONAL</b> directory typically contains
    the Stata Version 6 files <b>stcmd.ado</b>, <b>inputst.ado</b>, <b>outputst.ado</b>,
    <b>stcmd.hlp</b>, <b>inputst.hlp</b>, and <b>outputst.hlp</b>.  If the user has a higher
    version of Stat/Transfer installed in a directory in a position after
    PERSONAL of the <b>adopath</b>, then the user should probably remove these files
    from the <b>PERSONAL</b> directory.  After the user has done this, Stata will
    use the higher version of <b>stcmd</b>.
<p>
<p>
<b><u>Examples</u></b>
<p>
        <b>. inputst spss.sav</b>
<p>
        <b>. outputst mydata.Rdata /y</b>
<p>
        <b>. inputst mydata.Rdata /o-</b>
<p>
        <b>. stcmd R mydata.Rdata hisdata.csv /y</b>
        <b>. insheet using hisdata.csv, comma clear</b>
<p>
        <b>. stcmd mystcom.stcmd</b>
<p>
<p>
<b><u>Author</u></b>
<p>
    Roger Newson, National Heart and Lung Institute, Imperial College London,
    UK.
    Email: r.newson@imperial.ac.uk
<p>
<p>
<b><u>Also see</u></b>
<p>
     Manual: <b>[P] macro</b>, <b>[P] sysdir</b>, <b>[D] save</b>,
             <b>[GSW] C.3 Executing commands every time Stata is started</b>,
             <b>[GSM] C.1 Executing commands every time Stata is started</b>,
             <b>[GSU] C.1 Executing commands every time Stata is started</b>
    On-line: help for <b>macro</b>, <b>adopath</b>, <b>sysdir</b>, <b>saveold</b>, <b>profile</b>, <b>profilew</b>, 
             <b>profilem</b>, <b>profileu</b>
      Other: <b>Stat/Transfer .PDF Manual</b> if installed
</pre>