<pre>
help <b>strgroup</b>
-------------------------------------------------------------------------------
<b><u>Title</u></b>
<p>
    <b>strgroup</b> -- Match strings based on their Levenshtein edit distance.
<p>
<p>
<b><u>Syntax</u></b>
<p>
    <b>strgroup</b> <i>varname</i> [if] [in] , <b><u>gen</u></b><b>erate(</b><i>newvarname</i><b>)</b> <b><u>thresh</u></b><b>old(</b><i>#</i><b>)</b> [<b>first</b>
    <b><u>norm</u></b><b>alize([shorter|longer|none])</b> <b>noclean</b> <b>force</b>]
<p>
  <b>by</b> is allowed; see help by.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>strgroup</b> matches similar strings together. This can be useful when
    merging data that contain typos. For example, "widgets" will not merge
    with "widgetts" because the strings are not identical.  <b>strgroup</b> provides
    a way to match strings in an objective and automated manner. It employs
    the following algorithm:
<p>
        1. Calculate the Levenshtein edit distance between all pairwise
              combinations of strings in <i>varname</i>.
<p>
        2. Normalize the edit distance as specified by
              <b>normalize([shorter|longer|none])</b>. The default is to divide the
              edit distance by the length of the shorter string.
<p>
        3. Match a string pair if their normalized edit distance is less than
              or equal to the user-specified threshold.
<p>
        4. If string A is matched to string B and string B is matched to
              string C, then match A to C.
<p>
        5. Assign each group of matches a unique number and store this result
              in <i>newvarname</i>.
<p>
    For example, the Levenshtein edit distance between "widgets" and
    "widgetts" is 1.  The lengths of these two strings are 7 and 8,
    respectively. Assuming <b>normalize(shorter)</b>, they are matched by <b>strgroup</b>
    if 1/7 &lt;= threshold.
<p>
    <b>strgroup</b> is case sensitive.
<p>
    See levenshtein for an explanation of the Levenshtein edit distance.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>generate(</b><i>newvarname</i><b>)</b> specifies the name of a new variable to store the
        results.
<p>
    <b>threshold(</b><i>#</i><b>)</b> sets the threshold level for matching.
<p>
    <b>first</b> instructs <b>strgroup</b> to only match strings that share the same first
        character.  This typically reduces the amount of time required for
        <b>strgroup</b> to run by several orders of magnitude, at the cost of
        perhaps incorrectly not matching strings.  For example, "widgets" and
        "qidgets" will not be matched if you specify <b>first</b> because they do
        not begin with the same character.
<p>
    <b>normalize([shorter|longer|none])</b> is used to define the normalization of
        the Levenshtein edit distance. With <b>shorter</b> all edit distances are
        divided by the length of the shorter string in the pair; this is also
        the default. <b>longer</b> divides the edit distance by the length of the
        longer string. <b>none</b> specifies that no normalization is needed.
<p>
    <b>noclean</b> instructs <b>strgroup</b> not to trim leading and trailing blanks when
        comparing string pairs. Trimming can reduce run time.
<p>
    <b>force</b> forces <b>strgroup</b> to run even if when comparing more than 10,000
        observations. This may take a while and may cause memory problems if
        your dataset is too large.
<p>
<p>
<b><u>Notes</u></b>
<p>
    <b>strgroup</b> does not match missing strings.
<p>
    As explained above, <b>strgroup</b> calculates the Levenshtein edit distance
    between all pairwise combinations of strings in <i>varname</i>.  Let N be the
    number of observations being compared.  Then the amount of memory and
    number of calculations required by <b>strgroup</b> is proportional to
    (N)(N-1)/2, an expression that increases with the square of N.  Thus,
    large datasets need to be divided into subsets in order to facilitate
    calculations.  The <b>first</b> option automates this by subsetting strings
    according to their first characters.  Alternatively, the user can run
    <b>strgroup</b> on subsets of the data by using the <b>if</b>, <b>in</b> and/or <b>by</b> options.
<p>
    <b>strgroup</b> is implemented as a plugin in order to minimize memory
    requirements and to maximize speed.  Unfortunately, plugins are specific
    to the hardware architecture and software framework of your computer,
    i.e., plugins are not cross-platform.  Define a platform by two
    characteristics: machine type and operating system.  Stata stores these
    characteristics in <b>c(machine_type)</b> and <b>c(os)</b>, respectively. <b>strgroup</b>
    supports the following platforms at this time:
<p>
         <b>Machine type</b>                   <b>Operating system</b>
         PC                             Windows
         PC (64-bit x86-64)             Windows
         PC (64-bit x86-64)             Unix
         Macintosh                      MacOSX
         Macintosh (Intel 64-bit)       MacOSX
<p>
<p>
<b><u>Example</u></b>
<p>
    Merge two datasets together and identify potential matches that didn't
    merge.
<p>
       <b>. </b>sysuse auto, clear
       <b>. </b>tempfile t
       <b>. </b>keep make price
       <b>. </b>replace make = make + "a" in 5
       <b>. </b>replace make = "gibberish" in 10
       <b>. </b>save "`t'"
       <b>. </b>sysuse auto, clear
       <b>. </b>keep make
       <b>. </b>merge make using "`t'", sort
       <b>. </b>list if _merge!=3
       <b>. </b>strgroup make if _merge!=3, gen(group) threshold(0.25)
       <b>. </b>list if _merge!=3
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
    The code used to calculate the Levenshtein edit distance is based on a
    Python extension written by David Necas (Yeti).  His code is publicly
    available at
    http://code.google.com/p/pylevenshtein/source/browse/trunk/Levenshtein.c.
<p>
    Thanks to Dimitriy Masterov for compiling the 64-bit Windows version of
    the plugin.
<p>
<p>
<b><u>Author</u></b>
<p>
    Julian Reif, University of Chicago
<p>
    jreif@uchicago.edu
<p>
<p>
<b><u>Also see</u></b>
<p>
    levenshtein, regexm
<p>
</pre>