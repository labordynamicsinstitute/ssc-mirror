<pre>
<b>help stpm2illd</b> 
                             also see:  <b>illdprep  stpm2  stpm2_postestimation  </b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>stpm2illd</b> -- Illness death model post-estimation tool to estimate
                   transition hazards and probabilities after stpm2
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>stpm2illd</b> <i>newvarlist</i> [<b>,</b> <i>options</i>]
<p>
    <i>options</i>                             Description
    -------------------------------------------------------------------------
    <b>trans1</b><i>...</i><b>trans3</b>                      covariates specified by listed
                                          varname(s) be set to # when
                                          predicting hazards for each
                                          transition.
    <b>obs</b>                                  specifies the number of observations
                                          (of time) to predict for.
    <b>ci</b>                                   calculates confidence intervals for
                                          probabilities.
    <b>mint</b>                                 the minimum value of follow up time.
    <b>maxt</b>                                 the maximum value of follow up time.
    <b><u>time</u></b><b>name</b>                             name of new time variable generated
                                          in command.
    <b><u>haz</u></b><b>ard</b>                               predicts hazard function for each
                                          transition.
    <b>hazname</b>                              name given for transition hazards if
                                          <b><u>haz</u></b><b>ard</b> specified.
    <b>combine</b>                              combines the probabilities of being
                                          in states 3 and 4 to give overall
                                          probability of death.
    -------------------------------------------------------------------------
<p>
<b><u>Description</u></b>
<p>
    <b>stpm2illd</b> can be used after <b>stpm2</b> to obtain transition hazards and
    probabilities in an illness death model.
<p>
<p>
Four names should be specified in the <i>newvarlist</i>. The new variables names shoul
&gt; d be specified in the order according to the diagram below. 
So for example, if we write "alive ill dead illdead" in the newvarlist then the
&gt;  probability of being in each state as a function of time will be stored as
<b>prob_</b><i>alive</i>, <b>prob_</b><i>ill</i>, <b>prob_</b><i>dead</i> and <b>prob_</b><i>illdead</i>. 
<p>
                                      -------------                            
&gt; -------------
                                      |           |                            
&gt; |           |
                                      |   Alive   |         Transition 2       
&gt; |    Ill    |
                                      |           |--------------&gt;-------------
&gt; |           |
                                      |  State 1  |                            
&gt; |  State 2  |
                                      |           |                            
&gt; |           |
                                      -------------                            
&gt; -------------
                                            |                                  
&gt;       |                         
                                            |                                  
&gt;       |                        
                                            |                                  
&gt;       |                            
                               Transition 1 |                                  
&gt;       | Transition 3
                                            |                                  
&gt;       |                          
                                            |                                  
&gt;       |                      
                                            |                                  
&gt;       |                       
                                            |                                  
&gt;       |                          
                                      -------------                            
&gt; -------------
                                      |           |                            
&gt; |           |
                                      |   Dead    |                            
&gt; |   Dead    |
                                      |           |                            
&gt; |           |
                                      |  State 3  |                            
&gt; |  State 4  |
                                      |           |                            
&gt; |           |
                                      -------------                            
&gt; -------------          
                 
<b><u>Options</u></b>
<p>
    Note: in the table below, <i>vn</i> is an abbreviation for <i>varname</i>.
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>trans1(</b><i>vn # </i>[<i>vn # </i>..]<b>)</b><i>..</i><b>trans3(</b><i>vn # </i>[<i>vn # </i>..]<b>)</b> requests that the
        covariates specified by the listed <i>varname(s)</i> be set to # when
        predicting the hazards for each transition.  It is complusory to
        specify all of these. The transition numbers correspond to those in
        the diagram above.  Therefore, <b>trans1</b> relates to the transition from
        alive to dead, <b>trans2</b> relates to the transition from alive to ill,
        and <b>trans3</b> relates to the transition from ill to dead.
<p>
    <b>obs(</b><i>integer</i><b>)</b> specifies the number of observations (of time) to predict
        for (default 1000). Observations are evenly spread between the
        minimum and maximum value of follow-up time.
<p>
    <b>ci</b> calculates a 95% confidence interval for the probabilities and stores
        the confidence limits in <b>prob_</b><i>newvar</i><b>_lci</b> and <b>prob_</b><i>newvar</i><b>_uci</b>.
<p>
    <b>mint(</b><i>#</i><b>)</b> the minimum value of follow up time. The default is set as the
        minimum event time from <b>stset</b>.
<p>
    <b>maxt(</b><i>#</i><b>)</b> the maximum value of follow up time. The default is set as the
        maximum event time from <b>stset</b>.
<p>
    <b>timename(</b><i>varname</i><b>)</b> is the name given to time variable used for predictions
        (default {\it \_newt}).  Note that this is the variable for time that
        needs to be used when plotting curves for the transition hazards and
        probabiltiies.
<p>
    <b>hazard</b> predicts the hazard function for each transition.
<p>
    <b>hazname(</b><i>varlist</i><b>)</b> if the <b>hazard</b> is specified then this allows the user to
        specify the names for the transition hazards.  These will then be
        stored in variables called <b>h_</b><i>var</i>. If nothing is specified then the
        default names are <b>h_trans1</b>, <b>h_trans2</b> and <b>h_trans3</b>.
<p>
    <b>combine</b> allows the user to combine the probabilities of being in states 3
        and 4 to give the overall probability of death.  If this option is
        specified then the user only needs to give three names in <i>newvarlist</i>.
        The last name given in the list should correspond to the combined
        probability of states 3 and 4. So for example, if we write "alive ill
        dead" in the newvarlist then the probability of being in each state
        as a function of time will be stored as <b>prob_</b><i>alive</i>, <b>prob_</b><i>ill</i> and
        <b>prob_</b><i>dead</i>.
<p>
<b><u>Example</u></b>
<p>
<p>
The Rotterdam breast cancer data used in this example is taken from the book "F
&gt; lexible Parametric Survival Analysis Using Stata: Beyond the Cox Model"
by Patrick Royston and Paul C. Lambert (2011). The data can be downloaded from 
&gt; http://www.stata-press.com/data/fpsaus.html. 
The data contains information on 2,982 with primary breast cancer. Both time to
&gt;  relapse and time to death are recorded.
<p>
<p>
Open the data and run the <b>illdprep</b> command to set the data up in the format req
&gt; uired for illness death models using <b>stpm2</b> and <b>stpm2illd</b>. 
The ID variable in the data set is called <b>pid</b>. There are two event indicators; 
<b>&gt; rfi</b> indicates whether a patient has suffered a relapse, and <b>osi</b>
indicates whether a patient has died or not. There are also two event time vari
&gt; ables that correspond with these; <b>rf</b> and <b>os</b>.
<p>
        use rott2, clear
        illdprep, id(pid) statevar(rfi osi) statetime(rf os)
<p>
<p>
The command has expanded the data so that each individual has up to 3 rows of d
&gt; ata. As described above, six new variables have been generated. We can now <b>st</b>
<b>&gt; set</b> 
the data using the newly generated <b>status</b> variable as the failure indicator. Th
&gt; e newly generated <b>start</b> and <b>stop</b> times need to be included in the
<b>stset</b> command to indicate when an individual enters and leaves a transition.
<p>
        stset stop, enter(start) failure(status==1) scale(12) exit(time
            start+(10*12))
<p>
<p>
We can now run <b>stpm2</b> including each of the three transitions in the model.
<p>
        stpm2 trans1 trans2 trans3, scale(hazard) rcsbaseoff nocons dftvc(3)
            tvc(trans1 trans2 trans3) initstrata(trans)
<p>
<p>
Note that by including the three transition variables <b>trans1</b>, <b>trans2</b> and <b>trans3</b>
&gt; ) as both main effects and
time-dependent effects (using <b>tvc</b> option) we have fitted a stratified model wit
&gt; h three separate baselines, one for each transition. 
For this reason we have used the <b>rcsbaseoff</b> option together with the <b>nocons</b> opt
&gt; ion which excludes the baseline hazard from the model. 
<p>
<p>
The <b>stpm2illd</b> postestimation command can now be run to obtain the probability o
&gt; f being in each of the four states, 
as demonstrated in the above diagram, as a function of time. By specifying the 
<b>&gt; hazard</b> option the command will also
predict the hazard function for each of the three transitions.
<p>
        stpm2illd alive ill death illdeath, trans1(trans1 1) trans2(trans2 1)
            trans3(trans3 1) hazard
<p>
<p>
The variables <b>prob_alive</b>, <b>prob_ill</b>, <b>prob_death</b> and <b>prob_illdeath</b> have been gene
&gt; rated for the probabilities 
of being in each of the four states. As we have specified the <b>hazard</b> option the
&gt;  variables <b>h_trans1</b>, <b>h_trans2</b> and 
<b>h_trans3</b> have also been generated.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  <b>[ST] stpm2</b> <b>[ST] stpm2_postestimation</b>;
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
</pre>