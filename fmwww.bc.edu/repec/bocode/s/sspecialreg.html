<pre>
-------------------------------------------------------------------------------
help for <b>sspecialreg</b>
-------------------------------------------------------------------------------
<p>
<b><u>Estimate binary choice model with discrete endogenous regressor via special reg</u></b>
<b><u>&gt; ressor method</u></b>
<p>
        <b>sspecialreg</b><i> depvar specreg</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] , <b>endog(</b><i>varlist</i>)
              <b>iv(</b><i>varlist</i>) [ <b>exog(</b><i>varlist</i>) <b>hetero</b> <b>hetv(</b><i>varlist</i>) <b>kdens</b> <b>trim(</b><i>real</i>)
              <b>winsor</b> <b>bs</b> <b>bsreps(</b><i>integer</i>) ]
<p>
<b><u>Description</u></b>
<p>
<b>sspecialreg</b> estimates a binary choice model that includes one or more
endogenous regressors using Lewbel's (2000) special regressor method. This
assumes that the model includes a particular 'special regressor', V, that is
exogenous and appears additively in the model.  It must be continuously
distributed with a large support. A special regressor with thick tails (greater
kurtosis) will be more useful as a special regressor. To invoke <b>sspecialreg</b>,
you specify the <i>depvar</i> and the <i>specreg</i>, as well as the required lists of
endogenous regressors and excluded instruments.
<p>
This method has advantages over the linear probability model (estimated with OL
&gt; S or IV),
maximum likelihood and control function methods. The latter, as implemented by 
&gt; Stata's 
<b>ivprobit</b>, do not handle discrete or limited endogenous regressors. Unlike the m
&gt; aximum
likelihood approach, the special regressor method allows for heteroskedasticity
&gt;  of unknown
form in the model's error process.
<p>
A particular case, the simple special regressor method, is implemented by <b>sspec</b>
<b>&gt; ialreg</b>.
Two forms are defined, depending on assumptions made about the distribution of 
&gt; the special
regressor V. In the first form, only the mean of V is assumed to be related to 
&gt; other 
covariates. In the second, heteroskedastic form, higher moments of V can depend
&gt;  in 
arbitrary, unknown ways on the other covariates.
<p>
Two forms of the density estimator are available in <b>sspecialreg</b>: one based on a
&gt;  
standard kernel density approach, making use of Jann's <b>kdens</b>, and the other
based on the 'sorted data density' approach of Lewbel and Schennach (2007).
<p>
Just as in a <b>probit</b> or <b>ivprobit</b> model, the quantities of interest are not
the estimated coefficients, but rather the marginal effects, which are derived 
&gt; from
the average index function proposed by Lewbel, Dong and Yang (2012). Estimates 
&gt; of the
precision of the marginal effects are derived by bootstrapping, and <b>sspecialreg</b>
has options to specify that bootstrap standard errors should be computed.
<p>
<b><u>Options</u></b>
<p>
<b>endog</b>(<i>varlist</i>) is a required option. It provides the names of one or more
    endogenous regressors.
<p>
<b>iv</b>(<i>varlist</i>) is a required option. It provides the names of one or more excluded
    instruments. To satisfy the order condition for identification, there must
    be at least as many variables listed as there are in the endog() option.
<p>
<b>exog</b>(<i>varlist</i>) may be used to provide the names of one or more included
    exogenous variables.
<p>
<b>hetero</b> specifies that the heteroskedastic form of the model should be
    estimated.
<p>
<b>hetv</b>(<i>varlist</i>) may be used to provide the names of one or more variables assumed
    to play a role in the heteroskedasticity of the special regressor V. These
    might include, for instance, squares and cross products of some of the
    exogenous regressors in the model.
<p>
<b>kdens</b> specifies that the kernel density estimator should be used, rather than
    the default sorted data density estimator. The <b>kdens</b> package from SSC must
    be installed.
<p>
<b>trim(</b><i>real</i>) specifies that to ensure adequate support, the data are to be
    trimmed by a specified percentage, such as 2.5.
<p>
<b>winsor</b> specifies that the data are to be winsorized at the points specified by
    the trim() option. You must specify both trim() and winsor.
<p>
<b>bs</b> specifies that bootstrap standard errors are to be computed for the marginal
    effects.
<p>
<b>bsreps</b>(<i>integer</i>) specifies the number of bootstrap replications to be computed.
    The default value is 10. Computation of a large number of bootstrap
    replications may be very time-consuming.
<p>
<b><u>Saved results</u></b>
<p>
<b>sspecialreg</b> saves the estimated coefficients and VCE of the instrumental
variables regression if the <i>bs</i> option is not specified. If the <i>bs</i> option is
specified, the estimated marginal effects and their VCE are saved in e(b) and
e(V), respectively, allowing the use of postestimation commands such as <b>test</b>
and <b>lincom</b>.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . ssc install bcuse
<p>
        . bcuse sspecialreg_sample
<p>
        . sspecialreg D3 ageh, trim(5) kdens exog(whiteh married)
            endog(homeowner) iv(fstamp welfare)
<p>
        . sspecialreg D3 ageh, trim(5) bs exog(whiteh married) endog(homeowner)
            iv(fstamp welfare)
<p>
 
<b><u>Acknowledgements</u></b>
<p>
Development of this routine is based on code written by Yingying Dong. Implemen
&gt; tation of
a much faster version of the sorted data density estimator was provided by Ben 
&gt; Jann. 
Jann's <b>kdens</b> routine is used to provide the kernel density estimates. Thanks to
&gt;  
participants in the 2012 German Stata Users Meetings and the 2012 Stata Confere
&gt; nce for 
their helpful comments.
<p>
<b><u>References</u></b>
<p>
Baum, CF, Dong, Y., Lewbel, A., Yang, T., 2012. Binary Choice Models with
    Endogenous Regressors. http://repec.org/san2012/baum.san2012.pdf.
<p>
Dong, Y. and Lewbel, A., 2012. A Simple Estimator for Binary Choice Models with
    Endogenous Regressors. Forthcoming, Econometric Reviews.
    http://fmwww.bc.edu/EC-P/wp604.pdf.
<p>
Lewbel, A., 2000. Semiparametric Qualitative Response Model Estimation with
    Unknown Heteroskedasticity or Instrumental Variables.  Journal of
    Econometrics, 97, 145-177.
<p>
Lewbel, A., 2012.  An Overview of the Special Regressor Method.
    http://fmwww.bc.edu/EC-P/wp810.pdf.
<p>
Lewbel, A., Dong, Y., Yang, T., 2012. Comparing features of Convenient
    Estimators for Binary Choice Models With Endogenous Regressors.
    Forthcoming, Canadian Journal of Economics. Working paper version available
    from http://fmwww.bc.edu/EC-P/wp789.pdf.
<p>
Lewbel, A. and Schennach, S., 2007. A Simple Ordered Data Estimator for Inverse
    Density Weighted Functions. Journal of Econometrics, 186, 189-211.
<p>
<p>
<b><u>Citation</u></b>
<p>
<b>sspecialreg</b> is not an official Stata command. It is a free contribution to the
research community, like a paper. Please cite it as such:
<p>
    Baum, CF, 2012.  sspecialreg: Stata module to estimate binary choice
        model with discrete endogenous regressor via special regressor
        method.  http://ideas.repec.org/c/boc/bocode/s457546.html
<p>
<b><u>Author</u></b>
<p>
Christopher F Baum, Boston College, USA
baum@bc.edu
<p>
<p>
</pre>