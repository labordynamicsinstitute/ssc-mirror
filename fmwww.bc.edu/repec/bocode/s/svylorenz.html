<pre>
-------------------------------------------------------------------------------
help for <b>svylorenz</b>                          Stephen P. Jenkins (September 2006)
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Quantile group shares, cumulative shares (Lorenz ordinates), generalized Lorenz</u></b>
<b><u>&gt;  ordinates, and Gini coefficient</u></b>
<p>
        <b>svylorenz</b> <i>varname</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>n</u></b><b>gp(</b><i>#</i><b>)</b> <b><u>qgp</u></b><b>(</b><i>newvarname</i><b>)</b>
               <b><u>sub</u></b><b>pop(</b><i>varname</i><b>)</b> <b><u>pv</u></b><b>ar(</b><i>newvarname</i><b>)</b> <b><u>lv</u></b><b>ar(</b><i>newvarname</i><b>)</b>
               <b><u>selv</u></b><b>ar(</b><i>newvarname</i><b>)</b> <b><u>glv</u></b><b>ar(</b><i>newvarname</i><b>)</b> <b><u>seglv</u></b><b>ar(</b><i>newvarname</i><b>)</b>
               <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> ]
<p>
    Data must be <b>svyset</b> before using this command; see svyset.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>svylorenz</b> computes distribution-free variance estimates for quantile
    group shares of total <i>varname</i>, cumulative quantile group shares
    (cumulation is in ascending order of <i>varname</i>), generalized Lorenz
    ordinates, and the Gini coefficient. The Lorenz curve, <i>L</i>(<i>p</i>), is the graph
    of cumulative quantile group shares at each cumulative population share <i>p</i>
    = <i>F</i>(<i>varname</i>). The generalized Lorenz curve <i>GL</i>(<i>p</i>) is the Lorenz curve
    scaled up at each <i>p</i> by mean <i>varname</i>.  The Gini coefficient, <i>G</i>, is twice
    the area between the Lorenz curve and the line of perfect inequality, and
    ranges between 0 and 1. Higher values indicate greater inequality. Note
    that the Gini coefficient is calculated using all valid observations; it
    is <i>not</i> derived by approximation from the income shares.
<p>
    Beach and Davidson (1983) provide formulae for variance estimation of
    shares, cumulative shares and generalized Lorenz ordinates, but for
    unweighted data with no complex survey design features. Beach and Kaliski
    (1986) extend these results to the case with sample weights that are
    fixed and non-stochastic. Kovacevic and Binder (1997), using the
    estimating equations approach, provide formulae for variance estimation
    of cumulative shares allowing for probability weights and for complex
    survey design more generally.  They also provide formulae for variance
    estimation of <i>G</i>. All these linearization methods rely on asymptotic
    approximations, and small sample properties are not well-known.
<p>
    <b>svylorenz</b> derives variance estimates using the methods of Kovacevic and
    Binder (1997) for cumulative shares and <i>G</i>, and derives estimates for
    quantile group shares from those for cumulative shares using a result of
    Beach and Kaliski (1986). Variance estimates for generalized Lorenz
    ordinates are derived by an application of the estimating equations
    approach of Binder and Kovacevic (1995) and Kovacevic and Binder (1997).
    For an alternative derivation, see Zheng (2002).
<p>
    The point estimates computed by <b>svylorenz</b> are the same as the estimates
    that can be calculated using <b>sumdist</b>, <b>ineqdeco</b> and <b>ineqdec0</b>.  By default,
    however, <b>svylorenz</b> uses observations with non-negative values of <i>varname</i>,
    <b>ineqdeco</b> uses observations with strictly positive values of <i>varname</i>, and
    <b>ineqdec0</b> and <b>sumdist</b> use observations with negative, zero, or positive
    values of <i>varname</i>.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>ngp(</b><i>#</i><b>)</b> specifies the number of quantile groups, and must be an integer
        between 1 and 100. The default is 10.
<p>
    <b>qgp(</b><i>newvarname</i><b>)</b> creates a new variable in the current data set that
        identifies the quantile group membership of each observation.
<p>
    <b>subpop(</b><i>varname</i><b>)</b> specifies that estimates be computed for the single
        subpopulation defined by the observations for which <i>varname</i>!=0.
        Typically, <i>varname</i>=1 defines the subpopulation and <i>varname</i>=0
        indicates observations not belonging to the subpopulation.  For
        observations whose subpopulation status is uncertain, <i>varname</i> should
        be set to missing.
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, as a percentage, for confidence
        intervals.  The default is level(95) or as set by set level; see [U]
        20.6 Specifying the width of confidence intervals.
<p>
    The following options may be used to graph Lorenz curves and generalized
        Lorenz curves (see also <b>glcurve</b> which is a more general program for
        this task):
<p>
    <b>pvar(</b><i>newvarname</i><b>)</b> creates a new variable in the current data set
        containing the values of <i>p_j</i> = <i>F</i>(<i>x_j</i>) corresponding to each <i>j</i> for
        each quantile group <i>j</i> = 1,...,<i>J</i>, plus 0.
<p>
    <b>lvar(</b><i>newvarname</i><b>)</b> creates a new variable in the current data set
        containing the cumulative shares <i>L</i>(<i>p_j</i>), plus <i>L</i>(0) = 0.
<p>
    <b>selvar(</b><i>newvarname</i><b>)</b> creates a new variable in the current data set
        containing the estimated standard errors of the cumulative shares.
<p>
    <b>glvar(</b><i>newvarname</i><b>)</b> creates a new variable in the current data set
        containing the generalized Lorenz ordinates <i>GL</i>(<i>p_j</i>), plus <i>GL</i>(0) = 0.
<p>
    <b>seglvar(</b><i>newvarname</i><b>)</b> creates a new variable in the current data set
        containing the estimated standard errors of the generalized Lorenz
        ordinates.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . svyset psu_name [pw = wgt], strata(strata_name)
<p>
        . svylorenz income
<p>
        . svylorenz cYbhcg, ngp(20) pvar(p) lvar(l) selvar(sel)
<p>
        . twoway (connect p p) (connect l p, sort)
<p>
    Further examples are provided in the downloadable materials accompanying
    the presentation by Jenkins (2006).
<p>
<p>
<b><u>Saved Results</u></b>
<p>
    Scalars:
<p>
    <b>e(gini)</b>        <i>G</i>
    <b>e(se_gini)</b>     asymptotic SE of <i>G</i>
    <b>e(mean)</b>        mean of <i>varname</i>
    <b>e(se_mean)</b>     asymptotic SE of the mean
    <b>e(total)</b>       total of <i>varname</i>
    <b>e(ngps)</b>        number of quantile groups
    <b>e(q</b><i>j</i><b>)</b>          quantile <i>j</i>, where <i>j</i> = 1, ..., <i>ngps</i>
    <b>e(sh</b><i>j</i><b>)</b>         share of <i>varname</i> held by each quantile group <i>j</i>
    <b>e(se_sh</b><i>j</i><b>)</b>      asymptotic SE of each group <i>j</i>'s share of <i>varname</i>
    <b>e(cush</b><i>j</i><b>)</b>       cumulative share of <i>varname</i> held by each quantile group <i>j</i>
    <b>e(se_cush</b><i>j</i><b>)</b>    asymptotic SE of each group <i>j</i>'s cumulative share of
                 <i>varname</i>
    <b>e(gl</b><i>j</i><b>)</b>         generalized Lorenz ordinate of <i>varname</i> held by each
                 quantile group <i>j</i>
    <b>e(se_gl</b><i>j</i><b>)</b>      asymptotic SE of each group <i>j</i>'s generalized Lorenz
                 ordinate of <i>varname</i>
<p>
    Matrices:
<p>
    <b>e(quantiles)</b>   1 x (<i>ngps</i>-1) vector of quantiles
    <b>e(shares)</b>      1 x (<i>ngps</i>) vector of quantile group shares
    <b>e(V_cush)</b>      (<i>ngps</i>-1) x (<i>ngps</i>-1) variance-covariance matrix of
                 cumulative shares
    <b>e(V_gl)</b>        (<i>ngps</i>) x (<i>ngps</i>) variance-covariance matrix of generalized
                 Lorenz ordinates
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
    Philippe Van Kerm provided helpful comments on early drafts of this
        program.
<p>
<p>
<b><u>References</u></b>
<p>
    Beach, C.M. and R. Davidson. 1983. Distribution-free statistical
        inference with Lorenz curves and income shares. <i>Review of Economic</i>
        <i>Studies</i> 50: 723-725.
<p>
    Beach, C.M. and S.F. Kaliski. 1986. Lorenz curve inference with sample
        weights:  an application to the distribution of unemployment
        experience. <i>Applied Statistics</i> 35(1): 38-45.
<p>
    Binder, D.A. and M.S. Kovacevic. 1995. Estimating some measures of income
        inequality from survey data: an application of the estimating
        equations approach.<i>  Survey Methodology</i> 21: 137-145.
<p>
    Jenkins, S.P. 2006. Estimation and interpretation of measures of
        inequality, poverty, and social welfare using Stata. Presentation at
        North American Stata Users' Group Meetings 2006, Boston MA.  
        http://econpapers.repec.org/paper/bocasug06/16.htm.
<p>
    Kovaevic, M.S. and D.A. Binder. 1997. Variance estimation for measures of
        income inequality and polarization. <i>Journal of Official Statistics</i>
        13(1): 41-58. Full text downloadable from 
        http://www.jos.nu/Articles/abstract.asp?article=13141.
<p>
    Zheng, B. 2002. Testing Lorenz curves with non-simple random samples.
        <i>Econometrica</i> 70: 1235-1243.
<p>
<p>
<b><u>Author</u></b>
<p>
    Stephen P. Jenkins, Institute for Social and Economic Research,
    University of Essex. Email: stephenj@essex.ac.uk
<p>
<p>
<b><u>Also see</u></b>
<p>
    svy, svyset, xtile
<p>
</pre>