<pre>
-------------------------------------------------------------------------------
help for <b>profhap</b>
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Calculates profile likelihood confidence intervals for results using </u></b><b><u>hapipf</u></b>
<p>
        <b>profhap</b> [<b>if</b><i> exp</i>] , <b>or(</b><i>string</i><b>)</b> <b>ipf(</b><i>string</i><b>)</b> [ <b>by(</b><i>string</i><b>)</b> <b>acc(</b><i>real</i><b>)</b>
                           <b><u>lev</u></b><b>el(</b><i>real</i><b>)</b> <b>hapacc(</b><i>real</i><b>)</b> <b>savegraph</b> ]
<p>
<p>
<b><u>Description</u></b>
<p>
This function calculates the confidence intervals for the odds ratios estimated
by the command <b>hapipf</b>. It uses the profile likelihood by estimating the
log-likelihood of a series of constrained log-linear models.
<p>
This command will only estimate the confidence interval for a single OR and can
be used to estimate the odds ratio in a stratified analysis.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>or(</b><i>string</i><b>)</b> first the case control variable is specified then two
    haplotypes/alleles. The first haplotype/allele indicates the unexposed
    group and the other haplotype/allele is the exposed group e.g. <b>or(D 1 2)</b>
    specifies that the case control variable is D and that the allele 1
    represents the unexposed group and allele 2 the exposed.
<p>
<b>ipf(</b><i>string</i><b>)</b> specifies the log-linear model in the constrained table.  It
    requires special syntax of the form <b>l1*l2+l3</b>. <b>l1*l2</b> allows all the
    interactions between the first two loci and locus 3 is independent of them.
    This syntax is used in most books on Log-linear modelling, "-" terms and
    brackets are not allowed.
<p>
<b>by(</b><i>string</i><b>)</b> specifies a stratifying variable.
<p>
<b>acc(</b><i>real</i><b>)</b> specifies the accuracy of the estimated upper and lower bounds of the
    confidence interval.
<p>
<b><u>lev</u></b><b>el(</b><i>real</i><b>)</b> specifies the significance level of the confidence interval.
<p>
<b>hapacc(</b><i>real</i><b>)</b> specifies the convergence threshold of both hapipf and ipf.
<p>
<b>savegraph</b> specifies that the profile graph is saved to file <b>profile.gph</b>
<p>
<p>
<b><u>Examples</u></b>
<p>
<b>Single-point Odds Ratio (OR)</b>
<p>
The simplest example is where there is one genetic marker (with alleles 1 and
2) and a binary outcome<b> D</b>.  The model specified in the <b>ipf()</b> option must not
include the interaction of interest i.e. whether marker <b>l1</b> is associated with <b>D</b>
because this term is fitting using constraint files. Only one OR confidence
interval is calculated using profile likelihood and "reference" and "exposed"
alleles are specified as<b> 1</b> and <b>2</b>, respectively, in the<b> or()</b> option.
<p>
. profhap a1 a2, ipf(l1+D) or(D 1 2)
<p>
<b>Stratified Estimation of an OR</b>
<p>
The parameter of interest is the OR comparing haplotype 2.2 to haplotype 1.1.
Where the OR is now the pooled estimate over each level of the categorical
variable <b>S</b>.  Again the haplotype-outcome interaction <b>l1*l2*D</b> is not included in
the <b>ipf()</b> model.
<p>
. profhap a1 a2 b1 b2, ipf(S*D+l1*l2*S) or(D 1.1 2.2) by(S) acc(0.0001)
<p>
This can be extended to 3 markers (comparing haplotype 2.2.2 to haplotype
1.1.1).
<p>
. profhap a1 a2 b1 b2 c1 c2, ipf(S*D+l1*l2*l3*S) or(D 1.1.1 2.2.2) by(S) acc(0.
&gt; 0001)
<p>
<b><u>Author</u></b>
<p>
Adrian Mander, Glaxo Smithkline, Harlow, UK.
<p>
Email adrian.p.mander@gsk.com
<p>
<b><u>Also see</u></b>
<p>
Related commands
<p>
HELP FILES      Installation status     SSC installation links          Descrip
&gt; tion
<p>
hapipf          (required)              (ssc install hapipf)    Haplotype Frequ
&gt; ency estimation
qhapipf         (if installed)          (ssc install qhapipf)   Quantitative Tr
&gt; ait
swblock         (if installed)          (ssc install swblock)   Haplotype block
&gt; s
hapblock                (if installed)          (ssc install hapblock)  Haploty
&gt; pe blocks
gipf            (if installed)          (ssc install gipf)      Graphical Log-l
&gt; inear Representation 
<p>
<p>
</pre>