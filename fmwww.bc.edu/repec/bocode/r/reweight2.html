<pre>
<b>help reweight2</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>reweight2</b> -- Reweight data to user-defined control totals
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b><u>reweight2</u></b> <b>using</b> <i>filename</i> <b>,</b> <b>newweight</b>(<i>newvar</i>) [<b>oldweight</b>(<i>varname</i>)]
<p>
    <i>options</i>               Description
    -------------------------------------------------------------------------
    Main
      <b>oldweight(</b><i>varname</i><b>)</b>  name of original weighting variable if it exists,
                            otherwise constant is created
      <b>newweight(</b><i>newvar</i><b>)</b>   name of new variable generated by <b>reweight2</b>
                            containing new weights
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>reweight2</b> calculates new weights for data to match control totals
    specified in <i>filename</i>, where <i>filename</i> is a text (ASCII) file that can be
    read in by <b>insheet</b> (i.e. the format of the file must be specified
    otherwise .raw will be assumed). The first column in <i>filename</i> must
    contain names of variables in the original dataset and the second column
    must contain the control totals that you want the weighted data to sum to
    with <b>newweight</b>. Note that <b>reweight2</b> does not deal with categorical
    variables, these must be converted to dummy variables for each category
    using<b> tab, gen</b>, for example.
<p>
    <b>reweight2</b> uses the algoroithm defined in Gomulka (1992) to minimize the
    difference between <b>oldweight</b> and <b>newweight</b> subject to the constraints
    specified in <i>filename</i> being satisfied.
<p>
<p>
<b><u>Options</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>oldweight</b>(<i>varname</i>) specifies the existing weight variable in the data. If
        <b>oldweight</b> is not specified, <b>reweight2</b> creates a constant and
        minimises the distance between this and <b>newweight</b>.
<p>
    <b>newweight</b>(<i>newvar</i>) specifies the name of the new weighting variable you
        want <b>reweight2</b> to create.
<p>
<b><u>Example</u></b>
<p>
    Consider the following example from Creedy(2003).  <b>id</b> is the
    identification number of each unit included in the survey, <b>x1</b>, <b>x2</b>, <b>x3</b> and
    <b>x4</b> are variables included in the survey, <b>weight</b> is the vector of original
    survey weights:
<p>
<p>
<b>. use http://fmwww.bc.edu/repec/bocode/r/reweight.dta, clear</b>
<p>
<b>. list</b>
<p>
     +---------------------------------+
     | id   x1   x2   x3   x4   weight |
     |---------------------------------|
  1. |  1    1    1    0    0        3 |
  2. |  2    0    1    0    0        3 |
  3. |  3    1    0    2    0        5 |
  4. |  4    0    0    6    1        4 |
  5. |  5    1    0    4    1        2 |
     |---------------------------------|
  6. |  6    1    1    0    0        5 |
  7. |  7    1    0    5    0        5 |
  8. |  8    0    0    6    1        4 |
  9. |  9    0    1    0    0        3 |
 10. | 10    0    0    3    1        3 |
     |---------------------------------|
 11. | 11    1    0    2    0        5 |
 12. | 12    1    1    0    1        4 |
 13. | 13    1    0    3    1        4 |
 14. | 14    1    0    4    0        3 |
 15. | 15    0    0    5    0        5 |
     |---------------------------------|
 16. | 16    0    1    0    1        3 |
 17. | 17    1    0    2    1        4 |
 18. | 18    0    0    6    0        5 |
 19. | 19    1    0    4    1        4 |
 20. | 20    0    1    0    0        3 |
     +---------------------------------+
<p>
<p>
    The vector of survey weights produces the following aggregate totals:
<p>
<p>
<b>. tabstat x1 x2 x3 x4 [w = weight], s(su)</b>
<b>(analytic weights assumed)</b>
<p>
<p>
<p>
   stats |        x1        x2        x3        x4
---------+----------------------------------------
     sum |        44        24       213        32
--------------------------------------------------
<p>
    Now, let us assume that external information on these variables are
    available, and that the true totals are:
<p>
<p>
   stats |        x1        x2        x3        x4
---------+----------------------------------------
     sum |        50        20       230        35
--------------------------------------------------
<p>
    In this case, <b>reweight2</b> can be used to adjust the survey weights so that
    the new survey totals match the true totals:
<p>
    To do this, first create a spreadsheet file with these control totals and
    save as, say,<b> example.csv:</b>
<p>
<b>        x1      50</b>
<b>        x2      20</b>
<b>        x3      230</b>
<b>        x4      35</b>
<p>
    Then run the following command:
<p>
<p>
<b>. reweight2 using example.csv, oldweight(weight) newweight(newweight)</b>
<p>
<p>
<b>. tabstat x1 x2 x3 x4 [w = newweight], s(su)</b>
<b>(analytic weights assumed)</b>
<p>
<p>
<p>
   stats |        x1        x2        x3        x4
---------+----------------------------------------
     sum |        50        20       230        35
--------------------------------------------------
<p>
<p>
<b>. list weight newweight </b>
<p>
     +--------------------+
     | weight   newweight |
     |--------------------|
  1. |      3   3.043628  |
  2. |      3    1.70822  |
  3. |      5   4.451928  |
  4. |      4   4.323331  |
  5. |      2   2.835381  |
     |--------------------|
  6. |      5   5.072713  |
  7. |      5   7.048317  |
  8. |      4   4.323331  |
  9. |      3    1.70822  |
 10. |      3   2.048059  |
     |--------------------|
 11. |      5   4.451928  |
 12. |      4   4.756732  |
 13. |      4   4.865517  |
 14. |      3   3.628476  |
 15. |      5    3.95583  |
     |--------------------|
 16. |      3   2.002268  |
 17. |      4   4.174617  |
 18. |      5   4.610522  |
 19. |      4   5.670763  |
 20. |      3    1.70822  |
     +--------------------+
<p>
<p>
<b><u>Also see</u></b>
<p>
      Help:  <b>[R] tabulate</b> <b>[D] insheet</b>
<p>
<b><u>Thanks for citing reweight2 as follows</u></b>
<p>
    Browne, J. (2012),<i> Reweight2: Stata command to reweight data to</i>
    <i>user-defined control totals</i>.
<p>
<b><u>Disclaimer</u></b>
<p>
    THIS SOFTWARE IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
    EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
    WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE
    ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.
    SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY
    SERVICING, REPAIR OR CORRECTION.
<p>
    IN NO EVENT WILL THE COPYRIGHT HOLDERS OR THEIR EMPLOYERS, OR ANY OTHER PAR
&gt; TY WHO MAY MODIFY AND/OR REDISTRIBUTE THIS SOFTWARE, BE LIABLE TO YOU FOR DAM
&gt; AGES, INCLUDING ANY GENERAL, SPECIAL,
    INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USER'S ABILITY TO US
&gt; E THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDER
&gt; ED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
    PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EV
&gt; EN IF SUCH HOLDER OR OTHER PARTY ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
<p>
<p>
<b><u>References</u></b>
<p>
    Gomulka, J. (1992), ‘Grossing-up revisited’, in R. Hancock and H.
    Sutherland (eds), <i>Microsimulation Models for Public Policy Analysis: New</i>
    <i>Frontiers</i>, STICERD Occasional Paper, London: London School of Economics.
<p>
    Creedy, J. (2003),<i> Survey Reweighting for Tax Microsimulation Modelling</i>,
        Treasury Working Paper Series 03/17, New Zealand Treasury.
<p>
<b><u>Author</u></b>
<p>
    James Browne, Institute for Fiscal Studies, London, UK. If you observe
    any problems mailto:james_browne@ifs.org.uk
<p>
<p>
<p>
<p>
<p>
</pre>