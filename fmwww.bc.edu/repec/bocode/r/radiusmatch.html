<pre>
<b>help radiusmatch</b> 
-------------------------------------------------------------------------------
<p>
<b><u>Syntax</u></b>
    <b><u>rad</u></b><b>iusmatch</b> <i>treatvar</i> [<i>indepvars</i>] [<i>if</i>] [<i>in</i>] <b>,</b> <b><u>out</u></b><b>come(</b><i>varlist</i><b>)</b> [<i>options</i>]
<p>
    <i>options</i>                 Description
    -------------------------------------------------------------------------
    Specification
      <b><u>out</u></b><b>come(</b><i>varlist</i><b>)</b>      dependent variables
      <b><u>p</u></b><b>score(</b><i>varname</i><b>)</b>       user-supplied propensity score
      <b><u>mahal</u></b><b>anobis(</b><i>varlist</i><b>)</b>  additional matching variables
      <b>ate</b>                   estimate ATENT and ATE as well (Note: doubles
                              computation time)
<p>
    Parameters for matching
      <b><u>cqu</u></b><b>antile(</b><i>#</i><b>)</b>          defines the maximum distance as the <i>#</i> percentile
                              of the distance distribution; default is
                              <b>cquantile(90)</b>
      <b><u>cpe</u></b><b>rcent(</b><i>#</i><b>)</b>           defines the radius in %-distance to largest
                              one-to-one match; default is <b>cpercent(300)</b>
      <b><u>score</u></b><b>weight(</b><i>#</i><b>)</b>        values larger than 1 give more weight to the
                              propensity score in the mahalanobis metric;
                              default is <b>scoreweight(5)</b>
 
      <b><u>mwe</u></b><b>ight(</b><i>#</i><b>)</b>            maximum share of weight in % of one observation
                              compared to total weight; default is no
                              restriction on maximum weight <b>mweight(100)</b>
      <b>logit</b>                 uses logit instead of probit to estimate the
                              propensity score
      <b>index</b>                 uses linear index instead of probability as
                              propensity score
      <b><u>noc</u></b><b>ommon</b>              common support is not enforced
      <b>bc(</b><i>#</i><b>)</b>                 0 for no bias correction, 1 for linear bias
                              correction, 2 for linear and logit bias
                              correction; default is <b>bc(1)</b>
<p>
    Bootstrap and standard errors
      <b>knn</b>                   uses nearest-neighbor matching algorithm to
                              estimate the conditional variance
      <b><u>boot</u></b><b>strap(</b><i>#</i><b>)</b>          number of bootstrap replications; default is
                              <b>bootstrap(0)</b>
      <b>bfile(</b>[<i>"</i>]<i>filename</i>[<i>"</i>]<b>)</b> saves the results of all bootstrap replications
<p>
    Computation
      <b>boost</b>                 avoids loops when estimating the distances and
                              increases computation speed.
<p>
    -------------------------------------------------------------------------
    <i>indepvars</i> may contain factor variables; see fvvarlist.  Weights are not
      allowed.
<p>
<b><u>Description</u></b>
<p>
    <b>radiusmatch</b> estimates average treatment effects (ATET, ATENT, ATE) of
    <i>treatvar</i> for a set of outcomes variables <i>outcome</i> using radius matching.
    <i>indepvars</i> are used to compute the propensity score. <b>radiusmatch</b> is a
    one-to-many calliper matching algorithm as, for example, discussed by
    Rosenbaum and Rubin (1985) and used by Dehejia and Wahba (1999, 2002).
    Calliper or radius matching uses all comparison observations within a
    predefined distance around the propensity score or based on the
    Mahalanobis distance of the respective treated.  This allows for higher
    precision than fixed nearest neighbour matching in regions in which many
    similar comparison observations are available. Also, it may lead to a
    smaller bias in regions where similar controls are sparse. In other
    words, instead of fixing M globally, M is determined in the local
    neighbourhood of each treated observation.
<p>
    This estimator was proposed by Lechner, Miquel, and Wunsch (2011)
    combines the features of calliper matching with additional predictors and
    linear or nonlinear regression adjustment. After the first step of
    distance-weighted calliper matching with predictors, this estimator uses
    the weights obtained from matching in a weighted linear or non-linear
    regression in order to remove any bias due to mismatches.
    For a detailed description of the estimator and information on the
    adequate choice of the matching parameters please refer to Huber, Lechner
    &amp; Steinmayr (2012).
    Syntax and output of <b>radiusmatch</b> are oriented towards the popular
    <b>psmatch2</b> command by Barbara Sianesi and Edwin Leuven. The variables
    created by <b>radiusmatch</b> can be used with the <b>pstest</b> and <b>psgraph</b> commands
    to test for covariate imbalance and to graph the distribution of the
    propensity score. Both commands can be downloaded from the SSC archive.
    Note that <b>radiusmatch</b> requires the installation of the <b>tknz</b> command: .
    ssc install tknz, replace
 
    <b>radiusmatch</b> creates a number of variables:
        <b>_treated</b> equals 0 for control observations and 1 for treatment
        observations.
        <b>_untreated</b> is 1 - _treated
        <b>_support</b> equals 1 if the observation is on the common support and 0
        otherwise.
        <b>_pscore</b> is the estimated propensity score or a copy of the one
        provided by pscore().
        <b>_weightt</b> holds the estimated weights for the ATET
        <b>_weightut</b> holds the estimated weights for the ATENT
<p>
<b><u>Options</u></b>
<p>
        +---------------+
    ----+ Specification +----------------------------------------------------
<p>
    <b>outcome(</b><i>varlist</i><b>)</b> specifies the outcome variables.
<p>
    <b>pscore(</b><i>varname</i><b>)</b> is optional and specifies a user-supplied propensity
        score.
<p>
    <b>mahalanobis(</b><i>varlist</i><b>)</b> Additional covariates to be controlled for in
        addition to the propensity score. Under the default NULL, propensity
        score matching is performed. If not NULL, matching on the Mahalanobis
        distance defined by the propensity score and the additional
        covariates is performed.
<p>
    <b>ate</b> specifies that <b>radiusmatch</b> estimates the "ATET" (average treatment
        effect on the treated), the "ATENT" (average treatment effect on the
        nontreated), and the "ATE" (average treatment effect). If <b>ate</b> is not
        specified, only the ATET is estimated. Note that this option
        approximately doubles computation time.
<p>
        +-------------------------+
    ----+ Parameters for matching +------------------------------------------
    <b>cpercent(</b><i>#</i><b>)</b> is the multiplier of the maximum distance in pair matching
        (or a particular quantile, see <b>cquantile</b>) which defines the radius.
        Default is 300, i.e., the radius is equal to 300 percent of the
        maximum distance in pair matching (or a particular quantile).
<p>
    <b>cquantile(</b><i>#</i><b>)</b> is the quantile of the distances in pair matching to be used
        for the definition of the radius. Default is 90, i.e. the 0.9th
        quantile of the distances in pair matching are used. If <b>cquantile</b> is
        smaller or equal to 0 or greater or equal 1, the maximum distance is
        chosen. The size of the radius obtainedis a combination of <b>cquantile</b>
        and <b>cpercent</b>. E.g., <b>cpercent</b>=300 and <b>cquantile</b>=90 defines the radius
        as three times the 0.9th quantile of differences in pair matching.
<p>
    <b>mweight(</b><i>#</i><b>)</b> is the maximum relative weight an observation may receive
        based on inverse probability weighting by the propensity score. E.g.,
        if mweight=5, the maximum weight is 5 percent (compared to the joint
        weight of all other observations).  The default is 100 (=100
        percent), i.e., no restriction on the weight.
<p>
    <b>bc(</b><i>#</i><b>)</b> 0 for no bias correction, 1 for linear bias correction, 2 for
        linear and logit bias correction. In either case, the outcome is
        regressed on the propensity score, its square, and the variables used
        to compute the Mahalanobis distance within the counterfactual
        treatment state.
<p>
    <b>nocommon</b> specifies that no common support is imposed. The default is that
        common support is imposed). If support is imposed and <b>ate</b> is not
        specified, treated observations with propensity scores larger than
        the maximum propensity score among the nontreated are discarded. If
        <b>ate</b> is specified and common support is imposed, treated observations
        with propensity scores larger than the second largest propensity
        score among the nontreated are discarded from the sample. If
        commonsup=1 and estimand="ATENT", nontreated observations with
        propensity scores smaller than the minimum propensity score among the
        treated are discarded. For estimand="ATE"common support is imposed
        for both the treated and the nontreated.
<p>
    <b>logit</b> specifies that logit is used for propensity score estimation
        instead of probit (probit is default).
<p>
    <b>index</b> specifies that matching is based on the index of the probit/logit
        estimation instead of the propensity score (matching on the
        propensity score is default).
<p>
    <b>scoreweight(</b><i>#</i><b>)</b> specifies the weight of the p-score in Mahalanobis
        distance matching.  Default is 5, which implies that the p-score gets
        five times the weight of any of the additional covariates considered
        in Mahalanobis distance matching. A weight of 1 implies equal
        weighting of the p-score and additional covariates.
<p>
        +-------------------------------+
    ----+ Bootstrap and standard errors +------------------------------------
<p>
    <b>bootstrap(</b><i>#</i><b>)</b> specifies that the bootstrap should be used for inference.
        The number in paranthesis specifies the number of bootstrap
        replications. For any positive integer of reps, bootstrap standard
        errors and p-values arecomputed based on the specified number of
        bootstrap replications (recommended). p-values are computed by
        bootstrapping the t-statistic.In the case that the probit cannot be
        estimated in one bootstrap replication, the pscore estimated in the
        original sample is used. Note that in principle <b>radiusmatch</b> can also
        be used with the Stata bootstrap command.  However, bootstrapping the
        t-statistic is not possible in this case.
<p>
    <b>bfile(</b><i>filename</i><b>)</b> saves the estimated parameters and analytical standard
        errors of every bootstrap replication in "filename.dta". The first
        row contains the estimates in the original sample.
<p>
    <b>knn</b> specifies that a nearest neighbor matching algorithm is used for
        conditional variance estimation of the outcome given the matching
        weight under counterfactual treatment, which is required for
        estimating the standard error.  Default is local constant kernel
        regression (based on the Epanechnikov kernel and the rule of thumb
        for bandwidth choice).
<p>
        +-------------+
    ----+ Computation +------------------------------------------------------
<p>
    <b>boost</b> specifies that matrix operations should be used instead of loops
        wherever possible.  This reduces computational time by roughly one
        third but may cause problems in datasets with many observations (at
        my computer &gt; 30.000) when the operating system refuses to provide
        the memory needed.
<p>
<b><u>Examples:  radius matching without bootstrap</u></b>
<p>
    Radius matching based on the propensity score
        <b>. sysuse nlsw88</b>
        <b>. radiusmatch union age i.race married hours tenure south smsa,</b>
            <b>out(wage)</b>
<p>
    Radius matching based on Mahalanobis distance
        <b>. radiusmatch union age i.race married hours tenure south smsa,</b>
            <b>out(wage) mahal(age) ate</b>
<p>
    Radius matching with user supplied propensity score
        <b>. probit union age i.race married hours tenure south smsa</b>
        <b>. predict double pscore, index</b>
        <b>. radiusmatch union, pscore(pscore) out(wage) index ate</b>
<p>
<p>
<b><u>Examples:  radius matching with bootstrap</u></b>
<p>
    Radius matching based on Mahalanobis distance with bootstrapped inference
        <b>. radiusmatch union age i.race married hours tenure south smsa,</b>
            <b>out(wage) mahal(age) boot(99) ate</b>
<p>
-------------------------------------------------------------------------------
<p>
<b><u>Saved results</u></b>
<p>
    <b>radiusmatch</b> saves the following in <b>r()</b>:
<p>
    Matrices       
      <b>r(atet)</b>             vector of ATETs for all outcomes
      <b>r(atent)</b>            vector of ATENTs for all outcomes (if requested)
      <b>r(ate)</b>              vector of ATEs for all outcomes (if requested)
      <b>r(seatet)</b>           vector of asymptotic s.e. for ATET for all outcomes
      <b>r(seatent)</b>          vector of asymptotic s.e. for ATENT for all
                            outcomes (if requested)
      <b>r(seate)</b>            vector of asymptotic s.e. for ATE for all outcomes
                            (if requested)
      <b>r(y0_atet)</b>          vector of Y0 (average outcome of comparison group)
                            for ATET for all outcomes
      <b>r(y0_atent)</b>         vector of Y0 for ATENT for all outcomes (if
                            requested)
      <b>r(y0_ate)</b>           vector of Y0 for ATE for all outcomes (if
                            requested)
      <b>r(y1_atet)</b>          vector of Y1 (average outcome of treated group) for
                            ATET for all outcomes
      <b>r(y1_atent)</b>         vector of Y1 for ATENT for all outcomes (if
                            requested)
      <b>r(y1_ate)</b>           vector of Y1 for ATE for all outcomes (if
                            requested)
      <b>r(b_seatet)</b>         vector of bootstrap s.e. for ATET for all outcomes
      <b>r(b_seatent)</b>        vector of bootstrap s.e. for ATENT for all outcomes
                            (if requested)
      <b>r(b_seate)</b>          vector of bootstrap s.e. for ATE for all outcomes
                            (if requested)
      <b>r(b_patet)</b>          vector of bootstrap p-values for ATET for all
                            outcomes
      <b>r(b_patent)</b>         vector of bootstrap p-values for ATENT for all
                            outcomes (if requested)
      <b>r(b_pate)</b>           vector of bootstrap p-values for ATE for all
                            outcomes (if requested)
<p>
-------------------------------------------------------------------------------
<p>
<b><u>Thanks for citing radiusmatch as follows</u></b>
<p>
    Huber, M., M. Lechner, and A. Steinmayr. (2012). "Radius matching on the
        propensity score with bias adjustment: finite sample behaviour,
        tuning parameters and software implementation". University of St.
        Gallen, School of Economics and Political Science, Economics Working
        Paper Series No. 1226
<p>
<b><u>Disclaimer</u></b>
<p>
    THIS SOFTWARE IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
        EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
        WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
        THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS
        WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
        ALL NECESSARY SERVICING, REPAIR OR CORRECTION.  IN NO EVENT WILL THE
        COPYRIGHT HOLDERS OR THEIR EMPLOYERS, OR ANY OTHER PARTY WHO MAY
        MODIFY AND/OR REDISTRIBUTE THIS SOFTWARE, BE LIABLE TO YOU FOR
        DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL
        DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM
        (INCLUDING BUT NOT LIMITEDTO LOSS OF DATA OR DATA BEING RENDERED
        INACCURATE OR LOSSES SUSTAINED BY YOU ORTHIRD PARTIES OR A FAILURE OF
        THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),EVEN IF SUCH HOLDER
        OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
<p>
 <b><u>Further reading</u></b>
<p>
    Dehejia, R. H., and S. Wahba (1999): "Causal Effects in Non-experimental
        Studies: Reevaluating the Evaluation of Training Programmes", <i>Journal</i>
        <i>of the American Statistical Association</i>, 94, 1053-1062.
<p>
    Dehejia, R. H., and S. Wahba (2002): "Propensity Score- Matching Methods
        for Nonexperimental Causal Studies", <i>Review of Economics and</i>
        <i>Statistics</i>, 84, 151-161.
<p>
    Huber, M., M. Lechner and C. Wunsch (2012): "The performance of
        estimators based on the propensity score", forthcoming in the <i>Journal</i>
        <i>of Econometrics</i>.
<p>
    Lechner, M., R. Miquel and C. Wunsch (2011): "Long-Run Effects of Public
        Sector Sponsored Training in West Germany", <i>Journal of the European</i>
        <i>Economic Association</i>, 9, 742-784.
<p>
    Rosenbaum, P. R., and D. B. Rubin (1985): "Constructing a Control Group
        Using Multivariate Matched Sampling Methods that Incorporate the
        Propensity Score", <i>The American Statistician</i>, 39, 33-38.
<p>
<b><u>Authors</u></b>
<p>
    Martin Huber, University of St. Gallen.
<p>
    Michael Lechner, University of St. Gallen.
<p>
    Andreas Steinmayr, University of St. Gallen. If you observe any problems
        or if you have any comments or suggestions please contact
        andreas.steinmayr@unisg.ch.
<p>
</pre>