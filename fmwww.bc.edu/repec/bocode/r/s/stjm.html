<pre>
<b><u>Title</u></b>
<p>
    <b>stjm</b> -- Joint modelling of longitudinal and survival data
<p>
<p>
<a name="syntax"></a><b><u>Syntax</u></b>
<p>
        <b>stjm</b> <i>longdepvar</i> [<i>varlist</i>] [<i>if</i>] [<i>in</i>] <b>,</b> <b><u>p</u></b><b>anel(</b><i>varname</i><b>)</b>
            <b><u>survm</u></b><b>odel(</b><i>survsubmodel</i><b>)</b> [<i>options</i>]
<p>
    <i>options</i>                        Description
    -------------------------------------------------------------------------
      <b><u>p</u></b><b>anel(</b><i>varname</i><b>)</b>               panel identification variable
      <b><u>survm</u></b><b>odel(</b><i>survsubmodel</i><b>)</b>      survival submodel
<p>
    Longitudinal sub-model
      <b>ffp(</b><i>numlist</i><b>)</b>                 fixed powers of time
      <b>rfp(</b><i>numlist</i><b>)</b>                 fixed and random powers of time
      <b>frcs(</b><i>#</i><b>)</b>                      degrees of freedom for fixed splines of
                                     time
      <b>rrcs(</b><i>#</i><b>)</b>                      degrees of freedom for random splines of
                                     time
      <b><u>timeinterac</u></b><b>tion(</b><i>varlist</i><b>)</b>     covariates to interact with fixed time
                                     variables
      <b><u>cov</u></b><b>ariance(</b><i>vartype</i><b>)</b>          variance-covariance structure of the
                                     random effects
<p>
    Survival sub-model
      <b><u>survc</u></b><b>ov(</b><i>varlist</i><b>)</b>             fixed baseline covariates to be included
                                     in the survival submodel
      <b>df(</b><i>#</i><b>)</b>                        degrees of freedom for baseline hazard
                                     function
      <b>knots(</b><i>numlist</i><b>)</b>               knot locations for baseline hazard
                                     function
      <b><u>noorth</u></b><b>og</b>                     do not use orthogonal transformation of
                                     spline variables
<p>
    Association
      <b><u>noc</u></b><b>urrent</b>                    association not based on the current value
                                     of longitudinal response
      <b><u>derivassoc</u></b><b>iation</b>             association based on the first derivative
                                     (slope) of the longitudinal submodel
      <b><u>intassoc</u></b><b>iation</b>               allow association to be based on the
                                     random intercept
      <b><u>assoc</u></b><b>iation(</b><i>numlist</i><b>)</b>         allow association to be based on the
                                     random coefficient of a time variable
      <b><u>assoccov</u></b><b>ariates(</b><i>varlist</i><b>)</b>     adjust the association parameter(s) by
                                     covariates
      <b><u>nocoef</u></b><b>ficient</b>                do not include fixed coefficient when
                                     using <b>intassociation</b> or <b>association()</b>
<p>
    Maximisation
      <b>gh(</b><i>#</i><b>)</b>                        number of Gauss-Hermite quadrature points
      <b>gk(</b><i>#</i><b>)</b>                        number of Gauss-Kronrod quadrature points
      <b>gl(</b><i>#</i><b>)</b>                        number of Gauss-Legendre quadrature points
      <b>adaptit(</b><i>#</i><b>)</b>                   the number of adaptive Gauss-Hermite
                                     quadrature iterations; default is 5
      <b><u>noshowa</u></b><b>dapt</b>                  suppress display of adaptive quadrature
                                     sub-iterations
      <b>atol(</b><i>#</i><b>)</b>                      tolerance for the log-likelihood under the
                                     adaptive quadrature sub-iterations,
                                     default is 1.0E-05
      <b>nonadapt</b>                     use non-adaptive Gauss-Hermite quadrature
      <b>fulldata</b>                     use all data in survival component
                                     maximisation, see details
      <b><u>nulla</u></b><b>ssoc</b>                    sets the initial values for association
                                     parameters to be zero
      <b>noxtem</b>                       suppresses the default <b>emonly</b> option used
                                     in the <b>[XT] xtmixed</b> call for initial
                                     values
      <i>maximize_options</i>             control the maximization process; seldom
                                     used
<p>
    Reporting
      <b><u>showinit</u></b><b>ial</b>                  display output from initial value model
                                     fits
      <b><u>var</u></b><b>iance</b>                     show random-effects parameter estimates as
                                     variances-covariances
      <b><u>showc</u></b><b>ons</b>                     list constraints in output
      <b><u>keepc</u></b><b>ons</b>                     do not drop constraints used in ml routine
      <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>                     set confidence level; default is <b>level(95)</b>
<p>
<a name="survsubmodel"></a>    <i>survsubmodel</i>                   Description
    -------------------------------------------------------------------------
      <b><u>e</u></b><b>xponential</b>                  exponential survival submodel
      <b><u>w</u></b><b>eibull</b>                      Weibull survival submodel
      <b><u>g</u></b><b>ompertz</b>                     Gompertz survival submodel
      <b>fpm</b>                          flexible parametric survival submodel
      <b><u>weibw</u></b><b>eib</b>                     Mixture Weibull-Weibull survival submodel
      <b><u>weibe</u></b><b>xp</b>                      Mixture Weibull-exponential survival
                                     submodel
    -------------------------------------------------------------------------
<p>
<a name="vartype"></a>    <i>vartype</i>                        Description
    -------------------------------------------------------------------------
      <b><u>ind</u></b><b>ependent</b>                  one variance parameter per random effect,
                                     all covariances zero
      <b><u>ex</u></b><b>changeable</b>                 equal variances for random effects, and
                                     one common pairwise covariance
      <b><u>id</u></b><b>entity</b>                     equal variances for random effects, all
                                     covariances zero; the default for factor
                                     variables
      <b><u>un</u></b><b>structured</b>                 all variances and covariances distinctly
                                     estimated; the default
    -------------------------------------------------------------------------
<p>
    <i>longdepvar</i> specifies the longitudinal continuous response variable.
    You must <b>stset</b> your data before using <b>stjm</b>; see <b>[ST] stset</b>.
    See <b>stjm postestimation</b> for features available after estimation.
<p>
<a name="description"></a><b><u>Description</u></b>
<p>
    <b>stjm</b> fits shared parameter joint models for longitudinal and survival
    data using maximum likelihood. A single continuous longitudinal response
    and a single survival outcome are allowed. A linear mixed effects model
    is used for the longitudinal submodel, which lets time be modelled using
    fixed and/or random fractional polynomials or resticted cubic splines.
    Six choices are currently available for the survival submodel, including
    the exponential, Weibull, Gompertz, 2-component mixture Weibull-Weibull
    and 2-component mixture Weibull-exponential proportional hazards models.
    Furthermore, the flexible parametric survival model (see stpm2), modelled
    on the log cumulative hazard scale is also available. The association
    between the two processes can be induced via the default current value
    parameterisation, the first derivative of the longitudinal submodel,
    and/or a random coefficient such as the intercept.  Adaptive or
    non-adaptive Gauss-Hermite quadrature, coded in Mata, can be used to
    evaluate the joint likelihood. Under all survival submodels except the
    flexible parametric model, Gauss-Kronrod quadrature is used to evaluate
    the cumulative hazard. The dataset must be <b>stset</b> correctly into enter and
    exit times, using the enter option; see <b>[ST] stset</b>.  <b>stjm</b> uses <b>_t0</b> to
    denote measurement times. For example, below we have 3 patients with 2, 5
    and 3 measurements each, respectively.
<p>
                ---------------------------------
                id    _t0    _t   _d    long_resp
                ---------------------------------
                 1    0     0.2    0         0.93
                 1    0.2   0.7    0         1.32
                 2    0     0.5    0         1.15
                 2    0.5   1.2    0         1.67
                 2    1.2   1.6    0         1.92
                 2    1.6   1.9    0         2.65
                 2    1.9   2.6    1         3.15
                 3    0     2      0         0.25
                 3    2     2.3    0         0.21
                 3    2.3   2.4    1         0.31
                ---------------------------------
<p>
    Delayed entry joint models can be fitted, allowing age to be used as the
    timescale.
<p>
<a name="options"></a><b><u>Options</u></b>
<p>
    <b>panel(</b><i>varname</i><b>)</b> defines the panel identification variable. Each panel
        should be identified by a unique integer.
<p>
    <b>survmodel(</b><i>survsubmodel</i><b>)</b> specifies the survival submodel to be fit.
<p>
        <b>survmodel(fpm)</b> fits a flexible parametric survival submodel. This is
        a highly flexible fully parametric alternative to the Cox model,
        modelled on the log cumulative hazard scale using restricted cubic
        splines. For more details see stpm2.
<p>
        <b>survmodel(exponential)</b> fits an exponential survival submodel.
<p>
        <b>survmodel(weibull)</b> fits a Weibull survival submodel.
<p>
        <b>survmodel(gompertz)</b> fits a Gompertz survival submodel.
<p>
        <b>survmodel(weibweib)</b> fits a 2-component mixture Weibull-Weibull
        survival submodel.
<p>
        <b>survmodel(weibexp)</b> fits a 2-component mixture Weibull-exponential
        survival submodel.
<p>
        +------------------------+
    ----+ Longitudinal sub-model +-------------------------------------------
<p>
    <b>ffp(</b><i>numlist</i><b>)</b> specifies power transformations of the time variable, to be
        included in the longitudinal submodel as fixed covariates. _t0 is
        used as the time of measurements. Values must be in {-5, -4, -3, -2,
        -1, -0.5, 0, 0.5, 1, 2, 3, 4, 5}.
<p>
    <b>rfp(</b><i>numlist</i><b>)</b> specifies power transformations of the time variable, to be
        included in the longitudinal submodel as fixed and random covariates.
        _t0 is used as the time of measurements. Values must be in {-5, -4,
        -3, -2, -1, -0.5, 0, 0.5, 1, 2, 3, 4, 5}.
<p>
    <b>frcs(</b><i>#</i><b>)</b> specifies the degrees of freedom of the time variable, expanding
        time into restricted cubic splines as fixed covariates. _t0 is used
        as the time of measurements. The default knot locations are described
        under <b>df()</b>.
<p>
    <b>rrcs(</b><i>#</i><b>)</b> specifies the degrees of freedom of the time variable, expanding
        time into restricted cubic splines as random covariates. _t0 is used
        as the time of measurements. The default knot locations are described
        under <b>df()</b>.
<p>
    <b>timeinteraction(</b><i>varlist</i><b>)</b> covariates to interact with the fixed time
        components specified in <b>ffp</b>/<b>frcs</b>.
<p>
    <b>covariance(</b><i>vartype</i><b>)</b> specifies the variance-covariance structure of the
        random effects.
<p>
        <b>covariance(independent)</b> specifies a distinct variance for each random
        effect, with all covariances zero.
<p>
        <b>covariance(exchangeable)</b> specifies equal variances for all random
        effects, and one common pairwise covariance.
<p>
        <b>covariance(identity)</b> specifies equal variances for all random
        effects, with all covariances zero.
<p>
        <b>covariance(unstructured)</b> specifies that all variances and covariances
        are distinctly estimated.
<p>
        +--------------------+
    ----+ Survival sub-model +-----------------------------------------------
<p>
    <b>survcov(</b><i>varlist</i><b>)</b> specifies covariates to be included in the survival
        submodel.
<p>
    <b>df(</b><i>#</i><b>)</b> specifies the degrees of freedom for the restricted cubic spline
        function used for the baseline function under a flexible parametric
        survival submodel. <i>#</i> must be between 1 and 10, but usually a value
        between 1 and 4 is sufficient, with 3 being the default. The <b>knots()</b>
        option is not applicable if the <b>df()</b> option is specified. The knots
        are placed at the following centiles of the distribution of the
        uncensored log survival times:
<p>
        ------------------------------------------------------------
        df  knots        Centile positions
        ------------------------------------------------------------
         1    0    (no knots)
         2    1    50
         3    2    33 67
         4    3    25 50 75
         5    4    20 40 60 80
         6    5    17 33 50 67 83
         7    6    14 29 43 57 71 86
         8    7    12.5 25 37.5 50 62.5 75 87.5
         9    8    11.1 22.2 33.3 44.4 55.6 66.7 77.8 88.9
        10    9    10 20 30 40 50 60 70 80 90     
        ------------------------------------------------------------
        
        Note that these are <i>interior knots</i> and there are also boundary knots
        placed at the minimum and maximum of the distribution of uncensored
        survival times.
<p>
    <b>knots(</b><i>numlist</i><b>)</b> specifies knot locations for the baseline distribution
        function under a flexible parametric survival submodel, as opposed to
        the default locations set by df(). Note that the locations of the
        knots are placed on the standard time scale.  However, the scale used
        by the restricted cubic spline function is always log time. Default
        knot positions are determined by the df() option.
<p>
    <b>noorthog</b> suppresses orthogonal transformation of spline variables under a
        flexible parametric survival submodel.
<p>
        +-------------+
    ----+ Association +------------------------------------------------------
<p>
    <b>nocurrent</b> specifies that the association between the survival and
        longitudinal submodels is not based on the current value.  The
        default association is based on the current value of the longitudinal
        response.
<p>
    <b>derivassociation</b> specifies that the association between the survival and
        longitudinal submodels is based on the first derivative of the
        longitudinal submodel.
<p>
    <b>intassociation</b> specifies that the association between the survival and
        longitudinal submodels is based on the random intercept of the
        longitudinal submodel. By default this includes the fixed intercept
        coefficient.
<p>
    <b>association(</b><i>numlist</i><b>)</b> specifies that the association between the survival
        and longitudinal submodels is based on a random coefficient of time
        fractional polynomials specified in <b>rfracpoly</b>. By default this
        includes the fixed coefficient.
<p>
    <b>assoccovariates(</b><i>varlist</i><b>)</b> covariates to include in the linear predictor of
        the association parameter(s). Under the default current value
        association, this corresponds to interacting the longitudinal
        submodel with covariates.
<p>
    <b>nocoefficient</b> do not include the fixed coefficient when using
        <b>intassociation</b> or <b>association()</b>.
<p>
        +--------------+
    ----+ Maximisation +-----------------------------------------------------
<p>
    <b>gh(</b><i>#</i><b>)</b> specifies the number of Gauss-Hermite quadrature nodes used to
        evaluate the integrals over the random effects. The defaults are 5
        and 15 under adaptive and non-adaptive, respectively.  Minimum number
        of quadrature points is 2.
<p>
    <b>gk(</b><i>#</i><b>)</b> specifies the number of Gauss-Kronrod quadrature nodes used to
        evaluate the cumulative hazard under an exponential/Weibull/Gompertz
        survival submodel. Two choices are available, namely 7 or 15, with
        the default 15.
<p>
    <b>gl(</b><i>#</i><b>)</b> specifies the number of Gauss-Legendre quadrature nodes used to
        evaluate the cumulative hazard under an exponential/Weibull/Gompertz
        survival submodel. This is an alternative to Gauss-Kronrod
        quadrature, where the user can specify any number of nodes &gt;=5.
<p>
    <b>adaptit(</b><i>#</i><b>)</b> defines the number of iterations of adaptive Gauss-Hermite
        quadrature to use in the maximisation process, with the default 5.
        Adaptive quadrature is implemented at the beginning of each full
        Newton-Raphson iteration.
<p>
    <b>noshowadapt</b> suppresses the display of the log-likelihood values under the
        sub-iterations used to assess convergence of the adaptive quadrature
        implemented at the beginning of each full Newton-Raphson iteration.
<p>
    <b>atol(</b><i>#</i><b>)</b> tolerance for the log-likelihood under adaptive quadrature
        sub-iterations, default is 1.0E-05
<p>
    <b>nonadapt</b> use non-adaptive Gauss-Hermite quadrature to evaluate the joint
        likelihood. This will generally require a much higher number of
        nodes, <b>gh</b>, to ensure accurate estimates and standard errors,
        resulting in much greater computation time.
<p>
    <b>fulldata</b> forces <b>stjm</b> to use all rows of data in the survival component of
        the likelihood. By default, <b>stjm</b> assesses whether all covariates
        specified in <b>survcov()</b> are constant within panels, and if they are,
        only needs to use the first row of <b>_t0</b> and the final row of <b>_t</b> in the
        maximisation process providing considerable speed advantages.
<p>
    <b>nullassoc</b> sets the initial value for association parameters to be zero.
        Use of the default initial values may in rare situations cause <b>stjm</b>
        to display<i> initial values not feasible</i>; using this option solves
        this, however, convergence time is generally longer.
<p>
    <b>noxtem</b> suppresses the use of the <b>emonly</b> option in the <b>[XT] xtmixed</b> call
        uses to obtain initial values. By default, <b>emonly</b> is used which is
        often quicker and provides adequate starting values for the
        longitudinal component.
<p>
<a name="maximize_options"></a>    <i>maximize_options</i>; <b><u>dif</u></b><b>ficult</b>, <b><u>tech</u></b><b>nique(</b><i>algorithm_spec</i><b>)</b>, <b><u>iter</u></b><b>ate(</b><i>#</i><b>)</b>,
        [<b>no</b>]<b><u>lo</u></b><b>g</b>, <b><u>tr</u></b><b>ace</b>, <b><u>grad</u></b><b>ient</b>, <b>showstep</b>, <b><u>hess</u></b><b>ian</b>, <b><u>shownr</u></b><b>tolerance</b>,
        <b><u>tol</u></b><b>erance(</b><i>#</i><b>)</b>, <b><u>ltol</u></b><b>erance(</b><i>#</i><b>)</b> <b><u>gtol</u></b><b>erance(</b><i>#</i><b>)</b>, <b><u>nrtol</u></b><b>erance(</b><i>#</i><b>)</b>,
        <b><u>nonrtol</u></b><b>erance</b>, <b>from(</b><i>init_specs</i><b>)</b>; see <b>[R] maximize</b>. These options are
        seldom used, but the <b>difficult</b> option may be useful if there are
        convergence problems.
<p>
        +-----------+
    ----+ Reporting +--------------------------------------------------------
<p>
    <b>showinitial</b> displays the output from the <b>[XT] xtmixed</b> and <b>[ST] streg</b>, 
        <b>stpm2</b> or <b>stmix</b> models fitted to obtain initial values for <b>stjm</b>.
<p>
    <b>variance</b> show random-effects parameter estimates as variances-covariances
<p>
    <b>showcons</b> displays the constraints used by <b>stpm2</b> and <b>stjm</b> for the
        derivatives of the spline function. This option is only valid under a
        flexible parametric survival submodel.
<p>
    <b>keepcons</b> prevents the constraints imposed by <b>stjm</b> on the derivatives of
        the spline function when fitting delayed entry models being dropped.
        By default, the constraints are dropped. This option is only valid
        under a flexible parametric survival submodel.
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, as a percentage, for confidence
        intervals.  The default is <b>level(95)</b> or as set by <b>set level</b>.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    1. A random intercept is always assumed in each <b>stjm</b> call.
<p>
    2. Measurement time must be exclusively controlled through the options
    <b>ffp()</b>, <b>rfp()</b>, <b>frcs()</b>, <b>rrcs()</b> and <b>timeinteraction()</b>, and not included as
    fixed covariates in either submodel through [<i>varlist</i>] or
    <b>survcov(</b><i>varlist</i><b>)</b>.
<p>
    3. As with all survival models with multiple-record <b>st</b> data, time-varying
    covariates can be included in each submodel.
<p>
    4. Estimation is performed by maximum likelihood. Optimisation uses the
    default technique <b>nr</b>, meaning Stata's version of Newton-Raphson
    iterations.
<p>
    5. If convergence issues arise, try specifying the <b>nullassoc</b> option
    and/or increasing the number of Gauss-Hermite nodes, <b>gh()</b>. Users may also
    wish to vary the number of adaptive quadrature iterations using
    <b>adaptit()</b>.
<p>
    6. As with all models which use numerical integration, the number of
    quadrature nodes should be increased to establish the stability of the
    estimates.
<p>
    7. Note that under a flexible parametric survival sub-model, if more than
    one random effect is specified then survival sub-model coefficients are
    interpreted as proportional cumulative hazard ratios. In this case the
    equivalency between proportional cumulative hazard ratios and
    proportional hazards ratios does not hold.
<p>
        +---------------------------+
    ----+ Intermittant missing data +----------------------------------------
<p>
    If intermittent missing data is present in any covariates, for example:
<p>
                ---------------------------------
                id    _t0    _t   _d    long_resp
                ---------------------------------
                 1    0     0.2    0         0.93
                 1    0.2   0.7    0         1.32
                 2    0     0.5    0         1.15
                 2    0.5   1.2    0         .
                 2    1.2   1.6    0         .
                 2    1.6   1.9    0         2.65
                 2    1.9   2.6    1         3.15
                 3    0     2      0         0.25
                 3    2     2.3    0         0.21
                 3    2.3   2.4    1         0.31
                ---------------------------------
<p>
    then care must be taken to ensure the appropriate rows of data are
    included in the survival component of the joint likelihood. By default,
    <b>stjm</b> assesses whether all covariates included in <b>survcov()</b> are constant
    within panels, and if they are, only has to use the first row of <b>_t0</b> and
    the final row of <b>_t</b> for the survival likelihood component. However, if
    they are not, or the <b>fulldata</b> option is used, then all rows are included,
    as with multiple-record <b>st</b> data.
<p>
    For example, if we were to use the <b>fulldata</b> option when analysing the
    data in the above Table, then patient 2's survival contribution would be
    missing between times <b>_t0 = 0.5</b> and <b>_t = 1.6</b>. However, the correct
    contribution would be made by using only the first row of <b>_t0</b> and final
    row of <b>_t</b>.
<p>
    <b>stjm</b> displays a warning when this situation is detected. The simplest way
    of avoiding this is to remove any missing data before using <b>stset</b>.
<p>
<p>
<a name="examples"></a><b><u>Example 1: Simulated dataset</u></b>
<p>
    Load simulated example dataset:
    . use http://fmwww.bc.edu/repec/bocode/s/stjm_example
<p>
    stset the data:
    . stset stop, enter(start) f(event=1) id(id)
<p>
    Explore the joint data with a joint plot:
    . stjmgraph long_response, panel(id)
<p>
    Joint model with a random intercept and fixed slope in the longitudinal
    submodel, a flexible parametric survival submodel with 3 degrees of
    freedom, and association based on the current value. No covariates in
    either submodel.
    . stjm long_response, panel(id) survmodel(fpm) df(3) ffp(1)
<p>
    Joint model with a random intercept and fixed slope in the longitudinal
    submodel, a Weibull survival submodel, adjusting for treatment in the
    survival submodel and the interaction between treatment and measurement
    time in the longitudinal submodel. Current value association.
    . stjm long_response trt, panel(id) survmodel(weibull) ffp(1)
        survcov(trt) timeinterac(trt)
<p>
    Joint model with a random intercept and random slope in the longitudinal
    submodel, a Weibull survival submodel, and adjusting for treatment in
    both submodels.  Risk of event dependent on the current value and the
    first derivative of the longitudinal submodel.
    . stjm long_response trt, panel(id) survmodel(weibull) rfp(1)
        survcov(trt) derivassoc
<p>
<p>
<b><u>Example 2: Primary Biliary Cirrhosis dataset</u></b>
<p>
    This example dataset contains 1945 repeated measurements of serum
    bilirubin, from 312 patients with Primary Biliary Cirrhosis (PBC).
    Patients received treatment of D-penicillamine or placebo.  In all
    analyses we use the log of serum bilirubin.
<p>
    Load PBC dataset:
    . use http://fmwww.bc.edu/repec/bocode/s/stjm_pbc_example_data
<p>
    stset the data:
    . stset stop, enter(start) f(event=1) id(id)
<p>
    Explore the joint data with a joint plot:
    . stjmgraph logb, panel(id)
<p>
    Joint model with a random intercept and fixed slope in the longitudinal
    submodel, a Weibull survival submodel, and association based on the
    current value. We adjust for the interaction between treatment and fixed
    time in the longitudinal submodel, and treatment in the survival
    submodel.
    . stjm logb, panel(id) survmodel(w) ffp(1) timeinterac(trt) survcov(trt)
<p>
    Joint model with a random intercept and random slope in the longitudinal
    submodel, a Weibull survival submodel, and association based on the
    current value. We adjust for the interaction between treatment and fixed
    time in the longitudinal submodel, and treatment in the survival
    submodel. We also adjust for the interaction between log serum bilirubin
    and treatment.
    . stjm logb, panel(id) survmodel(w) rfp(1) timeinterac(trt) survcov(trt)
        assoccov(trt)
<p>
<p>
<b><u>Example 3: Liver cirrhosis with repeated measures of prothrombin index</u></b>
<p>
    This example dataset contains 2968 repeated measurements of prothrombin
    index, from 488 patients with liver cirrhosis. Patients received
    treatment of prednisone or placebo.
<p>
    Load dataset:
    . use http://fmwww.bc.edu/repec/bocode/s/stjm_prothro
<p>
    stset the data:
    . stset stop, enter(start) f(event=1) id(id)
<p>
    Explore the joint data with a joint plot:
    . stjmgraph pro, panel(id) lowess
<p>
    Joint model with a random intercept and random slope in the longitudinal
    submodel, a mixture Weibull-exponential survival submodel, and
    association based on the current value. We adjust for treatment in the
    survival submodel.
    . stjm pro, panel(id) survmodel(weibexp) rfp(1) survcov(trt)
<p>
    Joint model with a random intercept and fixed splines of time with 2
    degrees of freedom in the longitudinal submodel, a mixture
    Weibull-Weibull survival submodel, and association based on the current
    value. We adjust for the interaction between treatment and fixed splines
    of time in the longitudinal submodel, and treatment in the survival
    submodel.
    . stjm pro, panel(id) survmodel(weibweib) frcs(2) timeinterac(trt)
        survcov(trt)
<p>
<p>
<b><u>Author</u></b>
<p>
    Michael J. Crowther
    Department of Health Sciences
    University of Leicester
    E-mail: michael.crowther@le.ac.uk
<p>
    Part of this work was conducted when MJC was on an internship at
    StataCorp. In particular, he would like to thank Yulia Marchenko, Jeff
    Pitblado, Alan Riley and Vince Wiggins.
<p>
    Please report any errors you may find.
<p>
<p>
<b><u>References</u></b>
<p>
    Crowther MJ, Abrams KR and Lambert PC. Flexible parametric joint
        modelling of longitudinal and survival data.  <i>Statistics in Medicine</i>
        2012; (In Press).
<p>
    Crowther MJ, Abrams KR and Lambert PC. Joint modelling of longitudinal
    and survival data in Stata.  <i>The Stata Journal</i> 2012; (In Press).
<p>
    Lambert PC and Royston P. Further development of flexible parametric
        models for survival analysis. <i>The Stata Journal</i> 2009;9:265-290.
<p>
    Rabe-Hesketh S, Skrondal A and Pickles A. Reliable estimation of
        generalized linear mixed models using adaptive quadrature. <i>The Stata</i>
        <i>Journal</i> 2002;2:1-21.
<p>
    Wulfsohn MS and Tsiatis AA. A joint model for survival and longitudinal
        data measured with error. <i>Biometrics</i> 1997;53:330-339.
<p>
</pre>