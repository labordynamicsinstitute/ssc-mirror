<pre>
<b>help spreg postestimation</b>                                    also see:  <b>spreg</b>  
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Title</u></b>
<p>
    <b>spreg postestimation</b> -- Postestimation tools for spreg
<p>
<p>
<b><u>Description</u></b>
<p>
    The following postestimation commands are available after <b>spreg</b>:
<p>
    command          description
    -------------------------------------------------------------------------
INCLUDE help post_estat
INCLUDE help post_estimates
INCLUDE help post_lincom
INCLUDE help post_lrtest
INCLUDE help post_nlcom
        <b>predict</b>      predicted values
INCLUDE help post_predictnl
INCLUDE help post_test
INCLUDE help post_testnl
    -------------------------------------------------------------------------
<p>
<p>
<a name="predict"></a><b><u>Syntax for predict</u></b>
<p>
        <b>predict</b> [<i>type</i>] <i>newvar</i> [<i>if</i>] [<i>in</i>] [<b>,</b> <i>statistic</i>]
<p>
    <i>statistic</i>                     Description
    -------------------------------------------------------------------------
    Main
      <b><u>rf</u></b><b>orm</b>                       reduced-form predicted values; the default
      <b><u>li</u></b><b>mited</b>                     predictions based on a limited information
                                    set
      <b><u>na</u></b><b>ive</b>                       predictions based on the observed values of
                                    <b>y</b>
      <b>xb</b>                          linear prediction
      <b><u>rft</u></b><b>ransform(</b><i>real matrix T</i><b>)</b>  user-provided (<b>I</b>-<i>lambda</i>*<b>W</b>)^(-1)
    -------------------------------------------------------------------------
<p>
<p>
<b><u>Options for predict</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>rform</b> predicted values calculated from the reduced-form equation, <b>y</b> =
        (<b>I</b>-<i>lambda</i>*<b>W</b>)^(-1)*<b>X</b>*<b>b</b>.
<p>
    <b>limited</b> predicted values based on the limited information set.  This
        option is available only for a model with
        homoskedastically-distributed errors.
<p>
    <b>naive</b> predicted values based on the observed values of <b>y</b>, <i>lambda</i>*<b>W</b>*<b>y</b> +
        <b>X</b>*<b>b</b>.
<p>
    <b>xb</b> calculates the linear prediction <b>X</b>*<b>b</b>.
<p>
    See <i>Remarks</i> below for a detailed explanation of the <b>predict</b> options.
<p>
    <b>rftransform()</b> tells <b>predict</b> use the user-specified inverse of
        (<b>I</b>-<i>lambda</i>*<b>W</b>).  The matrix <i>T</i> should reside in Mata memory.  This
        option is available only with the reduced-form predictor.
<p>
<p>
<a name="remarks"></a><b><u>Remarks</u></b>
<p>
    The methods implemented in <b>predict</b> after <b>spreg</b> are documented in Drukker,
    Prucha, and Raciborski (2011) which can be downloaded from 
    http://econweb.umd.edu/~prucha/Papers/WP_spreg_2011.pdf.
<p>
<p>
    Recall the spatial-autoregressive spatial-error (SARAR) model
<p>
        <b>y</b> = <i>lambda</i>*<b>W</b>*<b>y</b> + <b>X</b>*<b>b</b> + <b>u</b>
<p>
        <b>u</b> = <i>rho</i>*<b>M</b>*<b>u</b> + <b>e</b>
<p>
    This model specifies a system of <i>n</i> simultaneous equations for the
    dependent variable <b>y</b>.
<p>
    The predictor based on the reduced-form equation is obtained by solving
    the model for the endogenous variable <b>y</b> which gives (<b>I</b>-<i>lambda</i>*<b>W</b>)^(-1)*<b>X</b>*<b>b</b>
    for the SAR and SARAR models and <b>X</b>*<b>b</b> for the SARE model.
<p>
    The limited information set predictor is described in Kalejian and Prucha
    (2007).  Let
<p>
        <b>U</b> = (<b>I</b>-<i>rho</i>*<b>M</b>)^(-1) * (<b>I</b>-<i>rho</i>*<b>M</b>')^(-1)
        
        <b>Y</b> = (<b>I</b>-<i>lambda</i>*<b>W</b>)^(-1) * (<b>I</b>-<i>lambda</i>*<b>W</b>')^(-1)
        
        E(<i>w_i</i>*<b>y</b>) = <i>w_i</i> * (<b>I</b>-<i>lambda</i>*<b>W</b>)^(-1) * <b>X</b>*<b>b</b>
        
        cov(<i>u_i</i>,<i>w_i</i>*<b>y</b>) = <i>sigma</i>^2 * <i>w_i</i>*<b>Y</b>*<i>w_i</i>'
        
        var(<i>w_i</i>*<b>y</b>) = <i>sigma</i>^2 * <i>u_i</i>*(<b>I</b>-<i>lambda</i>*<b>W</b>')^(-1)*<i>w_i</i>'
<p>
    where <i>w_i</i> and <i>u_i</i> denote the <i>i</i>th row of <b>W</b> and <b>U</b>, respectively.  The
    limited information set predictor for observation <i>i</i> is given by
<p>
<p>
                               cov(<i>u_i</i>,<i>w_i</i>*<b>y</b>)
        <i>lambda</i>*<i>w_i</i>*<b>y</b> + <i>x_i</i>*<b>b</b> + -------------- * [<i>w_i</i>*<b>y</b> - E(<i>w_i</i>*<b>y</b>)]
                                 var(<i>w_i</i>*<b>y</b>)
<p>
<p>
    where <i>x_i</i> denotes the <i>i</i>th row of <b>X</b>.  Because the formula involves the
    <i>sigma</i>^2 term, this predictor is available only for a model with
    homoskedastically-distributed errors.
<p>
    The reduced-form predictor is based on the information set {<b>X</b>,<b>W</b>}.  The
    limited information set predictor includes additionally the linear
    combination <b>W</b>*<b>y</b>, thus it is more efficient than the reduced-form
    predictor.  Both predictors are unbiased predictors conditional on their
    information set.
<p>
    The naive predictor is obtained by treating the values of <b>y</b> on the
    right-hand side as given, which results in the formula <i>lambda</i>*<b>W</b>*<b>y</b> + <b>X</b>*<b>b</b>
    for the SAR and SARAR models, and <b>X</b>*<b>b</b> for the SARE model.  Note that this
    predictor is a special case of the limited information set predictor with
    cov(<i>u_i</i>,<i>w_i</i>*<b>y</b>) = 0, but this this is true only when <i>lambda</i> = <i>rho</i> = 0.
<p>
    The naive predictor ignores the feedback that the neighboring
    observations may have on the value of <b>y</b> in a given observation.  The
    reduced-form and limited information set predictors factor this feedback
    into the computations through the (<b>I</b>-<i>lambda</i>*<b>W</b>)^(-1)*<b>X</b>*<b>b</b> term.  If you are
    interested in how a change to a covariate in an observation affects the
    entire system, you should use the reduced-form or the limited information
    set predictor.
<p>
<p>
<b><u>Examples</u></b>
<p>
    Setup
        <b>. use pollute</b>
        <b>. spmat use cobj using pollute.spmat</b>
        <b>. spreg ml pollution factories area, id(id) dlmat(cobj) elmat(cobj)</b>
<p>
    Obtain predicted values based on the reduced-form equation
        <b>. predict y0</b>
<p>
    Increase <b>factories</b> in observation 50 by 1 and obtain a new set of
    predicted values
        <b>. replace factories = factories+1 in 50</b>
        <b>. predict y1</b>
<p>
    Compare the two sets of predicted values
        <b>. gen deltay = abs(y1-y0)</b>
        <b>. count if deltay!=0</b>
<p>
    Note that a change in one observation resulted in a total of 25 changes.
<p>
<p>
<b><u>References</u></b>
<p>
    Drukker, D. M., I. R. Prucha, and R. Raciborski. 2011.
        Maximum-likelihood and generalized spatial two-stage least-squares
        estimators for a spatial-autoregressive model with
        spatial-autoregressive disturbances.  Working paper, University of
        Maryland, Department of Economics, 
        http://econweb.umd.edu/~prucha/Papers/WP_spreg_2011.pdf.
<p>
<p>
    Kelejian H. H., and I. R. Prucha. 2007.  The relative efficiencies of
        various predictors in spatial econometric models containing spatial
        lags. <i>Regional Science and Urban Economics</i> 37, 363-374.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  <b>spreg</b>, <b>spivreg</b> (if installed)
<p>
</pre>