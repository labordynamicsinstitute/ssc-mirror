<pre>
<b>help runmlwin</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>runmlwin</b> - Run the MLwiN multilevel modelling software from within Stata
<p>
<p>
<a name="syntax"></a><b><u>Syntax</u></b>
<p>
        <b>runmlwin</b> <i>responses_and_fixed_part</i><b>,</b> <i>random_part</i>
                  [discrete(<i>discrete_options</i>)] [mcmc(<i>mcmc_options</i>)]
                  [<i>general_options</i>]
<p>
    where the syntax of <i>responses_and_fixed_part</i> is one of the following
<p>
        for univariate continuous, binary, proportion and count response
        models
<p>
            <i>depvar</i> <i>indepvars</i> [<i>if</i>] [<i>in</i>]
<p>
        for univariate ordered and unordered categorical response models
<p>
            <i>depvar</i> <i>indepvars1</i> [(<i>indepvars2</i><b>,</b> <b><u>con</u></b><b>trast(</b><i>numlist</i><b>)</b>) ... ] [<i>if</i>] [
                        <i>in</i>]
<p>
            where <i>indepvars1</i> are those independent variables which appear
            with separate coefficients in each of every log-odds contrast,
            while <i>indepvars2</i> are those independent variables which appear
            with common coefficients for those log-odds contrasts specified
            in <b>contrast(</b><i>numlist</i><b>)</b>.  Contrasts can be thought of as the
            separate "subequations" or "arms" of a multinomial response
            model.  These contrasts are indexed 1,2,... up to the total
            number of contrasts included in the model.  The total number of
            contrasts will be one less than the number of response
            categories.
<p>
        for multivariate response models
<p>
            (<i>depvar1</i> <i>indepvars1</i><b>,</b> <b><u>eq</u></b><b>uation(</b><i>numlist</i><b>)</b>)
                        (<i>depvar2</i> <i>indepvars2</i><b>,</b> <b><u>eq</u></b><b>uation(</b><i>numlist</i><b>)</b>)
                        [(<i>depvar3</i> <i>indepvars3</i><b>,</b> <b><u>eq</u></b><b>uation(</b><i>numlist</i><b>)</b>)]
                        [ ... ]
                        [<i>if</i>] [<i>in</i>]
<p>
            where <b>equation(</b><i>numlist</i><b>)</b> specifies equation numbers.  Equation
            numbers are indexed 1,2,... up to the total number of equations
            (i.e. response variables) included in the model.
<p>
    and the syntax of <i>random_part</i> is
<p>
        [ ... ] [level2(<i>levelvar</i>: [<i>varlist</i>] [<b>,</b> <i>random_part_options</i>])]
                  level1(<i>levelvar</i>: [<i>varlist</i>] [<b>,</b> <i>random_part_options</i>])
<p>
    where <i>levelvar</i> is a variable identifying the groups or clusters for the
    random effects at each level.  <i>varlist</i> is the list of variables with
    random coefficients at each level.
<p>
<a name="random_part_options"></a>    <i>random_part_options - (R)IGLS and MCMC</i>  Description
    -------------------------------------------------------------------------
    Model - (R)IGLS and MCMC
      <b><u>d</u></b><b>iagonal</b>                              set all covariances to zero
<p>
    Model - (R)IGLS only
      <b><u>el</u></b><b>ements(</b><i>matrix</i><b>)</b>                      set specific (co)variances to
                                              zero
      <b><u>w</u></b><b>eightvar(</b><i>varname</i><b>)</b>                    specify variable containing
                                              sampling weights
<p>
    Model - MCMC only
      <b><u>mmi</u></b><b>ds(</b><i>varlist</i><b>)</b>                        specify variables containing
                                              multiple membership unit
                                              identifiers
      <b><u>mmw</u></b><b>eights(</b><i>varlist</i><b>)</b>                    specify variables containing
                                              multiple membership weights
      <b><u>cari</u></b><b>ds(</b><i>varlist</i><b>)</b>                       specify variables containing
                                              conditional autoregressive
                                              (CAR) unit identifiers
      <b><u>carw</u></b><b>eights(</b><i>varlist</i><b>)</b>                   specify variables containing
                                              conditional autoregressive
                                              (CAR) weights
      <b><u>fli</u></b><b>nits(</b><i>matrix</i><b>)</b>                       specify initial values for factor
                                              loadings
      <b><u>flc</u></b><b>onstraints(</b><i>matrix</i><b>)</b>                 constrain specific factor
                                              loadings to their initial
                                              values
      <b><u>fvi</u></b><b>nits(</b><i>matrix</i><b>)</b>                       specify initial values for factor
                                              (co)variances
      <b><u>fvc</u></b><b>onstraints(</b><i>matrix</i><b>)</b>                 constrain specific factor
                                              (co)variances to their initial
                                              values
      <b><u>fs</u></b><b>cores(</b><i>stub</i><b>*)                        </b>where <i>stub</i><b>*</b> is the variable stub
                                              for factor scores and their
                                              standard errors at this level
 
      <b><u>parexp</u></b><b>ansion</b>                          parameter expansion
<p>
    Estimation - (R)IGLS only
      <b>reset(</b><i>resetname</i><b>)</b>                      reset (co)variances to zero when
                                              variances turn negative
<p>
    Post-estimation - (R)IGLS and MCMC
      <b><u>r</u></b><b>esiduals(</b><i>stub</i><b>*,</b> [<i>residuals_options</i>]<b>)</b> where <i>stub</i><b>*</b> is the variable stub
                                              for residuals and their
                                              standard errors at this level
    -------------------------------------------------------------------------
<p>
<a name="discrete_options"></a>    <i>discrete_options - (R)IGLS and MCMC</i>     Description
    -------------------------------------------------------------------------
    Model((R)IGLS and MCMC)
      <b><u>d</u></b><b>istribution(</b><i>distname</i><b>)</b>                distribution(s) of <i>depvar(s)</i>
      <b><u>l</u></b><b>ink(</b><i>linkname</i><b>)</b>                        link function
      <b><u>de</u></b><b>nominator(</b><i>varlist</i><b>)</b>                  denominator(s) of <i>depvar(s)</i>
      <b><u>e</u></b><b>xtra</b>                                 extra binomial variation
      <b><u>b</u></b><b>asecategory(</b><i>#</i><b>)</b>                       set the value of the response to
                                              be used as the base or
                                              reference category (multinomial
                                              distributions only)
      <b><u>o</u></b><b>ffset(</b><i>varname</i><b>)</b>                       include <i>varname</i> in the model with
                                              coefficient constrained to 1
                                              (Poisson or negative binomial
                                              distributions only)
      <b><u>p</u></b><b>roportion(</b><i>varname</i><b>)</b>                   specify variable containing
                                              multinomial proportions
 
    Estimation - (R)IGLS only
      <b>mql1</b>                                  fit model using first order
                                              marginal quasi-likelihood
                                              linearization, the default
      <b>mql2</b>                                  fit model using second order
                                              marginal quasi-likelihood
                                              linearization
      <b>pql1</b>                                  fit model using first order
                                              penalised quasi-likelihood
                                              linearization
      <b>pql2</b>                                  fit model using second order
                                              penalised quasi-likelihood
                                              linearization
    -------------------------------------------------------------------------
<p>
<a name="mcmc_options"></a>    <i>mcmc_options - MCMC only</i>                Description
    -------------------------------------------------------------------------
    Model - MCMC only
      <b><u>log</u></b><b>formulation</b>                        specify log formulation for level
                                              1 variance
      <b>cc</b>                                    specify cross-classified model
      <b><u>msubs</u></b><b>cripts</b>                           use multiple subscript notation
      <b><u>corr</u></b><b>esiduals(</b><i>restype</i><b>)</b>                 specify the correlation structure
                                              of the level 1 random effects
                                              (i.e. the residual errors)
      <b>me(</b><i>varlist</i><b>, variances(</b><i>numlist</i><b>))</b>       specify subset of independent
                                              variables with measurement
                                              error
      <b><u>priorm</u></b><b>atrix(</b><i>matrix</i><b>)</b>                   specify informative priors for
                                              fixed and random part
                                              parameters
      <b><u>rpp</u></b><b>riors(</b><i>rppriors_spec</i><b>)</b>               specify prior distributions for
                                              the random part priors, the
                                              default is gamma(0.001,0.001)
      <b><u>savew</u></b><b>inbugs(</b><i>savewinbugs_options</i><b>)</b>      save specified model as a WinBUGS
                                              model
<p>
    Estimation - MCMC only
      <b>on</b>                                    fit model using default MCMC
                                              options
      <b><u>b</u></b><b>urnin(</b><i>#</i><b>)</b>                             specify number of iterations for
                                              the burn-in period, default is
                                              500
      <b><u>c</u></b><b>hain(</b><i>#</i><b>)</b>                              specify number of iterations for
                                              the monitoring chain period,
                                              default is 5000
      <b><u>t</u></b><b>hinning(</b><i>#</i><b>)</b>                           store every # iteration, default
                                              is 1
      <b><u>r</u></b><b>efresh(</b><i>#</i><b>)</b>                            refresh the MLwiN equation window
                                              every # iterations, default is
                                              50
      <b>scale(</b><i>#</i><b>)</b>                              set scale factor, default is 5.8
      <b><u>noadapt</u></b><b>ation</b>                          do not use adaptation
      <b><u>accept</u></b><b>ance(</b><i>#</i><b>)</b>                         set Metropolis Hastings
                                              acceptance rate, default is 0.5
      <b><u>tol</u></b><b>erance(</b><i>#</i><b>)</b>                          set the tolerance, default is 0.1
      <b>cycles(</b><i>#</i><b>)</b>                             number of cycles, default is 1
      <b><u>fem</u></b><b>ethod(</b><i>mcmc_method</i><b>)</b>                 specify fixed effects method,
                                              default depends on specified
                                              model
      <b><u>rem</u></b><b>ethod(</b><i>mcmc_method</i><b>)</b>                 specify random effects method,
                                              default depends on specified
                                              model
      <b>levelonevarmethod(</b><i>mcmc_method</i><b>)</b>        specify level 1 variance method,
                                              default depends on specified
                                              model
      <b>higherlevelsvarmethod(</b><i>mcmc_method</i><b>)</b>    specify higher level variances
                                              method, default depends on
                                              specified model
      <b>smcmc</b>                                 use structured MCMC methods
      <b>smvn</b>                                  use structured multivariate
                                              normal (MVN) framework
      <b><u>orth</u></b><b>ogonal</b>                            use orthogonal parameterisation
      <b><u>hc</u></b><b>entring(</b><i>#</i><b>)</b>                          use hierarchical centring at
                                              level #
      <b>seed(</b><i>#</i><b>)</b>                               set MCMC random number seed,
                                              default is 1
        
    Post estimation - MCMC only
      <b><u>savec</u></b><b>hains(</b><i>filename</i>[<b>, replace</b>]<b>)</b>       save MCMC parameter estimates for
                                              each iteration in filename.dta
      <b><u>imputei</u></b><b>terations(</b><i>numlist</i><b>)</b>             impute missing values at
                                              specified iterations
      <b><u>imputes</u></b><b>ummaries</b>                       for each missing value, calculate
                                              the mean and the standard
                                              deviation of the chain for that
                                              missing value
    -------------------------------------------------------------------------
<p>
<a name="general_options"></a>    <i>general_options - (R)IGLS and MCMC</i>      Description
    -------------------------------------------------------------------------
    Model - (R)IGLS only
      <b><u>w</u></b><b>eights(</b><i>weights_options</i><b>)</b>              apply sampling weights options
      <b><u>c</u></b><b>onstraints(</b><i>numlist</i><b>)</b>                  apply specified linear
                                              constraints
<p>
    Estimation - (R)IGLS only
      <b>igls</b>                                  fit model via iterative
                                              generalised least squares
                                              (equivalent to maximum
                                              likelihood), the default
      <b>rigls</b>                                 fit model via restrictive
                                              iterative generalised least
                                              squares (equivalent to maximum
                                              restricted likelihood)
      <b><u>maxi</u></b><b>terations(</b><i>#</i><b>)</b>                      specifies the maximum number of
                                              (R)IGLS iterations, default is
                                              20
      <b><u>tol</u></b><b>erance(</b><i>#</i><b>)</b>                          IGLS convergence tolerance,
                                              default is 2 (as in 10e-2)
      <b>seed(</b><i>#</i><b>)</b>                               set IGLS random number seed,
                                              default is <b>seed(</b><i>1</i><b>)</b>
<p>
    Estimation - (R)IGLS and MCMC
      <b><u>initsp</u></b><b>revious</b>                         use parameter estimates from
                                              previous model as initial
                                              values
      <b><u>initsm</u></b><b>odel(</b><i>name</i><b>)</b>                      use parameter estimates from
                                              specified model as initial
                                              values
      <b>initsb(</b><i>matrix</i><b>)</b>                        initial parameter values vector
      <b>initsv(</b><i>matrix</i><b>)</b>                        initial sampling (co)variance
                                              values matrix
<p>
    SE/Robust - (R)IGLS only
      <b><u>fps</u></b><b>andwich</b>                            sandwich estimates for fixed part
                                              standard errors
      <b><u>rps</u></b><b>andwich</b>                            sandwich estimates for random
                                              part standard errors
<p>
    Reporting - (R)IGLS and MCMC
      <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>                              set confidence level; default is
                                              level(95)
      <b>or</b>                                    report fixed-effects coefficients
                                              as odds ratios
      <b><u>ir</u></b><b>r</b>                                   report fixed-effects coefficients
                                              as incidence-rate ratios
      <b><u>rr</u></b><b>r</b>                                   report fixed-effects coefficients
                                              as relative-rate ratios
      <b>sd</b>                                    show random-effects variance as
                                              standard deviations
      <b><u>cor</u></b><b>relations</b>                          show random-effects covariance as
                                              correlations
      <b><u>nohead</u></b><b>er</b>                              suppress output header
      <b><u>nogr</u></b><b>oup</b>                               suppress table summarizing groups
      <b><u>nocont</u></b><b>rast</b>                            suppress table summarizing
                                              contrasts
      <b><u>nofet</u></b><b>able</b>                             suppress fixed-effects table
      <b><u>noret</u></b><b>able</b>                             suppress random-effects table
<p>
    Reporting - MCMC only
      <b><u>nodiag</u></b><b>nostics</b>                         do not calculate MCMC diagnostics
      <b><u>mo</u></b><b>de</b>                                  report parameter estimates as
                                              chain modes
      <b><u>me</u></b><b>dian</b>                                report parameter estimates as
                                              chain medians
      <b><u>z</u></b><b>ratio</b>                                report classical z-ratios and
                                              p-values
<p>
    Post-estimation - (R)IGLS and MCMC
      <b><u>sim</u></b><b>ulate(</b><i>newvar</i><b>)</b>                      simulates a new response variable
                                              <i>newvar</i> based on the estimated
                                              model parameters
<p>
    Export - (R)IGLS and MCMC
      <b><u>viewm</u></b><b>acro</b>                             view the MLwiN macro for the
                                              fitted model
      <b><u>savem</u></b><b>acro(</b><i>filename</i>[<b>, replace</b>]<b>)</b>        save the MLwiN macro for the
                                              fitted model
      <b><u>savew</u></b><b>orksheet(</b><i>filename</i>[<b>, replace</b>]<b>)</b>    save the MLwiN worksheet for the
                                              fitted model
<p>
    Other - (R)IGLS and MCMC
      <b><u>forces</u></b><b>ort</b>                             forces the data to be sorted
                                              according to the model
                                              hierarchy
      <b>nosort</b>                                prevents checking that the data
                                              are sorted according to the
                                              model hierarchy
      <b><u>forcer</u></b><b>ecast</b>                           forces a recast of all variables
                                              saved as long or double to
                                              float
      <b><u>nod</u></b><b>rop</b>                                prevents variables that do not
                                              appear in the model from being
                                              dropped prior to sending the
                                              data to MLwiN
      <b>nomlwin</b>                               prevent MLwiN from being run
      <b>mlwinpath(</b><i>string</i><b>)</b>                     mlwin.exe file address, including
                                              the file name
      <b>mlwinscriptpath(</b><i>string</i><b>)</b>               mlnscript.exe file address,
                                              including the file name;
                                              advanced use only
      <b>mlwinsettings(</b><i>mlwin_settings</i><b>)</b>         manually override MLwiN settings
      <b><u>nop</u></b><b>ause</b>                               suppresses the two pause steps in
                                              MLwiN
      <b><u>batc</u></b><b>h</b>                                 prevents any MLwiN GUI windows
                                              being displayed; advanced use
                                              only
    -------------------------------------------------------------------------
<p>
<a name="resetname"></a>    <i>resetname - (R)IGLS only</i>                Description
    -------------------------------------------------------------------------
    <b>all</b>                                     reset all (co)variances to zero
    <b><u>var</u></b><b>iances</b>                               reset only the variances to zero
    <b>none</b>                                    reset no (co)variances
    -------------------------------------------------------------------------
<p>
<a name="weights_options"></a>    <i>weights_options - (R)IGLS only</i>          Description
    -------------------------------------------------------------------------
    <b><u>nos</u></b><b>tandardised</b>                          no standardisation of the level
                                              specific weight variables
    <b><u>nofps</u></b><b>andwich</b>                            no sandwich estimates for fixed
                                              part standard errors
    <b><u>norps</u></b><b>andwich</b>                            no sandwich estimates for random
                                              part standard errors
    -------------------------------------------------------------------------
<p>
<a name="residuals_options"></a>    <i>residuals_options - (R)IGLS and MCMC</i>    Description
    -------------------------------------------------------------------------
    <b><u>var</u></b><b>iances</b>                               posterior variances
    <b><u>stand</u></b><b>ardised</b>                            standardised residuals
    <b><u>lev</u></b><b>erage</b>                                leverage residuals
    <b><u>inf</u></b><b>luence</b>                               influence residuals
    <b><u>del</u></b><b>etion</b>                                deletion residuals
    <b><u>samp</u></b><b>ling</b>                                sampling variance-covariance
                                              matrix
    <b>norecode</b>                                do not recode residuals
                                              exceedingly close or equal to
                                              zero to missing
    <b><u>ref</u></b><b>lated</b>                                unshrunken residuals
    -------------------------------------------------------------------------
<p>
<a name="residuals_options"></a>    <i>residuals_options - MCMC only</i>           Description
    -------------------------------------------------------------------------
    <b><u>savec</u></b><b>hains(</b><i>filename</i>[<b>, replace</b>]<b>)</b>         save MCMC residual estimates for
                                              each iteration in filename.dta
    -------------------------------------------------------------------------
<p>
<a name="distname"></a>    <i>distname - (R)IGLS and MCMC</i>             Description
    -------------------------------------------------------------------------
    <b>normal</b>                                  normal distribution
    <b>binomial</b>                                binomial distribution
    <b>multinomial</b>                             multinomial distribution
    <b>poisson</b>                                 Poisson distribution
    <b>nbinomial</b>                               negative binomial distribution
    -------------------------------------------------------------------------
<p>
<a name="linkname"></a>    <i>linkname - (R)IGLS and MCMC</i>             Description
    -------------------------------------------------------------------------
    <b><u>l</u></b><b>ogit</b>                                   logit link function
    <b><u>p</u></b><b>robit</b>                                  probit link function
    <b><u>c</u></b><b>loglog</b>                                 complementary log-log link
                                              function
    <b>log</b>                                     log link function
    <b><u>ol</u></b><b>ogit</b>                                  ordered logit link function
    <b><u>op</u></b><b>robit</b>                                 ordered probit link function
    <b><u>oc</u></b><b>loglog</b>                                ordered complementary log-log
                                              link function
    <b><u>m</u></b><b>logit</b>                                  unordered logit link function
    -------------------------------------------------------------------------
<p>
<a name="restype"></a>    <i>restype - MCMC only</i>                     Description
    -------------------------------------------------------------------------
    <b><u>un</u></b><b>structured</b>                            unstructured (co)variance matrix
    <b><u>ex</u></b><b>changeable</b>                            structured errors with a common
                                              correlation parameter and a
                                              common variance parameter
    <b><u>areq</u></b><b>vars</b>                                AR1 errors with a common variance
                                              parameter
    <b><u>eqcorrsindep</u></b><b>vars</b>                        structured errors with a common
                                              correlation parameter and
                                              independent variance parameters
    <b><u>arindep</u></b><b>vars</b>                             AR1 errors with independent
                                              variance parameters
    -------------------------------------------------------------------------
        
<a name="rppriors_spec"></a>    <i>rppriors_spec - MCMC only</i>               Description
    -------------------------------------------------------------------------
    <b><u>u</u></b><b>niform</b>                                 use the uniform prior
                                              distribution
    <b><u>g</u></b><b>amma(</b><i>a b</i><b>)</b>                              use the gamma prior distribution
                                              with shape a and scale b, the
                                              default is gamma(0.001,0.001)
    -------------------------------------------------------------------------
<p>
<a name="mcmc_method"></a>    <i>mcmc_method - MCMC only</i>                 Description
    -------------------------------------------------------------------------
    <b>gibbs</b>                                   Gibbs algorithm
    <b><u>uni</u></b><b>variatemh</b>                            univariate Metropolis Hastings
                                              algorithm
    <b><u>multi</u></b><b>variatemh</b>                          multivariate Metropolis Hastings
                                              algorithm
    -------------------------------------------------------------------------
        
<a name="savewinbugs_options"></a>    <i>savewinbugs_options - MCMC only</i>         Description
    -------------------------------------------------------------------------
    <b><u>m</u></b><b>odel(</b><i>filename</i>[<b>, replace</b>]<b>)</b>              save model as a WinBUGS model in
                                              filename.txt
    <b><u>i</u></b><b>nits(</b><i>filename</i>[<b>, replace</b>]<b>)</b>              save initial values in WinBUGS
                                              format in filename.txt
    <b><u>d</u></b><b>ata(</b><i>filename</i>[<b>, replace</b>]<b>)</b>               save data in WinBUGS format in
                                              filename.txt
    <b><u>nof</u></b><b>it</b>                                   do not fit the model in MLwiN
    -------------------------------------------------------------------------
<p>
<a name="mlwin_settings"></a>    <i>mlwin_settings - (R)IGLS and MCMC</i>       Description
    -------------------------------------------------------------------------
    <b><u>s</u></b><b>ize(</b><i>#</i><b>)</b>                                 specify maximum worksheet size
                                              allowed in MLwiN
    <b><u>l</u></b><b>evels(</b><i>#</i><b>)</b>                               specify maximum number of levels
                                              allowed in MLwiN
    <b><u>c</u></b><b>olumns(</b><i>#</i><b>)</b>                              specify maximum number of data
                                              columns allowed in MLwiN
    <b><u>v</u></b><b>ariables(</b><i>#</i><b>)</b>                            specify maximum number of
                                              modelled variables allowed in
                                              MLwiN
    <b>tempmat</b>                                 use memory allocated to the
                                              worksheet to store temporary
                                              matrices in MLwiN
    -------------------------------------------------------------------------
<p>
<p>
<a name="description"></a><b><u>Description</u></b>
<p>
    <b>runmlwin</b> allows Stata users to run the powerful MLwiN multilevel
    modelling software from within Stata.
<p>
    See <i>Remarks on alternative Stata commands for fitting multilevel models</i>
    below for more information.
<p>
    MLwiN has the following features:
<p>
        (1) Estimation of multilevel models for continuous, binary, count,
            ordered categorical and unordered categorical data;
<p>
        (2) Fast estimation via classical and Bayesian methods;
<p>
        (3) Estimation of multilevel models for cross-classified and multiple
            membership non-hierarchical data structures;
<p>
        (4) Estimation of multilevel multivariate response models, multilevel
            spatial models, multilevel measurement error models and
            multilevel multiple imputation models.
<p>
<p>
    MLwiN is required to use <b>runmlwin</b>.  See <i>Remarks on </i><i>runmlwin</i><i> installation</i>
    <i>instructions</i> below for more information.
<p>
    A comprehensive range of <b>runmlwin</b> examples and a user forum are available
    at:
<p>
        http://www.bristol.ac.uk/cmm/software/runmlwin
<p>
<p>
<a name="options"></a><b><u>Options</u></b>
<p>
<a name="options_model"></a>        +-------+
    ----+ Model +------------------------------------------------------------
<p>
    (a) random part model options
<p>
    All options reported in this sub-section are specific to the level at
    which they are specified.
<p>
    <b>diagonal</b> specifies a diagonal matrix for the random effects
        variance-covariance matrix.  This implies zero correlations between
        the random effects at that level.  Note that should a Toeplitz or
        other banded structures be desired (for example when modelling
        longitudinal data), these can be implemented using the <b>constraints</b>
        options.
<p>
    <b>elements(</b><i>matrix</i><b>)</b> sets specific (co)variances to zero.  Note that the
        matrix must be a row vector with one column for each (co)variance
        where the lower diagonal elements of the variance covariance matrix
        have been vectorised row by row.  If there are <i>q</i> random effects terms
        (variables with random coefficients), the unstructured covariance
        matrix has <i>q</i>(<i>q</i>+1)/2 unique parameters.  The elements of this vector
        must be 0 or 1 where 0 sets the relevant (co)variance to zero and 1
        specifies the parameter to be freely estimated.  See <i>Examples</i> for an
        example of this option.
<p>
    <b>weightvar(</b><i>varname</i><b>)</b> specifies the variable containing the sampling
        weights.
<p>
    <b>mmids(</b><i>varlist</i><b>)</b> specifies the variables containing the multiple membership
        unit identifiers.  The number of variables should equal the maximum
        number of higher level units that any lower level unit belongs to.
        The order in which the multiple membership unit identifier variables
        is specified is irrelevant other than it must correspond to the order
        in which the associated multiple membership weight variables is
        specified.  Zero values rather than missing values must be assigned
        for redundant identifier variables.
<p>
    <b>mmweights(</b><i>varlist</i><b>)</b> specifies the variables containing the multiple
        membership weights.  The number of variables should equal the maximum
        number of higher level units that any lower level unit belongs to.
        The ordering of the variables must correspond to the ordering of the
        multiple membership unit identifier variables.  Zero values rather
        than missing values must be assigned for redundant weight variables.
<p>
    <b>carids(</b><i>varlist</i><b>)</b> specifies the variables containing the conditional
        autoregressive (CAR) unit identifiers.  The number of variables
        should equal the maximum number of higher level units that any lower
        level unit belongs to.  The order in which the CAR unit identifier
        variables is specified is irrelevant other than it must correspond to
        the order in which the associated CAR weight variables is specified.
        Zero values rather than missing values must be assigned for redundant
        identifier variables.
<p>
    <b>carweights(</b><i>varlist</i><b>)</b> specifies the variables containing the conditional
        autoregressive (CAR) weights.  The number of variables should equal
        the maximum number of higher level units that any lower level unit
        belongs to.  The ordering of the variables must correspond to the
        ordering of the CAR unit identifier variables.  Zero values rather
        than missing values must be assigned for redundant weight variables.
<p>
    <b>flinits(</b><i>matrix</i><b>)</b> specifies initial values for factor loadings.  The number
        of rows must equal the number of responses.  The number of columns
        must equal the number of factors.
<p>
    <b>flconstraints(</b><i>matrix</i><b>)</b> constrain specific factor loadings to their initial
        values.  The number of rows must equal the number of responses.  The
        number of columns must equal the number of factors.  The elements of
        this matrix must be 0 or 1 where 0 freely estimates the factor
        loading and 1 constrains the factor loading to its initial value.
<p>
    <b>fvinits(</b><i>matrix</i><b>)</b> specifies initial values for factor (co)variances.  The
        number of rows and the number of columns must equal the number of
        factors.  The diagonal elements correspond to the factor variances.
        The off-diagonal elements correspond to the factor covariances.
        Initial values for the factor variances must be positive.  Intial
        values for the covariances must correspond to correlations that lie
        between -1 and +1.
<p>
    <b>fvconstraints(</b><i>matrix</i><b>)</b> constrain specific factor (co)variances to their
        initial values.  The number of rows and the number of columns must
        equal the number of factors.  The elements of this matrix must be 0
        or 1 where 0 freely estimates the (co)variance and 1 constrains the
        (co)variance to its initial value.
<p>
    <b><u>fs</u></b><b>cores(</b><i>stub</i><b>*)</b> calculates posterior estimates of the factor scores and
        their associated standard errors for all factors specified at the
        given level.  runmlwin will name the factors.  For example if there
        are three factors in the model, runmlwin would name the factors
        <i>stub1</i>, <i>stub2</i>, <i>stub3</i> and would name their associated standard errors
        as <i>stub1se</i>, <i>stub2se</i>, <i>stub3se</i>.
<p>
    <b>parexpansion</b> uses parameter expansion. Note that parameter expansion
        cannot be specified at level 1.
<p>
<p>
    (b) discrete response model options
<p>
    <b>distribution(</b><i>distname</i><b>)</b> specifies the distribution(s) of the <i>depvar(s)</i>.
        <b>normal</b> is applicable for continuous response variables, <b>binomial</b> for
        binary and proportion response variables, <b>multinomial</b> for ordinal and
        nominal categorical response variables and <b>poisson</b> and <b>nbinomial</b>
        (negative binomial) are applicable for count responses.  In
        multivariate response models where one or more response variables are
        discrete, one distribution must be given for each response variable.
<p>
    <b>link(</b><i>linkname</i><b>)</b> specifies the link function.  <b>logit</b>, <b>probit</b> and <b>cloglog</b>
        (complementary log-log) are applicable when the <b>binomial</b> distribution
        has been specified, <b>log</b> is applicable when either the <b>poisson</b> or
        <b>nbinomial</b> distributions have been specified, and <b>ologit</b> (ordered
        logit), <b>oprobit</b> (ordered probit), <b>ocloglog</b> (ordered complementary
        log-log) and <b>mlogit</b> (unordered logit) are applicable when the
        <b>multinomial</b> distribution has been specified.  Note that it is not
        possible to specify multivariate response models which have a mixture
        of different types of discrete response.  Thus, only one link
        function can be specified for the discrete responses.  In
        multivariate response models where a mixture of continuous and
        discrete response variables are specified, only the link function for
        the discrete responses is specified.
<p>
    <b>denominator(</b><i>varlist</i><b>)</b> specifies the variables containing the <b>binomial</b>
        denominator(s) (i.e. the number of binomial trials) for the response
        variable(s).  This option is only applicable when modelling
        proportions (i.e. counts with known totals).  For example, to model
        school level data on the proportion of students who pass an exam, the
        data should have one row per school, the <i>depvar</i> is the proportion of
        students who passed the exam and the <b>denominator</b> is the number of
        students who took the exam.  Note that this implementation differs
        from that for <b>[XT] xtmelogit</b> where one would specify a numerator (the
        number of children who passed the exam) as the response variable
        rather than the proportion.
<p>
    <b>extra</b> specifies an extra binomial variation parameter to allow for over-
        or under-dispersion.
<p>
    <b>basecategory(</b><i>#</i><b>)</b> specifies the value of the response to be used as the
        base or reference category.  This option is only applicable when
        modelling ordinal or nominal categorical response variables using the
        <b>multinomial</b> distribution.  When modelling ordinal responses, the
        basecategory must be either the first or last response category.
<p>
    <b>offset(</b><i>varname</i><b>)</b> includes <i>varname</i> in the fixed part of the model with
        coefficient constrained to one.  This option is only applicable when
        modelling count responses using the <b>poisson</b> or <b>nbinomial</b>
        distributions.
<p>
    <b>proportion(</b><i>varname</i><b>)</b> specifies the variable containing multinomial
        proportions.  For example, to model neighbourhood level data on the
        proportion of individuals in good, average and poor health, the data
        should have three rows per neighbourhood.  The first row should give
        the proportion of individuals in good health.  The second row should
        give the proportion of individuals in average health.  The third row
        should give the proportion of individuals in poor health.  The total
        number of individuals in each neighbourhood is then specified with
        the <b>denominator</b> option.
<p>
<p>
    (c) MCMC model options
<p>
    <b>logformulation</b> specifies a log formulation model for the level 1
        variance.
<p>
    <b>cc</b> specifies that the model is a non-hierarchical cross-classified model
        rather than a hierarchal model. In cross-classified models, the
        levels are often referred to as classifications.
<p>
    <b>msubscripts</b> uses multiple subscript notation.
<p>
    <b>corresiduals(</b><i>restype</i><b>)</b> specifies the correlation structure of the level 1
        random effects (i.e. the residual errors).
<p>
        <b>unstructured</b>, the default, is the most general structure; it
        estimates distinct variances for each residual error and distinct
        covariances for each residual error pair.
<p>
        <b>exchangeable</b> fits structured errors with a common correlation
        parameter and a common variance parameter.
<p>
        <b>ar1eqvars</b> fits AR1 errors with a common variance parameter.
<p>
        <b>eqcorrsindepvars</b> fits structured errors with a common correlation
        parameter and independent variance parameters.
<p>
        <b>ar1indepvars</b> fits AR1 errors with independent variance parameters.
<p>
    <b>me(</b><i>varlist</i><b>, variances(</b><i>numlist</i><b>))</b> specifies the subset of independent
        variables with measurement error.  The corresponding measurement
        error variances are specified in <b>variances(</b><i>numlist</i><b>)</b>.
<p>
    <b>priormatrix(</b><i>matrix</i><b>)</b> specifies informative priors for the fixed and random
        part parameters.
<p>
    <b>rppriors(</b><i>rppriors_spec</i><b>)</b> specifies prior distributions for the random part
        priors.  <b>uniform</b> specifies the uniform distribution.  <b>gamma(</b><i>a</i><b>,</b><i> b</i><b>)</b>
        specifies the gamma distribution.  The default <i>rppriors_spec</i> is
        <b>gamma(0.001,0.001)</b>.
<p>
    <b>savewinbugs(</b><i>savewinbugs_options</i><b>)</b> saves the specified model as a WinBUGS
        model.  The model can then be fitted in WinBUGS using the <b>winbugs</b>
        suite of commands if these are installed.
<p>
        <i>savewinbugs_options</i> are
<p>
            <b>model(</b><i>filename </i>[<b>,</b><i> replace</i>]<b>)</b> saves the model as a WinBUGS model in
                filename.txt
<p>
            <b>inits(</b><i>filename </i>[<b>,</b><i> replace</i>]<b>)</b> saves the initial values in WinBUGS
                format in filename.txt
<p>
            <b>data(</b><i>filename </i>[<b>,</b><i> replace</i>]<b>)</b> saves the data in WinBUGS format in
                filename.txt
<p>
            <b>nofit</b> do not fit the model in MLwiN
<p>
<p>
    (d) general model options
<p>
    <b>weights(</b><i>weights_options</i><b>)</b> specifies overall options for any sampling
        weights variables included in the model.  This option can only be
        specified if the user has specified the <b>weightvar</b> option at one or
        more levels.
<p>
        The <b>nostandardisation</b> option specifies that the level specific weight
        variables should not be standardised
<p>
        The <b>nofpsandwich</b> option specifies that sandwich estimates should not
        be used for the standard errors of the fixed part parameter estimates
        at any level
<p>
        The <b>norpsandwich</b> option specifies that sandwich estimates should not
        be used for the standard errors of the random part parameter
        estimates at any level
<p>
        See <i>Remarks on using sampling weights</i> below for more information.
<p>
    <b>constraints(</b><i>clist</i><b>)</b> specifies the constraint numbers for the constraints
        to be applied to the model.  Constraints are specified using the <b>[R]</b>
        <b>constraint</b> command.  Only linear constraints can be specified.  See
        <i>Examples</i> for an example of this option.
<p>
<p>
<a name="options_estimation"></a>        +------------+
    ----+ Estimation +-------------------------------------------------------
<p>
    (a) random part estimation options
<p>
    All options reported in this sub-section are specific to the level at
    which they are specified.
<p>
    <b>reset(</b><i>resetname</i><b>)</b> specifies the action to be taken when during estimation
        a variance parameter at a particular iteration is estimated to be
        negative.  <b>all</b> resets a negative variance to zero along with any
        associated covariances.  <b>variances</b> resets a negative variance to zero
        but not the associated covariances.  <b>none</b> ignores negative variances;
        no parameters are reset to zero.
<p>
<p>
    (b) discrete response estimation options
<p>
    <b>mql1</b>, the default, specifies that the model be fitted using a first order
        marginal quasi-likelihood linearization.  See <i>Remarks on</i>
        <i>quasilikelihood estimates: MQL1, MQL2, PQL1 and PQL2</i> below for more
        information.
<p>
    <b>mql2</b> specifies that the model be fitted using a second order marginal
        quasi-likelihood linearization.
<p>
    <b>pql1</b> specifies that the model be fitted using a first order penalised
        quasi-likelihood linearization.
<p>
    <b>pql2</b> specifies that the model be fitted using a second order penalised
        quasi-likelihood linearization.
<p>
<p>
    (c) MCMC estimation options
<p>
    <b>on</b> fits the specified model using default MCMC options.
<p>
    <b>burnin(</b><i>#</i><b>)</b> specifies the number of iterations for the burn-in period.  The
        default is <b>burnin(500)</b>.  This option specifies the number of
        iterations necessary for the MCMC to reach approximate stationary or,
        equivalently, to converge to a stationary distribution.  The required
        length of the burn-in period will depend on the initial values.
<p>
    <b>chain(</b><i>#</i><b>)</b> specifies the number of iterations for the monitoring chain
        period.  The default <b>is chain(5000)</b>.  This is the number of
        iterations, after the burn-in period, for which the chain is to be
        run.  Distributional summaries for the parameters are based on these
        iterations.  Parameter estimates are given by the means of these
        chains, while the standard errors are given by the standard deviation
        of these chains.
<p>
    <b>thinning(</b><i>#</i><b>)</b> stores every #-th iteration of the monitoring chains.  The
        default is <b>thinning(1)</b>.  Parameter means and standard deviations are
        based on the non-thinned monitoring chains.  All other MCMC summary
        statistics (e.g. ESS and 95% credible intervals) are based on the
        thinned monitoring chain.  The <b>or</b>, <b>irr</b>, <b>rrr</b>, <b>sd</b>, <b>correlation</b>, <b>mode</b>
        and <b>median</b> options also all only apply to the thinned monitoring
        chains.  For example, fitting a model for a monitoring chain length
        of 50,000 and setting thinning to 10 will result in 5,000 iterations
        being stored.  The parameter means and standard deviations will then
        be based on all 50,000 iterations, while the ESS's and 95% credible
        intervals will be based on the 5,000 stored iterations.
<p>
    <b>refresh(</b><i>#</i><b>)</b> refreshes the MLwiN equation window every # stored iterations.
        The default is <b>refresh(50)</b>.  When the <b>nopause</b> option is not used,
        refreshing the MLwiN equation window less frequently can speed up
        estimation time.
<p>
    <b>scale(</b><i>#</i><b>)</b> sets the scale factor.  The default is <b>scale(5.8)</b>.
<p>
    <b>noadaptation</b> prevents adaptation from being used.
<p>
    <b>acceptance(</b><i>#</i><b>)</b> sets the Metropolis Hastings acceptance rate.  The default
        is <b>acceptance(0.5)</b> and permissible values range from zero to one.
<p>
    <b>tolerance(</b><i>#</i><b>)</b> sets the tolerance rate used for adapting.  The default is
        <b>tolerance(0.1)</b> and permissible values range from zero to one.
<p>
    <b>cycles(</b><i>#</i><b>)</b> sets the number of Metropolis Hastings cycles per MCMC
        iteration.  The default is <b>cycles(1)</b>.  The higher # is, the more
        likely a new proposed parameter value will be accepted on each
        iteration.
<p>
    <b>femethod(</b><i>mcmc_method</i><b>)</b> specifies the MCMC method for estimating the fixed
        effects.  The default depends on the specified model.
<p>
        <b>gibbs</b> uses the Gibbs algorithm and is the default for continuous
        response models.
<p>
        <b>univariatemh</b> uses the univariate Metropolis Hastings algorithm and is
        the default for univariate discrete response models.
<p>
        <b>multivariatemh</b> uses the multivariate Metropolis Hastings algorithm
        and is the default for multivariate response models with at least one
        discrete response.
<p>
    <b>remethod(</b><i>mcmc_method</i><b>)</b> specifies the MCMC method for estimating the random
        effects.  The default depends on the specified model.  <i>mcmc_method</i> is
        defined under the <b>femethod(</b><i>mcmc_method</i><b>)</b> option.
<p>
    <b>levelonevarmethod(</b><i>mcmc_method</i><b>)</b> specifies the MCMC method for estimating
        the level 1 variance.  The default depends on the specified model.
        <i>mcmc_method</i> is defined under the <b>femethod(</b><i>mcmc_method</i><b>)</b> option.
<p>
    <b>higherlevelsvarmethod(</b><i>mcmc_method</i><b>)</b> specifies the MCMC method for
        estimating the level 2 and higher variances.  The default depends on
        the specified model. <i>mcmc_method</i> is defined under the
        <b>femethod(</b><i>mcmc_method</i><b>)</b> option.
<p>
    <b>smcmc</b> uses structured MCMC methods.
<p>
    <b>smvn</b> uses the structured multivariate normal (MVN) framework.
<p>
    <b>orthogonal</b> uses orthogonal parameterisation.  Note that Browne (2012)
        recommends to always specify this option for discrete response
        models.  There is little advantage to specifying this option for
        continuous response models as in these models the fixed effects are
        generally blocked updated.
<p>
    <b>hcentring(</b><i>#</i><b>)</b> uses hierarchical centring at level #.
<p>
    <b>seed(</b><i>#</i><b>)</b> specifies the initial value of the MCMC random number seed. The
        default is <b>seed(1)</b>.  <i>#</i> should be a positive integer.  Note that there
        are two random number seeds in MLwiN and therefore two seed options
        in <b>runmlwin</b>:  The IGLS random number seed and the MCMC random number
        seed.  In contrast to Stata commands, both seeds in MLwiN have
        default initial values.  That is, these seeds are the same every time
        you call <b>runmlwin</b>.  The only time you will therefore need to set the
        IGLS or M seeds is if you wish to replicate MLwiN analyses carried
        out when using MLwiN in the traditional point-and-click way.
<p>
<p>
    (d) General estimation options
<p>
    <b>igls</b>, the default, specifies that the model be fitted using iterative
        generalised least squares (equivalent to maximum likelihood).  See
        <i>Remarks on IGLS vs. RIGLS</i> below for more information.
<p>
    <b>rigls</b> specifies that the model be fitted using restrictive iterative
        generalised least squares (equivalent to maximum restricted
        likelihood, also referred to as residual maximum likelihood).
<p>
    <b>maxiterations(</b><i>#</i><b>)</b> specifies the maximum number of (R)IGLS iterations.  The
        default is <b>maxiterations(20)</b>.
<p>
    <b>tolerance(</b><i>#</i><b>)</b> specifies the convergence tolerance for the IGLS algorithm.
        The default is <b>tolerance(</b><i>2</i><b>)</b> as in a tolerance of 10e-2.  IGLS
        iterations will be halted once every parameter changes by a relative
        amount less than <i>#</i>.
<p>
    <b>seed(</b><i>#</i><b>)</b> specifies the initial value of the IGLS random number seed.  The
        default is <b>seed(</b><i>1</i><b>)</b>.  This option allows you to replicate your results
        if you use the <b>simulate(</b><i>newvar</i><b>)</b> option.  <i>#</i> should be a positive
        integer.  Note that there are two random number seeds in MLwiN and
        therefore two seed options in <b>runmlwin</b>:  The IGLS random number seed
        and the MCMC random number seed.  In contrast to Stata commands, both
        seeds in MLwiN have default initial values.  That is, these seeds are
        the same every time you call <b>runmlwin</b>.  The only time you will
        therefore need to set the IGLS or M seeds is if you wish to replicate
        MLwiN analyses carried out when using MLwiN in the traditional
        point-and-click way.
<p>
    <b>initsprevious</b> specifies that the parameter estimates from the previous
        model are used as the initial values.  This option is used:  (1) when
        building a series of increasingly complex models using IGLS; (2) when
        moving from MQL1 estimation to PQL2 estimation; (3) to specify
        initial values for MCMC estimation.  When the current model contains
        new parameters not specified in the previous model, new fixed part
        parameters are set to zero, random part variance parameters are set
        to one and random part covariances are set to zero.
<p>
        Note that when this option is used to specify initial values for
        fitting the model using the Metropolis Hastings algorithm in MCMC
        (i.e. for discrete response models), this option will also feed the
        parameter sampling variance-covariance values into the algorithm.
<p>
    <b>initsmodel(</b><i>name</i><b>)</b> specifies that the parameter estimates from the model
        results saved under <i>name</i> are used as the initial values.  See
        comments for <b>initsprevious</b>.
<p>
    <b>initsb(</b><i>matrix</i><b>)</b> specifies the parameter initial values vector.  See
        comments for <b>initsprevious</b>.
<p>
    <b>initsv(</b><i>matrix</i><b>)</b> specifies the parameter initial sampling
        variance-covariance values matrix.  Note this option is only relevant
        when fitting the model using the Metropolis Hastings algorithm in
        MCMC (i.e. for discrete response models).  See comments for
        <b>initsprevious</b>.
<p>
<p>
<a name="options_se_robust"></a>        +-----------+
    ----+ SE/Robust +--------------------------------------------------------
<p>
    <b>fpsandwich</b> specifies the robust or sandwich estimates for the fixed part
        standard errors.
<p>
    <b>rpsandwich</b> specifies the robust or sandwich estimates for the random part
        standard errors.
<p>
<p>
<a name="options_reporting"></a>        +-----------+
    ----+ Reporting +--------------------------------------------------------
<p>
    <b>level(</b><i>#</i><b>)</b> set confidence level (credible level if using MCMC); default is
        <b>level(95)</b>.
<p>
    <b>or</b> reports the fixed-effects coefficients transformed to odds ratios,
        i.e., exp(b) rather than b.  Standard errors and confidence intervals
        are similarly transformed.  This option affects how results are
        displayed, not how they are estimated.  <b>or</b> may only be specified when
        modelling binary responses when using the <b>binomial</b> distribution and
        logit link function or when modelling ordinal categorical responses
        using the <b>multinomial</b> distribution.  <b>or</b> may be specified at
        estimation or when replaying previously estimated results.
<p>
    <b>irr</b> reports the fixed-effects coefficients transformed to incidence-rate
        ratios, i.e., exp(b) rather than b.  Standard errors and confidence
        intervals are similarly transformed.  This option affects how results
        are displayed, not how they are estimated.  <b>irr</b> may only be specified
        when modelling count responses using the <b>poisson</b> or <b>nbinomial</b>
        distributions.  <b>irr</b> may be specified at estimation or when replaying
        previously estimated results.
<p>
    <b>rrr</b> reports the fixed-effects coefficients transformed to relative-risk
        ratios, i.e., exp(b) rather than b.  Standard errors and confidence
        intervals are similarly transformed.  This option affects how results
        are displayed, not how they are estimated.  <b>rrr</b> may only be specified
        when modelling nominal categorical responses using the <b>multinomial</b>
        distribution.  <b>rrr</b> may be specified at estimation or when replaying
        previously estimated results.
<p>
    <b>sd</b> shows random-effects variance parameter estimates as standard
        deviations.  Standard errors and confidence intervals are similarly
        transformed.  This option affects how results are displayed, not how
        they are estimated.  <b>sd</b> may be specified at estimation or when
        replaying previously estimated results.
<p>
    <b>correlations</b> shows random-effects covariance parameter estimates as
        correlations.  Standard errors and confidence intervals are similarly
        transformed.  This option affects how results are displayed, not how
        they are estimated.  <b>correlations</b> may be specified at estimation or
        when replaying previously estimated results.
<p>
    <b>noheader</b> suppresses the output header, either at estimation or upon
        replay.
<p>
    <b>nogroup</b> suppresses the display of group summary information (number of
        groups, average group size, minimum, and maximum) from the output
        header.  <b>nogroup</b> may be specified at estimation or when replaying
        previously estimated results.
<p>
    <b>nocontrast</b> suppresses the display of contrast summary information (number
        of contrasts, description of each contrast) from the output header.
        This option is only relevant for multinomial response models.
        <b>nocontrast</b> may be specified at estimation or when replaying
        previously estimated results.
<p>
    <b>nofetable</b> suppresses the fixed-effects table from the output, either at
        estimation or upon replay.
<p>
    <b>noretable</b> suppresses the random-effects table from the output, either at
        estimation or upon replay.
<p>
    <b>nodiagnostics</b> prevents MCMC diagnostics from being calculated.  This is a
        helpful option to specify if you are running a simulation study using
        MCMC estimation as the calculation of the MCMC diagnostics can take
        some time for models fitted to large data sets.  Note that specifying
        this option will not allow the <b>or</b>, <b>irr</b>, <b>rrr</b>, <b>sd</b>, <b>correlation</b>, <b>mode</b>
        and <b>median</b> options to be specified.  <b>nodiagnostics</b> may be specified
        at estimation or when replaying previously estimated results.
<p>
    <b>mode</b> reports the parameter estimates as the modes of the MCMC chains
        rather than the means.  <b>mode</b> may be specified at estimation or when
        replaying previously estimated results.
<p>
    <b>median</b> reports the parameter estimates as the medians of the MCMC chains
        rather than the means.  <b>median</b> may be specified at estimation or when
        replaying previously estimated results.
<p>
    <b>zratio</b> reports classical z-ratios and p-values (i.e. under the assumption
        that the chains are normally distributed) <b>zratio</b> may be specified at
        estimation or when replaying previously estimated results.
<p>
<p>
<a name="options_post_estimation"></a>        +-----------------+
    ----+ Post-estimation +--------------------------------------------------
<p>
    <b>simulate(</b><i>newvar</i><b>)</b> simulates a new response variable based on the estimated
        model parameters.  Make sure to specify the IGLS random number <b>seed</b>
        to be able to replicate the simulated responses.
<p>
    <b>residuals(</b><i>stub</i><b>*,</b><i> residuals_options</i><b>)</b> calculates posterior estimates of the
        residuals and their associated standard errors for all random effects
        specified at the given level.  Posterior estimates are also known as
        empirical Bayes estimates or best linear unbiased predictions (BLUPs)
        of the random effects.  <b>runmlwin</b> will name the residuals.  For
        example if there are three random effects terms in the model,
        <b>runmlwin</b> would name the residuals <i>stub0</i>, <i>stub1</i>, <i>stub2</i> and would name
        their associated standard errors as <i>stub0se</i>, <i>stub1se</i>, <i>stub2se</i>.
<p>
        The <b>variances</b> option calculates the posterior variances instead of
        the posterior standard errors.
<p>
        The <b>standardised</b>, <b>leverage</b>, <b>influence</b> and <b>deletion</b> options calculate
        standardised, leverage, influence and deletion residuals
        respectively.  The postfix for these four types are <i>std</i>, <i>lev</i>, <i>inf</i> and
        <i>del</i> respectively.  For example if there are two random effects terms
        in the model, <b>runmlwin</b> would name the standardised residuals
        <i>stub0std</i>, <i>stub1std</i> and <i>stub2std</i>.
<p>
        The <b>sampling</b> option calculates the sampling variance covariance
        matrix for the residuals.  For example if there are three random
        effects terms in the model, <b>runmlwin</b> would name the standardised
        residuals <i>stub0var</i>, <i>stub01cov</i>, <i>stub1var</i>, <i>stub02cov</i>, <i>stub12cov</i>,
        <i>stub2var</i>.
<p>
        The <b>norecode</b> option prevents residuals with values exceedingly close
        or equal to zero from being recoded to missing.
<p>
        The <b>reflate</b> option returns unshrunken residuals.
<p>
    <b>savechains(</b><i>filename </i>[<b>,</b><i> replace</i>]<b>)</b> saves the MCMC parameter estimates for
        each iteration in filename.dta.
<p>
    <b>imputeiterations(</b><i>numlist</i><b>)</b> imputes missing values at specified iterations.
        It is important to specify a sufficiently high number of iterations
        between imputations to reduce the correlation between the sets of
        imputed values.
<p>
    <b>imputesummaries</b> for each missing value, calculates the mean and the
        standard deviation of the chain for that missing value.
<p>
<p>
<a name="options_export"></a>        +--------+
    ----+ Export +-----------------------------------------------------------
<p>
    <b>viewmacro</b>view the MLwiN macro for the fitted model.  This option is
        useful if you wish to learn how to write your own MLwiN macros.
<p>
    <b>savemacro(</b><i>filename</i>[<b>,</b><i> replace</i>]<b>)</b> saves the MLwiN macro for the fitted
        model.  The <b>replace</b> option overwrites the MLwiN macro if it already
        exists.
<p>
    <b>saveworksheet(</b><i>filename</i>[<b>,</b><i> replace</i>]<b>)</b> saves the MLwiN worksheet for the
        fitted model.  The <b>replace</b> option overwrites the MLwiN worksheet if
        it already exists.
<p>
<p>
<a name="options_other"></a>        +-------+
    ----+ Other +------------------------------------------------------------
<p>
    <b>forcesort</b> forces the data sent to MLwiN to be sorted according to the
        model hierarchy.  We recommend that users sort their data manually
        using the <b>sort</b> command prior to using <b>runmlwin</b>.
<p>
    <b>nosort</b> prevents <b>runmlwin</b> from checking that the data are sorted according
        to the model hierarchy.  When this option is used <b>runmlwin</b> does not
        report the table summarizing groups and the <b>residuals()</b> and <b>fscores()</b>
        options are not allowed.
<p>
    <b>forcerecast</b> forces a recast of all variables saved as long or double to
        float.  forcerecast should be used with caution.  forcerecast is for
        those instances where you have a variable saved as a long or double
        but would now be satisfied to have the variable stored as a float,
        even though that would lead to a slight rounding of its values.  An
        important example of when this is inappropriate is when identifiers
        variables are saved as long or double.  A slight rounding of the
        values of identifiers will lead to a merging of units.
<p>
    <b>nodrop</b> prevents variables that do not appear in the model from being
        dropped prior to sending the data to MLwiN.
<p>
    <b>nomlwin</b> prevents MLwiN from being run.  When used in conjunction with the
        <b>viewmacro</b> option, the user can examine the MLwiN macro that <b>runmlwin</b>
        writes, without having to fit the associated model in MLwiN.
<p>
    <b>mlwinpath(</b><i>string</i><b>)</b> specifies the file address for mlwin.exe, including the
        file name.
<p>
        For example: <b>mlwinpath(C:\Program Files\MLwiN v2.26\i386\mlwin.exe)</b>.
<p>
    <b>mlwinscriptpath(</b><i>string</i><b>)</b> is an advanced option which specifies the file
        address for mlnscript.exe, including the file name.
<p>
        For example: <b>mlwinscriptpath(C:\Program Files\MLwiN</b>
        <b>v2.26\i386\mlnscript.exe)</b>.
<p>
        mlnscript.exe is a command line version of MLwiN, which only runs
        scripts.  Note, that runmlwin will only call mlnscript.exe when <b>batch</b>
        is specified.  See <i>Remarks on running runmlwin in batch mode</i> below
        for more information.
<p>
    <b>mlwinsettings(</b><i>mlwin_settings</i><b>)</b> manually overrides MLwiN's default
        settings.  The default behaviour is that <b>runmlwin</b> will examine the
        specified model and then automatically override MLwiN's default <b>size</b>,
        <b>levels</b>, <b>columns</b> and <b>variables</b> settings with model specific settings.
        However, a potential issue is that <b>runmlwin</b> typically overrides
        MLwiN's default settings with settings that are conservative (i.e.
        settings that are typically higher than the minimum required to fit
        the model).  Thus, <b>runmlwin</b> will assign more RAM to MLwiN than is
        strictly necessary.  Users who run into error messages relating to a
        shortage of RAM on their computer, may therefore wish to experiment
        with manually overriding these settings to attempt to get the model
        to fit.
<p>
        <i>mlwin_settings</i> are
<p>
            <b>size(</b><i>#</i><b>)</b> specifies the maximum worksheet size allowed in MLwiN
<p>
            <b>levels(</b><i>#</i><b>)</b> specifies the maximum number of levels allowed in MLwiN
<p>
            <b>columns(</b><i>#</i><b>)</b> specifies the maximum number of data columns allowed
                in MLwiN
<p>
            <b>variables(</b><i>#</i><b>)</b> specifies the maximum number of modelled variables
                allowed in MLwiN
<p>
            <b>tempmat</b> instructs MLwiN to use memory allocated to the worksheet
                to store temporary matrices
<p>
    <b>nopause</b> suppresses the two pause steps in MLwiN.  This option is very
        useful if you want to run a do-file containing a series of <b>runmlwin</b>
        models.  MLwiN will automatically launch and exit once each specified
        model has been fitted.  MLwiN will not display the Equations window,
        but estimation progress is indicated by the progress gauges in the
        bottom left hand corner of the MLwiN software.  See <i>Examples</i> for an
        example of this option.
<p>
    <b>batch</b> suppresses the two pause steps in MLwiN and prevents the MLwiN
        software from being displayed.  This option is very useful if you
        want to perform a simulation study.  MLwiN will automatically launch
        and exit once each specified model has been fitted, but this will not
        be visible to the user.  A limitation of this option is that there is
        no way of monitoring a model's estimation progress.  For example, it
        is not possible to see for how many iterations a model has been
        iterating for.
<p>
        This option can also be used in conjunction with running Stata in
        batch mode in an environment without an interactive session.
        Examples of this would be running Stata from a task scheduler (see
        http://www.stata.com/support/faqs/win/batch.html) or submitting jobs
        to a cluster.  When this option is used any error messages produced
        by MLwiN are displayed in Stata after the model is run.
<p>
        In addition, if you have used <b>mlwinscriptpath()</b> or the
        MLwiNScript_path <b>global</b> to specify the mlnscript.exe file address,
        then specifying <b>batch</b> will run the model using mlnscript.exe rather
        than mlwin.exe.  See <i>Remarks on running runmlwin in batch mode</i> below
        for more information.
<p>
<p>
<a name="remarks"></a><b><u>Remarks</u></b>
<p>
    Remarks are presented under the following headings:
<p>
    Remarks on alternative Stata commands for fitting multilevel models
    Remarks on downloading runmlwin
    Remarks on downloading runmlwin_manually
    Remarks on keeping runmlwin up-to-date
    Remarks on getting runmlwin working for the first time
    Remarks on running runmlwin in batch mode
    Remarks on how runmlwin works
    Remarks on estimation procedures in MLwiN: (R)IGLS and MCMC
    Remarks on IGLS vs. RIGLS
    Remarks on quasilikelihood estimates: MQL1, MQL2, PQL1 and PQL2
    Remarks on MCMC
    Remarks on Bayesian DIC
    Remarks on using sampling weights
    Remarks on using multiple membership weights
    Remarks on MLwiN estimation problems and error messages
<p>
<p>
<p>
<a name="alternative_commands"></a><b><u>Remarks on alternative Stata commands for fitting multilevel models</u></b>
<p>
    The multilevel models fitted by <b>runmlwin</b> are often considerably faster
    than those fitted by the Stata's <b>[XT] xtmixed</b>, <b>[XT] xtmelogit</b> and <b>[XT]</b>
    <b>xtmepoisson</b> commands.  The range of models which can be fitted by
    <b>runmlwin</b> is also much wider than those available through those commands.
    <b>runmlwin</b> also allows fast estimation on large data sets for many of the
    more complex multilevel models available through the user written <b>gllamm</b>
    command.  Rabe-Hesketh and Skrondal (2012) is an outstanding resource for
    readers wanting to first familiarise themselves with each of these
    pre-existing Stata commands.  The Stata manual help pages for these
    commands also provide much useful information.
<p>
<p>
<a name="downloading_runmlwin"></a><b><u>Remarks on downloading runmlwin</u></b>
<p>
    The recommended way to install <b>runmlwin</b> is to type the following from a
    net-aware version of Stata
<p>
        <b>. ssc install runmlwin</b>
<p>
    and this will install <b>runmlwin</b> from its official location on the
    Statistical Software Components (SSC) archive.
<p>
<p>
<a name="downloading_runmlwin_manually"></a><b><u>Remarks on downloading runmlwin manually</u></b>
<p>
    Some users will not be allowed to download Stata ado packages to their
    computer, for example students in computer labs.  For these users we
    recommend that IT support at their institutions install <b>runmlwin</b>
    centrally for them.  However, if this is not possible, then we recommend
    users manually change their default Stata ado package download location
    to one where they are allowed to save files.  Users then need to instruct
    Stata where on their computer this location is.  This process can be
    semi-automated by issuing the following five commands where users must
    change the directory path "C:\temp" to a path where they can save files.
<p>
        (1) Store the original PLUS directory path in the <b>global</b> macro
            sysdir_plus
<p>
        <b>. global sysdir_plus = c(sysdir_plus)</b>
<p>
        (2) Change the PLUS directory path to a directory where you can save
            files
<p>
        <b>. sysdir set PLUS "C:\temp"</b>
<p>
        (3) Install <b>runmlwin</b> to this new directory
<p>
        <b>. ssc install runmlwin</b>
<p>
        (4) Revert back to the original PLUS directory path
<p>
        <b>. sysdir set PLUS "$sysdir_plus"</b>
<p>
        (5) Add the <b>runmlwin</b> directory to the ado-file directory path
<p>
        <b>. adopath + "C:\temp"</b>
<p>
    Note, you will need to run the last command every time you open Stata.
    Advanced users may wish do this by inserting the command into the profile
    do-file profile.do.  See <b>profile</b>.
<p>
<p>
<a name="remarks_first_time"></a><b><u>Remarks on getting runmlwin working for the first time</u></b>
<p>
    In order to get <b>runmlwin</b> working, you must:
<p>
        (1) install the latest version of MLwiN on your computer;
<p>
        (2) set the full MLwiN path using <b>mlwinpath(</b><i>string</i><b>)</b> or a <b>global</b> macro
            called MLwiN_path.
<p>
    If you don't have the latest version of MLwiN, visit:
<p>
        http://www.bristol.ac.uk/cmm/software/mlwin.
<p>
    MLwiN is free for UK academics (thanks to support from the UK Economic
    and Social Research Council).  A fully unrestricted 30-day trial version
    is available for non-UK academics.
<p>
    Advanced users may wish to set the MLwiN path every time Stata is started
    by simply inserting the following line into the profile do-file
    profile.do.  See <b>profile</b>.
<p>
        <b>. global MLwiN_path "C:\Program Files\MLwiN v2.26\i386\mlwin.exe"</b>
<p>
    Where you must substitute the MLwiN path that is correct for your
    computer for the path given in quotes in the above example.
<p>
<p>
<a name="remarks_batch_mode"></a><b><u>Remarks on running runmlwin in batch mode</u></b>
<p>
Advanced users may wish to additionally specify the <b>mlwinscriptpath(</b><i>string</i><b>)</b> or 
&gt; a <b>global</b> macro called MLwiNScript_path in order to run <b>runmlwin</b> using <b>batch</b>.
The situations where this may be useful include:
<p>
        (1) Faster loading times/execution;
<p>
        (2) Fitting models to very large datasets (via the 64-bit version of
            mlnscript.exe);
<p>
        (3) Running <b>runmlwin</b> in environments where no graphical user
            interface (GUI) is available, for example when run as a scheduled
            task or on Unix (Linux or Mac OSX) type systems.
<p>
    Users may wish to set the MLwiN script path every time Stata is started
    by simply inserting the following line into the profile do-file
    profile.do.  See <b>profile</b>.
<p>
    32-bit users should point to the 32-bit version of mlnscript.exe.
<p>
        <b>. global MLwiNScript_path "C:\Program Files\MLwiN</b>
            <b>v2.26\i386\mlnscript.exe"</b>
<p>
    64-bit users should point to the 64-bit version of mlnscript.exe.
<p>
        <b>. global MLwiNScript_path "C:\Program Files (x86)\MLwiN</b>
            <b>v2.26\x64\mlnscript.exe"</b>
<p>
    Where in both cases you must substitute the MLwiN script path that is
    correct for your computer for the path given in quotes in the above
    example.
<p>
<p>
<a name="updating_runmlwin"></a><b><u>Remarks on keeping runmlwin up-to-date</u></b>
<p>
    We are constantly improving <b>runmlwin</b>. To check that you are using the
    latest version of <b>runmlwin</b>, type the following command:
<p>
        . adoupdate runmlwin
<p>
<p>
<a name="how_runmlwin_works"></a><b><u>Remarks on how runmlwin works</u></b>
<p>
    <b>runmlwin</b> carries out the following steps:
<p>
        (1) Writes an MLwiN macro for the specified multilevel model.
<p>
        (2) Opens MLwiN and runs the MLwiN macro.
<p>
        (3) Pauses MLwiN once the model is specified.  This allows the user
            to check that the model is specified as expected.  If the model
            is specified correctly, the user should click the "Resume macro"
            button (otherwise the user should click the "Abort macro" button
            to return control to Stata).
<p>
        (4) Fits the model in MLwiN.
<p>
        (5) Pauses MLwiN once the model has been fitted (i.e. converged).
            This allows the user to examine the model results. If the model
            has fitted correctly, the user should click the "Resume macro"
            button (otherwise the user should click the "Abort macro" button
            to return control to Stata).
<p>
        (6) Stores and displays the model results in Stata
<p>
    Note that advanced users can use the <b>nopause</b> option to suppress steps (3)
    and (5).  This is essential when running simulation studies.
<p>
<p>
<a name="estimation_procedures_in_MLwiN"></a><b><u>Remarks on estimation procedures in MLwiN: (R)IGLS and MCMC</u></b>
<p>
    MLwiN uses two principal estimation procedures:
<p>
        (1) Iterative Generalised Least Squares (IGLS) equivalent to maximum
            likelihood under normality and Restrictive Iterative Generalised
            Least Squares (RIGLS) which is formally equivalent to residual
            maximum likelihood (REML) under normality.  See <i>Remarks on IGLS</i>
            <i>vs. RIGLS</i> below for more information.
<p>
        (2) Markov Chain Monte Carlo (MCMC) estimation.  See <i>Remarks on MCMC</i>
            below for more information.
<p>
    In addition, for discrete response models fitted by (R)IGLS,
    quasilikelihood estimates are calculated.  See <i>Remarks on quasilikelihood</i>
    <i>estimates: MQL1, MQL2, PQL1 and PQL2</i> below for more information.
<p>
<p>
<a name="IGLS_vs_RIGLS"></a><b><u>Remarks on IGLS vs. RIGLS</u></b>
<p>
    <b>igls</b> and <b>rigls</b> will give almost identical results in models where the
    number of units at each level is high.  The methods give different
    results, particularly for the random part parameters, when the number of
    units at a given level are few.  For example, the <b>rigls</b> estimate for the
    level 2 variance in a two-level normal response model will be larger than
    the <b>igls</b> estimate when there are few level 2 units.
<p>
<p>
<a name="quasilikelihood_estimates"></a><b><u>Remarks on quasilikelihood estimates: MQL1, MQL2, PQL1 and PQL2</u></b>
<p>
    <b>mql1</b>, <b>mql2</b>, <b>pql1</b> and <b>pql2</b> specify the linearization technique for fitting
    discrete response models by (R)IGLS.  All four quasilikelihood methods
    are approximate: <b>pql2</b> is the most accurate but the least stable and the
    slowest to converge, <b>mql1</b> is the least accurate but the most stable and
    fastest to converge.  We recommend that model exploration is conducted
    using <b>mql1</b>.  For any final model, we recommend fitting the model using
    <b>pql2</b> (or preferably MCMC) as a two stage process.  First fit the model
    using <b>mql1</b>, then refit the model using <b>pql2</b> where the <b>initsprevious</b>
    option (or <b>initsmodel(</b><i>name</i><b>)</b> or initsb(matrix)) is specified to use the
    <b>mql1</b> parameter estimates as the starting values for fitting the model
    using <b>pql2</b>.
<p>
<p>
<a name="MCMC"></a><b><u>Remarks on MCMC</u></b>
<p>
    Markov Chain Monte Carlo (MCMC) methods are Bayesian estimation
    techniques which can be used to estimate multilevel models.
<p>
    MCMC works by drawing a random sample of values for each parameter from
    its probability distribution.  The mean and standard deviation of each
    random sample gives the point estimate and standard error for that
    parameter.
<p>
    We start by specifying the model and our prior knowledge for each
    parameter (we nearly always specify that we have no knowledge!).  Next we
    specify initial values for the model parameters (nearly always the IGLS
    estimates).  We then run the MCMC algorithm until each parameter
    distribution has settled down to its stationary distribution.  (i.e. the
    burnin period when the chains are converging to their posterior
    distribution).  We then run the MCMC algorithm for a further period (the
    monitoring period) in order to store a monitoring chain for each
    parameter.  Point estimates and standard errors are given by the means
    and standard deviations of these monitoring chains.
<p>
    An important aspect of MCMC is specifying initial values.  Users can
    specify that the initial values are the parameter estimates from the
    previous model, <b>initsprevious</b>.  Alternatively, they can specify that the
    initial values are the parameter estimates from some other previously
    stored model, <b>initsmodel(</b><i>name</i><b>)</b>.  Or they can even manually specify any
    set of initial values they like, <b>initsb(</b><i>matrix</i><b>)</b>.
<p>
    A second important aspect of MCMC is the prior knowledge (i.e. prior
    distribution) that we specify for each parameter.  By default MLwiN sets
    diffuse or uninformative priors, and these can be used to approximate
    maximum likelihood estimation.  Users can specify informative priors
    using the <b>priormatrix(</b><i>matrix</i><b>)</b> and <b>rppriors(</b><i>rppriors_spec</i><b>)</b> options.
<p>
    We recommend users seeking further information, examples and references,
    to consult the comprehensive MLwiN MCMC manual by Browne (2012) and
    additionally the help system within MLwiN.  The MLwiN MCMC manual also
    gives lengthier explanations for all MCMC options implemented in
    <b>runmlwin</b>.
<p>
<p>
<a name="Bayesian_DIC"></a><b><u>Remarks on Bayesian DIC</u></b>
<p>
    The Bayesian Deviance Information Criterion (DIC) is an MCMC penalised
    goodness of fit measure.  It is equivalent to the Akaike Information
    Criterion (AIC) used in maximum likelihood estimation.
<p>
    The AIC is given by
<p>
        AIC = -2*logL + 2k = Deviance + 2k
<p>
    where
<p>
        L is the maximized value of the likelihood function (i.e. the
        likelihood evaluated at the maximum likelihood point estimates of the
        model parameters)
<p>
        k is the number of model parameters
<p>
    In MCMC estimation, the DIC statistic has an analogous definition:
<p>
        DIC = Deviance + 2*p_d
<p>
    where:
<p>
        The Deviance is evaluated at the posterior means of the model
        parameters
<p>
        p_d is the effective number of model parameters
<p>
    The four statistics reported in the standard <b>runmlwin</b> model output are:
<p>
    Dbar:  The average goodness of fit of the model over the iterations.
<p>
    D(thetabar):  The goodness of fit of the model evaluated at the posterior
    means of the model parameters.
<p>
    pD:  The effective number of parameters summarises the complexity of the
    model: pD = Dbar - D(thetabar).
<p>
    DIC:  The statistic of interest: DIC = Dbar + pD = D(thetabar) + 2pD.
<p>
<p>
<a name="sampling_weights"></a><b><u>Remarks on using sampling weights</u></b>
<p>
    Sampling weights are only available for estimation using (R)IGLS.
    Sampling weights should therefore only be used for continuous response
    variables as the quasilikelihood procedures available for (R)IGLS
    estimation of discrete response variables are only approximate.  See
    <i>Remarks on quasilikelihood estimates: MQL1, MQL2, PQL1 and PQL2</i> above for
    more information.  We recommend that sampling weights should always be
    standardised and that sandwich estimates should always be used for the
    sampling estimates of both fixed part and random part parameter
    estimates.  These recommendations are implemented in the default settings
    for <b>runmlwin</b>, but can be changed using the <b>weights</b> option.  Note also
    that if level 2 weights are specified then MLwiN requires the level 1
    weights to be conditional level 1 weights.
<p>
<p>
<a name="mm_weights"></a><b><u>Remarks on using multiple membership weights</u></b>
<p>
    Consider a two-level multiple membership model of students (level 1) who
    are multiple members of schools (level 2).  In this example, the number
    of multiple membership unit identifier variables specified should equal
    the maximum number of schools attended by any given student.  Suppose
    this maximum number of schools attended is three, then there should be
    three multiple membership unit identifier variables.  Intuitively, these
    can be thought of as corresponding to the first school attended, the
    second school attended and the third school attended, respectively.
    However, the order in which the (potentially) three school IDs appears is
    irrelevant other than it must correspond to the ordering of the
    associated multiple membership weight variables.
<p>
    For students who attend three schools, all <i>three</i> of the multiple
    membership unit identifier variables should take different non-zero
    values and these values should give the school IDs of the <i>three</i> different
    schools attended.
<p>
    For students who attend two schools, <i>two</i> of the three multiple membership
    unit identifier variables should take non-zero values and these values
    should give the school IDs of the <i>two</i> different schools attended.  The
    third multiple membership unit identifier variable must take the value
    zero to indicate that no third school was attended.  No other value than
    zero (not even a missing value) is permitted to indicate that a third
    school was not attended.  A consequence of this is that zero is the only
    invalid school identifier value; no school in the data should have a zero
    value.
<p>
    Finally, for students who attend a single school, one of the three
    multiple membership unit identifier variables should take a non-zero
    value and this value should give the school ID of the <i>single</i> school
    attended.  The second and third multiple membership unit identifier
    variables should take zero values to indicate that no second or third
    schools were attended.
<p>
<p>
<a name="MLwiN_estimation_problems_and_er"></a><b><u>Remarks on MLwiN estimation problems and error messages</u></b>
<p>
    Multilevel models are complex, often involving multiple sets of random
    effects at multiple levels.  Users may sometimes run into MLwiN error
    messages.  Help for a range of common MLwiN error messages are provided
    on the MLwiN website:
<p>
        http://www.bristol.ac.uk/cmm/software/support/support-faqs/errors.htm
            &gt; l#errormessage
<p>
<p>
<a name="examples"></a>        <b><u>Examples</u></b>
<p>
    IMPORTANT.  The following examples will only work on your computer once
    you have installed MLwiN and once you have told <b>runmlwin</b> what the
    mlwin.exe file address is.  See <i>Remarks on installing runmlwin</i> above for
    more information.
<p>
    <b>(a) Continuous response models</b>
<p>
    Two-level models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/tutorial, clear</b>
<p>
    Two-level random-intercept model, analogous to xtreg (fitted using IGLS)
    <i>(See Section </i><i>2.5</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin normexam cons standlrt, level2(school: cons)</b>
            <b>level1(student: cons) nopause</b>
<p>
    Two-level random-intercept and random-slope (coefficient) model (fitted
    using IGLS)
    <i>(See Section </i><i>4.4</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin normexam cons standlrt, level2 (school: cons standlrt)</b>
            <b>level1 (student: cons) nopause</b>
<p>
    Refit the model, where this time we additionally calculate the level 2
    residuals (fitted using IGLS)
    <i>(See Section </i><i>4.4</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin normexam cons standlrt, level2 (school: cons standlrt,</b>
            <b>residuals(u)) level1 (student: cons) nopause</b>
<p>
    Two-level random-intercept and random-slope (coefficient) model with a
    complex level 1 variance function (fitted using IGLS)
    <i>(See Section </i><i>7.3</i><i> of the MLwiN User Manual)</i>
        <b>. matrix A = (1,1,0,0,0,1)</b>
        <b>. runmlwin normexam cons standlrt girl,</b><b> </b><b>level2(school: cons standlrt)</b>
            <b>level1(student: cons standlrt girl, elements(A)) nopause</b>
<p>
    Two-level random-intercept and random-slope (coefficient) model using
    MCMC (where we first fit the model using IGLS to obtain initial values
    for the MCMC chains)
    <i>(See Section </i><i>6.0</i><i> of the MLwiN MCMC Manual)</i>
        <b>. runmlwin normexam cons standlrt, level2 (school: cons standlrt)</b>
            <b>level1 (student: cons) nopause</b>
        <b>. runmlwin normexam cons standlrt,</b><b> </b><b>level2 (school: cons standlrt)</b>
            <b>level1 (student: cons) mcmc(on) initsprevious nopause</b>
<p>
    Multivariate response models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/gcsemv1, clear</b>
<p>
    Random-intercept bivariate response model (fitted using IGLS)
    <i>(See Section </i><i>14.3</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin (written cons female, eq(1))</b><b> </b><b>(csework cons female,</b><b> </b><b>eq(2)),</b>
            <b>level2(school: (cons, eq(1)) (cons, eq(2))) level1(student:</b><b>  </b>
            <b>(cons, eq(1)) (cons, eq(2))) nopause</b>
<p>
    Cross-classified models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/xc, clear</b>
<p>
    Two-way cross-classified model (fitted using MCMC where starting values
    for the MCMC chains are manually specified by the user)
    <i>(See Section </i><i>15.4</i><i> of the MLwiN MCMC Manual)</i>
        <b>. matrix b = (0,.33,.33,.33)</b>
        <b>. runmlwin attain cons, level3(sid: cons) level2(pid: cons)</b>
            <b>level1(pupil: cons) mcmc(cc) initsb(b) nopause</b>
<p>
<p>
    <b>(b) Discrete response models</b>
<p>
    Binary response multilevel models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/bang, clear</b>
        <b>. generate lc1 = (lc==1)</b>
        <b>. generate lc2 = (lc==2)</b>
        <b>. generate lc3plus = (lc&gt;=3)</b>
<p>
    Two-level random intercepts logit model (fitted using IGLS MQL1)
    <i>(See Section </i><i>9.3</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin use cons lc1 lc2 lc3plus age, level2(district: cons)</b>
            <b>level1(woman)</b><b> </b><b>discrete(distribution(binomial) link(logit)</b>
            <b>denominator(cons)) nopause</b>
<p>
    Two-level random intercepts logit model (fitted using IGLS PQl2 where
    IGLS MQL1 estimates from previous model are used as initial values)
    <i>(See Section </i><i>9.3</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin use cons lc1 lc2 lc3plus age</b><b> </b><b>, level2(district: cons)</b>
            <b>level1(woman) discrete(distribution(binomial) link(logit)</b>
            <b>denominator(cons) pql2) initsprevious nopause</b>
<p>
    Two-level random intercepts probit model (fitted using IGLS PQL2)
        <b>. runmlwin use cons lc1 lc2 lc3plus age,</b><b> </b><b>level2(district: cons)</b>
            <b>level1(woman)</b><b> </b><b>discrete(distribution(binomial) link(probit)</b>
            <b>denominator(cons) pql2) nopause</b>
<p>
    Two-level random intercepts probit model (fitted using MCMC where IGLS
    PQL2 estimates from previous model are used as initial values)
    <i>(See Section </i><i>10.2</i><i> of the MLwiN MCMC Manual)</i>
        <b>. runmlwin use cons lc1 lc2 lc3plus age,</b><b> </b><b>level2(district: cons)</b>
            <b>level1(woman)</b><b> </b><b>discrete(distribution(binomial) link(probit)</b>
            <b>denominator(cons)) mcmc(on) initsprevious nopause</b>
<p>
<p>
    Unordered multinomial response models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/bang, clear</b>
        <b>. generate lc1 = (lc==1)</b>
        <b>. generate lc2 = (lc==2)</b>
        <b>. generate lc3plus = (lc&gt;=3)</b>
<p>
    Two-level random intercepts unordered multinomial model (fitted using
    IGLS MQL1)
    <i>(See Section </i><i>10.5</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin use4 cons lc1 lc2 lc3plus, level2(district: cons)</b>
            <b>level1(woman) discrete(distribution(multinomial) link(mlogit)</b>
            <b>denom(cons)</b><b> </b><b>basecategory(4)) nopause</b>
<p>
    Ordered multinomial response models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/alevchem, clear</b>
        <b>. egen school = group(lea estab)</b>
        <b>. generate gcseav = gcse_tot/gcse_no</b>
        <b>. egen gcseav_rank = rank(gcseav)</b>
        <b>. generate gcseav_uniform = (gcseav_rank - 0.5)/_N</b>
        <b>. generate gcseavnormal = invnorm(gcseav_uniform)</b>
<p>
    Two-level random intercepts ordered multinomial model with common
    coefficients for predictor variable gcseavnormal (fitted using IGLS PQL2)
    <i>(See Section </i><i>11.4</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin a_point cons (gcseavnormal, contrast(1/5)), level2(school:</b>
            <b>(cons, contrast(1/5))) level1(pupil)</b>
            <b>discrete(distribution(multinomial) link(ologit) denom(cons)</b>
            <b>base(6) pql2) nopause</b>
        <i>(</i><i>Click to run</i><i>)</i>
<p>
    Two-level random intercepts ordered multinomial model with separate
    coefficients for predictor variable gcseavnormal (fitted using IGLS PQL2)
    <i>(See Section </i><i>12.3</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin a_point cons gcseavnormal,</b><b> </b><b>level2(school: (cons,</b>
            <b>contrast(1/5))) level1(pupil) discrete(distribution(multinomial)</b>
            <b>link(ologit) denom (cons) base(6) pql2) nopause</b>
<p>
    Count data model
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/mmmec, clear</b>
        <b>. generate lnexpected = ln(exp)</b>
<p>
    Three-level random intercepts Poisson model (fitted using RIGLS MQL1)
    <i>(See Section </i><i>12.3</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin obs cons uvbi, level3(nation: cons)</b><b> </b><b>level2(region: cons)</b>
            <b>level1(county)</b><b> </b><b>discrete(distribution(poisson) offset(lnexpected))</b>
            <b>rigls nopause</b>
<p>
    Three-level random intercepts Poisson model (fitted using MCMC where IGLS
    MQL1 estimates from previous model are used as initial values)
    <i>(See Section </i><i>11.3</i><i> of the MLwiN MCMC Manual)</i>
        <b>. runmlwin obs cons uvbi, level3(nation: cons) level2(region: cons)</b>
            <b>level1(county) discrete(distribution(poisson) offset(lnexpected))</b>
            <b>mcmc(burnin(5000) chain(50000) refresh(500)) initsprevious</b>
            <b>nopause</b>
        <i>(</i><i>Click to run</i><i>)</i>
<p>
<p>
    <b>(c) Multivariate response models</b>
<p>
    Multivariate discrete and mixed response models
    ---------------------------------------------------------------------------
    Setup
        <b>. use http://www.bristol.ac.uk/cmm/media/runmlwin/tutorial, clear</b>
        <b>. generate binexam = (normexam&gt;0)</b>
        <b>. generate binlrt = (standlrt&gt;0)</b>
<p>
    Two-level bivariate binary response probit model (fitted using IGLS MQL1)
    <i>(See Section </i><i>14.5</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin (binexam cons, equation(1))</b><b> </b><b>(binlrt cons, equation(2)),</b>
            <b>level1(student:)</b><b> </b><b>discrete(distribution(binomial binomial)</b>
            <b>link(probit) denominator(cons cons)) nosort nopause</b>
<p>
    Two-level mixed bivariate continuous and binary response probit model
    (fitted using IGLS MQL1)
    <i>(See Section </i><i>14.5</i><i> of the MLwiN User Manual)</i>
        <b>. runmlwin (normexam cons, equation(1)) (binlrt cons, equation(2)),</b>
            <b>level1(student:(cons, equation(1)) (cons, equation(2)))</b>
            <b>discrete(distribution(normal binomial) link(probit)</b>
            <b>denominator(cons cons)) nosort nopause</b>
        <i>(</i><i>Click to run</i><i>)</i>
<p>
    ---------------------------------------------------------------------------
<p>
    A full range of <b>runmlwin</b> examples using both (R)IGLS and MCMC is
    available at:
<p>
        http://www.bristol.ac.uk/cmm/software/runmlwin/examples/
<p>
    These include do-files which allow you to replicate all the analyses
    reported in the MLwiN User Manual (Rasbash et al., 2012) and the MCMC
    MLwiN Manual (Browne, 2012).
<p>
    The log files for these two manuals are presented below.
<p>
    MLwiN User Manual
        1 - Introducing Multilevel Models
        2 - Introduction to Multilevel Modelling
        3 - Residuals
        4 - Random Intercept and Random Slope Models
        5 - Graphical Procedures for Exploring the Model
        6 - Contextual Effects
        7 - Modelling the Variance as a Function of Explanatory Variables
        8 - Getting Started with your Data
        9 - Logistic Models for Binary and Binomial Responses
        10 - Multinomial Logistic Models for Unordered Categorical Responses
        11 - Fitting an Ordered Category Response Model
        12 - Modelling Count Data
        13 - Fitting Models to Repeated Measures Data
        14 - Multivariate Response Models
        15 - Diagnostics for Multilevel Models
        16 - An Introduction to Simulation Methods of Estimation
        17 - Bootstrap Estimation
        18 - Modelling Cross-classified Data
        19 - Multiple Membership Models
<p>
    MLwiN MCMC Manual
        1 - Introduction to MCMC Estimation and Bayesian Modelling
        2 - Single Level Normal Response Modelling
        3 - Variance Components Models
        4 - Other Features of Variance Components Models
        5 - Prior Distributions, Starting Values and Random Number Seeds
        6 - Random Slopes Regression Models
        7 - Using the WinBUGS Interface in MLwiN
        8 - Running a Simulation Study in MLwiN
        9 - Modelling Complex Variance at Level 1 - Heteroscedasticity
        10 - Modelling Binary Responses
        11 - Poisson Response Modelling
        12 - Unordered Categorical Responses
        13 - Ordered Categorical Responses
        14 - Adjusting for Measurement Errors in Predictor Variables
        15 - Cross Classified Models
        16 - Multiple Membership Models
        17 - Modelling Spatial Data
        18 - Multivariate Normal Response Models and Missing Data
        19 - Mixed Response Models and Correlated Residuals
        20 - Multilevel Factor Analysis Modelling
        21 - Using Structured MCMC
        22 - Using the Structured MVN framework for models
        23 - Using Orthogonal fixed effect vectors
        24 - Parameter expansion
        25 - Hierarchical Centring
 
 
<a name="saved_results"></a><b><u>Saved results</u></b>
<p>
    <b>runmlwin</b> saves the following in e():
<p>
    Scalars       
      <b>e(numlevels)</b>       number of levels
      <b>e(N)</b>               number of observations
      <b>e(k)</b>               number of parameters
      <b>e(k_f)</b>             number of FE parameters
      <b>e(k_r)</b>             number of RE parameters
      <b>e(extrabinomial)</b>   1 if extra binomial variation is used, 0 otherwise
      <b>e(ll)</b>              log (restricted) likelihood
      <b>e(deviance)</b>        deviance (= -22*e(ll))
      <b>e(iterations)</b>      number of iterations
      <b>e(converged)</b>       1 if converged, 0 otherwise
      <b>e(time)</b>            estimation time (seconds)
      <b>e(burnin)</b>          number of burn-in iterations
      <b>e(chain)</b>           number of chain iterations
      <b>e(thinning)</b>        frequency with which successive values in the chain
                           are stored
      <b>e(mcmcnofit)</b>       1 if MCMC model is not fitted, 0 otherwise
      <b>e(mcmcdiagnostics)</b> 1 if MCMC diagnostics have been calculated, 0
                           otherwise
      <b>e(dbar)</b>            average deviance across the chain iterations
      <b>e(dthetabar)</b>       deviance at the mean values of the model parameters
      <b>e(pd)</b>              effective number of parameters
      <b>e(dic)</b>             Bayesian deviance information criterion
      <b>e(size)</b>            maximum worksheet size allowed in MLwiN
      <b>e(maxlevels)</b>       maximum number of levels allowed in MLwiN
      <b>e(columns)</b>         maximum number of data columns allowed in MLwiN
      <b>e(variables)</b>       maximum number of modelled variables allowed in
                           MLwiN
      <b>e(tempmat)</b>         1 if use memory allocated to the worksheet to store
                           temporary matrices in MLwiN, 0 otherwise
<p>
    Macros        
      <b>e(cmd)</b>             runmlwin
      <b>e(version)</b>         runmlwin version
      <b>e(cmdline)</b>         command as typed
      <b>e(title)</b>           title in estimation output
      <b>e(depvars)</b>         name(s) of dependent variable(s)
      <b>e(distribution)</b>    distribution(s)
      <b>e(link)</b>            link function
      <b>e(denominators)</b>    denominator(s)
      <b>e(basecategory)</b>    the value of <i>depvar</i> to be treated as the base
                           category
      <b>e(respcategories)</b>  the values of <i>depvar</i>
      <b>e(offsets)</b>         offset(s)
      <b>e(ivars)</b>           grouping variables
      <b>e(level1id)</b>        level 1 identifier variable
      <b>e(weightvar)</b>       sampling weights variables
      <b>e(weighttype)</b>      sampling weights types
      <b>e(method)</b>          estimation method: IGLS, RIGLS or MCMC
      <b>e(linearization)</b>   linearization technique: MQL1, MQL2, PQL1 or PQL2
      <b>e(properties)</b>      b V
      <b>e(chains)</b>          MCMC chains for all parameters
<p>
    Matrices      
      <b>e(b)</b>               coefficient vector
      <b>e(V)</b>               variance-covariance matrix of the estimators
      <b>e(N_g)</b>             group counts
      <b>e(g_min)</b>           group size minimum
      <b>e(g_avg)</b>           group size averages
      <b>e(g_max)</b>           group size maximums
      <b>e(RP2)</b>             level 2 matrix of random part parameters
      <b>e(RP1)</b>             level 1 matrix of random part parameters
      <b>e(P)</b>               priors
      <b>e(sd)</b>              standard deviation for each chain
      <b>e(mode)</b>            mode for each chain
      <b>e(meanmcse)</b>        Monte Carlo standard error (MCSE) evaluated at the
                           mean of each chain
      <b>e(ess)</b>             effective sample size (ESS) for each chain
      <b>e(quantiles)</b>       quantiles for each chain
      <b>e(lb)</b>              lower credible interval bound for each chain
      <b>e(ub)</b>              upper credible interval bound for each chain
      <b>e(KD1)</b>             kernel density for each chain
      <b>e(KD2)</b>             kernel density for each chain
      <b>e(ACF)</b>             autocorrelation function (ACF) for each chain
      <b>e(PACF)</b>            partial autocorrelation function (PACF) for each
                           chain
      <b>e(MCSE)</b>            Monte Carlo standard error (MCSE) for each chain
      <b>e(bd)</b>              Brooks-Draper diagnostic for mean of each chain
      <b>e(rl1)</b>             Raftery-Lewis diagnostic for each 2.5th quantile of
                           each chain
      <b>e(rl2)</b>             Raftery-Lewis diagnostic for each 97.5th quantile of
                           each chain
      <b>e(pvalmean)</b>        one-sided Bayesian p-value for each chain where
                           chain mean is treated as parameter estimate
      <b>e(pvalmode)</b>        one-sided Bayesian p-value for each chain where
                           chain mode is treated as parameter estimate
      <b>e(pvalmedian)</b>      one-sided Bayesian p-value for each chain where
                           chain median is treated as parameter estimate
<p>
    Functions     
      <b>e(sample)</b>          marks estimation sample
<p>
<p>
<a name="about_cmm"></a><b><u>About the Centre for Multilevel Modelling</u></b>
<p>
    The MLwiN software is developed at the Centre for Multilevel Modelling.
    The Centre was established in 1986, and has been supported largely by
    project grants from the UK Economic and Social Research Council.  The
    Centre has been based at the University of Bristol since 2005.
<p>
    The Centres website:
<p>
        http://www.bristol.ac.uk/cmm
<p>
    contains much of interest, including new developments, and details of
    courses and workshops.  This website also contains the latest information
    about the MLwiN software, including upgrade information, maintenance
    downloads, and documentation.
<p>
    The Centre also runs a free online multilevel modelling course:
<p>
        http://www.bristol.ac.uk/cmm/learning/course.html
<p>
    which contains modules starting from an introduction to quantitative
    research progressing to multilevel modelling of continuous and
    categorical data.  Modules include a description of concepts and models
    and instructions of how to carry out analyses in MLwiN, Stata and R.
    There is a also a user forum, videos and interactive quiz questions for
    learners self-assessment.
<p>
<p>
<a name="citation"></a><b><u>How to cite </u></b><b><u>runmlwin</u></b><b><u> and MLwiN</u></b>
<p>
    <b>runmlwin</b> is not an official Stata command.  It is a free contribution to
    the research community, like a paper.  Please cite it as such:
<p>
        Leckie, G. and Charlton, C. 2011. <b>runmlwin</b>: Stata module for fitting
            multilevel models in the MLwiN software package. Centre for
            Multilevel Modelling, University of Bristol.
<p>
    Similarly, please also cite the MLwiN software:
<p>
        Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B.
            2009. MLwiN Version 2.1. Centre for Multilevel Modelling,
            University of Bristol.
<p>
    For models fitted using MCMC estimation, we ask that you additionally
    cite:
<p>
        Browne, W.J. 2012. MCMC Estimation in MLwiN, v2.26. Centre for
            Multilevel Modelling, University of Bristol.
<p>
<p>
<a name="user_forum"></a><b><u>The </u></b><b><u>runmlwin</u></b><b><u> user forum</u></b>
<p>
    Please use the <b>runmlwin</b> user forum to post any questions you have about
    <b>runmlwin</b>.  We will try to answer your questions as quickly as possible,
    but where you know the answer to another user's question please also
    reply to them!
<p>
        http://www.cmm.bristol.ac.uk/forum/
<p>
<p>
<a name="authors"></a><b><u>Authors</u></b>
<p>
    George Leckie
    Centre for Multilevel Modelling
    University of Bristol
    g.leckie@bristol.ac.uk
<p>
<p>
    Chris Charlton
    Centre for Multilevel Modelling
    University of Bristol
<p>
<p>
<a name="acknowledgments"></a><b><u>Acknowledgments</u></b>
<p>
    We are very grateful to colleagues at the Centre for Multilevel Modelling
    and the University of Bristol for their useful comments.
<p>
    The development of this command was funded under the LEMMA project, a
    node of the UK Economic and Social Research Council's National Centre for
    Research Methods (grant number RES-576-25-0003).
<p>
<p>
<a name="disclaimer"></a><b><u>Disclaimer</u></b>
<p>
    <b>runmlwin</b> comes with no warranty.  We recommend that users check their
    results with those obtained through operating MLwiN by its graphical user
    interface.  Users are also encouraged to check their results with those
    produced by other statistical software packages.
<p>
<p>
<a name="references"></a><b><u>References</u></b>
<p>
    Browne, W.J. 2012. MCMC Estimation in MLwiN, v2.26.  Centre for
        Multilevel Modelling, University of Bristol.
        http://www.bristol.ac.uk/cmm/software/mlwin/download/manuals.html
<p>
    Rabe-Hesketh, S. and Skrondal, A. 2012. Multilevel and Longitudinal
        Modeling using Stata (Third Edition). College Station, TX: Stata
        Press.
<p>
    Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. 2012. A Users
        Guide to MLwiN, v2.26. Centre for Multilevel Modelling, University of
        Bristol.
        http://www.bristol.ac.uk/cmm/software/mlwin/download/manuals.html
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[XT] xtmixed</b> <b>[XT] xtmelogit</b> <b>[XT] xtmepoisson</b> <b>[XT] xtreg</b>
<p>
    Online:  <b>[XT] xtmixed</b>, <b>[XT] xtmelogit</b>, <b>[XT] xtmepoisson</b>, <b>[XT] xtreg</b>, 
             <b>mcmcsum</b>, <b>savewsz</b>, <b>reffadjust</b>, <b>gllamm</b>
<p>
</pre>