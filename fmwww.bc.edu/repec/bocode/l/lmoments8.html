<pre>
-------------------------------------------------------------------------------
help for <b>lmoments8</b>
-------------------------------------------------------------------------------
<p>
<b><u>L-moments and derived statistics</u></b>
<p>
        <b>lmoments8</b> [<i>varlist</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>all</u></b><b>obs</b> <b><u>d</u></b><b>etail</b>
                 <b><u>m</u></b><b>atname(</b><i>matrix_name</i><b>)</b> <i>tabdisp_options</i> <b>variablenames</b>
                 <b>se</b>[<b>(</b><i>matrix_list_options</i><b>)</b>] ]
<p>
        <b>lmoments8</b> <i>varname</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>all</u></b><b>obs</b> <b>by(</b><i>varlist</i><b>)</b> <b><u>d</u></b><b>etail</b>
                 <b><u>g</u></b><b>enerate(</b><i>specification</i><b>)</b> <b><u>m</u></b><b>atname(</b><i>matrix_name</i><b>)</b> <i>tabdisp_options</i>
                 <b>se</b>[<b>(</b><i>matrix_list_options</i><b>)</b>] ]
<p>
<p>
    <b>by ... :</b> may also be used with <b>lmoments8</b>:  see help on by.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>lmoments8</b> calculates L-moments and derived statistics for a <i>varlist</i>. Any
    string variables in <i>varlist</i> are ignored. Specifically, the first four
    L-moments and the derived statistics t, t_3 and t_4 are calculated for
    each variable in <i>varlist</i>.  Stata 8 is required. At the time of writing,
    <b>lmoments</b> is the latest version of this program: it requires Stata 9.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    Denote by X(j:n) the j th smallest observation from a sample of size n
    from a variable X and by E the expectation operator.
<p>
    The first four L-moments are defined by
<p>
        E (X(1:1)),
<p>
        1/2 E (X(2:2) - X(1:2)),
<p>
        1/3 E (X(3:3) - 2 X(2:3) + X(1:3)) and 
<p>
        1/4 E (X(4:4) - 3 X(3:4) + 3 X(2:4) - X(1:4)). 
<p>
    They are estimated via these weighted averages for a sample x_1, ...,
    x_n, otherwise known as probability-weighted moments:
<p>
        b_0 = average of x(j:n),
<p>
                         j - 1
        b_1 = average of ----- x(j:n),
                         n - 1
<p>
                         j - 1 j - 2
        b_2 = average of ----- ----- x(j:n) and 
                         n - 1 n - 2
<p>
                         j - 1 j - 2 j - 3
        b_3 = average of ----- ----- ----- x(j:n). 
                         n - 1 n - 2 n - 3
<p>
    The estimators are
<p>
        l_1 = b_0,
        l_2 = 2 b_1 - b_0, 
        l_3 = 6 b_2 - 6 b_1 + b_0 and 
        l_4 = 20 b_3 - 30 b_2 + 12 b_1 - b_0, 
<p>
    whence
<p>
        t   = l_2 / l_1        (cf. coefficient of variation),
        t_3 = l_3 / l_2        (cf. skewness) and
        t_4 = l_4 / l_2        (cf. kurtosis). 
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>allobs</b> specifies use of the maximum possible number of observations for
        each variable. The default is to use only those observations for
        which all variables in <i>varlist</i> are not missing.
<p>
    <b>by()</b> specifies one or more variables defining distinct groups for which
        L-moments should be calculated. <b>by()</b> is allowed only with a single
        <i>varname</i>. The choice between <b>by:</b>  and <b>by()</b> is partly one of precisely
        what kind of output display is required. The display with <b>by:</b> is
        clearly structured by groups while that with <b>by()</b> is more compact. To
        show L-moments for several variables and several groups with a single
        call to <b>lmoments8</b>, the display with <b>by:</b>  is essential.
<p>
    <b>detail</b> specifies a full display of results. By default, n, l_1, l_2, t_3
        and t_4 are shown. <b>detail</b> adds l_3, l_4 and t.
<p>
    <b>generate()</b> specifies one or more new variables to hold calculated
        results. <b>generate()</b> is allowed only with a single <i>varname</i>. This
        option is most useful when you want to save L-moments calculated for
        several groups for further analysis. Note that <b>generate()</b> is not
        allowed with the <b>by:</b> prefix: use the <b>by()</b> option instead.  Values for
        the new variables will necessarily be identical for all observations
        in each group: typically it will be useful to select just one
        observation for each group, say by using egen, tag().
<p>
        The specification consists of one or more space-separated elements
        <i>newvar</i><b>=</b><i>statistic</i>, where <i>newvar</i> is a new variable name and <i>statistic</i>
        is one of <b>n</b>, <b>l_1</b>, <b>l_2</b>, <b>l_3</b>, <b>l_4</b>, <b>t</b>, <b>t_3</b> or <b>t_4</b>. Omission of the
        underscore, as in <b>l1</b>, <b>l2</b>, <b>l3</b>, <b>l4</b>, <b>t3</b> and <b>t4</b>, is also allowed.
<p>
    <b>matname()</b> specifies the name of a matrix in which to save the results of
        (the last set of) calculations. There will be 8 columns.  The columns
        will contain n, l_1, l_2, l_3, l_4, t, t_3 and t_4.  The matrix will
        contain missing values if n &lt; 4 or l_1 == 0 or l_2 == 0.
<p>
    <i>tabdisp_options</i> are options of tabdisp.  The default display has
        <b>format(%9.3f)</b>.
<p>
    <b>variablenames</b> specifies that the variable names of <i>varlist</i> should be used
        in display. The default is to use variable labels to indicate a set
        of variables.
<p>
    <b>se</b> specifies that the variance matrix of sample L-moments and the
        standard error vector of sample L-moments and derived ratios be
        displayed.  The variance matrix of sample L-moments is estimated
        using the exact unbiased distribution-free estimator of Elamir and
        Seheult (2004).  Note that negative estimates of each variance are
        possible, especially with very small samples.  The standard errors of
        sample L-moments are the square roots of the diagonal elements of
        that matrix. The standard errors of t, t_3 and t_4 are obtained from
        the variances of ratios l_2/l_1, l_3/l_2, l_4/l_2 using
        Taylor-series-based approximations: for a ratio U/V,
<p>
        var(U/V) = {var(U)/E(U)^2 + var(V)/E(V)^2 - 2 cov(U,V)/(E(U) E(V))}
        {E(U)/E(V)}^2.
<p>
        This information is reported for the last-named variable or group
        only. However, <b>by:</b> may be used to obtain listings of standard errors
        for each of several groups. <b>se</b> may be specified with options of 
        matrix list to tune the display of the matrices. This option can be
        rather slow for large sample sizes.
<p>
<p>
<b><u>Examples</u></b> 
<p>
    <b>. lmoments8 price-foreign</b>
<p>
    <b>. bysort rep78: lmoments8 mpg</b>
<p>
    <b>. lmoments8 mpg, by(rep78) generate(mean=l1 L2=l2 L_CV=t)</b>
<p>
    <b>. lmoments8 c, se(format(%9.4f))</b>
<p>
<p>
<b><u>Saved results</u></b> 
<p>
    (for last-named variable or group only)
<p>
        r(N)     n
        r(l_1)   l_1
        r(l_2)   l_2
        r(l_3)   l_3
        r(l_4)   l_4
        r(t)     t
        r(t_3)   t_3
        r(t_4)   t_4
        r(b_1)   b_1
        r(b_2)   b_2
        r(b_3)   b_3
<p>
        if <b>se</b> specified only: 
        r(V)     variance matrix of l_1 ... l_4
        r(SE)    standard error vector of l_1 ... l_4 t t_3 t_4 
<p>
<p>
<b><u>Acknowledgements</u></b> 
<p>
        
    <b>lmoments8</b> includes code from Patrick Royston's <b>lshape</b> program. Allan
    Seheult kindly provided and discussed reprints of his joint work.
<p>
<b><u>Author</u></b>
<p>
        
    Nicholas J. Cox, Durham University, U.K.
    n.j.cox@durham.ac.uk
<p>
<p>
<b><u>References</u></b>
<p>
    The L-moments page
<p>
    Elamir, E.A.H. and A.H. Seheult. 2004.  Exact variance structure of
        sample L-moments.  <i>Journal of Statistical Planning and Inference</i> 124:
        337-359.
<p>
    Hosking, J.R.M. 1990. L-moments: Analysis and estimation of distributions
        using linear combinations of order statistics.  <i>Journal of the Royal</i>
        <i>Statistical Society</i> Series B 52: 105-124.
<p>
    Hosking, J.R.M. 1998. L-moments. In Kotz, S., C.B. Read and D.L. Banks
        (eds) <i>Encyclopedia of Statistical Sciences Update Volume 2.</i>  New
        York: Wiley, 357-362.
<p>
    Hosking, J.R.M. and J.R. Wallis. 1997.  <i>Regional frequency analysis: an</i>
        <i>approach based on L-moments.</i>  Cambridge University Press.
<p>
    Royston, P. 1992.  Which measures of skewness and kurtosis are best?
        <i>Statistics in Medicine</i> 11: 333-343.
<p>
</pre>