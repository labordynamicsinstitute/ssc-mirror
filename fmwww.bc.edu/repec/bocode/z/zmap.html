<pre>
-------------------------------------------------------------------------------
help for <b>zmap</b>
-------------------------------------------------------------------------------
<p>
<b><u>Binned scatter map</u></b>
<p>
        <b>zmap</b> <i>zvar</i> <i>xvar</i> <i>yvar</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [ <b>,</b> { <b><u>pct</u></b><b>iles(</b><i>numlist</i><b>)</b> |
                 <b><u>br</u></b><b>eaks(</b><i>numlist</i><b>)</b> } <b><u>mult</u></b><b>iples</b> <i>graph_options</i> ]
<p>
   
<b><u>Description</u></b> 
<p>
    <b>zmap</b> graphs (or maps) binned values of a variable z with respect to two
    variables x and y treated as Cartesian coordinates. In geographical or
    cartographical terms x defines distance east and y defines distance
    north. The range of z is divided into two or more bins or classes and
    points in each bin are shown distinctly. The resulting plot is thus a
    composite scatter plot.
<p>
    By default binning is into 8 classes with 7 breaks determined by the 5 10
    25 50 75 90 95% points or percentiles of the distribution of z.
    Alternatively, the user may specify other percentile breaks, or a set of
    breaks on the scale of z. The number of classes in general is naturally
    one more than the number of breaks.
<p>
    By default with between 1 and 8 breaks, points falling into different
    bins are shown with different gray scale colours, darker meaning higher
    values. If more than 8 breaks are specified, default colours are just
    those of the prevailing graph scheme. In either case users may specify
    their own colour choices to override defaults.
<p>
    Lower limits are inclusive, so that each bin contains points &gt;= its lower
    limit and &lt; its upper limit. The upper limit of the highest class is
    open.
<p>
<p>
<b><u>Remarks</u></b> 
<p>
    The main intended application is that z is a spatial series measured at
    numerous points or for numerous small areas with respect to map
    coordinates x and y. However, nothing ties this command to spatial data.
    Users may wish to use the command on other trivariate data. The marker
    symbols used may then be better set to something larger than the default
    of points.
<p>
    If the y variable follows a table or matrix row or Southern latitude
    convention so that it increases downwards, then use the <b>ysc(reverse)</b>
    option.
<p>
    If you already have a classificatory variable, you do not need any
    special machinery. Some basic technique is given by the schematic
    examples below.  See also Cox (2005).
<p>
    <b>separate y, by(</b><i>classvar</i><b>) veryshortlabel</b>
    <b>scatter `r(varlist)' x</b>
<p>
    or
<p>
    <b>scatter y x, by(</b><i>classvar</i><b>)</b>
<p>
    The following limitations may be noted:
<p>
    1. <b>zmap</b> is not smart about tied values. Higher values of z for the same x
    and y values will just overplot lower values. If this is important,
    consider averaging z for each distinct combination of x and y in some
    way. An example appears below.
<p>
    2. <b>zmap</b> does not apply any special intelligence to ensure appropriate
    aspect ratios to maintain equal scales on both x and y axes.  The
    presumption is that most uses will be exploratory or that, if this is
    important, <b>xsize()</b>, <b>ysize()</b> or <b>aspect()</b> options may be used according to
    taste.
<p>
    3. <b>zmap</b> can do nothing about the limitations of your monitor, or indeed
    any other monitor.
<p>
<p>
<b><u>Options</u></b> 
<p>
    <b>pctiles(</b><i>numlist</i><b>)</b> specifies that breaks between categories are defined by
        the percent points or percentiles indicated.  For example, <b>pct(25 50</b>
        <b>75)</b> specifies that the 25%, 50% and 75% points (lower quartile,
        median, upper quartile) be used as breaks, thus defining 4 classes.
        Percent points must be greater than 0 and less than 100.
<p>
    <b>breaks(</b><i>numlist</i><b>)</b> specifies that breaks between categories are defined by
        the values indicated.  For example, <b>br(100 200 400)</b> specifies that
        values of 100, 200 and 400 be used as breaks, thus defining 4
        classes.
<p>
        Only one of <b>pctiles()</b> and <b>breaks()</b> may be specified.  If neither is
        specified, the default is <b>pctiles(5 10 25 50 75 90 95)</b>.
<p>
    <b>multiples</b> specifies that each bin or class be shown as a separate graph.
        Thus each plot is just a plot of the x and y values of points in that
        bin of z. <b>multiples</b> is likely to be most useful with a small number
        of bins.
<p>
    <i>graph_options</i> refers to any of the options of scatter.  Defaults include,
        but are not limited to,
<p>
        if <b>multiples</b> is not specified:  <b>ysc(off) xsc(off) ms(p ..)</b>
        <b>legend(col(1) pos(3)) plotregion(style(none))</b>
<p>
        if <b>multiples</b> is specified:  <b>by(, compact) yla(none) xla(none) ms(p)</b>
        <b>mcolor(gs4) legend(off) plotregion(style(none))</b>
<p>
<p>
<b><u>Examples</u></b> 
<p>
    (spatial data, all x, y pairs distinct)
    <b>. zmap B5 X Y, pct(25 50 75)</b>
    <b>. zmap B5 X Y, pct(25 50 75) mcolor(blue blue*0.5 orange*0.5 orange)</b>
    <b>. zmap B5 X Y, pct(25 50 75) multiples</b>
<p>
    (non-spatial data, average z given x, y first)
    <b>. webuse nlswork</b>
    <b>. egen mean = mean(ln_wage), by(age grade)</b>
    <b>. egen tag = tag(age grade)</b>
    <b>. label var mean "mean ln wage"</b>
    <b>. su ln_wage if !missing(age, grade), detail</b>
    <b>. zmap mean age grade if tag, breaks(.993 1.166 1.361 1.641 1.964 2.275</b>
        <b>2.456) ms(S ..) ysc(on) xsc(on) yla(0/18, ang(h)) ytitle(`: var label</b>
        <b>grade') xla(15(5)45) note("")</b>
 
<p>
<p>
<b><u>Acknowledgments</u></b> 
<p>
    Vince Wiggins made a very helpful suggestion.
<p>
<p>
<b><u>Author</u></b> 
<p>
    Nicholas J. Cox, Durham University, U.K.
    n.j.cox@durham.ac.uk
<p>
<p>
<b><u>References</u></b> 
<p>
    Cox, N.J. 2005. Classifying data points on scatter plots.  <i>Stata Journal</i>
        5: 604-606.
<p>
<p>
<b><u>Also see</u></b> 
<p>
    On-line: help for spmap (if installed)
<p>
</pre>