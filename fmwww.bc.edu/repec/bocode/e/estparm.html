<pre>
-------------------------------------------------------------------------------
help for <b>estparm</b> and <b>estparmtest</b>                                 (Roger Newson)
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Save results from a </u></b><b><u>parmest</u></b><b><u> resultsset and test equality</u></b>
<p>
        <b>estparm</b> <i>varlist</i> [<i>if</i>] [<i>in</i>] [ <b>,</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b><u>ef</u></b><b>orm</b> <b><u>o</u></b><b>bs(</b><i>varname</i><b>)</b> <b><u>eq</u></b><b>(</b><i>varname</i><b>)</b>
               <b><u>dfc</u></b><b>ombine(</b><i>combination_rule</i><b>)</b> ]
<p>
        <b>estparmtest</b> <i>varlist</i> [<i>if</i>] [<i>in</i>] [ <b>,</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b><u>ef</u></b><b>orm</b> <b><u>o</u></b><b>bs(</b><i>varname</i><b>)</b> <b><u>eq</u></b><b>(</b>
               <i>varname</i><b>)</b> <b><u>dfc</u></b><b>ombine(</b><i>combination_rule</i><b>)</b> ]
<p>
<p>
    where <i>varlist</i> is a list of 2 or 3 variables with the syntax
<p>
        <i>estimate_varname</i> <i>stderr_varname</i> [ <i>dof_varname</i> ]
<p>
    and <i>estimate_varname</i>, <i>stderr_varname</i> and <i>dof_varname</i> are the names of
    existing variables, containing parameter estimates, standard errors, and
    degrees of freedom, respectively.  If the <i>dof_varname</i> is specified, then
    the test statistics are assumed to have a <i>t</i>-distribution, with degrees of
    freedom equal to the sum of the variable specified by <i>dof_varname</i>.  If
    the <i>dof_varname</i> is not specified, then the test statistics are assumed to
    have a standard Normal sampling distribution.
<p>
    A <i>combination_rule</i> is
<p>
    <b>sum</b> | <b>constant</b>
<p>
    <b>by</b> and <b>statsby</b> are allowed; see prefix.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>estparm</b> is an inverse of <b>parmest</b>.  It inputs 2 or 3 variables in the 
    <i>varlist</i>, containing parameter estimates, standard errors, and
    (optionally) degrees of freedom.  It saves a set of estimation results
    for the parameters, assuming that the parameter estimates are
    statistically uncorrelated.  <b>estparmtest</b> is an extended version of
    <b>estparm</b>, which also performs a chi-squared or F test of the hypothesis
    that all these parameters are equal.  <b>estparmtest</b> can be used for
    performing interaction tests, using data from regression models for
    multiple subsets, stored in a <b>parmest</b> or <b>parmby</b> output dataset (or
    resultsset).
<p>
<p>
<b><u>Options for </u></b><b><u>estparm</u></b><b><u> and </u></b><b><u>estparmtest</u></b>
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, as a percentage, for confidence
        intervals of the estimates; see <b>level</b>.
<p>
    <b>eform</b> indicates that the input estimates are exponentiated, and that the
        input standard errors are multiplied by the exponentiated estimate,
        as produced by the <b>eform</b> option of <b>parmest</b> and <b>parmby</b>.  Note that the
        output confidence limits are not exponentiated, whether or not <b>eform</b>
        is specified.  (This is because the column names in the estimation
        output matrices are all set to <b>_cons</b>, and the <b>ereturn display</b> command
        of Stata will not print parameters with that name if the <b>eform()</b>
        option is specified.)
<p>
    <b>obs(</b><i>varname</i><b>)</b> specifies an existing numeric variable, whose sum is stored
        in the estimation results as <b>e(N)</b> and reported in the output as the
        total number of observations.  Such a variable might have been
        created by <b>parmest</b> or <b>parmby</b>, using the option <b>escal(N)</b>.
<p>
    <b>eq(</b><i>varname</i><b>)</b> specifies an existing string variable, whose values are used
        to specify the equation names used in the estimation results.  It is
        the responsibility of the user to ensure that values of this variable
        are unique.  If <b>eq()</b> is not specified, then the equation names are
        set to numbers from 1 to the number of parameters, in order of
        appearance in the dataset.  (The column names used in the estimation
        results are all set to <b>_cons</b>.)
<p>
    <b>dfcombine(</b><i>combination_rule</i><b>)</b> specifies a rule for combining the degrees of
        freedom of the input parameters to define the combined residual
        degrees of freedom for the output estimation results, if a degrees of
        freedom variable is specified.  This combined residual degrees of
        freedom is used by <b>estparmtest</b> as the denominator degrees of freedom
        in an <i>F</i>-test.  The value of <b>dfcombine()</b> may be <b>sum</b> (the default), or
        <b>constant</b>.  If <b>sum</b> is specified, then the residual degrees of freedom
        for the output estimation results is the sum of the values of the
        input degrees of freedom variable.  If <b>constant</b> is specified, then
        <b>estparm</b> and <b>estparmtest</b> check that the degrees of freedom variable is
        equal to a constant value in all input observations, and sets the
        output residual degrees of freedom to that constant value.  The
        specification <b>dfcombine(constant)</b> is useful if the input parameters
        are uncorrelated parameters of the same model, and that model was
        estimated with a single estimation command, using a common degrees of
        freedom for all parameters.  This will be the case if the parameters
        are group means, and the model is a regression model, whose only
        parameters are group means, and which was fitted using a single
        regression command, with a single pooled scalar degrees of freedom.
        If there is no input degrees of freedom variable, then the
        <b>dfcombine()</b> option is ignored.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    <b>estparm</b> and <b>estparmtest</b> are designed for use with output datasets (or
    resultssets) produced (directly or indirectly) by the <b>parmest</b> package,
    which can be downloaded from SSC, and contains the programs <b>parmest</b>, 
    <b>parmby</b>, <b>parmcip</b> and <b>metaparm</b>.  They are intended mainly to perform tests
    of the hypothesis that several independently estimated parameters are
    equal.  In particular, if there are multiple subsets of observations in
    the data, and a regression model is fitted to each subset, then
    <b>estparmtest</b> may be used to test the hypothesis that all the regression
    coefficients are equal.  This hypothesis is thought by some scientists to
    be an interesting hypothesis to test.  For instance, in the medical
    sector, if the subsets are defined by genotypes, and the regression model
    measures the effect of an exposure variable on levels of a disease, then
    a test of the hypothesis of equality between the regression coefficients
    in the subsets is known as a test of gene-environment interaction.
<p>
<p>
<b><u>Technical note</u></b>
<p>
    If the model fitted to each subset is the same linear regression model,
    fitted using <b>regress</b> with the <b>robust</b> option, then the <i>F</i>-test statistic
    output by <b>estparmtest</b> should be the same as the corresponding <i>F</i>-test
    statistic output by <b>test</b> if those models are fitted as a single
    regression model to all subsets (using <b>regress</b> with the <b>robust</b> option),
    with a separate parameter set for each subset.  If the model fitted to
    each subset is the same generalized linear model, fitted using <b>glm</b> with
    the <b>vce(robust)</b> option, then the chi-squared test statistic output by
    <b>estparmtest</b> should be slightly less than the corresponding chi-squared
    statistic output by <b>test</b> if those models are fitted as a single
    regression model to all subsets (using <b>glm</b> with the <b>vce(robust)</b> option),
    with a separate parameter set for each subset.  However, the two
    chi-squared statistics will be asymptotically equivalent in large
    samples.  This is because the Huber variance formula used by Stata uses a
    scale factor of <b>N/(N-1)</b> in generalized linear models and a scale factor
    of <b>N/(N-k)</b> in linear regression models, where <b>N</b> is the number of
    observations and <b>k</b> is the number of parameters.
<p>
<p>
<b><u>Examples</u></b>
<p>
    The following examples use the <b>auto</b> data, with an added variable <b>seqgp4</b>,
    which groups the dats using groups of 4 successive observations.  In each
    group of 4 successive observations, the first, second, third and fourth
    observation are assigned to groups 1, 2, 3 and 4, respectively.  In each
    example, the <b>parmby</b> module of the SSC package <b>parmest</b> is used to create
    an output dataset (or resultsset), with 1 observation per estimated
    parameter.  In this resultsset, <b>estparmtest</b> is used to test the
    hypothesis that the regression slopes or odds ratios in the 4 groups are
    equal.
<p>
-------------------------------------------------------------------------------
Setup
        <b>. sysuse auto, clear</b>
        <b>. gene seqgp4=mod(_n,4)+1</b>
        <b>. lab var seqgp4 "Sequential group (of 4)"</b>
        <b>. tab seqgp4</b>
<p>
-------------------------------------------------------------------------------
Example with <b>regress</b>
        <b>. preserve</b>
        <b>. parmby "regress mpg weight", by(seqgp4) norestore escal(N) ren(es_1</b>
            <b>N)</b>
        <b>. estparmtest estimate stderr dof if parm=="weight", obs(N)</b>
        <b>. ereturn list</b>
        <b>. return list</b>
        <b>. restore</b>
<p>
-------------------------------------------------------------------------------
Example with <b>logit</b>
        <b>. preserve</b>
        <b>. parmby "logit foreign mpg", by(seqgp4) norestore escal(N) ren(es_1</b>
            <b>N)</b>
        <b>. estparmtest estimate stderr if parm=="mpg", obs(N)</b>
        <b>. ereturn list</b>
        <b>. return list</b>
        <b>. restore</b>
<p>
-------------------------------------------------------------------------------
Example with <b>logit</b> and the <b>eform</b> option
        <b>. preserve</b>
        <b>. parmby "logit foreign mpg, or", by(seqgp4) norestore escal(N)</b>
            <b>ren(es_1 N) eform</b>
        <b>. estparmtest estimate stderr if parm=="mpg", obs(N) eform</b>
        <b>. ereturn list</b>
        <b>. return list</b>
        <b>. restore</b>
<p>
    The following example illustrates the use of <b>estparmtest</b> with <b>statsby</b>.
    Note that the <b>basepop()</b> option of <b>statsby</b> is used to prevent the <b>matsize</b>
    from being exceeded.
<p>
        <b>. statsby pvalue=r(p), by(snpoly) clear basepop(snpoly==1):</b>
            <b>estparmtest estimate stderr if parm=="exposure", obs(N) eform</b>
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>estparm</b> and <b>estparmtest</b> save the following in <b>e()</b>:
<p>
    Scalars        
      <b>e(N)</b>                total number of observations
      <b>e(df_r)</b>             total degrees of freedom
<p>
    Macros         
      <b>e(cmd)</b>              <b>estparm</b>)
      <b>e(cmdline)</b>          command as typed
      <b>e(predict)</b>          program used to implement <b>predict</b>
      <b>e(dfcombine)</b>        <b>dfcombine()</b> option
      <b>e(properties)</b>       <b>b V</b>)
<p>
    Matrices       
      <b>e(b)</b>                coefficient vector)
      <b>e(V)</b>                variance-covariance matrix of the estimators
      <b>e(df_estparm)</b>       parameter-specific degrees of freedom
<p>
    The parameter-specific degrees of freedom vector has the dimensions of
    the coefficient vector, and contains the contents of the degrees of
    freedom variable.
<p>
    <b>estparmtest</b> also saves the following in <b>r()</b>:
<p>
    Scalars   
      <b>r(p)</b>           two-sided p-value
      <b>r(F)</b>           F statistic
      <b>r(df)</b>          test constraints degrees of freedom
      <b>r(df_r)</b>        residual degrees of freedom
      <b>r(dropped_i)</b>   index of <i>i</i>th constraint dropped
      <b>r(chi2)</b>        chi-squared
      <b>r(ss)</b>          sum of squares (test)
      <b>r(rss)</b>         residual sum of squares
      <b>r(drop)</b>        <b>1</b> if constraints were dropped, <b>0</b> otherwise
<p>
<p>
<b><u>Author</u></b>
<p>
    Roger Newson, Imperial College London, UK.  Email:
    r.newson@imperial.ac.uk
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[R] estimates</b>, <b>[R] test</b>, <b>[P] ereturn</b>, <b>[D] statsby</b>
<p>
      Help:  <b>[P] estimates</b>, <b>[R] test</b>, <b>[P] ereturn</b>, <b>[D] statsby</b>
             <b>parmest</b>, <b>parmby</b>, <b>parmcip</b>, <b>metaparm</b> if installed
</pre>