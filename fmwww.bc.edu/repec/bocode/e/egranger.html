<pre>
-------------------------------------------------------------------------------
help for <b>egranger</b>
-------------------------------------------------------------------------------
<p>
<b><u>Engle-Granger (EG) and Augmented Engle-Granger (AEG) cointegration tests and 2-</u></b>
<b><u>&gt; step ECM estimation</u></b>
<p>
        <b>egranger</b> <i>varlist</i> [, <b>ecm</b> <b><u>L</u></b><b>ags(</b><i>#</i><b>)</b> <b><u>TR</u></b><b>end</b> <b><u>QTR</u></b><b>end</b> <b><u>REG</u></b><b>ress</b> ]
<p>
<p>
<b><u>Description</u></b>
<p>
<b>egranger</b> conducts tests for cointegration proposed by Engle and Granger (1987),
reporting test statistics plus critical values calculated by MacKinnon (1990,
2010).  <b>egranger</b> will also estimate an ECM (Error Correction Mechanism) model
using the 2-step procedure proposed by Engle and Granger (1987).
<p>
<b>egranger</b> requires Stata 9.0 or higher.
<p>
<p>
<b><u>Engle-Granger tests for cointegration</u></b>
<p>
The Engle-Granger (EG) test for cointegration is a two-step residual-based
test.  Say that we suspect that the variables y, x_1, ..., x_k are
cointegrated.  The simplest form of the test is performed as follows.  First, y
is regressed on a constant and x_1, ..., x_k and the residuals are calculated.
Then, the first difference of the residuals is regressed on the lagged level of
the residuals without a constant.  The test statistic is the traditional OLS
t-statistic on the lagged residual.  Under the null hypothesis that y and x_1,
..., x_k are not cointegrated, the residual should be non-stationary, hence the
resemblance of the EG test to the Dickey-Fuller test for non-stationarity (see 
dfuller).  Rejection of the null is evidence the residual is stationary, i.e.,
that the series are indeed cointegrated.
<p>
The EG test requires the error terms to be serially independent.  If this is
not the case, lags of the first difference of the residual can be included in
the second (test) regression so that the residuals in that regression appear
serially uncorrelated.  This version of the test is usually known as the
Augmented Engle-Granger (AEG) test.  The number of desired lags is specified by
the <b>lags(#)</b> option.
<p>
A linear or quadratic trend may be included in the first-step regression by
using the <b>trend</b> or <b>qtrend</b> options.
<p>
The distributions of the EG/AEG test statistics are non-standard, and depend on
the number of series being tested, the sample size, and whether a linear or
quadratic trend is included.  MacKinnon (1990, 2010) has computed response
surface regressions which provide critical values for all these cases.  These
are the critical reported by <b>egranger</b>.
<p>
The EG/AEG test can be seen as a robust alternative to the Johansen tests for
cointegration available via Stata's <b>vecrank</b>.  The EG test makes fewer
distributional assumptions, but, unlike <b>vecrank</b>, does not allow the
identification of the number of cointegrating vectors.  In some applications
this last limitation may not be important, e.g., in the bivariate case when
there are only two variables and hence at most one cointegrating relationship.
<p>
<p>
<b><u>Engle-Granger two-step ECM model estimation</u></b>
<p>
Engle and Granger (1987) also proposed a two-step method for estimating ECM
(Error Correction Mechanism) models.
<p>
The first step is identical to the first step in the EG/AEG test procedure
described above.  In the second step, the first difference of y is regressed on
the lagged level of the first-step residual and the lagged first differences of
x_1, ..., x_k using OLS.  The coefficient on the lagged residual is an estimate
of the ECM "speed of correction" parameter.
<p>
The EG two-step ECM estimation is obtained by specifying the <b>ecm</b> option.  Lags
of y and x can be included by specifying the <b>lags(#)</b> option:  <b>lags(1)</b> causes
the lagged first difference of y to be added to the second-step ECM alongside
the lagged first difference of x; <b>lags(tau)</b> where tau&gt;1 causes lags 1..tau of
the first differences of y and x to appear in the second-step ECM.
<p>
<p>
<b><u>Saved results and postestimation options</u></b>
<p>
<b>egranger</b> uses Stata's <b>regress</b> to estimate the test regression and ECM.  All the
main <b>regress</b> results are preserved after <b>egranger</b> has run.  This allows the
user to employ Stata's built-in postestimation commands for <b>regress</b> after
<b>egranger</b> is used.  In particular, the standard <b>regress</b> postestimation commands
can be used to obtain information criteria and to test for serial correlation
in the EG/AEG test regression or ECM estimation regression.
<p>
In addition to the standard <b>regress</b> results, <b>egranger</b> saves the following:
<p>
Variables
   <b>_egresid</b>      First-step residuals
<p>
Scalars
   <b>e(lags)</b>       Number of lags in the test or second-step regression
   <b>e(N1)</b>         Sample size in the first-step regression
   <b>e(N2)</b>         Sample size in the second-step regression
<p>
Scalars (EG and AEG tests only)
   <b>e(Zt)</b>         EG/AEG test statistic
   <b>e(cv1)</b>        EG/AEG 1% critical value
   <b>e(cv5)</b>        EG/AEG 5% critical value
   <b>e(cv10)</b>       EG/AEG 10% critical value
<p>
<p>
<b><u>Options</u></b>
<p>
<b>ecm</b> requests that the Engle-Granger two-step ECM is estimated.  The default is
    to report the EG/AEG cointegration test.
<p>
<b>lags(#)</b> specifies the number of lags of the first difference of the residuals
    to include in the AEG test regression or the number of lags of first
    differences of the potentially cointegrating variables to include in the
    ECM second-step regression.
<p>
<b>trend</b> specifies that a linear trend is included in the first-step regression.
<p>
<b>qtrend</b> specifies that a quadratic trend is included in the first-step
    regression.
<p>
<b>regress</b> requests that the first-step and (if applicable) EG/AEG test
    regressions are reported.
<p>
<p>
<b><u>Examples</u></b>
<p>
(Cointegration test)
<p>
    . webuse rdinc
<p>
    . egranger ln_ne ln_se
<p>
    . egranger ln_ne ln_se, lags(2)
<p>
    . egranger ln_ne ln_se, lags(2) trend
<p>
    . egranger ln_ne ln_se ln_me, lags(1) qtrend
<p>
(Report the internal 1st-step and test regressions)
<p>
    . egranger ln_ne ln_se, lags(2) regress
<p>
(Replicate the above test by hand)
<p>
    . regress ln_ne ln_se
<p>
    . predict double resid, res
<p>
    . regress D.resid L.resid L(1/2)D.resid, nocons
<p>
(Two-step ECM estimation)
<p>
    . egranger ln_ne ln_se, ecm
<p>
(Use <b>lags(#)</b> option)
<p>
    . egranger ln_ne ln_se, ecm lags(2)
<p>
(Report the internal 1st-step regression)
<p>
    . egranger ln_ne ln_se, ecm lags(2) regress
<p>
(Replicate the above 2-step ECM estimation by hand)
<p>
    . regress ln_ne ln_se
<p>
    . capture drop resid
<p>
    . predict double resid, res
<p>
    . regress D.ln_ne L.resid L(1/2)D.(ln_ne ln_se)
<p>
<p>
<b><u>Citation</u></b>
<p>
<b>egranger</b> is not an official Stata command.  It is a free contribution to the
research community, like a paper.  Please cite it as such:
<p>
    Schaffer, M.E.  2010.  egranger: Engle-Granger (EG) and Augmented
        Engle-Granger (AEG) cointegration tests and 2-step ECM estimation.
        http://ideas.repec.org/c/boc/bocode/s457210.html
<p>
<p>
<b><u>References</u></b>
<p>
Engle, R.F. and Granger, C.W.J.  1987.  "Co-integration and Error Correction:
    Representation, Estimation and Testing" Econometrica, Vol. 55, pp. 251–276.
<p>
MacKinnon, James G.  1990, 2010. Critical Values for Cointegration Tests.
    Queen's Economics Department Working Paper No. 1227, Queen's University,
    Kingston, Ontario, Canada.  Available at
    http://ideas.repec.org/p/qed/wpaper/1227.html.
<p>
<p>
<b><u>Author</u></b>
<p>
   Mark E Schaffer, Heriot-Watt University, UK
   m.e.schaffer@hw.ac.uk
<p>
        
<b><u>Acknowledgements</u></b>
<p>
Thanks to Julia Darby and the students in the SGPE QM1 course for the impetus
for writing this program, and to Kit Baum for feedback on the program and help
file.
<p>
<p>
<b><u>Also see</u></b>
<p>
 Manual:  <b>[TS] dfuller</b>; <b>[TS] vec intro</b>; <b>[TS] vecrank</b>
On-line:  help for dfuller; vec intro; vecrank
</pre>