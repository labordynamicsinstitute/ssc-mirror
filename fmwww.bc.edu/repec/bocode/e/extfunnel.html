<pre>
-------------------------------------------------------------------------------
<b>help extfunnel</b>                                                                 
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Title</u></b>
<p>
    <b>extfunnel</b> -- Graphical augmentations to the funnel plot to illustrate
                   potential impact of a new study on a meta-analysis
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>extfunnel</b> <i>varname1</i> <i>varname2</i> [<i>if</i>] [<i>in</i>] [<b>,</b> <i>options</i>]
<p>
    <i>options</i>                             Description
    -------------------------------------------------------------------------
    <b>fixedi</b>                              specifies a fixed effect model using
                                          the inverse variance method
                                          (default)
    <b>randomi</b>                             specifies a random effect model using
                                          the method of DerSimonian &amp; Laird
    <b><u>cp</u></b><b>oints(</b><i>integer</i><b>)</b>                    the number of points to evaluate the
                                          contours; a greater value produces
                                          smoother contour plots
    <b>null(</b><i>real</i><b>)</b>                          value of the null hypothesis for
                                          effect estimate; default is 0
    <b><u>isq</u></b><b>uared(</b><i>numlist max</i><b>=</b><i>5</i><b>)</b>             I-squared contours
    <b><u>tausq</u></b><b>uared(</b><i>numlist max</i><b>=</b><i>5</i><b>)</b>           tau-squared contours
    <b><u>meas</u></b><b>ure(</b><i>string</i><b>)</b>                     defines the target of inference which
                                          can be one of <b>lci</b>/<b>uci</b>/<b>ciwidth</b>
    <b>loe(</b><i>numlist max</i><b>=</b><i>2</i><b>)</b>                  defines the limits of clinical
                                          equivalence
    <b><u>loel</u></b><b>ine</b>                             displays the limits of clinical
                                          equivalence
    <b><u>newstudyc</u></b><b>ontrol(</b><i>integer</i><b>)</b>            defines the number of patients in the
                                          control arm of a new trial
    <b><u>newstudyt</u></b><b>reatment(</b><i>integer</i><b>)</b>          defines the number of patients in the
                                          treatment arm of a new trial
    <b>or</b>                                  specifies that odds ratios should be
                                          used. Valid only when
                                          <b>newstudycontrol</b> and
                                          <b>newstudytreatment</b> are specified
    <b>rr</b>                                  specifies that risk ratios should be
                                          used. Valid only when
                                          <b>newstudycontrol</b> and
                                          <b>newstudytreatment</b> are specified
    <b>xrange(</b><i>numlist</i><b>)</b>                     defines the range of effect estimates
    <b>yrange(</b><i>numlist</i><b>)</b>                     defines the range of standard errors
    <b>sumd</b>                                display summary diamond
    <b><u>sumdp</u></b><b>osition(</b><i>real</i><b>)</b>                  the vertical coordinate where the
                                          summary diamond is placed
    <b><u>pred</u></b><b>iction</b>                          display prediction interval
    <b><u>nonull</u></b><b>line</b>                          suppress display of line of no effect
    <b><u>nopooled</u></b><b>line</b>                        suppress display of pooled estimate
                                          line
    <b>noshading</b>                           suppress display of shaded regions
    <b><u>noscat</u></b><b>ter</b>                           suppress display of scatter of
                                          original study effects
    <b>nometan</b>                             suppress display of original
                                          meta-analysis results using <b>metan</b>
    <b>label(</b><i>string</i><b>)</b>                       pass label option to <b>metan</b>
    <b>eform</b>                               exponentiates the x-axis labels,
                                          valid only when input variables are
                                          log-transformed, e.g. log odds
                                          ratios
    <b>scheme(</b><b><u>g</u></b><b>rayscale)</b>                   colour scheme is grayscale (default)
    <b>scheme(</b><b><u>c</u></b><b>olor)</b>                       colour scheme is color
    <b><u>add</u></b><b>plot(</b><i>string</i><b>)</b>                     additional twoway plot
    <b>level(</b><i>real</i><b>)</b>                         statistical significance level;
                                          default is 5
    twoway_options                      pass options to the <b>twoway</b> plot
    -------------------------------------------------------------------------
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>extfunnel</b> creates graphical overlay augmentations to the funnel plot. The
    purpose of these overlays is to display the potential impact a new study
    would have on an existing meta-analysis, providing an indication of the
    robustness of the meta-analysis to the addition of new evidence. Thus,
    these extend the use of the funnel plot beyond assessments of publication
    biases. Two main graphical displays can be produced; i) statistical
    significance contours, which define regions of the funnel plot in which a
    new study would have to be located in order to change the statistical
    significance of the meta-analysis; and ii) heterogeneity contours, which
    show how a new study would affect the extent of heterogeneity in a given
    meta-analysis. extfunnel can also illustrate the impact a new study has
    on lower and upper confidence interval values, the confidence interval
    width of the pooled meta-analytic result, and overlays for the impact of
    a future study on, user defined, limits of clinical equivalence. Inverse
    variance weighted methods are implemented using both explicit formulae
    for contour lines, and a simulation approach optimised in Mata.
<p>
    <i>varname1</i> is assumed to contain normally distributed effect estimates and
    <i>varname2</i> is assumed to contain standard errors of <i>varname1</i>.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>fixedi</b> specifies a fixed effect model using the inverse variance method.
        This is the default.
<p>
    <b>randomi</b> specifies a random effect model using the method of DerSimonian &amp;
        Laird, with the estimate of heterogeneity being taken from the
        inverse-variance fixed-effect model.
<p>
    <b>cpoints(</b><i>integer</i><b>)</b> specifies the number of points to evaluate either the
        shaded statisticial significance contours and/or the heterogeneity
        contours. The default number for a fixed and random effect
        meta-analyses are 3500 and 100, respectively.  When a random
        meta-analysis is invoked, the maximum number of contourpoints is 500.
        A larger number of <b>cpoints</b> results in a smoother graph, but takes
        longer to compute (see Remarks for more details).
<p>
    <b>null(</b><i>real</i><b>)</b> is the value of the null hypothesis for effect estimate;
        default is 0. When <b>measure</b> is specified this is the value which
        <b>lci</b>/<b>uci</b>/<b>ciwidth</b> is compared to. If <b>lci</b>/<b>uci</b> is specified the value of
        <b>null</b> is compared to lower/upper confidence interval value of the
        updated meta-analyses, and colour coded depending on whether the
        updated estimate is less than or more than the <b>null</b>. If <b>ciwidth</b> is
        specified then the width confidence interval of the updated
        meta-analyses are compared to the value define by <b>null</b>.
<p>
    <b>isquared(</b><i>numlist</i><b>)</b> Values that define the I-squared contours. Must be a
        numlist of maximum length 5 and should have elements in the range
        0-100.
<p>
    <b>tausquared(</b><i>numlist</i><b>)</b> Values that define the Tau-squared contours. Must be
        a vector of maximum length 4 and should have elements in the range
        0-Inf.
<p>
    <b>measure(</b><i>string</i><b>)</b> defines the target of inference which can be one of
        <b>lci</b>/<b>uci</b>/<b>ciwidth</b>.
<p>
    <b>loe(</b><i>numlist</i><b>)</b> defines the limits of clinical equivalence. The default
        legend assumes a beneficial and detrimental effect in specific
        directions.  The legend can be re-labelled using <b>legend(order(1</b>
        <b>"text1" 2 "text2"...))</b>. For further details see Sutton et al. (2007).
<p>
    <b>loeline</b> displays the limits of clinical equivalence.
<p>
    <b>newstudycontrol(</b><i>int</i><b>)</b> defines the number of patients in the control arm of
        a new trial. <b>newstudytreatment</b> and <b>newstudycontrol</b> defined together
        produce a statistical significance contour graph, whereby each
        possible permutation of results is calculated and analysed within the
        appropriate meta-analysis model. Odds ratios and risk ratios are
        supported.
<p>
    <b>newstudytreatment(</b><i>int</i><b>)</b> defines the number of patients in the treatment
        arm of a new trial.
<p>
    <b>or</b> specifies that log odds ratios should be used, valid only when
        <b>newstudytreatment</b> and <b>newstudycontrol</b> are specified. This is the
        default. Alternatively, <b>rr</b> can be specified for risk ratios.
<p>
    <b>rr</b> specifies that log risk ratios should be used, valid only when
        <b>newstudytreatment</b> and <b>newstudycontrol</b> are specified.
<p>
    <b>xrange(</b><i>numlist</i><b>)</b> defines the range of effect estimates.
<p>
    <b>yrange(</b><i>numlist</i><b>)</b> defines the range of standard errors.
<p>
    <b>sumd</b> display the summary diamond.
<p>
    <b>sumdposition(</b><i>real</i><b>)</b> defines the vertical coordinate where the summary
        diamond is placed.
<p>
    <b>prediction</b> displays the prediction interval.
<p>
    <b>nonullline</b> suppresses the display of the vertical line of no effect.
<p>
    <b>nopooledline</b> suppresses the display of the vertical line at the pooled
        effect estimate.
<p>
    <b>noshading</b> suppresses the display of shaded regions.
<p>
    <b>noscatter</b> suppresses the display of the scatter of original study
        effects.
<p>
    <b>nometan</b> suppress display of original meta-analysis results using <b>metan</b>.
<p>
    <b>label(</b>[<i>namevar</i><b>=</b><i>namevar</i>]<b>,</b><i> </i>[<i>yearvar</i><b>=</b><i>yearvar</i>]<b>)</b> labels the data by its name,
        year or both. This is a <b>metan</b> option. Either or both option/s may be
        left blank. For the table display the overall length of the label is
        restricted to 20 characters.
<p>
    <b>eform</b> exponentiates the x-axis labels (valid only when the input
        variables are log transformed, e.g. log odds ratios or log risk
        ratios).
<p>
    <b>scheme</b>(<i>string</i>) specifies the color scheme of the graph. Default is
        <b>grayscale</b>. Can also specify <b>color</b> which can be useful to distinguish
        areas when <b>loe</b> is specified.
<p>
    <b>addplot(</b><i>string</i><b>)</b> allows additional twoway plots to be overlayed on the
        <b>extfunnel</b> plot.
<p>
    <b>level(</b><i>real</i><b>)</b> defines the statistical significance level. Default is 95.
<p>
    <b>twoway_options</b> see <b>[G]</b> <i>twoway_options</i>.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    <b>extfunnel</b> uses a simulation based process, optimised in Mata, to produce
    all statistical significance contour graphs, except when <b>fixedi</b> is used.
    This process can be slightly computationally intensive when <b>cpoints</b> is
    large (&gt;100). We recommend that initial plots are built with the default
    <b>cp</b>(100), with final plots being produced using <b>cp</b>(500).  When
    <b>newstudycontrol</b> and <b>newstudytreatment</b> are used, <b>extfunnel</b> can be very
    computationally intensive as this form of display has not been optimised
    in Mata.
<p>
    Return code 900 or macros overflow can occur when <b>cp</b> is large, this can
    be remedied by reducing <b>cp</b> slightly.
<p>
<p>
<b><u>Examples</u></b>
<p>
    Fixed effect funnel plot with statistical significance contours.
    <b>. extfunnel logOR selogOR</b>
<p>
    Random effect funnel plot with statistical significance contours, with
    summary diamond and a prediction interval displayed.
    <b>. extfunnel logOR selogOR, randomi sumd predict cp(500)</b>
<p>
    Fixed effect funnel plot with statistical significance contours and
    I-squared contours.
    <b>. extfunnel logOR selogOR, isquared(25 35 50)</b>
<p>
    Fixed effect funnel plot with statistical significance contours and
    tau-squared contours.
    <b>. extfunnel logOR selogOR, tausquared(0.5 1 1.5)</b>
<p>
    Random effect funnel plot with user defined limits of clinical
    equivalence.
    <b>. extfunnel ES seES, randomi loe(-0.25 0.25) nometan sumd nopooledline</b>
        <b>loeline cp(400)</b>
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>extfunnel</b> saves the following in <b>r()</b>:
<p>
    Matrices: 
      <b>r(ESmat)</b>              Effect estimate values used to create the plot
      <b>r(seESmat)</b>            Standard error values used to create the plot
      <b>r(status)</b>             Status code for each combination of effect and
                              standard error.
<p>
    <b>r(status)</b> coding: For the stat. sig. plot; coded 0/1/2 i.e. non-sig/stat.
    sig greater than null/stat. sig. less than null. Coded 1 to 8 for limits
    of clinical equivalence, corresponding to default legend.
<p>
    Note: Matrices are not returned under a fixedi statistical significance
    contour plot.
<p>
<p>
<b><u>Authors</u></b>
<p>
    Michael J. Crowther, University of Leicester, United Kingdom.
    michael.crowther@le.ac.uk.
<p>
    Dean Langan, Clinical Trials Research Unit (CTRU), University of Leeds,
    United Kingdom. d.p.langan@leeds.ac.uk.
<p>
    Alex J. Sutton, University of Leicester, United Kingdom. ajs22@le.ac.uk.
 
    Thanks to Rob Herbert and Manuela Ferreira for invaluable suggestions for
    improvement and testing of the command.
 
    Please report any errors you may find.
<p>
<p>
<b><u>References</u></b>
<p>
    Crowther, M. J., Langan, D. and Sutton, A. J. Graphical augmentations to
        the funnel plot assess the impact of a new study on an existing
        meta-analysis: The extfunnel command. <i>The Stata Journal</i> 2012; (In
        Press).
<p>
    Langan, D., Higgins, J. P. T., Gregory, W. and Sutton, A. J. Graphical
        augmentations to the funnel plot assess the impact of additional
        evidence on a meta-analysis. <i>J. Clin. Epidemiology</i> 2012;65(5):511-9.
<p>
    Palmer, T. M., J. L. Peters, A. J. Sutton, and S. G. Moreno. Contour
        enhanced funnel plots for meta-analysis. <i>Stata Journal</i> 2008; 8:
        242-254.
<p>
    Peters, J. L., A. J. Sutton, D. R. Jones, K. R. Abrams, and L. Rushton.
        Contour-enhanced meta-analysis funnel plots help distinguish
        publication bias from other causes of asymmetry. <i>Journal of Clinical</i>
        <i>Epidemiology</i> 2008; 61: 991-996.
<p>
    Sutton AJ, Cooper NJ, Jones DR, Lambert PC, Thompson JR, Abrams KR.
        Evidence-based sample size calculations based upon meta-analysis.
        <i>Statistics in Medicine</i> 2007; 26:2479-2500.
<p>
    Sutton AJ, Donegan S, Takwoingi Y, Garner P, Gamble C, Donald A. An
        encouraging assessment of methods to inform priorities for updating
        systematic reviews. <i>J. Clin. Epidemiol.</i> 2009; 62: 241–251.
<p>
    Sterne, J. A. C., and R. M. Harbord. Funnel plots in meta-analysis. <i>Stata</i>
        <i>Journal</i> 2004; 4: 127-141.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  <b>metan</b> (if installed)
</pre>