<pre>
-------------------------------------------------------------------------------
help for <b>ellip</b>                                                  (SJ4-#: gr32_1)
-------------------------------------------------------------------------------
<p>
<b><u>Graphing confidence ellipses</u></b>
<b><u>[An update of </u></b><b><u>ellip</u></b><b><u> for Stata 8]</u></b>
<p>
        <b>ellip</b> <i>yvar</i> <i>xvar</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b>means</b> <i>common_options</i> ]
<p>
        <b>ellip</b> <i>yvar</i> [<i>xvar</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] <b>,</b> <b>coefs</b> [<b><u>p</u></b><b>ool(</b><i>#</i><b>)</b>
              [<b>plopts(</b><i>line_options</i><b>)</b> <b>pcopts(</b><i>connect_options</i><b>)</b>] <i>common_options</i> ]
<p>
where <i>common_options</i> are:
<p>
              <b><u>c</u></b><b>onstant(</b><i>statname</i> [<i>#</i>] | <i>#</i><b>)</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b>formula(</b><i>acosr</i> | <i>theta</i><b>)</b>
              <b><u>g</u></b><b>enerate(</b><i>ynewvar</i> <i>xnewvar</i><b>)</b> <b><u>nogr</u></b><b>aph</b> <b>replace</b> <b>evr(</b><i>#</i><b>)</b> <b><u>f</u></b><b>rom(</b><i>#</i><b>)</b> <b><u>t</u></b><b>o(</b><i>#</i><b>)</b>
              <b><u>np</u></b><b>oints(</b><i>#</i><b>)</b> <b>overlay</b> <b>total</b> [<b><u>tl</u></b><b>abel(</b><i>label</i><b>)</b>] <b><u>diam</u></b><b>eter(</b><i>#</i><b>)</b>
              [<b>dlopts(</b><i>line_options</i><b>)</b>] <b>plot(</b><i>plot</i><b>)</b> <i>connect_options</i>
              <i>twoway_options</i>
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>ellip</b> calculates a confidence ellipse from the elliptically distributed
    variables <i>yvar</i> and <i>xvar</i>, and then graphs the confidence ellipse using
    <b>graph twoway line</b>. By default, or if the option <b>means</b> is specified, <i>yvar</i>
    and <i>xvar</i> are data variables. If the option <b>coefs</b> is specified, <i>yvar</i> and
    <i>xvar</i> are the first two independent variables after an immediately
    preceding <b>regress</b>. If <b>coefs</b> is specified without <i>xvar</i>, then the <i>_cons</i> in
    <b>regress</b> is used for <i>xvar</i>.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>means</b> | <b>coefs</b> specifies how to center the confidence ellipse. The
        default, and the <b>means</b> option uses two variable means, whereas <b>coefs</b>
        uses the first two regression coefficients from an immediately
        preceding <b>regress</b>. Default subtitles are "Means centered" and
        "Coefficient centered", respectively. If you restricted <b>regress</b> to a
        portion of the data using <b>if</b> or <b>in</b>, then you will generally want to
        use the same conditions with <b>coefs</b>. coefs is not allowed with <b>by()</b>,
        because it would be misleading, since Stata only remembers the last
        set of estimates.
<p>
    <b>pool(</b><i>#</i><b>)</b> displays a confidence ellipse labeled "pooled ellipse, bp" using
        all the data, a confidence ellipse labeled "best subset ellipse, b"
        using a theoretically unproblematic subset, and a connected curve
        labeled "fractionally pooled curve" with # connecting lines. <b>pool()</b>
        must be used with <b>if</b> or <b>in</b>, and with <b>coefs</b>. <b>pool()</b> is incompatible
        with <b>by()</b>, <b>diameter()</b>, and <b>evr()</b>. <b>formula()</b> is ignored. See
        Alexandersson (1998) for examples.
<p>
    <b>plopts(</b><i>line_options</i><b>)</b>, to be used with <b>pool()</b>, affect the rendition of the
        pooled line; see line_options.
<p>
    <b>pcopts(</b><i>connect_options</i><b>)</b>, to be used with <b>pool()</b>, affect the rendition of
        the connecting points in the pooled line; see connect_options. Sort
        options are ignored.
<p>
    <b>constant(</b><i>statname</i> [<i>#</i>] | <i>#</i><b>)</b> specifies the boundary constant c. The overall
        and <b>means</b> default is <b>c(</b><i>4</i><b>)</b> and corresponds to a joint confidence
        interval of 1 - exp^(-#/2) * 100, or 86%. The <b>coefs</b> default is <b>c(</b><i>f</i>
        <i>2</i><b>)</b>. Available statnames are:
<p>
        <i>statname</i>    definition of statname; calculation of c
        -------------------------------------------------------------
        <b>sd</b>          Standard deviation; c = #^2.
                    Confidence level is 1 - exp^(-(#^2)/2) * 100.
                    sd cannot be used with level().
        <b>t2</b>          Hotelling's T2 / n; c = #(n-1)/(n-#) * F.
        <b>pt2</b>         prediction T2; c = t2 * (n+1) / n.
        <b>chi2</b>        Chi-squared; c = chi2(#).
        <b>chi2_n</b>      sample-adjusted chi2; c = chi2(#) / n.
        <b>pchi2_n</b>     Prediction chi2_n; c = chi2(#) / n * (n + 1).
        <b>f</b>           Multiplier-fixed F; c = 2 * F(#,n-#).
        <b>f_scheffe</b>   Scheffe-adjusted F; c = # * F(#,n-#).
        <b>fadj</b>        Denominator-adjusted F; c = 2 * F(2,n-#).
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, in percent, for calculation of
        the confidence ellipse; the default <i>#</i> is 95. <b>level()</b> cannot be used
        with <b>constant(</b><i>sd</i><b>)</b>.
<p>
    <b>formula(</b><i>acosr</i> | <i>theta</i><b>)</b> is included only for the curious users to show
        that two seemingly different formulas are equivalent. <b>formula(</b><i>acosr</i><b>)</b>
        is based on the angular distance, acos(r), and on the amplitudes.
        <b>formula(</b><i>theta</i><b>)</b> is based on the rotation angle of the major axis
        against the x-axis, theta, and on the semi-major and semi-minor axes,
        a and b. <b>formula(</b><i>acosr</i><b>)</b> is the default.
<p>
    <b>generate(</b><i>ynewvar</i> <i>xnewvar</i><b>)</b> generates two new variables, <i>ynewvar</i> and
        <i>xnewvar</i>, which define the confidence ellipse. If the current dataset
        contains fewer observations than in <b>npoints()</b>, then the length of the
        dataset will be expanded accordingly with missing values, even if
        ynewvar and xnewvar are temporary variables, and a warning message is
        displayed. <b>generate()</b> cannot be used with <b>by()</b>.
<p>
    <b>nograph</b> specifies to not construct a graph. In contrast, the built-in
        nodraw option merely suppresses the display of the graph. <b>nograph</b> is
        often used together with <b>generate()</b>.
<p>
    <b>replace</b> replaces any existing variables in <b>generate()</b>.
<p>
    <b>evr(</b><i>#</i><b>)</b> specifies the error variance ratio # of <i>yvar</i> to <i>xvar</i>, where # is a
        floating point number between 0 and 99999. The default is 1. The
        ratio 0 corresponds to regression of x on y, 1 corresponds to
        orthogonal regression and the major axis, and a very large number,
        say 99999, corresponds to regression of y on x. See McCartin (2003).
<p>
    <b>from(</b><i>#</i><b>)</b> specifies the value from which the ellipse parameter runs. The
        default is 0. You only need to specify this option if you do not want
        to display the beginning of an ellipse.
<p>
    <b>to(</b><i>#</i><b>)</b> specifies the value to which the ellipse parameter runs. The
        default is 2 pi. You only need to specify this option if you do not
        want to display the end of an ellipse. If <b>from()</b> is smaller than
        <b>to()</b>, as by default, the parameter runs clockwise. Otherwise, the
        parameter runs counter-clockwise.
<p>
    <b>overlay</b>, to be used with <b>by()</b>, creates an overlaid graph for all
        by-groups. <b>overlay</b> cannot be used with <b>by(</b><i>..., total</i><b>)</b>.
<p>
    <b>total</b>, to be used with <b>by()</b>, adds an extra by-group with a confidence
        ellipse for the entire dataset.
<p>
    <b>tlabel(</b><i>label</i><b>)</b>, to be used with <b>total</b>, adds a user-specified label for the
        by-graph produced by the option total. The default label is "Total".
<p>
    <b>diameter(</b><i>#</i><b>)</b> adds a diameter of the ellipse with slope -99999 &lt;= <i>#</i> &lt;=
        99999. A diameter of the ellipse is any chord through the center of
        the ellipse. The option is incompatible with <b>pool()</b>.
<p>
    <b>rlopts(</b><i>line_options</i><b>)</b>, to be used with <b>refline()</b>, affect the rendition of
        the reference line; see line_options.
<p>
    <b>plot(</b><i>plot</i><b>)</b> provides a way to add other plots to the generated graph; see
        help plot_option. By default, when this option is specified, the
        legend appears; see help legend_option. By default the descriptive
        text in the legend is obtained from the y-variables' variable labels.
        Examples of such plots are another confidence ellipse, a regression
        line, inscribing reference lines, a scatter plot of <i>yvar</i> and <i>xvar</i> and
        of the midpoint.
<p>
    <i>connect_options</i> are any of the options documented in help 
        connect_options. The options <b>sort</b>[<b>(</b><i>varlist</i><b>)</b>] and <b>cmissing(</b>{<b>y</b>|<b>n</b>} ...<b>)</b>
        are ignored. The default is <b>cmissing(n</b> ...<b>)</b>, meaning that ellipses
        are not connected to each other.
<p>
    <i>twoway_options</i> are any of the options documented in help twoway_options.
        These include options for titling the graph (see help title_options),
        options for saving the graph to disk (see help saving_option), and
        the <b>by()</b> option (see help by_option). The <b>by()</b> option is incompatible
        with the option <b>pool()</b>.  <b>by(</b><i>..., total</i><b>)</b> adds an extra by-group for
        all by-groups combined; it may not be used with the option <b>overlay</b>.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    This is version 2 of <b>ellip</b>, see Alexandersson (1998).  Two of the most
    notable new features are the feature to graph confidence ellipses around
    variable means, and the feature to add inscribed lines. These features
    allow a geometric characterization of linear regression with unequal
    error variances, as in McCartin (2003). To access the dialogs
    interactively, type<b> db ellip</b> or see help ellip_dlg. To create menu items
    permanently, copy these lines to <b>profile.do</b>:
<p>
<p>
    <b> if _caller() &gt; 7 {</b>
    <b>     if "`c(console)'"=="" {</b>
    <b>         window menu append submenu "stUserGraphics" "Confidence Ellipses"</b>
    <b>         window menu append item "Confidence Ellipses" ///</b>
    <b>             "for Means" "db ellip_means"</b>
    <b>         window menu append item "Confidence Ellipses" ///</b>
    <b>             "for Regression Coefficients" "db ellip_coefs"</b>
    <b>     }</b>
    <b> }</b>
<p>
<p>
    Results are saved in r(); see help return list.
<p>
<p>
<b><u>Examples</u></b>
<p>
    <b>. sysuse auto, clear</b>
<p>
    <b>. ellip mpg weight</b>              // graph the default ellipse with c(4)
      <i>(</i><i>click to run</i><i>)</i>
          
    <b>. ellip mpg weight, g(ey ex)</b>    // also generate the ellipse variables
<p>
    <b>. ellip mpg weight, c(t2) plot(line ey ex)</b>
          // overlaid graph of 95% T2 and default ellipses
<p>
    <b>. reg mpg weight</b>
    
    <b>. ellip weight, coefs c(chi2)</b>
          // 95% Chi-square confidence ellipse around _b[weight] and _b[_cons]
          
    Many more examples are available in a test script package on SSC. To find
    out details: ssc describe ellip. To download: ssc install ellip and net
    get ellip.
<p>
<p>
<b><u>Author</u></b>    
<p>
        Anders Alexandersson, Mississippi State University, USA
        Email: aa1@msstate.edu.  
   
   
<b><u>References</u></b>
<p>
    Alexandersson, A. 1998. gr32: Confidence ellipses. <i>Stata Technical</i>
        <i>Bulletin</i> 46: 10-13. In <i>Stata Technical Bulletin Reprints</i>, vol. 8,
        54-57. College Station, TX: Stata Press.
<p>
    McCartin, B. 2003. A Geometric Characterization of Linear Regression.
        <i>Statistics: A Journal of Theoretical and Applied Statistics</i> 37(2):
        101-117.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[G] graph twoway</b>, <b>[G] graph twoway line</b>
<p>
</pre>