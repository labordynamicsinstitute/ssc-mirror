<pre>
<b>help emh</b>                                                 Version 1.0 2010-10-12
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>emh</b> -- Extended Mantel-Haenszel Statistics
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>emh</b> <i>var1</i> <i>var2</i> [<i>if</i>] [<i>in</i>] [<i>weight</i>] [<b>,</b> <i>options</i>]
<p>
    <i>options</i>                     Description
    -------------------------------------------------------------------------
    Main
      <b><u>s</u></b><b>trata(</b><i>varlist</i><b>)</b>           stratify on <i>varlist</i>
      <b><u>c</u></b><b>orrelation</b>               Correlation Statistic; the default
      <b><u>a</u></b><b>nova</b>                     ANOVA (Mean Scores) Statistic
      <b><u>g</u></b><b>eneral</b>                   General Association Statistic
      <b><u>t</u></b><b>ransformation(</b><i>scoretype</i><b>)</b> use transformation scores, e.g., ranks
    -------------------------------------------------------------------------
    <b>by</b> is allowed; see <b>[D] by</b>.
    <b>fweight</b>s are allowed; see weight.
    Only one of <b>correlation</b>, <b>anova</b> and <b>general</b> is permitted at a time.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>emh</b> calculates extended Mantel-Haenszel chi-square test statistics (also
    known as Cochran-Mantel-Haenszel Statistics) for stratified tables.
    Tables are defined by <i>var1</i> and <i>var2</i>, both which must be numeric.
    Stratification is optional.
<p>
<p>
<b><u>Options</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>strata(</b><i>varlist</i><b>)</b> specifies variables on which to stratify the analysis.
        Stratification variables may be numeric, string or a mix of the two.
<p>
    <b>correlation</b> Correlation Statistic--tests for a linear association between
        <i>var1</i> and <i>var2</i>.  Suitable when both are at least ordinal.
<p>
    <b>anova</b> ANOVA (Row Mean-score Differences) Statistic--tests for a
        difference in means of <i>var1</i> between groups that are defined by <i>var2</i>.
        Suitable when <i>var1</i>, the response variable, is at least ordinal.
        <i>var2</i>, the predictor variable, may be nominal (unordered).
<p>
    <b>general</b> General Association Statistic--most general form of association;
        of interest especially when both <i>var1</i> and <i>var2</i> are nominal.
<p>
    <b>transformation(</b><i>scoretype</i><b>)</b> When <b>correlation</b> is specified, transforms both
        <i>var1</i> and <i>var2</i>; when <b>anova</b> is specified, transforms the response
        variable (<i>var1</i>).  This option is ignored when <b>general</b> is specified.
        Available <i>scoretype</i>s are <i>table</i> (untransformed--the default), <i>integer</i>,
        <i>rank</i>, <i>ridit</i>, <i>modridit</i> (standardized midranks), <i>savage</i> (Savage
        scores), <i>mood</i> (Mood scores), <i>median</i> (above or at-or-below median),
        <i>vdw</i> (van der Waerden scores) and <i>klotz</i> (Klotz scores).
<p>
<p>
<b><u>Remarks</u></b>
<p>
    <b>emh</b> computes chi-square test statistics for association of row and column
    variables in unstratified or stratified tables.  A good introduction to
    the use of these statistics is Chapters 2 through 7 of M. E. Stokes, C.
    S. Davis and G. G. Koch, <i>Categorical Data Analysis Using the SAS(R)</i>
    <i>System</i> Second Edition.  Cary, North Carolina:  SAS Institute, 2000.
<p>
    <b>emh</b> uses tabulate internally.  The number of levels of <i>var1</i> and <i>var2</i> are
    limited to what <b>tabulate</b> can accept.  In order to accommodate an analysis
    with many levels of either or both of these variables, e.g., with
    continuous variables, matsize and memory might need to be set larger.
<p>
    Computing extended Mantel-Haenszel statistics involves inverting a pooled
    covariance matrix.  For some datasets, the matrix might be singular.
    When this occurs, a warning is displayed, and the chi-square statistic
    and associated p-value are set to missing.  Such occurrences are more
    likely when requesting the General Association statistic for a dataset
    with many levels of row and column variables and with a substantial
    amount of missing data.
<p>
    Some transformation types available in <b>emh</b> have an established use in
    unstratified two-group mean score-difference analysis, e.g., Mood test,
    van der Waerden test, Klotz test.  Their use does not appear so well
    known in stratified analysis of multi-group (&gt;2) datasets.  In this
    context, such transformations might not display the desired sensitivity
    to location or scale difference.  In general, users should exercise care
    in choosing whether and how to employ various scoring schemes.
<p>
<p>
<b><u>Examples</u></b>
<p>
    <b>. sysuse auto</b>
<p>
    <b>. emh rep78 price, s(foreign)</b>
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>emh</b> saves the following in <b>r()</b>:
<p>
    Scalars   
      <b>r(chi2)</b>        chi-square test statistic
      <b>r(df)</b>          degrees of freedom for chi-square statistic
      <b>r(p)</b>           p-value for reported chi-square statistic and degrees of
                       freedom
<p>
    Macros    
      <b>r(scoretype)</b>   short-name for score type, as specified in
                       <b>transformation(</b><i>scoretype</i><b>)</b>
      <b>r(ScoreType)</b>   formal name for score type, as displayed in output
<p>
<p>
<b><u>Author</u></b>
<p>
    J. Coveney E-mail jcoveney@bigplanet.com if you observe any problems.
<p>
<p>
<b><u>Also see</u></b>
<p>
      Help:  <b>[ST] epitab</b>; vanelteren (if installed), somersd (if installed), 
             <b>[R] tabulate twoway</b>
</pre>