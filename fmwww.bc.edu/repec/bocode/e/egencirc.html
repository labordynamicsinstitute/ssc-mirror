<pre>
-------------------------------------------------------------------------------
help for <b>egencirc</b>
-------------------------------------------------------------------------------
<p>
<b><u>Extensions to generate (circular functions)</u></b>
<p>
        <b>egen</b> [<i>type</i>] <i>newvar</i> <b>=</b> <i>fcn</i><b>(</b><i>arguments</i><b>)</b> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <i>options</i>]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>egen</b> creates <i>newvar</i> of the optionally specified storage type equal to
    <i>fcn</i><b>(</b><i>arguments</i><b>)</b>.  Depending on <i>fcn()</i>, <i>arguments</i>, if present, refers to an
    expression, <i>varlist</i>, or a <i>numlist</i> and the <i>options</i> are similarly <i>fcn</i>
    dependent.
<p>
    This help file documents various user-written <b>egen</b> functions for use with
    circular variables, usually measured on a scale from 0 to 360 degrees.
<p>
<p>
<b><u>egen</u></b><b><u> functions</u></b>
<p>
    <b>atan2(</b><i>sinevar cosinevar</i><b>)</b> [ <b>,</b> <b><u>rad</u></b><b>ians</b> ] returns the arctangent of two
        variables <i>sinevar</i> and <i>cosinevar</i> as a angle in the range 0 to 360
        degrees.  The option <b>radians</b> specifies that the results should be in
        radians.
<p>
    <b>invvm(</b><i>exp</i><b>)</b> [<b>,</b> <b><u>k</u></b><b>appa(</b><i>#</i><b>)</b> <b>tol(</b><i>#</i><b>)</b> <b>log</b> <b><u>rad</u></b><b>ians</b> ] returns the inverse
        distribution function (quantile function) of a variable following a
        von Mises distribution with vector mean zero and concentration
        parameter specified by the <b>kappa()</b> option as angles in the range -180
        to 180 degrees, and as a function of an expression giving cumulative
        probabilities and so taking values between 0 and 1.  If <b>kappa()</b> is
        not specified, the function looks for <b>r(kappa)</b>, as is left in memory
        by circvm. The quantile function is calculated using the <b>vm()</b>
        function documented below and an algorithm given by Fisher (1993,
        p.53). (Note that the steps of that algorithm should be numbered 1 to
        4, contrary to early printings of Fisher 1993.) The default tolerance
        for that algorithm is 1e-6. This may be varied by the <b>tol()</b> option.
        The <b>log</b> option may be used to see a display of the maximum error of
        approximation as the algorithm proceeds, as a check on convergence.
        <b>tol</b> and <b>log()</b> are technical options and are rarely used.  The option
        <b>radians</b> specifies that the results should be in radians.
<p>
    <b>rndvm(),</b> [<b>,</b> <b><u>k</u></b><b>appa(</b><i>#</i><b>)</b> <b><u>m</u></b><b>u(</b><i>#</i><b>)</b> <b><u>rad</u></b><b>ians</b> ] returns a random sample from a von
        Mises distribution with vector mean specified by the <b>mu()</b> option and
        concentration parameter specified by the <b>kappa()</b> option, as angles in
        the range 0 to 360 degrees. Note that no argument is required or
        allowed.  If <b>mu()</b> is not specified, the function looks for
        <b>r(vecmean)</b>, as is left in memory by circvm; if that is not found, a
        value of 0 is assumed.  Any argument of <b>mu()</b> should be in degrees.
        If <b>kappa()</b> is not specified, the function looks for <b>r(kappa)</b>, as is
        left in memory by circvm. The random sample is calculated using an
        algorithm introduced by Best and Fisher (1979) and given by Fisher
        (1993, p.49) and Mardia and Jupp (2000, p.43). The option <b>radians</b>
        specifies that the results should be in radians.
<p>
    <b>vm(</b><i>varname</i><b>),</b> [<b>,</b> <b><u>k</u></b><b>appa(</b><i>#</i><b>)</b> <b><u>m</u></b><b>u(</b><i>#</i><b>)</b> <b><u>rad</u></b><b>ians</b> ] returns the cumulative
        distribution function of a von Mises distribution with vector mean
        specified by the <b>mu()</b> option and concentration parameter specified by
        the <b>kappa()</b> option, given angles in the range 0 to 360 degrees.  If
        <b>mu()</b> is not specified, the function looks for <b>r(vecmean)</b>, as is left
        in memory by circvm; if that is not found, a value of 0 is assumed.
        Any argument of <b>mu()</b> should be in degrees, unless the <b>radians</b> option
        is also specified.  If <b>kappa()</b> is not specified, the function looks
        for <b>r(kappa)</b>, as is left in memory by circvm. The distribution
        function is calculated using an algorithm discussed and implemented
        in Fortran by Hill (1976, 1977), using choices of constants to ensure
        accuracy to 8 decimal places (see Hill 1977, p.280).  The option
        <b>radians</b> specifies that the inputs are in radians.
<p>
    <b>vmden(</b><i>varname</i><b>)</b> [<b>,</b> <b><u>k</u></b><b>appa(</b><i>#</i><b>)</b> <b><u>m</u></b><b>u(</b><i>#</i><b>)</b> <b><u>rad</u></b><b>ians</b> ] returns the density function
        of a von Mises distribution with vector mean specified by the <b>mu()</b>
        option and concentration parameter specified by the <b>kappa()</b> option,
        given angles in the range 0 to 360 degrees.  If <b>mu()</b> is not
        specified, the function looks for <b>r(vecmean)</b>, as is left in memory by
        circvm; if that is not found, a value of 0 is assumed.  Any argument
        of <b>mu()</b> should be in degrees, unless the <b>radians</b> option is also
        specified.  If <b>kappa()</b> is not specified, the function looks for
        <b>r(kappa)</b>, as is left in memory by circvm.  The option <b>radians</b>
        specifies that the inputs are in radians.
<p>
<p>
<b><u>Remarks</u></b> 
   
    <b>invvm()</b> and <b>vmden()</b> use the calculator function i0kappa.
<p>
<p>
<b><u>Examples</u></b>
<p>
    <b>. egen angle = atan2(sine cosine)</b>
<p>
    <b>. circvm wallasp</b>
    <b>. egen rndvm = rndvm()</b>
    <b>. egen Fvm = vm(wallasp)</b>
    <b>. egen vmden = vmden(wallasp)</b>
<p>
<p>
<b><u>Author</u></b> 
<p>
    Nicholas J. Cox, University of Durham, U.K.
    n.j.cox@durham.ac.uk
<p>
<p>
<b><u>References</u></b>
<p>
    Best, D.J. and Fisher, N.I. 1979.  Efficient simulation of the von Mises
        distribution.  <i>Applied Statistics</i> 28: 152--157.
<p>
    Fisher, N.I. 1993. <i>Statistical analysis of circular data.</i>  Cambridge:
        Cambridge University Press.
<p>
    Hill, G.W. 1976. New approximations to the von Mises distribution.
        <i>Biometrika</i> 63: 673--676. (Erratum 1997, 64: 655.)
<p>
    Hill, G.W. 1977. ALGORITHM 518: Incomplete Bessel function I_0:  the von
        Mises distribution. <i>ACM Transactions on Mathematical Software</i> 3:
        279--284.
<p>
    Mardia, K.V. and Jupp, P.E. 2000. <i>Directional statistics.</i>  Chichester:
        John Wiley.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[R] egen</b>
<p>
</pre>