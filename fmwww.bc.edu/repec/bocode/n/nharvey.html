<pre>
-------------------------------------------------------------------------------
help for <b>nharvey</b>                          (StataList distribution 17 July 2001)
-------------------------------------------------------------------------------
<p>
<b><u>Nyblom-Harvey panel test of common stochastic trends</u></b>
<p>
        <b>nharvey</b> <i>varname</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [ , <b><u>V</u></b><b>lags({itnumlist})</b> <b><u>t</u></b><b>rend</b> <b>nolrv</b>
              ]
<p>
<b>nharvey</b> is for use with panel data.  You must <b>tsset</b> your data before using
<b>nharvey</b>, using the panel form of <b>tsset</b>; see help tsset.
<p>
<i>varname</i> may contain time-series operators; see help varlist.
<p>
<p>
<b><u>Description</u></b>
<p>
<b>nharvey</b> estimates one form of the test of common stochastic trends developed by
Nyblom and Harvey (NH, 2000). The test is of the validity of a specified value
of the rank of the covariance matrix of the disturbances driving the
multivariate random walk. This rank is equal to the number of common trends, or
levels, in the series. As NH show, "this test is very simple insofar as it does
not require any models to be estimated, even if serial correlation is present."
(p.176) The special case calculated by <b>nharvey</b> is that of the rank (<b>K</b> in NH'
terms) equalling zero, which may be taken as a test that there are no common
trends among the variables. NH state that "common trends imply cointegration,
and vice versa." Thus a failure to reject the null hypothesis of zero common
trends is also an indication that the variables do not form a cointegrated
combination.
<p>
The test may be considered as a generalization of the Nyblom and Makelainen (19
&gt; 83) and
Kwiatkowski et al. (1992, kpss) univariate tests for stationarity of a series. 
Those tests are of the null hypothesis that the series is stationary, or statio
&gt; nary
around a deterministic trend, against the alternative that a random walk compon
&gt; ent
is present. <b>nharvey</b> considers the same structure in the context of multiple
time series. By default the routine calculates the test statistic for both IID 
&gt; errors
and errors allowed to be serially correlated, using an estimate of the long-run
variance derived from the spectral density matrix at frequency zero. 
<p>
The critical values for <b>nharvey</b> for the constant and trend case are tabulated
in NH, 2000. They show that the asymptotic distribution of the test statistic d
&gt; epends
only on the number of series (N) and the hypothesized number of common trends.
The critical values for (<b>K=0</b>) of NH Tables 1 and 2 have been extended for 
additional values of N via simulation of the asymptotic distribution (programs 
available on request).
 
<b>nharvey</b> may be extended to test the hypothesis that the rank of the covariance 
matrix, (<b>K</b>) takes on a certain value, less than N (the number of series), 
against the alternative that it has a greater value. That extension is left to 
&gt; future
development.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>trend</b> includes a time trend in the model (NH Table 2 for K=0).
<p>
<b>vlags</b> specifies a list of lags to be used in calculating the long-run variance.
    If this option is not specified, <b>m</b>, the truncation point in NH Eqn. 16, is
    calculated as T^0.25. If a list of lags is provided (perhaps with a local
    macro), the long-run variance matrix and resulting test statistic is
    calculated for each value of vlags.
<p>
<b>nolrv</b> omits the calculation of the statistic using a long-run variance
    estimator. For a large sample size (T), the calculation of this statistic
    involves a very sizable amount of computation, and the routine will be very
    slow.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . use http://fmwww.bc.edu/ec-p/data/hayashi/sheston91.dta,clear
<p>
        .  nharvey rgdppc if country&lt;11
<p>
        .  nharvey rgdppc if country&lt;11, vlag(2(2)6)
<p>
        .  nharvey D.rgdppc if country&lt;11, trend
<p>
<b><u>References</u></b>
<p>
Kwiatkowski, D., Phillips, P.C.B., Schmidt, P. and Y. Shin. Testing the
null hypothesis of stationarity against the alternative of a unit root:
How sure are we that economic time series have a unit root? Journal of
Econometrics, 54, 1992, 159-178.
<p>
Nyblom, Jukka and Andrew Harvey. Tests of common stochastic trends. Econometric
Theory, 16, 2000, 176-199.
<p>
Nyblom, Jukka, and T. Makelainen. Comparison of tests for the presence of
random walk coefficients in a simple linear model. Journal of the American
Statistical Association, 78, 1983, 856-864.  
<p>
<b><u>Acknowledgements</u></b>
<p>
We thank Jukka Nyblom for clarifications on the calculation of critical 
values for the routine, and pointing out typographical errors in the article. W
&gt; e are
also very grateful to Nina Jones for detecting and diagnosing an error in the
computations and benchmarking our corrected code against her MATLAB code.
Remaining errors are our own.
<p>
<b><u>Authors</u></b>
<p>
Christopher F Baum, Boston College, USA, baum@bc.edu
Fabian Bornhorst, European University Institute, Italy, Fabian.Bornhorst@iue.it
<p>
<b><u>Also see</u></b>
<p>
On-line:  kpss (if installed), hadrilm (if installed), madfuller (if
</pre>