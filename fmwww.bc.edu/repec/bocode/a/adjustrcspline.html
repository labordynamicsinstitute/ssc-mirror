<pre>
<p>
help for <b>adjustrcspline</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>adjustrcspline</b> -- Displays the adjusted predictions after using a
                        restricted cubic spline.
<p>
<b><u>Syntax</u></b>
<p>
        <b>adjustrcspline</b> [<i>if</i>] [<i>in</i>] <b>,</b> [ <b>at(</b><i>var </i><b>=</b><i> # </i>[<i>var </i><b>=</b><i> # </i>[...]]<b>)</b>
               <b>link(</b><i>linkname</i><b>)</b> <b><u>cus</u></b><b>tominvlink(</b><i>inv_link_specification</i><b>)</b>
               <b><u>ci</u></b><b>opts(</b><i>rarea_options</i><b>)</b> <b>noci</b> <b>level(</b><i>#</i><b>)</b> <b><u>line</u></b><b>opts(</b><i>line_options</i><b>)</b>
               <b>addplot(</b><i>plot</i><b>)</b> <b><u>gen</u></b><b>erate(</b><i>newvar1 </i>[<i>newvar2 newvar3</i>]<b>)</b> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>adjustrcspline</b> displays a graph of adjusted predictions, after estimating
    a model that uses a restricted cubic spline as an explanatory variable.
    All other variables are set to their mean value or, if the <b>at()</b> option is
    specified, to the specified numbers. The restricted cubic spline needs to
    be created using <b>mkspline2</b>.
<p>
    <b>adjustrcspline</b> will automatically compute the appropriate expected values
    (i.e. detect the appropriate link function) for the following commands:
    <b>regress</b>, <b>logit</b>, <b>logistic</b>, <b>betafit</b>, <b>probit</b>, <b>poisson</b>, <b>cloglog</b>, and <b>glm</b>
    (with the exception of the negative binomial link function). For other
    commands users can specify the appropriate link function using the <b>link()</b>
    option. With the <b>link()</b> option you can specify the dentity, logit,
    probit, log, log-complement, log-log, complementary log-log, reciprocal,
    power, and the odds power links. If your model uses another link function
    you can specify that inverse link function (the transformation that needs
    to be applied to the linear predictor in order to get a prediction in the
    metric of the dependent variable ) with the <b>custominvlink()</b> option.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>at(</b><i>var </i><b>=</b><i> # </i>[<i>var </i><b>=</b><i> # </i>[...]]<b>)</b> specifies the values of the other explanatory
        variables (and offset or exposure) at which the predicted values are
        calculated. The default is to set all variables at their mean.
<p>
        The only exception is the default when the<b> exposure()</b> option is
        specified in the estimation command. In that case the default is to
        set the exposure equal to the exp(mean(offset)).
<p>
    <b>link(</b><i>linkname</i><b>)</b> specifies the link function used for computing the
        predictions. The link functions that can be specified are:  identity,
        logit, probit, log, logcomplement, loglog, cloglog, reciprocal, power
        #, opower #. These link functions are described in <b>[R] glm</b> and
        (Hardin and Hilbe 2001).
<p>
    <b>custominvlink(</b><i>inv_link_specification</i><b>)</b> specifies a user specified inverse
        link funtion, i.e. the transformation of the linear predictor that
        leads to the metric of the dependent variable. The syntax is the same
        as in predictnl, in particular the linear predictor can be specified
        with <b>xb()</b>.
<p>
    <b>ciopts(</b><i>rarea_options</i><b>)</b> specifies options of twoway rarea to tune the
        display of the confidence interval.
<p>
    <b>noci</b> suppresses the display of the confidence interval.
<p>
    <b>level(</b><i>#</i><b>)</b> specifies a confidence level to use for confidence intervals.
        See help on level.
<p>
    <b>lineopts(</b><i>line_options</i><b>)</b> specifies options of twoway line to tune the
        display of the point estimates of the adjusted predictions.  These
        options can also be added directly, which can be convenient to change
        for instance the legend, axis titles, etc.
<p>
    <b>addplot(</b><i>plot</i><b>)</b> provides a way to add other plots to the generated graph.
        See help on addplot_option.
<p>
    <b><u>gen</u></b><b>erate(</b><i>newvar1 </i>[<i>newvar2 newvar3</i>]<b>)</b> specifies that the values of the
        adjusted predictions and optionally the lower and upper bounds of the
        confidence interval be saved in <i>newvar1</i>, <i>newvar2</i> and <i>newvar3</i>
        respectively.
<p>
<p>
<p>
<b><u>Examples</u></b>
<p>
<p>
<p>
<b>    sysuse nlsw88, clear</b>
<b>    recode grade 0/5=5</b>
<b>        </b>
<b>    mkspline2 grades = grade, cubic nknots(3)</b>
<b>    logit never_married grades*</b>
<b>        </b>
<b>    adjustrcspline</b>
<p>
    (click to run)
<p>
<p>
<p>
<b>    sysuse uslifeexp, clear</b>
<b>    </b>
<b>    mkspline2 ys = year, cubic</b>
<b>    reg le ys* if year != 1918</b>
<b>        </b>
<b>    adjustrcspline if year != 1918,                             ///</b>
<b>        addplot(scatter le year if year != 1918, msymbol(Oh) || ///</b>
<b>                scatter le year if year == 1918, msymbol(X) )   ///</b>
<b>        ytitle("life expectancy")                               ///</b>
<b>        note("1918 was excluded from the computations because of the Spanish fl</b>
<b>&gt; u")</b>
<p>
    (click to run)
<p>
<p>
<p>
<b>    sysuse nlsw88, clear</b>
<b>    recode grade 0/5=5</b>
<b>        </b>
<b>    mkspline2 grades = grade, cubic nknots(3)</b>
<b>    logit never_married grades*</b>
<b>        </b>
<b>    adjustrcspline, custominvlink("1/(1+exp(-1*xb()))")</b>
<p>
    (click to run)
<p>
<p>
<p>
<b>    sysuse nlsw88, clear</b>
<b>    recode grade 0/5=5</b>
<b>        </b>
<b>    mkspline2 grades = grade, cubic nknots(3)</b>
<b>    glm never_married grades* south, link(cloglog) family(binomial)</b>
<b>    </b>
<b>    adjustrcspline, at(south=0)</b>
<p>
    (click to run)
<p>
<p>
<p>
<b>    sysuse cancer, clear</b>
<b>    gen long id = _n</b>
<b>    stset studytime, failure(died) id(id)</b>
<b>        </b>
<b>    stsplit t, every(1)</b>
<p>
<b>    mkspline2 ts=t, cubic nknots(3)</b>
<b>    xi: streg i.drug age ts*, dist(exp)</b>
<b>        </b>
<b>    adjustrcspline , at(_Idrug_2=0 _Idrug_3=0) ///</b>
<b>                     link("log")               ///</b>
<b>                     noci                      ///</b>
<b>                     ytitle(hazard)</b>
<p>
    (click to run)
<p>
<p>
<b><u>References</u></b>
    James W. Hardin and Joseph M. Hilbe (2001) <i>Generalized Linear Models and</i>
    <i>Extensions</i>, 2nd edition.  College Station, TX: Stata Press.
<p>
<p>
<b><u>Author</u></b>
<p>
    Maarten L. Buis
    Universitaet Tuebingen
    Institut fuer Soziologie
    maarten.buis@ifsoz.uni-tuebingen.de
<p>
<p>
<b><u>Suggested citation if using adjustrcspline in published work</u></b>
<p>
    <b>adjustrcspline</b> is not an official Stata command. It is a free
    contribution to the research community, like a paper. Please cite it as
    such.
<p>
    Buis, Maarten L.  2009. "POSTRCSPLINE: Stata module containing
    post-estimation commands for models using a restricted cubic spline" 
    http://ideas.repec.org/c/boc/bocode/s456928.html
<p>
<p>
<b><u>Also see</u></b>
<p>
<p>
    If installed: <b>mfxrcspline</b>, <b>mkspline2</b>, <b>rcspline</b>
</pre>