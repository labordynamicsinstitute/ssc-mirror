<pre>
-------------------------------------------------------------------------------
help for <b>brrmodel</b>
-------------------------------------------------------------------------------
<p>
<b><u>Model estimates with balance repeated replication (BRR) based standard errors</u></b>
<p>
        <b>brrmodel</b> <i>varlist</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>brrw</u></b><b>eight(</b><i>varlist</i><b>)</b>
               <b>fay(</b><i>#</i><b>)</b> <b>deff</b> <b>deft</b> <b>cmd(</b><i>command name</i><b>)</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b>dof(</b><i>#</i><b>)</b> <b>or</b>
               <i>command_options</i> ]
<p>
<p>
<b>pweight</b>s are allowed; see help weights.  Analysis weights are required, and
must be specified with the command, or by the svyset pweight command.
<p>
<p>
<b><u>Description</u></b>
<p>
<b>brrmodel</b> estimates regression-type models for complex survey data.  Standard
errors are calculated using a series of user-supplied replication weights, by
the balanced repeated replication (BRR) method.  This is an alternate method to
the Taylor series linearization methods used by Stata's svy-based commands.
<p>
It will run ols regression, logit/probit, ordered logit/probit, multinomial
logit, and poisson regression models.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>brrweight()</b> specifies the list of variables that contain the replicate weights
    for the dataset.  The standard errors for the model are based on the
    variation in the estimates generated across the various weights.
<p>
    A set of <b>brrweights</b> is required for the analysis.  Once the brrweights are
    specified they are stored as a characteristic of the dataset and need not
    be respecified in subsequent command.
<p>
<b>fay()</b> specifies the k value that should be used for weighting the estimates,
    based on Fay's method.  The default is zero, meaning that simple averaging
    will be used.  As with the replicate weights, the value for fay() is stored
    as a characteristic of the dataset once it is specified, and need not be
    re-specified in subsequent commands.
<p>
<b>dof()</b> specifies the degrees of freedom for model fit and t-statistics.  The
    default is to use the number of replications.
<p>
<b>deff</b> and <b>deft</b> request that design effects deff and deft be displayed with the
    model estimates.  See <b>[R] svymean</b> for details.
<p>
<b>cmd()</b> specifies the model estimation command.  Valid options are regress logit 
    probit logistic oprobit, ologit, mlogit and poisson.  The default is ols
    regression.
<p>
<b>or</b> specifies that coefficients from a logit model should be displayed as
    odds-ratios.  See logit.
<p>
<p>
<b><u>Example command and output</u></b>
<p>
        . brrmodel income region sex asset [pw=wgt] , brrw(bwgt*)
<p>
        OLS estimates with BRR-based standard errors
<p>
        Analysis weight:      wgt              Number of obs       =      1904
        Replicate weights:    bwgt*            Population size     =     10738
        Number of replicates: 20               Degrees of freedom  =        20
        k (Fay's method):     0.000            F(   3,     18)     =     86.40
                                               Prob &gt; F            =    0.0000
                                               R-squared           =    0.0057
<p>
        -----------------------------------------------------------------------
-------
              income |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. In
&gt; terval]
        -------------+---------------------------------------------------------
-------
              region |   .6214526    .116294     5.34   0.000     .3788676    .
&gt; 8640376
                 sex |  -1.121041   .2671536    -4.20   0.000    -1.678313   -.
&gt; 5637684
               asset |   .1274654   .0077771    16.39   0.000     .1112427    .
&gt; 1436881
               _cons |   37.61598   .5194737    72.41   0.000     36.53238    3
&gt; 8.69959
        -----------------------------------------------------------------------
-------
<p>
<p>
<b><u>Saved Results</u></b>
<p>
<b>brrmodel</b> is an estimation command, so it saves model estimates and brr-based (c
&gt; o)variance 
matrix in e(b) and e(V) and creates e(sample) to reflect the estimation sample.
&gt;   It also stores design effects
in e(deff) and e(deft), and the simple-random-sampling-without-replacement (co)
&gt; variance matrix in e(V_srs).
<p>
svytest will estimate adjusted Wald linear hypothesis tests after BRR model
estimation.  (<b>brrmodel</b> specifies the estimation command as "svybrrmodel" in
order to allow <b>svytest</b> to function.)
<p>
Scalars e(N_strata) and e(N_psu) are set in order to allow <b>svytest</b> to operate c
&gt; orrectly.  N_strata
is set to the degrees of freedom for the model (by default the number of replic
&gt; ates), and N_psu is set to twice the
degrees of freedom.
<p>
predict after an estimation should work as documented for the relevant command.
&gt;   Warning: this
has not been tested extensively.
<p>
<p>
<b><u>Methods and formulae</u></b>
<p>
Point estimates are calculated using aweights, and are identical to those
produced by Stata's svy-based commands.  The variance matrix of the estimates
is formed by calculating
<p>
                   G    
                V = c * SUM [ (B - B(i))(B - B(i))' ]
                  i=1
<p>
where B is the estimated coefficient vector based on the full sample weights,
B(i) is the estimated coefficient vector using the i'th set of replicate
weights, G is the number of replicates, and c is a constant defined as:
<p>
         1 / G            for standard BRR (i.e. fay==0), or
<p>
         1 / (G*(1-k)^2)  for Fay's method.
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
I would like to thank Bobby Gutierrez at StataCorp for advice on implementation
of BRR.
<p>
<p>
<b><u>Author</u></b>
<p>
        Nick Winter
        Cornell University
        nw53@cornell.edu
<p>
</pre>