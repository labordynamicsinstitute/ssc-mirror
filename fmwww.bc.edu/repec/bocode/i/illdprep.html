<pre>
<b>help illdprep</b> 
                            also see:  <b>stpm2  stpm2illd  stpm2_postestimation  </b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>illdprep</b> --  Sets the data up in the format required for illness death
                   models using <b>stpm2</b> and <b>stpm2illd</b>.
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>illdprep</b> [<b>,</b> <i>options</i>]
<p>
    <i>options</i>                             Description
    -------------------------------------------------------------------------
    <b>id</b>                                   specifies the name of the ID
                                          variables in your data set.
    <b>statevar</b>                             specifies the names of the two event
                                          indicator variables e.g. relapse
                                          and dead.
    <b>statetime</b>                            specifies the names of the two event
                                          time variables e.g. relapsetime and
                                          survtime.
    <b>status</b>                               allows user to specify the name of
                                          the newly generated status
                                          variable.
    -------------------------------------------------------------------------
<p>
<b><u>Description</u></b>
<p>
    <b>illdprep</b> is used to set up the data in the required format for illness
    death models using <b>stpm2</b> and <b>stpm2illd</b>.
<p>
The command will expand the data so that each individual will have up to 3 rows
&gt;  of data. Six new variables will be created. The variables <i>trans1</i>, <i>trans2</i> 
and <i>trans3</i> are variables that indicate whether an individual has passed through
&gt;  that particular transition. The transition numbers correspond to those in th
&gt; e 
diagram below. The <i>status</i> variable is an additional event indicator that summar
&gt; izes the information from <i>trans1</i>, <i>trans2</i> and <i>trans3</i>. Finally, 
the variables <i>start</i> and <i>stop</i> give the times at which each individual enters and
&gt;  leaves each transition.
<p>
<p>
                                      -------------                            
&gt; -------------
                                      |           |                            
&gt; |           |
                                      |   Alive   |         Transition 2       
&gt; |    Ill    |
                                      |           |--------------&gt;-------------
&gt; |           |
                                      |  State 1  |                            
&gt; |  State 2  |
                                      |           |                            
&gt; |           |
                                      -------------                            
&gt; -------------
                                            |                                  
&gt;       |                         
                                            |                                  
&gt;       |                        
                                            |                                  
&gt;       |                            
                               Transition 1 |                                  
&gt;       | Transition 3
                                            |                                  
&gt;       |                          
                                            |                                  
&gt;       |                      
                                            |                                  
&gt;       |                       
                                            |                                  
&gt;       |                          
                                      -------------                            
&gt; -------------
                                      |           |                            
&gt; |           |
                                      |   Dead    |                            
&gt; |   Dead    |
                                      |           |                            
&gt; |           |
                                      |  State 3  |                            
&gt; |  State 4  |
                                      |           |                            
&gt; |           |
                                      -------------                            
&gt; -------------          
<b><u>Options</u></b>
<p>
    <b>id</b> specifies the name of the id variable in the data set. Before the
        command is used each id number should have just 1 row of data.  The
        command will expand the data so that each id number will have up to 3
        rows of data.
<p>
    <b>statevar(</b><i>varlist</i><b>)</b> specifies the names of the two event indicator
        variables needed to split the data. Looking at the diagram above, an
        indicator variable will be needed to specify whether a patient has
        become ill and whether a patient has died. As death is a final
        absorbing state this must come last in the varlist. So for example if
        we were interested in relapse and death and our event indicator
        variables were relapse and dead then we would specify
        <b>statevar(</b><i>relapse dead</i><b>)</b> in that order.
<p>
    <b>statetime(</b><i>varlist</i><b>)</b> specifies the names of the two event time variables.
        The variables should be inputted in the order that corresponds to
        <b>statevar(</b><i>varlist</i><b>)</b>.  So if our event time variables were relapsetime
        and survtime then we would specify <b>statetime(</b><i>relapsetime survtime</i><b>)</b> in
        that order to correspond with the example given for
        <b>statevar(</b><i>varlist</i><b>)</b>.
                 
<p>
<p>
<b><u>Example</u></b>
<p>
<p>
The Rotterdam breast cancer data used in this example is taken from the book "F
&gt; lexible Parametric Survival Analysis Using Stata: Beyond the Cox Model"
by Patrick Royston and Paul C. Lambert (2011). The data can be downloaded from 
&gt; http://www.stata-press.com/data/fpsaus.html. 
The data contains information on 2,982 with primary breast cancer. Both time to
&gt;  relapse and time to death are recorded.
<p>
<p>
Open the data and run the <b>illdprep</b> command to set the data up in the format req
&gt; uired for illness death models using <b>stpm2</b> and <b>stpm2illd</b>. 
The ID variable in the data set is called <b>pid</b>. There are two event indicators; 
<b>&gt; rfi</b> indicates whether a patient has suffered a relapse, and <b>osi</b>
indicates whether a patient has died or not. There are also two event time vari
&gt; ables that correspond with these; <b>rf</b> and <b>os</b>.
<p>
        use rott2, clear
        illdprep, id(pid) statevar(rfi osi) statetime(rf os)
<p>
<p>
The command has expanded the data so that each individual has up to 3 rows of d
&gt; ata. As described above, six new variables have been generated. We can now <b>st</b>
<b>&gt; set</b> 
the data using the newly generated <b>status</b> variable as the failure indicator. Th
&gt; e newly generated <b>start</b> and <b>stop</b> times need to be included in the
<b>stset</b> command to indicate when an individual enters and leaves a transition.
<p>
        stset stop, enter(start) failure(status==1) scale(12) exit(time
            start+(10*12))
<p>
<p>
Once the data is <b>stset</b> we can run the <b>stpm2</b> and <b>stpm2illd</b> commands to fit an il
&gt; lness death model.
<p>
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  <b>[ST] stpm2</b> <b>[ST] stpm2_postestimation</b>;
                 
</pre>