<pre>
<b>help metandi</b>                                                    (Roger Harbord)
                                              also see:  metandi postestimation
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
<b>metandi</b> -- Meta-analysis of diagnostic accuracy
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>metandi</b><i> tp fp fn tn</i> [<i>if</i>] [<i>in</i>] [<b>,</b> <b><u>p</u></b><b>lot</b> <b><u>g</u></b><b>llamm</b> <b>ip(g|m)</b> <b><u>ni</u></b><b>p(</b><i>#</i><b>)</b>
                 <b><u>nob</u></b><b>ivariate</b> <b><u>noh</u></b><b>sroc</b> <b><u>nos</u></b><b>ummarypt</b> <b><u>d</u></b><b>etail</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <b>allc</b> <b><u>tr</u></b><b>ace</b>
                 <b><u>nolo</u></b><b>g</b> <b><u>do</u></b><b>ts</b>]
<p>
    <b>by</b> may be used with <b>metandi</b>; see <b>by</b>.
<p>
    See metandi postestimation for features available after estimation, in
    particular the<b> predict</b> command.  <b>metandiplot</b> graphs the results from
    <b>metandi</b>.
<p>
<b><u>Contents</u></b>
<p>
  Description - Options - Remarks - Examples - References - Acknowledgements
    - Author - Citation of metandi - Also see
<p>
<p>
<a name="s_description"></a><b><u>Description</u></b>
<p>
    <b>metandi</b> performs meta-analysis of diagnostic test accuracy studies in
    which both the index test under study and the reference test (gold
    standard) are dichotomous.  It takes as input four variables <i>tp fp fn tn</i>
    giving the number of true positives, false positives, false negatives and
    true negatives within each study.  It fits a two-level mixed logistic
    regression model, with independent binomial distributions for the true
    positives and true negatives conditional on the sensitivity and
    specificity in each study, and a bivariate normal model for the logit
    transforms of sensitivity and specificity between studies.
<p>
<p>
    In Stata 10 <b>metandi</b> fits the model using the built-in command <b>xtmelogit</b>
    by default.  In Stata 8 or 9 it makes use of the user-written command 
    <b>gllamm</b>, which must therefore be installed.  To ensure you have the most
    recent version of <b>gllamm</b>, type<b> ssc install gllamm, replace</b>.
<p>
    <b>metandi</b> does not allow covariates to be fitted, i.e. meta-<i>regression</i> of
    diagnostic accuracy is not supported.
<p>
<p>
<a name="s_options"></a><b><u>Options</u></b>
<p>
        +------+
    ----+ Plot +-------------------------------------------------------------
<p>
    <b>plot</b> requests a plot of the results on a summary receiver operating
        characteristic (SROC) plot.  This is a convenience option equivalent
        to executing the <b>metandiplot</b> command after <b>metandi</b> with the same list
        of variables<i> tp fp fn tn</i> (and the same <i>if</i> and <i>in</i> qualifiers if
        specified).  Greater control of the plot is available through the
        options of the <b>metandiplot</b> command when issued separately.
<p>
    The remaining options below control details of the estimation algorithm
    and reporting of results.  Typically you will not need to specify any of
    them.  However, this model can be difficult or slow to fit to certain
    datasets, in which case they may prove useful.
<p>
        +------------+
    ----+ Estimation +-------------------------------------------------------
<p>
    <b>gllamm</b> specifies that the model be fitted using <b>gllamm</b>.  This is the
        default in Stata 8 and 9 so the option is only of use in Stata 10, in
        which the model is fitted using <b>xtmelogit</b> by default.
<p>
    <b>ip(g</b>|<b>m)</b> specifies the quadrature method:  <b>ip(g)</b>, the default, gives
        Cartesian product quadrature.  <b>ip(m)</b> is only available when the model
        is fitted using <b>gllamm</b>.  It gives spherical quadrature, which can be
        more efficient though its properties are less well known and it can
        sometimes cause adaptive quadrature to take longer to converge.  See
        Rabe-Hesketh, Skrondal &amp; Pickles (2005).
<p>
    <b>nip(#)</b> specifies the number of integration points used for quadrature.
        Higher values should result in greater accuracy, but typically at the
        expense of longer execution times.  Specifying too small a value can
        lead to convergence problems, or even failure of adaptive quadrature
        - if <b>gllamm</b> reports the error "log-likelihood cannot be computed",
        try increasing <b>nip()</b>.  For Cartesian product quadrature, <b>nip()</b>
        specifies the number of points for each of the two random effects;
        the default is <b>nip(5)</b>.  For spherical quadrature, <b>nip()</b> specifies the
        degree <i>d</i> of the approximation; the default is <b>nip(9)</b>, and the only
        values currently supported by <b>gllamm</b> are 5, 7, 9, 11 and 15.  These
        defaults give approximately the same accuracy, as degree <i>d</i> for
        spherical quadrature corresponds in accuracy approximately to (<i>d</i> +
        1)/2 points per random effect for Cartesian product quadrature.
        (Rabe-Hesketh &amp; Skrondal 2005, appendix B.)
<p>
        +-----------+
    ----+ Reporting +--------------------------------------------------------
<p>
    <b>nobivariate</b>, <b>nohsroc</b> and <b>nosummarypt</b> suppress reporting of the bivariate
        parameter estimates, the HSROC parameter estimates or the summary
        point estimates respectively.
<p>
    <b>detail</b> displays the default output of all <b>gllamm</b> or <b>xtmelogit</b> commands
        issued.  If the model is fitted using <b>gllamm</b>, this includes the
        output of two univariate models used to give good starting values for
        the bivariate model.
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, in percent, for confidence
        intervals of the coefficients; see help level.
<p>
    <b>nolog</b> suppresses display of the iteration log.
<p>
    <b>trace</b> adds a display of the current parameter vector to the iteration
        log.
<p>
<p>
<a name="s_remarks"></a><b><u>Remarks</u></b>
<p>
        +--------+
    ----+ Models +-----------------------------------------------------------
<p>
    Estimates are displayed for the parameters of both the bivariate model
    (Reitsma et al. 2005) and the Hierarchical Summary Receiver Operating
    Characteristic (HSROC) model (Rutter &amp; Gatsonis 2001).  In the models
    without covariates fitted by <b>metandi</b>, these are different
    parameterisations of the same model (Harbord et al. 2007, Arends 2006).
<p>
    <b>metandi</b> fits the model using the approach Chu &amp; Cole (2006) refer to as a
    generalized linear mixed model approach to bivariate meta-analysis of
    sensitivity and specificity.  As they indicate, in the common situation
    of low cell counts this may be preferable to the approach originally used
    by Reitsma et al. (2005) involving empirical logit transforms.  This
    generalized linear mixed model approach corresponds to the "empirical
    Bayes" approach to fitting the HSROC model introduced by Macaskill
    (2004).
<p>
        +--------+
    ----+ Output +-----------------------------------------------------------
<p>
    In the output of <b>metandi</b>, the bivariate parameters are denoted using E()
    for expectation (mean), Var() for variance, Corr() for correlation,
    logitSe for logit(sensitivity) and logitSp for logit(specificity).  The
    HSROC parameters are denoted using the notation of Rutter &amp; Gatsonis
    (2001), giving Latin names for Greek letters but abbreviating
    <i>sigma</i>^2_<i>alpha</i> and <i>sigma</i>^2_<i>theta</i> to s2alpha and s2theta.
<p>
    The correlation rather than the covariance is displayed for the bivariate
    parameterisation as the correlation is more interpretable and its
    confidence interval can usually be computed.  However, the correlation is
    often estimated imprecisely and may sometimes be estimated as -1 (or +1)
    (Riley et al. 2007).  This corresponds to estimating s2alpha (or s2theta)
    to be very close to zero.  When this occurs the estimated standard error
    and confidence interval for both are unreliable and will often be
    displayed as missing values.
<p>
    The following estimates for the summary point are also displayed:
    sensitivity (Se), specificity (Sp), diagnostic odds ratio (DOR), positive
    likelihood ratio (LR+), negative likelihood ratio (LR-), inverse of the
    negative likelihood ratio (1/LR-).
<p>
    Confidence intervals are computed assuming asymptotic normality after a
    log transformation for variance parameters and for DOR, LR+ and LR-, an 
    atanh (Fisher's <i>z</i>) transformation for the correlation, and a logit
    transformation for proportions.
<p>
    The covariance between the estimates of E(logitSe) &amp; E(logitSp) is
    displayed at the end of the output as this is needed in addition to the
    other bivariate parameter estimates to construct confidence or prediction
    regions around the summary point.
<p>
        +--------+
    ----+ GLLAMM +-----------------------------------------------------------
<p>
    For detailed information on the <b>gllamm</b> command, see the GLLAMM manual
    (Rabe-Hesketh, Skrondal &amp; Pickles 2004) and Rabe-Hesketh &amp; Skrondal
    (2005).
<p>
<p>
<a name="s_examples"></a><b><u>Examples</u></b>
<p>
    <b>. metandi tp fp fn tn</b>
<p>
    <b>. metandi tp fp fn tn, plot</b>
<p>
    <b>. metandi a b c d, nobivariate nohsroc plot</b>
<p>
    <b>. metandi</b> (Replays default output)
<p>
    <b>. metandi a b c d if test==2, detail</b>
<p>
<p>
<a name="s_references"></a><b><u>References</u></b>
<p>
<a name="arends"></a>    Arends LR (2006).  Multivariate meta-analysis: modelling the
        heterogeneity.  Doctoral Thesis, Erasmus University Rotterdam.
        http://hdl.handle.net/1765/7845
<p>
<a name="chu"></a>    Chu H, Cole SR (2006).  Bivariate meta-analysis of sensitivity and
        specificity with sparse data:  a generalized linear mixed model
        approach.  Journal of Clinical Epidemiology 59:1331-1332.
        doi:10.1016/j.jclinepi.2006.06.011
<p>
<a name="harbord"></a>    Harbord RM, Deeks JJ, Egger M, Whiting P, Sterne JA (2007).  A
        unification of models for meta-analysis of diagnostic accuracy
        studies.  <i>Biostatistics</i> 8:239-251.  doi:10.1093/biostatistics/kxl004
<p>
<a name="macaskill"></a>    Macaskill P (2004).  Empirical Bayes estimates generated in a
        hierarchical summary ROC analysis agreed closely with those of a full
        Bayesian analysis.  Journal of Clinical Epidemiology 57:925-932.
        doi:10.1016/j.jclinepi.2003.12.019
<p>
<a name="rhs"></a>    Rabe-Hesketh S, Skrondal A (2005).  <i>Multilevel and Longitudinal Modeling</i>
        <i>Using Stata.</i>  College Station, TX: Stata Press.
        http://www.stata.com/bookstore/mlmus.html
<p>
<a name="gllammmanual"></a>    Rabe-Hesketh S, Skrondal A, Pickles A (2004).  GLLAMM Manual.  <i>U.C.</i>
        <i>Berkeley Division of Biostatistics Working Paper Series.</i>  Working
        Paper 160.  http://www.bepress.com/ucbbiostat/paper160
<p>
<a name="rhsp"></a>    Rabe-Hesketh S, Skrondal A, Pickles A (2005).  Maximum likelihood
        estimation of limited and discrete dependent variable models with
        nested random effects.  <i>Journal of Econometrics</i> 128:301-323.
        doi:10.1016/j.jeconom.2004.08.017
<p>
<a name="reitsma"></a>    Reitsma JB, Glas AS, Rutjes AWS, Scholten RJPM, Bossuyt PM, Zwinderman AH
        (2005).  Bivariate analysis of sensitivity and specificity produces
        informative summary measures in diagnostic reviews.  <i>Journal of</i>
        <i>Clinical Epidemiology</i> 58:982-990.  doi:10.1016/j.jclinepi.2005.02.022
<p>
<a name="riley"></a>    Riley RD, Abrams KR, Sutton AJ, Lambert PC, Thompson JR (2007).
        Bivariate random-effects meta-analysis and the estimation of
        between-study correlation.  <i>BMC Medical Research Methodology</i> 7:3.
        doi:10.1186/1471-2288-7-3
<p>
<a name="rutter"></a>    Rutter CM, Gatsonis CA (2001).  A hierarchical regression approach to
        meta-analysis of diagnostic test accuracy evaluations.  <i>Statistics in</i>
        <i>Medicine</i> 20:2865-2884.  doi:10.1002/sim.942
<p>
<p>
<a name="s_acknowledgements"></a><b><u>Acknowledgements</u></b>
<p>
    Joseph Coveney worked out how to fit the bivariate model using <b>gllamm</b> and
    posted the syntax on Statalist.  I also thank him for generous and
    helpful email correspondence.  <b>metandi</b> is essentially a wrapper for
    <b>gllamm</b> and I thank the authors of <b>gllamm</b> for their work, and
    Sophia-Rabe-Hesketh in particular for helpful email correspondence.
    Thanks also to Susan Mallett for pointing out a bug in a previous
    version.
<p>
<p>
<a name="s_author"></a><b><u>Author</u></b>
<p>
    Roger Harbord, Department of Social Medicine, University of Bristol, UK.
    roger.harbord@bristol.ac.uk
<p>
<p>
<a name="s_citation"></a><b><u>Citation of metandi</u></b>
<p>
    <b>metandi</b> is not an official Stata command.  It is a free contribution to
    the research community, like a paper.  Please cite it as such:
<p>
    Harbord, RM (2008).  metandi: Stata module for meta-analysis of
        diagnostic accuracy.  Statistical Software Components, Boston College
        Department of Economics.  Revised 15 Apr 2008.
<p>
    <b>metandi</b> is based on the ideas and relies on the results in Harbord et al.
    (2006), which should therefore be cited as well.
<p>
<p>
<a name="s_also_see"></a><b><u>Also see</u></b>
<p>
    Online:  <b>metandiplot</b>, <b>xtmelogit</b> (in Stata 10 or above), <b>gllamm</b> (if
</pre>