<pre>
<b>help mata _u2jackpseud</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>_u2jackpseud() -- Jackknife pseudovalue functions used by somersd</b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <i>void</i>           <b>_u2jackpseud(</b><i>phiidot</i> [<b>,</b> <i>phiii</i><b>,</b> <i>fweight</i>]<b>)</b>
<p>
        <i>void</i>           <b>_v2jackpseud(</b><i>phiidot</i> [<b>,</b> <i>phiii</i><b>,</b> <i>fweight</i>]<b>)</b>
<p>
    where
<p>
              <i>phiidot</i>:  <i>numeric matrix</i>
                <i>phiii</i>:  <i>numeric matrix</i>
              <i>fweight</i>:  <i>numeric colvector</i>
<p>
<p>
<b><u>Description</u></b>
<p>
    These functions are used by the <b>somersd</b> package to calculate jackknife
    pseudovalues for Hoeffding U statistics and von Mises V statistics of
    degree 2, on the basis of kernel totals provided as input by the user.
    Applications of these functions are discussed in the file <b>somersd.pdf</b>,
    which is distributed with the <b>somersd</b> package.  The theory of Hoeffding U
    statistics, von Mises V statistics, and their kernel functions is
    presented in chapter 5 of Serfling (1980).
<p>
    <b>_u2jackpseud(</b><i>phiidot</i><b>,</b> <i>phiii</i><b>,</b> <i>fweight</i><b>)</b> inputs and modifies a matrix
    <i>phiidot</i>, with one column for each of a set of degree-2 Hoffding U
    statistics.  On entry, the <i>i</i>th row of each column of <i>phiidot</i> contains the
    <i>i</i>th kernel total of the corresponding degree-2 Hoeffding U statistic.
    This kernel total might be denoted as <i>phi</i>_<i>i.</i> in the notation of (19) to
    (24) of the file <b>somersd.pdf</b>, which is distributed with the <b>somersd</b>
    package.  On exit, the <i>i</i>th row of each column of the matrix <i>phiidot</i>
    contains the <i>i</i>th jackknife pseudovalue of the same degree-2 Hoeffding U
    statistic.  This pseudovalue might be denoted as <i>psi</i>_<i>i</i> in the notation of
    (19) to (24) of <b>somersd.pdf</b>.  The input matrix <i>phiii</i> contains, in the <i>i</i>th
    row of each column, the degree-2 kernel function of the <i>i</i>th sampling unit
    with itself, which might be denoted <i>phi_ii</i> in the notation of
    <b>somersd.pdf</b>.  The input column vector <i>fweight</i> contains frequency weights,
    implying that the <i>i</i>th rows of <i>phiidot</i> and <i>phiii</i> represent a number of
    sampling units stored in the <i>i</i>th row of <i>fweight</i>.  Both <i>phiii</i> and <i>fweight</i>
    are unchanged on exit.  The matrix <i>phiii</i> may have one row and/or one
    column and is then input into the calculation as if the row and/or column
    were duplicated as many times as necessary for conformability with
    <i>phiidot</i>.  The column vector <i>fweight</i> may have one row and is then input
    into the calculations as if the row were duplicated as many times as
    necessary for conformability with <i>phiidot</i>.  If <i>phiii</i> is absent, then it
    is set to a scalar with value 0.  If <i>fweight</i> is absent, then it is set to
    a scalar with value 1.  <b>_u2jackpseud()</b> still works if <i>phiidot</i>, <i>phiii</i>, and
    <i>fweight</i> are views onto the dataset in memory.
<p>
    <b>_v2jackpseud(</b><i>phiidot</i><b>,</b> <i>phiii</i><b>,</b> <i>fweight</i><b>)</b> inputs and modifies a matrix
    <i>phiidot</i>, using the additional input matrix <i>phiii</i> and the additional input
    weight vector <i>fweight</i>.  The function <b>_v2jackpseud()</b> is similar to the
    function <b>_u2jackpseud()</b>, except that each column of <i>phiidot</i> contains on
    input the kernel totals and contains on output the jackknife pseudovalues
    of a degree-2 von Mises V statistic rather than a degree-2 Hoeffding U
    statistic.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    The use of the jackknife is discussed in Miller (1974).  The application
    of the jackknife specifically to U statistics is discussed in Arvesen
    (1969).  The <b>somersd</b> package uses the infinitesimal jackknife; that is,
    it uses the jackknife to define standard errors for means, U statistics
    or V statistics and then uses Taylor polynomials to define standard
    errors for ratios of these means, U statistics, V statistics, or
    transformations of these ratios.  The formulas used are given in detail
    in the file <b>somersd.pdf</b>, which is distributed with the <b>somersd</b> package.
<p>
<p>
<b><u>Conformability</u></b>
<p>
    <b>_u2jackpseud(</b><i>phiidot</i><b>,</b> <i>phiii</i><b>,</b> <i>fweight</i><b>)</b>, <b>_v2jackpseud(</b><i>phiidot</i><b>,</b> <i>phiii</i><b>,</b>
    <i>fweight</i><b>)</b>:
          <i>phiidot</i>:  <i>N x K</i>
            <i>phiii</i>:  <i>N x K</i> or <i>N x</i> 1 or 1 <i>x K</i> or 1 <i>x</i> 1
          <i>fweight</i>:  <i>N x</i> 1 or 1 <i>x</i> 1
<p>
<p>
<b><u>Diagnostics</u></b>
<p>
    <b>_u2jackpseud()</b> and <b>_v2jackpseud()</b> carry out no checks for missing values.
    Therefore, an entry in the matrix <i>phiidot</i> on output will be missing if
    any entry in the input matrices affecting its value is missing.
<p>
<p>
<b><u>Source code</u></b>
<p>
    _u2jackpseud.mata, _v2jackpseud.mata
<p>
<p>
<b><u>Author</u></b>
<p>
    Roger Newson, Imperial College London, UK.
    Email: r.newson@imperial.ac.uk
<p>
<p>
<b><u>References</u></b>
<p>
    Arvesen, J. N. 1969. Jackknifing U-statistics.  <i>Annals of Mathematical</i>
    <i>Statistics</i> 40: 2076-2100.
<p>
    Miller, R. G. 1974. The jackknife--a review. <i>Biometrika</i> 61: 1-15.
<p>
    Serfling, R. 1980. <i>Approximation Theorems of Mathematical Statistics</i>. New
    York: Wiley.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[M-0] intro</b>
<p>
    Online:  <b>mata</b>,
             <b>somersd</b> (if installed)
</pre>