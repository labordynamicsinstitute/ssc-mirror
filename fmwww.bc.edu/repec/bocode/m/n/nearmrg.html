<pre>
 ------------------------------------------------------------------------------
help for <b>nearmrg</b>
-------------------------------------------------------------------------------
<p>
<b><u>Nearest match merging of datasets</u></b>
<p>
<p>
    <b>nearmrg</b> [<i>varlist</i>] <b>using</b> <b>,</b> <b><u>n</u></b><b>earvar(</b><i>varname</i><b>)</b> [ <b><u>lim</u></b><b>it(</b><i>real</i><b>)</b>
        <b><u>g</u></b><b>enmatch(</b><i>newvarname</i><b>)</b> <b><u>low</u></b><b>er</b> <b><u>up</u></b><b>per</b> <b><u>ro</u></b><b>undup</b> <b><u>type</u></b><b>(</b><i>mergetype</i><b>)</b>
        <i>mergeoptions</i>]
<p>
<p>
<b><u>Description</u></b>
<p>
<b>nearmrg</b> performs nearest match merging of two datasets on the values of the
numeric variable <i>nearvar</i>.  <b>nearmrg</b> was designed as a way to use lookup tables
that have binned or rounded values on the variable of interest.
<p>
The user specifies whether the master dataset should be matched with
observations in the using dataset with the value closest and higher (or<b> upper</b>)
than each <i>nearvar</i> value, or observations nearest and <b>lower</b> than near values.{
}
<p>
Since the <i>nearvar</i> must be a numeric variable, be sure to convert any time-date
string variables to their numeric equivalent (see datetime).  Variables may be
specified in an optional <i>varlist</i> and these variables are treated as standard
merge variable which must match exactly. This option allows nearest matching
within subsets defined by the varlist.  <b>nearmrg</b> requires Stata 11+ since it
utilizes the newer merge command syntax.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>nearvar()</b> is required and specifies the variable in the master and using
    datasets that is to be matched as closely as possible.  <b>nearvar()</b> is not
    optional and must be unique in the using dataset, but not necessarily in
    the master dataset.
<p>
<p>
<b>limit()</b> is optional and specifies a limit to how far away from the master
    dataset value the matched using dataset value can be.  For a <b>nearvar()</b> that
    represents days or date-time, you can specify "limit(90)" to limit matches
    to within 90 days of the matching date.
<p>
<p>
<b>lower, upper, roundup</b> are mutually exclusive options that alter the default
    approach to defining the nearest match for <b>nearvar</b>.  <b>lower</b> matches to the
    closest value of <b>nearvar</b> in the using dataset that is less than or equal to
    <b>nearvar</b> in the master dataset.  <b>upper</b> matches to the closest value that is
    greater than or equal to <b>nearvar</b>.  <b>roundup</b> breaks distance ties by always
    selecting the higher value instead of the default lower value.  If none of
    these options are specified, <b>nearmrg</b> matches to the closest observation
    defined as minimizing the absolute difference between <b>nearvar</b> in the master
    and using datasets.
<p>
<b>type()</b> is an advanced option that overrides the default <i>mergetype</i> <b>m:1</b>.  See the
    help merge documentation for information on the other available <i>mergetype</i>s
    (e.g., m:1, 1:m, m:m, 1:1).
<p>
<b>genmatch()</b> is optional and specifies that a new variable should be created in
    the master datset that identifies the specific value of <b>nearvar</b> in the
    using dataset that was matched.
<p>
<b>mergeoptions</b> allows the user to specify any of the standard Stata merge options
    (such as <b>update</b> or<b> replace</b>).  See merge for more on these options.
<p>
<p>
<p>
<b><u>Example</u></b>
<p>
//Find car prices in "autoexpense.dta" within $50 of "auto.dta"//
<p>
**1:  create 'using' data**
webuse autoexpense.dta, clear
rename make make2
sa "using.dta", replace
<p>
**2:  merge to auto.dta by price**
sysuse auto.dta, clear
nearmrg  using "using.dta", upper nearvar(price) genmatch(usingmatch) limit(50)
&gt;  
list make* price  usingmatch _m if inrange(_m, 3, 5)
<p>
<p>
<p>
<p>
<p>
<b><u>Authors</u></b>
  Current version of <b>nearmrg</b> (updated for Stata 11+ merge syntax) is
      written and maintained by:
        
        <b>Eric A. Booth</b>
        Public Policy Research Institute
        Texas A&amp;M University
        ebooth@tamu.edu
        http://www.eric-a-booth.com
<p>
<p>
        
      *Original <b>nearmrg</b> package appeared in 2003 and was co-authored by:
         Michael Blasnik
         M Blasnik &amp; Associates
         michael.blasnik@verizon.net
        
         Katherine Smith
         Clinical Epidemiology and Biostatistics Unit
         Murdoch Childrens Research Institute
         katherine.smith@mcri.edu.au
<p>
<p>
<b><u>Also See</u></b>
<p>
On-line:  help for merge
</pre>