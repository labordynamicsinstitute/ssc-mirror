<pre>
<b>help mata mm_ecdf()</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>mm_ecdf() -- Cumulative distribution function</b>
<p>
<b><u>Syntax</u></b>
<p>
        <i>real matrix</i> <b>mm_ecdf(</b><i>X</i> [<b>,</b> <i>w</i><b>,</b> <i>mid</i>]<b>)</b>
<p>
        <i>real matrix</i> <b>mm_relrank(</b><i>X</i><b>,</b> <i>w</i><b>,</b> <i>Q</i> [<b>,</b> <i>mid</i>]<b>)</b>
<p>
        <i>real matrix</i> <b>mm_ranks(</b><i>X</i> [<b>,</b> <i>w</i><b>,</b> <i>ties</i><b>,</b> <i>mid</i><b>,</b> <i>norm</i>]<b>)</b>
<p>
<p>
    where
<p>
              <i>X</i>:  <i>real matrix</i> containing data (rows are observations, columns
                  variables)
<p>
              <i>w</i>:  <i>real colvector</i> containing weights
<p>
            <i>mid</i>:  <i>real scalar</i> indicating that midpoints be used
<p>
              <i>Q</i>:  <i>real matrix</i> containing evaluation points
<p>
           <i>ties</i>:  <i>real scalar</i> determining the treatment of ties; <i>ties</i>==0:
                  randomly split ties (default); <i>ties</i>==1: use highest rank in
                  case of ties; <i>ties</i>==2: use mean rank in case of ties;
                  <i>ties</i>==3: use lowest rank in case of ties; <i>ties</i>==4: order
                  ties by <i>w</i>
<p>
           <i>norm</i>:  <i>real scalar</i> indicating that the ranks be normalized
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>mm_ecdf()</b> returns the empirical cumulative distribution function
    (e.c.d.f.) of each column of <i>X</i>. Observations with equal values receive
    the same cumulative value.
<p>
    <b>mm_relrank()</b> evaluates the e.c.d.f of <i>X</i> at the values provided by <i>Q</i>. That
    is, <b>mm_relrank()</b> returns the relative ranks of <i>Q</i> in the distribution of
    <i>X</i>. Note that <b>mm_relrank()</b> works column by column. If <i>Q</i> has one column and
    <i>X</i> has several columns, then the relative ranks of <i>Q</i> are computed in each
    column of <i>X</i>. If <i>X</i> has one column and <i>Q</i> has several columns, then the
    e.c.d.f of <i>X</i> is evaluated in each column of <i>Q</i>. If <i>X</i> and <i>Q</i> both have
    several columns, then the number of columns is required to be the same
    and relative ranks are computed column by column.
<p>
    Note that
<p>
        <b>mm_relrank(</b><i>x</i><b>,</b> <i>w</i><b>,</b> <i>x</i><b>)</b> = <b>mm_ecdf(</b><i>x</i><b>,</b> <i>w</i><b>)</b>
<p>
    if <i>x</i> is a column vector. Naturally, <b>mm_ecdf()</b> is faster.
<p>
    <b>mm_ranks()</b> returns for each column of <i>X</i> the ranks of the values in <i>X</i>,
    where the smallest values are ranked highest (i.e. rank 1 is returned for
    the smallest value, rank 2 for the second smallest, etc.). Seen
    differently, <b>mm_ranks()</b> returns the absolute cumulative frequency
    distribution of each column of <i>X</i> or, if <i>norm</i>!=0 is specified, the
    relative cumulative distribution.
<p>
    <i>w</i> specifies weights associated with the observations (rows) in <i>X</i>. Omit <i>w</i>,
    or specify <i>w</i> as 1 to obtain unweighted results. Using <i>w</i>!=1 in <b>mm_ranks()</b>
    does not seem to make much sense if the result is to be interpreted as
    ranks. It is useful, however, to compute the absolute frequency
    distribution function from weighted data.
<p>
    <i>mid</i>!=0 specifies to use midpoints in the e.c.d.f. That is, at each step
    in the distribution, the value of the midpoint of the step is returned.
    <i>mid</i>!=0 in <b>mm_relrank()</b> only affects the results for <i>Q</i>-values that have an
    exact match in <i>X</i>.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    The formula for the empirical cumulative distribution function
    implemented in <b>mm_ecdf()</b> and <b>mm_relrank()</b> is:
<p>
               { 0        if x &lt; x(1)
        F(x) = { W(i)/W   if x(i) &lt;= x &lt; x(i+1), i=1,...,n-1
               { 1        if x &gt;= x(n)
<p>
    where x(1), x(2), ..., x(n) are the ordered observations, W(i) is the
    running sum of weights, and W is the overall sum of weights.
<p>
    The default for <b>mm_ranks()</b> is to return ranks in random order where <i>x</i> is
    tied. Alternatively, specify <i>ties</i>==1 to assign the highest occurring rank
    to tied observations, <i>ties</i>==2 to assign mean ranks, or <i>ties</i>==3 to assign
    the lowest rank. Example:
<p>
        : x = (1,2,2,3)'
        
        : x, mm_ranks(x,1,0), mm_ranks(x,1,1), mm_ranks(x,1,2),
        &gt;    mm_ranks(x,1,3)
                 1     2     3     4     5
            +-------------------------------+
          1 |    1     1     1     1     1  |
          2 |    2     2     2   2.5     3  |
          3 |    2     3     2   2.5     3  |
          4 |    3     4     4     4     4  |
            +-------------------------------+
<p>
    Furthermore, <i>ties</i>==4 ranks tied observations in order of <i>w</i> (observations
    with smallest weights are ranked highest). Where <i>w</i> is constant, <i>ties</i>==4
    is equivalent to <i>ties</i>==0.
<p>
    Note that <b>mm_ecdf()</b> is closely related to <b>mm_ranks()</b>. In fact:
<p>
        <b>mm_ecdf(x, w)</b> = <b>mm_ranks(x, w, 3, 0, 1)</b>
<p>
<p>
<b><u>Conformability</u></b>
<p>
    <b>mm_ecdf(</b><i>X</i><b>,</b> <i>w</i><b>,</b> <i>mid</i><b>)</b>:
             <i>X</i>:  n <i>x</i> k
             <i>w</i>:  n <i>x</i> 1 or 1 <i>x</i> 1
           <i>mid</i>:  1 <i>x</i> 1
        <i>result</i>:  n <i>x</i> k
<p>
    <b>mm_relrank(</b><i>X</i><b>,</b> <i>w</i><b>,</b> <i>Q</i><b>,</b> <i>mid</i><b>)</b>:
             <i>X</i>:  n <i>x</i> 1 or n <i>x</i> k
             <i>w</i>:  n <i>x</i> 1 or 1 <i>x</i> 1
             <i>Q</i>:  r <i>x</i> 1 or r <i>x</i> k
           <i>mid</i>:  1 <i>x</i> 1
        <i>result</i>:  r <i>x</i> 1 or r <i>x</i> k
<p>
    <b>mm_ranks(</b><i>X</i><b>,</b> <i>w</i><b>,</b> <i>ties</i><b>,</b> <i>mid</i><b>,</b> <i>norm</i><b>)</b>:
             <i>X</i>:  n <i>x</i> k
             <i>w</i>:  n <i>x</i> 1 or 1 <i>x</i> 1
          <i>ties</i>:  1 <i>x</i> 1
           <i>mid</i>:  1 <i>x</i> 1
          <i>norm</i>:  1 <i>x</i> 1
        <i>result</i>:  n <i>x</i> k
<p>
<p>
<b><u>Diagnostics</u></b>
<p>
    The functions return missing if <i>w</i> contains missing values. Missing values
    in <i>X</i> or <i>Q</i> are ranked lowest.
<p>
<p>
<b><u>Source code</u></b>
<p>
    mm_ecdf.mata, mm_relrank.mata, mm_ranks.mata
<p>
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jann@soz.gess.ethz.ch
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  help for <b>cumul</b>, <b>relrank</b> (if installed), <b>moremata</b>
<p>
</pre>