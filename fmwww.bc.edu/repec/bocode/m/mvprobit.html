<pre>
-------------------------------------------------------------------------------
help for <b>mvprobit</b>                            Cappellari and Jenkins (15jan2003)
-------------------------------------------------------------------------------
<p>
<b><u>Multivariate probit models, estimated by Simulated Maximum Likelihood</u></b>
<p>
    <b>mvprobit</b> <i>equation1</i> <i>equation2 ...</i> <i>equationM</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b>
            <b><u>dr</u></b><b>aws(</b><i>#</i><b>)</b> <b><u>s</u></b><b>eed(</b><i>#</i><b>)</b> <b><u>b</u></b><b>eta0</b> <b><u>a</u></b><b>trho0(</b><i>matrix_name</i><b>)</b> <b><u>r</u></b><b>obust</b> <b><u>cl</u></b><b>uster(</b><i>varname</i><b>)</b>
            <b><u>const</u></b><b>raints(</b><i>numlist</i><b>)</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> <i>maximize_options</i> ]
<p>
where each equation is specified as
<p>
            <b>(</b> [<i>eqname</i><b>:</b>] <i>depvar</i> [<b>=</b>] [<i>varlist</i>] [<b>,</b> <b><u>nocon</u></b><b>stant</b>] <b>)</b>
<p>
<b>by</b> <i>...</i> <b>:</b> may be used with <b>mvprobit</b>; see help by.
<p>
<b>pweight</b>s, <b>aweight</b>s, <b>fweight</b>s, and <b>iweight</b>s are allowed; see help weights.
<p>
<b>mvprobit</b> shares the features of all estimation commands; see help est.
<p>
<b>mvprobit</b> typed without arguments redisplays the last estimates.  The level
option may be used.
<p>
Predictions based on <b>mvprobit</b> estimates, including predicted joint and marginal
probabilities, can be derived using mvppred.
<p>
<p>
<b><u>Description</u></b>
<p>
<b>mvprobit</b> estimates <i>M</i>-equation probit models, by the method of simulated maximum
likelihood (SML). (Cf. <b>probit</b> and <b>biprobit</b> which estimate 1-equation and
2-equation probit models by maximum likelihood.) The variance-covariance matrix
of the cross-equation error terms has values of 1 on the leading diagonal, and
the off-diagonal elements are correlations to be estimated (rho<i>ji</i> = rho<i>ij</i>, and
rho<i>ii</i> = 1, for all <i>i</i> = 1,...,<i>M</i>).
<p>
<b>mvprobit</b> uses the Geweke-Hajivassiliou-Keane (GHK) simulator to evaluate the
<i>M</i>-dimensional Normal integrals in the likelihood function. For each
observation, a likelihood contribution is calculated for each replication, and
the simulated likelihood contribution is the average of the values derived from
all the replications. The simulated likelihood function for the sample as a
whole is then maximized using standard methods (<b>ml</b> in this case). For a brief
description of the GHK smooth recursive simulator, see Greene (2000: 183-185),
who also provides references to the literature.
<p>
Under standard conditions, the SML estimator is consistent as the number of
observations and the number of draws tend to infinity, and is asymptotically
equivalent to the true maximum likelihood estimator as the ratio of the square
root of the sample size to the number of draws tends to zero. Thus, other
things equal, the more draws, the better. In practice, however, it has been
observed that a relatively small number of draws may work well for `smooth'
likelihoods. An integer number corresponding to the square root of the number
of observations is often used for the number of random draws. For small sample
sizes, a larger number of draws may be required.
<p>
Estimation is numerically intensive, and may be very slow if the data set is
large, if the number of draws is large, or (especially) if the number of
equations is large. Users may also need to <b>set matsize</b> and <b>set memory</b> to values
above the default ones. (See help for matsize and memory.) Use of the <b>atrho0</b>
option may speed up convergence.
<p>
Models for which the matrix of rhos is close to not being positive definite are
likely to be difficult to maximize. (The Cholesky factorization used by SML
requires positive definiteness.) This is more likely if |rho<i>ji</i>| is close to
one. In these cases, <b>ml</b> may report difficulties calculating numerical
derivatives and a non-concave log-likelihood. In difficult maximization
problems, the message "Warning: cannot do Cholesky factorization of rho matrix"
may appear between iterations. It may be safely ignored if the maximization
proceeds to a satisfactory conclusion. Results may differ depending on the sort
order of the data, because the sort order affects which values of the random
variable(s) get allocated to which observation. (Be assured, however, that
<b>mvprobit</b> does not change the sort order of the data.) This potential problem is
reduced, the larger the number of random draws that is used.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>draws(</b><i>#</i><b>)</b> specifies the number of random variates drawn when calculating the
    simulated likelihood. The default is 5. (See the discussion above
    concerning the number of draws.)
<p>
<b>seed(</b><i>#</i><b>)</b> specifies the initial value of the (pseudo-)random-number seed used by
    the <b>uniform()</b> function in the simulation process. The value should be an
    integer (the default value is 123456789). Warning: if the number of draws
    is 'small', changes in the seed value may lead to surprisingly large
    changes in estimates.
<p>
<b>beta0</b> specifies that the estimates of the marginal probit regressions (used to
    provide starting values) are reported.
<p>
<b>atrho0(</b><i>matrix_name</i><b>)</b> allows users to specify starting values for the
    off-diagonal elements of the rho matrix that are different from the default
    values (which are all zero).  More precisely, the matrix <i>matrix_name</i>
    contains values of the incidental parameter in each /atrho<i>ji</i> equation, i.e.
    atanh(rho<i>ji</i>) = .5*ln((1+rho<i>ji</i>)/(1-rho<i>ji</i>)). Matrix <i>matrix_name</i> must have
    properly named column names. E.g. if a starting value in /atrho<i>21</i> is being
    set, one would first use the command <b>matrix </b><i>matrix_name</i><b> = (</b><i>value</i><b>)</b>, followed
    by <b>matrix colnames </b><i>matrix_name</i><b> = atrho21:_cons</b>. Between 1 and <i>M</i>(<i>M</i>-1)/2
    /atrho<i>ji</i> starting values may be specified, where <i>j</i> = 2,...,<i>M</i>, and <i>i</i> &lt; <i>j</i>.
    One likely source for a non-default starting value for atrho<i>ji</i> is the
    /athrho parameter estimate from the <b>biprobit</b> model corresponding to
    equations <i>j</i> and <i>i</i> of the full <b>mvprobit</b> model.
<p>
<b>robust</b> specifies that the Huber/White/sandwich estimator of variance is to be
    used in place of the traditional calculation; see <b>[U] 23.11 Obtaining</b>
    <b>robust variance estimates</b>.  <b>robust</b> combined with <b>cluster()</b> allows
    observations which are not independent within cluster (although they must
    be independent between clusters).  If you specify pweights, <b>robust</b> is
    implied.
<p>
<b>cluster(</b><i>varname</i><b>)</b> specifies that the observations are independent across groups
    (clusters) but not necessarily within groups.  <i>varname</i> specifies to which
    group each observation belongs; e.g., <b>cluster(personid)</b> in data with
    repeated observations on individuals.  See <b>[U] 23.11 Obtaining robust</b>
    <b>variance estimates</b>. <b>cluster()</b> can be used with pweights to produce
    estimates for unstratified cluster-sampled data.  Specifying <b>cluster()</b>
    implies <b>robust</b>.
<p>
<b>noconstant</b> suppresses the constant term (intercept) in the relevant regression.
<p>
<b>constraints(</b><i>numlist</i><b>)</b> specifies the linear constraints to be applied during
    estimation.  Constraints are defined using the <b>constraint</b> command and are
    numbered; see help constraint. The default is to perform unconstrained
    estimation.
<p>
<b>level(</b><i>#</i><b>)</b> specifies the confidence level, in percent, for the confidence
    intervals of the coefficients; see help level.
<p>
<i>maximize_options</i> control the maximization process; see help maximize.  Use of
    them is likely to be rare.
<p>
<p>
<b><u>Saved results</u></b>
<p>
In addition to the usual results saved after <b>ml</b>, <b>mvprobit</b> also saves the
following:
<p>
<b>e(draws)</b> is the number of random draws used when simulating probabilities.
<p>
<b>e(seed)</b> is the initial seed value used by the random-number generator.
<p>
<b>e(neqs)</b> is the number of equations in the <i>M</i>-equation model.
<p>
<b>e(ll0)</b> is the log-likehood for the comparison model (the sum of the
    log-likelihoods from the marginal univariate probit models corresponding to
    each equation).
<p>
<b>e(chi2_c)</b> is chi-square test statistic for the likelihood ratio test of the
    multivariate probit model against the comparison model.
<p>
<b>e(nrho)</b> is the number of estimated rhos (the degrees of freedom for the
    likelihood ratio test against the comparison model).
<p>
<b>e(rho</b><i>ji</i><b>)</b> is the estimate of correlation <i>ji</i> in the variance-covariance matrix of
    cross-equation error terms.
<p>
<b>e(serho</b><i>ji</i><b>)</b> is the estimated standard error of correlation <i>ji</i>.
<p>
<b>e(rhs</b><i>i</i><b>)</b> is the list of explanatory variables used in equation <i>i</i>. This list does
    not include the constant term, regardless of whether there is one is
    implied by equation <i>i</i>.
<p>
<b>e(nrhs</b><i>i</i><b>)</b> is number of explanatory variables in equation <i>i</i>.  This number
    includes the constant term if there is one implied by equation <i>i</i>.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . use http://www.stata-press.com/data/r7/school.dta, clear
<p>
        . biprobit (private = years logptax loginc) (vote=years logptax loginc)
<p>
        . mvprobit (private = years logptax loginc) (vote = years logptax
            loginc), dr(15)
<p>
        . mvprobit (private = years logptax loginc) (vote = years logptax,
            nocons), nolog
<p>
        . mvprobit (private years logptax loginc) (vote years logptax, nocons),
            beta0
<p>
        . constraint define 1 [private]loginc = 0.4
<p>
        . mvprobit (private = years logptax loginc) (vote = years logptax
            loginc, nocons), constraint(1)
<p>
        . mvprobit (private = years logptax loginc) (vote = years logptax
            loginc) (pub12 = years loginc)
<p>
        . mvprobit (private = loginc logptax) (vote = loginc logptax)(school =
            logptax)(pub5 = ), dr(10)
<p>
<p>
<b><u>Authors</u></b>
<p>
    Lorenzo Cappellari, Universita del Piemonte-Orientale, Italy
    &lt;Lorenzo.Cappellari@eco.unipmn.it&gt;
<p>
    Stephen P. Jenkins, ISER, University of Essex, U.K.
    &lt;stephenj@essex.ac.uk&gt;
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
    Thanks to Nick Cox and Weihua Guan for comments and suggestions.  Much of
    our code for syntax handling and display of results was inspired by code
    used in <b>biprobit</b>.
<p>
<p>
<b><u>References</u></b>
<p>
    Greene, W.H. (2000), <i>Econometric Analysis, Fourth edition</i>, Prentice-Hall
        International, Upper Saddle River NJ.
<p>
 
<b><u>Also see</u></b>
<p>
 Manual:  <b>[U] 23 Estimation and post-estimation commands</b>,
          <b>[U] 29 Overview of model estimation in Stata</b>,
          <b>[R] biprobit</b>
<p>
On-line:  help for constraint, est, postest, ml, biprobit, probit, and (if
                   installed) triprobit.
<p>
<p>
<p>
</pre>