<pre>
<b>help mata mz_panrowshape()</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>mz_panrowshape() -- Reorganizes, in rows, a panel data matrix for which</b>
              <b>the panels are presented by columns</b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
    <i>transmorphic matrix</i> <b>mz_panrowshape(</b><i>V</i><b>,</b> <i>idcol</i><b>,</b> <i>f</i> [<b>,</b> <i>d</i> ]<b>)</b>
<p>
<p>
    where
<p>
              <i>V</i>:  <i>transmorphic matrix</i> containing panel data
<p>
          <i>idcol</i>:  <i>real scalar</i> indicating the column containing the subject
                identifier
<p>
              <i>f</i>:  <i>string scalar</i> indicating how the user wants the panels to
                be presented
<p>
              <i>d</i>:  <i>real rowvector</i> containing the columns to be removed and is
                optional
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>mz_panrowshape()</b> reshapes a <i>(K * t) x c</i> panel data set matrix <i>V</i>, to a <i>u x</i>
    <i>(v * K)</i> panel data matrix, (<i>u</i> &lt;= <i>t</i> and <i>v</i> &lt;= <i>c</i>) if the argument <i>f</i> takes
    the value <i>"CK"</i>. <i>K</i> is the number of panels, <i>t</i> the number of observations
    in panels and <i>c</i> the number of columns of matrix <i>V</i>. The <i>"CK"</i> means that
    each panel (see the help for <b>[M-5] panelsetup()</b> for the definition of
    panel data in <b>mata</b>) is merged to the preceding until the exhaustion of
    the panels.
<p>
    <b>mz_panrowshape()</b> returns a <i>u x (K * v)</i> matrix, (<i>u</i> &lt;= <i>t</i> and <i>v</i> &lt;= <i>c</i>) if the
    argument <i>f</i> takes the value <i>"KC"</i>. The <i>"KC"</i> means that each column is
    merged to itself by panel until the exhaustion of panels.  This action is
    repeated for all columns of <i>V</i> and the resulting sub-matrices are
    themselves merged to each other.
<p>
    <b>mz_panrowshape()</b> always returns balanced panels, same number of
    observations in all the panels, even if <i>V</i> is not balanced. The balancing
    criterion used is<b> panelsetup(V, idcol, 2, 0)</b>. See <b>[M-5] panelsetup()</b> for
    more details.
<p>
    It should be noted that the real multiplications <i>(v * K)</i> and <i>(K * v)</i> in <i>u</i>
    <i>x (v * K)</i> and <i>u x (K * v)</i> respectively give the same value if <i>u</i> and <i>v</i> are
    identical in the two cases but they are used here to emphasize the
    difference in the arrangement of columns in the returned matrices.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    Remarks are presented under the following headings:
<p>
        Case where <i>f</i> takes the value <i>"CK"</i>
        The matrix <i>V</i> is balanced
        The matrix <i>V</i> is unbalanced
        Case where <i>f</i> takes the value <i>"KC"</i>
        String matrix
<p>
<a name="remarks1"></a><b><u>Case where </u></b><i><u>f</u></i><b><u> takes the value </u></b><i><u>"CK"</u></i>
<p>
<a name="remarks2"></a><b><u>The matrix </u></b><i><u>V</u></i><b><u> is balanced</u></b>
<p>
        : V
               1   2     3     4
            +---------------------+
          1 |  1   1   3.1   3.7  |
          2 |  1   2   9.2   4.2  |
          3 |  1   3   2.5   6.5  |
          4 |  1   4   8.4     7  |
          5 |  1   5   4.6   3.9  |
          6 |  2   1   6.2   1.5  |
          7 |  2   2   5     3.2  |
          8 |  2   3   7.8   9.6  |
          9 |  2   4   5.4   7.7  |
         10 |  2   5   3.4   9.2  |
         11 |  3   1   2.1   2.3  |
         12 |  3   2     9   1.5  |
         13 |  3   3   1.4   6.7  |
         14 |  3   4   4.8   3.3  |
         15 |  3   5   9.5   9.7  |
            +---------------------+
<p>
          The first column of <i>V</i> contains the subject identifier. There are
          three panels, each of them has five observations.
<p>
        : mz_panrowshape(V, 1, "CK")
               1   2     3     4   5   6     7     8   9   10   11    12
            +-------------------------------------------------------------+
          1 |  1   1   3.1   3.7   2   1   6.2   1.5   3   1   2.1   2.3  |
          2 |  1   2   9.2   4.2   2   2     5   3.2   3   2     9   1.5  |
          3 |  1   3   2.5   6.5   2   3   7.8   9.6   3   3   1.4   6.7  |
          4 |  1   4   8.4     7   2   4   5.4   7.7   3   4   4.8   3.3  |
          5 |  1   5   4.6   3.9   2   5   3.4   9.2   3   5   9.5   9.7  |
            +-------------------------------------------------------------+
<p>
         If we want to drop the second column of <i>V</i>, we set
<p>
        : d = 2
        : d
        : 2
<p>
         Then
<p>
        : mz_panrowshape(V, 1, "CK", d)
               1     2     3   4     5     6   7     8     9
            +-------------------------------------------------+
          1 |  1   3.1   3.7   2   6.2   1.5   3   2.1   2.3  |
          2 |  1   9.2   4.2   2     5   3.2   3     9   1.5  |
          3 |  1   2.5   6.5   2   7.8   9.6   3   1.4   6.7  |
          4 |  1   8.4     7   2   5.4   7.7   3   4.8   3.3  |
          5 |  1   4.6   3.9   2   3.4   9.2   3   9.5   9.7  |
            +-------------------------------------------------+
<p>
         If we want to drop the first two columnns, we set
<p>
        : d = (1,2)
        : d
        :      1   2
            +---------+
          1 |  1   2  |
            +---------+
<p>
         Then
<p>
        : mz_panrowshape(V, 1, "CK", d)
                 1     2     3     4     5     6
            +-------------------------------------+
          1 |  3.1   3.7   6.2   1.5   2.1   2.3  |
          2 |  9.2   4.2     5   3.2     9   1.5  |
          3 |  2.5   6.5   7.8   9.6   1.4   6.7  |
          4 |  8.4     7   5.4   7.7   4.8   3.3  |
          5 |  4.6   3.9   3.4   9.2   9.5   9.7  |
            +-------------------------------------+
<p>
<a name="remarks3"></a><b><u>The matrix </u></b><i><u>V</u></i><b><u> is unbalanced</u></b>
<p>
        : V
                1  2     3     4
            +---------------------+
          1 |  1   2   9.2   4.2  |
          2 |  1   3   2.5   6.5  |
          3 |  1   4   8.4     7  |
          4 |  1   5   4.6   3.9  |
          5 |  2   1   6.2   1.5  |
          6 |  2   2     5   3.2  |
          7 |  3   1   2.1   2.3  |
          8 |  3   2     9   1.5  |
          9 |  3   3   1.4   6.7  |
            +---------------------+
<p>
        : mz_panrowshape(V, 1,"CK")
               1   2     3     4   5   6     7     8   9  10    11    12
            +-------------------------------------------------------------+
          1 |  1   2   9.2   4.2   2   1   6.2   1.5   3   1   2.1   2.3  |
          2 |  1   3   2.5   6.5   2   2     5   3.2   3   2     9   1.5  |
            +-------------------------------------------------------------+
<p>
          As the minimum number of observations in panels is two (panel
          number 2), the balancing criterion makes that the result is a
          panel data set with only two observations per panel.
<p>
          If <i>V</i> had only one observation in panel number 2,
<p>
        : V
               1   2     3     4
            +---------------------+
          1 |  1   2   9.2   4.2  |
          2 |  1   2   9.2   4.2  |
          3 |  1   4   8.4     7  |
          4 |  1   5   4.6   3.9  |
          5 |  2   1   6.2   1.5  |
          6 |  3   1   2.1   2.3  |
          7 |  3   2     9   1.5  |
          8 |  3   3   1.4   6.7  |
            +---------------------+
<p>
          we would have
<p>
        : mz_panrowshape(V, 1, "CK")
               1     2     3     4     5     6     7     8
            +-----------------------------------------------+
          1 |  1     2   9.2   4.2     3     1   2.1   2.3  |
          2 |  1     3   2.5   6.5     3     2     9   1.5  |
          3 |  1     4   8.4     7     3     3   1.4   6.7  |
            +-----------------------------------------------+
<p>
          Panel number 2 is dropped because it is a singleton. 
          See <b>[M-5] panelsetup()</b> for more details on balancing
          panel data sets with <b>mata</b>.
<p>
<a name="remarks4"></a><b><u>Case where </u></b><i><u>f</u></i><b><u> takes the value </u></b><i><u>"KC"</u></i>
<p>
        : V
               1   2     3     4
            +---------------------+
          1 |  1   1   3.1   3.7  |
          2 |  1   2   9.2   4.2  |
          3 |  1   3   2.5   6.5  |
          4 |  1   4   8.4     7  |
          5 |  1   5   4.6   3.9  |
          6 |  2   1   6.2   1.5  |
          7 |  2   2   5     3.2  |
          8 |  2   3   7.8   9.6  |
          9 |  2   4   5.4   7.7  |
         10 |  2   5   3.4   9.2  |
         11 |  3   1   2.1   2.3  |
         12 |  3   2     9   1.5  |
         13 |  3   3   1.4   6.7  |
         14 |  3   4   4.8   3.3  |
         15 |  3   5   9.5   9.7  |
            +---------------------+
<p>
        : mz_panrowshape(V, 1, "KC")
               1   2   3   4   5   6     7     8     9    10    11    12
            +-------------------------------------------------------------+
          1 |  1   2   3   1   1   1   3.1   6.2   2.1   3.7   1.5   2.3  |
          2 |  1   2   3   2   2   2   9.2     5     9   4.2   3.2   1.5  |
          3 |  1   2   3   3   3   3   2.5   7.8   1.4   6.5   9.6   6.7  |
          4 |  1   2   3   4   4   4   8.4   5.4   4.8     7   7.7   3.3  |
          5 |  1   2   3   5   5   5   4.6   3.4   9.5   3.9   9.2   9.7  |
            +-------------------------------------------------------------+
            
         If we want to drop the first two columnns
<p>
        : d = (1,2)
        : d
        :      1   2
            +---------+
          1 |  1   2  |
            +---------+
<p>
        : mz_panrowshape(V, 1, "KC", d)
                 1     2     3     4     5     6
            +-------------------------------------+
          1 |  3.1   6.2   2.1   3.7   1.5   2.3  |
          2 |  9.2     5     9   4.2   3.2   1.5  |
          3 |  2.5   7.8   1.4   6.5   9.6   6.7  |
          4 |  8.4   5.4   4.8     7   7.7   3.3  |
          5 |  4.6   3.4   9.5   3.9   9.2   9.7  |
            +-------------------------------------+
<p>
<a name="remarks5"></a><b><u>String matrix</u></b>
<p>
        : V
               1     2     3
            +-----------------+
          1 |  A   a11   a12  |
          2 |  A   a21   a22  |
          3 |  A   a31   a32  |
          4 |  B   b11   b12  |
          5 |  B   b21   b22  |
          6 |  B   b31   b32  |
          7 |  C   c11   c12  |
          8 |  C   c21   c22  |
          9 |  C   c31   c32  |
            +-----------------+
<p>
        : d = 1
        : d
        : 1
        
<p>
        : mz_panrowshape(V, 1, "KC", d)
                 1     2     3     4     5     6
            +-------------------------------------+
          1 |  a11   b11   c11   a12   b12   c12  |
          2 |  a21   b21   c21   a22   b22   c22  |
          3 |  a31   b31   c31   a32   b32   c32  |
            +-------------------------------------+
<p>
<b><u>Conformability</u></b>
<p>
    <b>mz_panrowshape(</b><i>V</i><b>,</b> <i>idcol</i><b>,</b> <i>f</i><b>,</b> <i>d</i><b>)</b>
         <i>V</i>:  <i>(K * t) x c</i>
     <i>idcol</i>:  <i>1 x 1</i>
         <i>f</i>:  <i>1 x 1</i>
         <i>d</i>:  <i>1 x m</i>, <i>m &lt; c</i>    (optional)
    <i>result</i>:  <i>u x (v * K)</i> or <i>u x (K * v)</i>, <i>u</i> &lt;= <i>t</i>, <i>v</i> &lt;= <i>c</i>, <i>t</i> = number
                of obs. in panel, <i>K</i> = number of panels
<p>
<b><u>Diagnostics</u></b>
<p>
    <b>mz_panrowshape()</b> aborts with error if <i>d</i> is equal to all columns of <i>V</i> or
    if <i>V</i> is not a panel data matrix.
<p>
<p>
<b><u>Source code</u></b>
<p>
    mz_panrowshape.mata
<p>
<p>
<b><u>Author</u></b>
<p>
    Diallo Ibrahima Amadou, zavren@gmail.com
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  help for <b>[M-5] panelsetup()</b>, <b>mz_pancolshape()</b>, <b>ltimbimata</b>
</pre>