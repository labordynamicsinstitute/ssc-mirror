<pre>
<b>help mata somdtransf</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>somdtransf() -- Transformations used by somersd</b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <i>void</i>           <b>_somdtransf(</b><i>transf</i><b>,</b> <i>theta</i><b>,</b> <i>zeta</i> [ <b>,</b> <i>dzeta</i> ]<b>)</b>
<p>
    where
<p>
               <i>transf</i>:  <i>string scalar</i>
                <i>theta</i>:  <i>real matrix</i>
                 <i>zeta</i>:  <i>real matrix</i>
                <i>dzeta</i>:  <i>real matrix</i>
<p>
<p>
<b><u>Description</u></b>
<p>
    This function is used by <b>somersd</b> to perform the transformations specified
    by the <b>transf()</b> option and described in the file <b>somersd.pdf</b>, which is
    distributed with the <b>somersd</b> package.
<p>
    <b>somdtransf(</b><i>transf</i><b>,</b> <i>theta</i><b>,</b> <i>zeta</i><b>,</b> <i>dzeta</i><b>)</b> inputs a string scalar in <i>transf</i>,
    which specifies one of the transformations used by the <b>transf()</b> option of
    <b>somersd</b>, and a matrix <i>theta</i>, containing values for Somers' <i>D</i> or Kendall's
    tau-a.  It outputs a matrix <i>zeta</i>, with the same dimensions as <i>theta</i>,
    containing the transformed values, and, optionally, a matrix <i>dzeta</i>, with
    the same dimensions, containing the derivatives of the transformed values
    with respect to the untransformed values.  Either <i>zeta</i> or <i>dzeta</i>, but not
    both, may be the same matrix as <i>theta</i>, which is then overwritten.  Some
    transformations, or their derivatives, are undefined for untransformed
    values of 1 and -1 and may be too large to be calculated at values close
    to 1 or -1.  In these cases, <b>tidottree()</b> uses a maximum value <i>thetamax</i>,
    slightly less than one, and sets the transformed values and their
    derivatives to the transformed value and derivative for <i>thetamax</i> for
    untransformed values from <i>thetamax</i> to 1 and sets the transformed values
    and their derivatives to the transformed value and derivative for
    <i>-thetamax</i> for untransformed values from -1 to <i>-thetamax</i>.  The value of
    <i>thetamax</i> depends on the transformation specified by the string scalar
    <i>transf</i>.  If the untransformed value is greater than 1, or less than -1,
    then the transformed value and its derivative are set to missing.  If the
    string scalar <i>transf</i> contains a value other than one of the
    transformation names recognized by the <b>transf()</b> option of <b>somersd</b>, then
    all the transformed values and their derivatives are set to missing.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    The value of the maximum untransformed value <i>thetamax</i> depends on the
    value of <i>transf</i>, which specifies a transformation recognized by the
    <b>transf()</b> option of <b>somersd</b>.  The recognized values, and corresponding
    maximum untransformed values, are as follows:
<p>
    <i><u>transf</u></i>          <i><u>thetamax</u></i>
    <b>iden</b>            1
    <b>z</b>               0.999999999999999
    <b>asin</b>            0.999999999999999
    <b>rho</b>             1
    <b>zrho</b>            0.99999999
    <b>c</b>               1
<p>
    These values ensure that any value of Somers' D or Kendall's tau-a from
    -1 to 1 will have a nonmissing transformed value and derivative. These
    values will not be strictly correct for untransformed values of magnitude
    greater than <i>thetamax</i>.  However, confidence intervals generated by 
    <b>somersd</b> for such untransformed values should probably not be taken
    seriously, because these confidence intervals are calculated by the
    infinitesimal jackknife method and work by the Central Limit Theorem,
    which does not work well for such extreme population values of Somers' <i>D</i>
    and Kendall's tau-a. The formulas for all these transformations, and for
    their derivatives and inverses, are given in the manual <b>somersd.pdf</b>,
    distributed with the <b>somersd</b> package.
<p>
<p>
<b><u>Conformability</u></b>
<p>
    <b>_somdtransf(</b><i>transf</i><b>,</b> <i>theta</i><b>,</b> <i>zeta</i><b>,</b> <i>dzeta</i><b>)</b>:
           <i>transf</i>:  1 <i>x</i> 1
            <i>theta</i>:  <i>M x N</i>
             <i>zeta</i>:  <i>M x N</i>
            <i>dzeta</i>:  <i>M x N</i>
<p>
<p>
<b><u>Diagnostics</u></b>
<p>
    <b>_somdtransf(</b><i>transf</i><b>,</b> <i>theta</i><b>,</b> <i>zeta</i><b>,</b> <i>dzeta</i><b>)</b> returns missing values of <i>zeta</i>
    and <i>dzeta</i> for values of <i>theta</i> greater than 1, or less than -1, or for
    unrecognized values of <i>transf</i>.
<p>
<p>
<b><u>Source code</u></b>
<p>
    _somdtransf.mata
<p>
<p>
<b><u>Author</u></b>
<p>
    Roger Newson, Imperial College London, UK.
    Email: r.newson@imperial.ac.uk
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[M-0] intro</b>
<p>
    Online:  <b>mata</b>,
             <b>somersd</b> (if installed)
</pre>