<pre>
-------------------------------------------------------------------------------
help for <b>micombine7</b>                                             Patrick Royston
-------------------------------------------------------------------------------
<p>
<b><u>Estimation of regression models with multiply imputed samples</u></b>
<p>
<p>
        <b>micombine7</b> <i>regression_cmd</i> [<i>yvar</i>] <i>covarlist</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>]
                 [<i>weight</i>] [ <b>,</b> <b><u>nocons</u></b><b>tant</b> <b><u>det</u></b><b>ail</b> <b><u>e</u></b><b>form(</b><i>string</i><b>)</b>
                 <b><u>g</u></b><b>enxb(</b><i>newvarname</i><b>)</b> <b><u>imp</u></b><b>id(</b><i>varname</i><b>)</b> <b>lrr</b> <i>regression_cmd_options</i>
                 ]
<p>
    where
<p>
        <i>regression_cmd</i> may be clogit, cnreg, glm, logistic, logit, mlogit, 
        ologit, oprobit, poisson, probit, qreg, regress, rreg, stcox, streg,
        or xtgee.
<p>
    <b>micombine7</b> shares only a small subset of the features of all estimation
    commands (see help estimates); see <i>Remarks</i>.
<p>
    All weight types supported by <i>regression_cmd</i> are allowed; see help 
    weights.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>micombine7</b> estimates the parameters of a regression model whose type is
    determined by <i>regression_cmd</i>. Parameter estimates are combined across
    several replicates obtained previously by multiple imputation, e.g. by
    using mvis7 to create a file of imputed data.  See <i>Remarks</i> for a brief
    account of how <b>micombine7</b> combines the estimates and obtains standard
    errors.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>detail</b> gives details of the regression model for each imputation.
<p>
    <b>eform(</b><i>string</i><b>)</b> indicates that the exponentiated form of the coefficients
        is to be output and reporting of the constant is to be suppressed;
        <i>string</i> is used to label the exponentiated coefficients.
<p>
    <b>genxb(</b><i>newvarname</i><b>)</b> creates <i>newvarname</i> to hold the linear predictor from
        each regression model, averaged over all the imputations.
<p>
    <b>impid(</b><i>varname</i><b>)</b> specifies that <i>varname</i> is the variable identifying the
        imputations. The number of imputations is determined as the number of
        unique values of <i>varname</i>. Default <i>varname</i>: <b>_j</b>.
<p>
    <b>lrr</b> specifies that the Li-Raghunathan-Rubin (LRR) robust estimate of the
        variance-covariance matrix of the regression coefficients be used.
<p>
    <b>noconstant</b> suppresses the regression constant in all regressions.
<p>
    <i>regression_cmd_options</i> may be any of the options appropriate to
        <i>regression_cmd</i>.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    Details of statistical inference from multiple imputed datasets are
    nicely described in a recent Stata Journal article by John Carlin and
    colleagues (Carlin et al, 2003).  Here, with due acknowledgment to John,
    I give an edited version of Section 2 of his article.
<p>
    A simple method of combining estimates from several models was derived by
    Rubin (1987).  Suppose initially that primary interest lies in estimating
    a scalar quantity, Q.  Here, Q is a regression coefficient, for example,
    the log hazard ratio in a proportional hazards model. Suppose that we
    have imputed m complete datasets using an appropriate model. In each
    dataset, standard complete-data methods are used to obtain an estimate of
    Q with an associated standard error.  Let Q(k) and U(k) denote the point
    estimate and variance respectively from the kth (k = 1, 2, ... , m)
    dataset. The point estimate Q^ of Q from multiple imputation is simply
    the arithmetic mean of Q(1),...,Q(k).
<p>
    Obtaining a valid standard error for this estimate of Q^ requires
    combining information on within-imputation and between-imputation
    variation. The latter is important in reflecting uncertainty due to
    variability between imputation samples. First, a within-imputation
    variance component, W, is obtained as the mean of the complete-data
    variance estimates, Q(1),....,Q(k). Second, a between-imputation variance
    component, B, is calculated as the sum of squares of Q(1),....,Q(k) about
    Q^, divided by m-1. The (total) variance T of Q^ is given by
<p>
        T = W + B * (1 + 1/m)
<p>
    Rubin (1987) showed that (Q - Q^)/sqrt(T) is distributed approximately as
    Student's t on nu degrees of freedom, where
<p>
        nu = (m - 1) * (1 + W /(B * (1 + 1/m)))^2
<p>
    The (1 + 1/m) term in these expressions indicates that it is not
    necessary to a create large number of imputed datasets, particularly when
    B is much smaller than W. The condition will be satisfied unless there is
    much missing data and the parameter estimates within each dataset are
    very precise.
<p>
<p>
<b><u>Examples</u></b>
<p>
    <b>. mvis7 y x1 x2 x3 using imp, m(10) genmiss(m_)</b>
    <b>. use imp, clear</b>
    <b>. micombine7 regress y x1 x2 x3</b>
    <b>. stset time, failure(cens)</b>
    <b>. micombine7 stcox x1 x2 x3, genxb(index)</b>
<p>
<p>
<b><u>Author</u></b>
<p>
    Patrick Royston, MRC Clinical Trials Unit, London.
    patrick.royston@ctu.mrc.ac.uk
<p>
<p>
<b><u>References</u></b>
<p>
    Carlin, J. B., N. Li, P. Greenwood, and C. Coffey. 2003.  Tools for
        analyzing multiple imputed datasets. <i>Stata Journal</i> <b>3(3)</b>: 226-244.
<p>
    Li, K., T. Raghunathan, and D. Rubin. 1991. Large sample significance
        levels from multiply-imputed data using moment-based statistics and
        an F reference distribution.  <i>Journal of the American Statistical</i>
        <i>Association</i> <b>86</b>: 1065-1073.
<p>
    Royston P. 2004. Multiple imputation of missing values.  <i>Stata Journal</i>
        <b>4(3)</b>:227-241.
<p>
    Rubin, D. 1987. Multiple Imputation for Nonresponse in Surveys. New York:
        John Wiley &amp; Sons.
<p>
    Schafer, J. 1997. Analysis of Incomplete Multivariate Data. London:
        Chapman &amp; Hall.
<p>
    van Buuren, S., H. C. Boshuizen and D. L. Knook. 1999. Multiple
        imputation of missing blood pressure covariates in survival analysis.
        <i>Statistics in Medicine</i> <b>18</b>:681-694. (Also see
        http://www.multiple-imputation.com.)
<p>
<p>
<b><u>Also see</u></b>
<p>
</pre>