<pre>
<b>help oaxaca9</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>oaxaca9</b> -- Blinder-Oaxaca decomposition of outcome differentials
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>oaxaca9</b> <i>depvar</i> [<i>indepvars</i>] [<i>if</i>] [<i>in</i>] [<i>weight</i>] <b>,</b> <b>by(</b><i>groupvar</i><b>)</b> [
               <i>options</i> ]
<p>
<p>
<a name="opt"></a>    <i>options</i>                    Description
    -------------------------------------------------------------------------
    Main
      <b>by(</b><i>groupvar</i><b>)</b>             specifies the groups; <b>by()</b> is required
      <b>swap</b>                     swap groups
      <b><u>d</u></b><b>etail</b>[<b>(</b><i>dlist</i><b>)</b>]          display detailed decomposition
      <b><u>a</u></b><b>djust(</b><i>varlist</i><b>)</b>          adjustment for selection variables
<p>
    Decomposition type
      <b><u>three</u></b><b>fold</b>[<b>(</b><b><u>r</u></b><b>everse)</b>]     three-fold decomposition; the default
      <b><u>w</u></b><b>eight(</b><i># </i>[<i># </i>...]<b>)</b>        two-fold decomposition based on specified
                                 weights
      <b><u>p</u></b><b>ooled</b>[<b>(</b><i>model_opts</i><b>)</b>]     two-fold decomposition based on pooled model
                                 including <i>groupvar</i>
      <b><u>o</u></b><b>mega</b>[<b>(</b><i>model_opts</i><b>)</b>]      two-fold decomposition based on pooled model
                                 excluding <i>groupvar</i>
      <b><u>ref</u></b><b>erence(</b><i>name</i><b>)</b>          two-fold decomposition based on stored model
      <b>split</b>                    split unexplained part of two-fold
                                 decomposition
<p>
    X-Values
      <b>x1(</b><i>names_and_values</i><b>)</b>     provide custom X-values for Group 1
      <b>x2(</b><i>names_and_values</i><b>)</b>     provide custom X-values for Group 2
      <b><u>cat</u></b><b>egorical(</b><i>clist</i><b>)</b>       identify dummy variable sets and apply
                                 deviation contrast transform
<p>
    SE/SVY
      <b>svy</b>[<b>(</b><i>svyspec</i><b>)</b>]           survey data estimation
      <b>vce(</b><i>vcetype</i><b>)</b>             <i>vcetype</i> may be may be <b>analytic</b>, <b><u>r</u></b><b>obust</b>,
                                 <b><u>cl</u></b><b>uster</b> <i>clustvar</i>, <b><u>boot</u></b><b>strap</b>, or <b><u>jack</u></b><b>knife</b>
      <b><u>cl</u></b><b>uster(</b><i>varname</i><b>)</b>         adjust standard errors for intragroup
                                 correlation (Stata 9)
      <b><u>fix</u></b><b>ed</b>[<b>(</b><i>varlist</i><b>)</b>]         assume non-stochastic regressors
      <b>suest</b>[<b>(</b><i>name</i><b>)</b>] | <b>nosuest</b>  do/do not use <b>suest</b> to obtain joint variance
                                 matrix
      <b>nose</b>                     suppress computation of standard errors
<p>
    Models
      <b>model1(</b><i>model_opts</i><b>)</b>       estimation details for the Group 1 model
      <b>model2(</b><i>model_opts</i><b>)</b>       estimation details for the Group 2 model
      <b><u>noi</u></b><b>sily</b>                  display model estimation output
<p>
    Reporting
      <b>xb</b>                       display table with coefficients and means
      <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>                 set confidence level; default is <b>level(95)</b>
      <b>eform</b>                    report exponentiated results
      <b><u>nole</u></b><b>gend</b>                 suppress legend
    -------------------------------------------------------------------------
    <b>bootstrap</b>, <b>by</b>, <b>jackknife</b>, <b>statsby</b>, and <b>xi</b> are allowed; see prefix.
    Weights are not allowed with the <b>bootstrap</b> prefix.
    <b>aweight</b>s are not allowed with the <b>jackknife</b> prefix.
    <b>vce()</b>, <b>cluster()</b>, and weights are not allowed with the <b>svy</b> option.
    <b>fweight</b>s, <b>aweight</b>s, <b>pweight</b>s, and <b>iweight</b> are allowed; see weight.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>oaxaca9</b> computes the so-called Blinder-Oaxaca decomposition, which is
    often used to analyze wage gaps by sex or race. <i>depvar</i> is the outcome
    variable of interest (e.g. log wages) and <i>indepvars</i> are predictors (e.g.
    education, work experience, etc.). <i>groupvar</i> identifies the groups to be
    compared. For methods and formulas see Jann (2008).
<p>
    <b>oaxaca9</b> typed without arguments replays the last results, optionally
    applying <b>xb</b>, <b>level()</b>, <b>eform</b>, or <b>nolegend</b>.
<p>
<p>
<b><u>Options</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>by(</b><i>groupvar</i><b>)</b> specifies the <i>groupvar</i> that defines the two groups that will
        be compared. <b>by()</b> is required.
<p>
    <b>swap</b> reverses the order of the groups.
<a name="dlist"></a><p>
    <b>detail</b>[<b>(</b><i>dlist</i><b>)</b>] requests that the detailed results for the individual
        predictors be reported. Use <i>dlist</i> to subsume the results for sets of
        regressors (results for variables not appearing in <i>dlist</i> are listed
        individually). The syntax for <i>dlist</i> is
<p>
            <i>name</i><b>:</b><i>varlist</i> [<b>,</b> <i>name</i><b>:</b><i>varlist</i> <i>...</i>]
<p>
        The usual shorthand conventions apply to the <i>varlist</i>s specified in
        <i>dlist</i> (see help <i>varlist</i>; additionally, <b>_cons</b> is allowed). For
        example, specify <b>detail(exp:exp*)</b> to subsume <b>exp</b> (experience) and
        <b>exp2</b> (experience squared).  <i>name</i> is any valid Stata name and labels
        the set.
<p>
    <b>adjust(</b><i>varlist</i><b>)</b> causes the differential to be adjusted by the
        contribution of the specified variables before performing the
        decomposition. This is useful, for example, if the specified
        variables are selection terms. Note that <b>adjust()</b> is not needed for 
        <b>heckman</b> models.
<p>
        +--------------------+
    ----+ Decomposition type +-----------------------------------------------
<p>
    <b>threefold</b>[<b>(reverse)</b>] computes the three-fold decomposition. This is the
        default unless <b>weight()</b>, <b>pooled</b>, <b>omega</b>, or <b>reference()</b> is specified.
        The decomposition is expressed from the viewpoint of Group 2. Specify
        <b>threefold(reverse)</b> to express the decomposition from the viewpoint of
        Group 1.
<p>
    <b>weight(</b><i># </i>[<i># </i>...]<b>)</b> computes the two-fold decomposition where <i>#</i> [<i># ...</i>] are
        the weights given to Group 1 relative to Group 2 in determining the
        reference coefficients (weights are recycled if there are more
        coefficients than weights). For example, <b>weight(1)</b> uses the Group 1
        coefficients as the reference coefficients, <b>weight(0)</b> uses the Group
        2 coefficients.
<p>
    <b>pooled</b>[<b>(</b><i>model_opts</i><b>)</b>] computes the two-fold decomposition using the
        coefficients from a pooled model over both groups as the reference
        coefficients. <i>groupvar</i> is included in the pooled model as an
        additional control variable. Estimation details may be specified in
        parentheses; see the <b>model1()</b> option below.
<p>
    <b>omega</b>[<b>(</b><i>model_opts</i><b>)</b>] computes the two-fold decomposition using the
        coefficients from a pooled model over both groups as the reference
        coefficients (without including <i>groupvar</i> as a control variable in the
        pooled model). Estimation details may be specified in parentheses;
        see the <b>model1()</b> option below.
<p>
    <b>reference(</b><i>name</i><b>)</b> computes the two-fold decomposition using the
        coefficients from a stored model. <i>name</i> is the name under which the
        model was stored; see <b>estimates store</b>. Do not combine the <b>reference()</b>
        option with bootstrap or jackknife methods.
<p>
    <b>split</b> causes the "unexplained" component in the two-fold decomposition to
        be split into a part related to Group 1 and a part related to Group
        2. <b>split</b> is effective only if specified with <b>weight()</b>, <b>pooled</b>, <b>omega</b>,
        or <b>reference()</b>.
<p>
    Only one of <b>threefold</b>, <b>weight()</b>, <b>pooled</b>, <b>omega</b>, and <b>reference()</b> is
    allowed.
<p>
        +----------+
    ----+ X-Values +---------------------------------------------------------
<a name="x1x2"></a><p>
    <b>x1(</b><i>names_and_values</i><b>)</b> and <b>x2(</b><i>names_and_values</i><b>)</b> provide custom values for
        specific predictors to be used for Group 1 and Group 2 in the
        decomposition. The default is to use the group means of the
        predictors.  The syntax for <i>names_and_values</i> is
<p>
            <i>varname</i> [<b>=</b>] <i>value</i> [[<b>,</b>] <i>varname</i> [<b>=</b>] <i>value</i> <i>...</i> ]
<p>
        Example: <b>x1(educ 12 exp 30)</b>
<a name="clist"></a><p>
    <b>categorical(</b><i>clist</i><b>)</b> identifies sets of dummy variables representing
        categorical variables and transforms the coefficients so that the
        results of the decomposition are invariant to the choice of the
        (omitted) base category (deviation contrast transform). The syntax
        for <i>clist</i> is
<p>
            <i>varlist</i> [<b>,</b> <i>varlist</i> <i>...</i> ]
<p>
        where each <i>varlist</i> must contain indicator (0/1) variables for all
        categories including the base category (that is, a base category
        indicator variable must exist in the data). To generate a suitable
        set of indicator variables use, for example,
<p>
            <b>tabulate</b> <i>catvar</i><b>, generate(</b><i>stubname</i><b>)</b> [ <b>nofreq</b> ]
<p>
        where <i>catvar</i> is the categorical variable and the indicator variables
        will be named <i>stubname</i><b>1</b>, <i>stubname</i><b>2</b>, ... (<b>nofreq</b> may be used to
        suppress the frequency table; see help <b>tabulate</b>).
<p>
        The variables of a set specified in <b>categorical()</b> are added to the
        <i>indepvars</i> (unless at least one of the variables of the set already
        appears in <i>indepvars</i>), omitting the first variable of the set to
        prevent collinearity for model estimation (i.e. the first variable is
        used to represent the base category). Change the order of the
        variables or explicitly specify the desired terms in <i>indepvars</i> to
        change the base category.
<p>
        The deviation contrast transform can also be applied to interactions
        between a categorical and a continuous variable. Specify the
        continuous variable in parentheses at the end of the list in this
        case, i.e.
<p>
            <i>varlist</i> <b>(</b><i>varname</i><b>)</b> [<b>,</b> <i>...</i> ]
<p>
        and also include a list for the main effects. Example:
<p>
            <b>categorical(d1 d2 d3, xd1 xd2 xd3 (x))</b>
<p>
        where <b>x</b> is the continuous variable, and <b>d1</b> etc. and <b>xd1</b> etc. are the
        main effects and interaction effects.
<p>
        +--------+
    ----+ SE/SVY +-----------------------------------------------------------
<a name="svy"></a><p>
    <b>svy</b>[<b>(</b>[<i>vcetype</i>] [<b>,</b> <i>svy_options</i>]<b>)</b>] executes <b>oaxaca9</b> while accounting for
        the survey settings identified by <b>svyset</b> (this is essentially
        equivalent to applying the <b>svy</b> prefix command, although the <b>svy</b>
        prefix is not allowed with <b>oaxaca9</b> due to some technical issues).
        <i>vcetype</i> and <i>svy_options</i> are as described in help <b>svy</b>.
<p>
    <b>vce(</b><i>vcetype</i><b>)</b> specifies the type of standard errors reported. <i>vcetype</i> may
        be may be <b>analytic</b> (the default), <b>robust</b>, <b>cluster</b> <i>clustvar</i>,
        <b>bootstrap</b>, or <b>jackknife</b>; see <b>[R]</b> <i>vce_option</i>.
<p>
    <b>cluster(</b><i>varname</i><b>)</b> adjusts standard errors for intragroup correlation; this
        is Stata 9 syntax for <b>vce(cluster</b> <i>clustvar</i><b>)</b>.
<p>
    <b>fixed</b>[<b>(</b><i>varlist</i><b>)</b>] identifies fixed regressors (all if specified without
        argument; an example for fixed regressors are experimental factors).
        The default is to treat regressors as stochastic. Stochastic
        regressors inflate the standard errors of the decomposition
        components.
<p>
    <b>suest</b>[<b>(</b><i>name</i><b>)</b>] enforces using <b>suest</b> to obtain the covariances between the
        models/groups. <b>suest</b> is implied by <b>pooled</b>, <b>omega</b>, <b>reference()</b>, <b>svy</b>,
        <b>vce(cluster)</b>, and <b>cluster()</b>. Specify <b>suest(</b><i>name</i><b>)</b> to save <b>suest</b>'s
        estimation results under name <i>name</i> using <b>estimates store</b>. <b>nosuest</b>
        prevents applying <b>suest</b>, which may cause biased standard errors.
<p>
    <b>nose</b> suppresses the computation of standard errors.
<p>
        +------------------+
    ----+ Model estimation +-------------------------------------------------
<a name="mopts"></a><p>
    <b>model1(</b><i>model_opts</i><b>)</b> and <b>model2(</b><i>model_opts</i><b>)</b> specify the estimation details
        for the two group-specific models. The syntax for <i>model_opts</i> is
<p>
            [<i>estcom</i>] [<b>,</b> <b><u>sto</u></b><b>re(</b><i>name</i><b>)</b> <b><u>add</u></b><b>rhs(</b><i>spec</i><b>)</b> <i>estcom_options</i> ]
<p>
        where <i>estcom</i> is the estimation command to be used and <i>estcom_options</i>
        are options allowed by <i>estcom</i>. The default estimation command is 
        <b>regress</b>. <b>store(</b><i>name</i><b>)</b> saves the model's estimation results under name
        <i>name</i> using <b>estimates store</b>. <b>addrhs(</b><i>spec</i><b>)</b> adds <i>spec</i> to the "right-hand
        side" of the model. For example, use <b>addrhs()</b> to add extra variables
        to the model. Examples:
<p>
            <b>model1(heckman, select(</b><i>varlist_s</i><b>) twostep)</b>
<p>
            <b>model1(ivregress 2sls, addrhs((</b><i>varlist2</i><b>=</b><i>varlist_iv</i><b>)))</b>
<p>
        Technical notes:
<p>
          o <b>oaxaca9</b> uses the first equation for the decomposition if a model
            contains multiple equations.
<p>
          o Coefficients that occur in one of the models only are assumed
            zero for the other group. It is important, however, that the
            associated variables contain non-missing values for all
            observations in both groups.
<p>
    <b><u>noi</u></b><b>sily</b> displays the models' estimation output.
<p>
        +-----------+
    ----+ Reporting +--------------------------------------------------------
<p>
    <b>xb</b> displays a table containing the regression coefficients and predictor
        values on which the decomposition is based.
<p>
    <b>level(</b><i>#</i><b>)</b> specifies the confidence level, as a percentage, for confidence
        intervals.  The default is <b>level(95)</b> or as set by <b>set level</b>.
<p>
    <b>eform</b> specifies that the results be displayed in exponentiated form.
<p>
    <b>nolegend</b> suppresses the legend for the regressor sets defined by the
        <b>detail()</b> option.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . use http://fmwww.bc.edu/RePEc/bocode/o/oaxaca.dta
<p>
        . oaxaca9 lnwage educ exper tenure, by(female)
<p>
        . oaxaca9 lnwage educ exper tenure, by(female) weight(1)
<p>
        . oaxaca9 lnwage educ exper tenure, by(female) pooled
<p>
        . svyset [pw=wt]
        . oaxaca9 lnwage educ exper tenure, by(female) svy
<p>
        . oaxaca9 lnwage educ exper tenure, by(female) vce(bootstrap)
<p>
<p>
<b><u>Saved Results</u></b>
<p>
    Scalars   
      <b>e(N)</b>           number of observations
      <b>e(N_1)</b>         number of observations in Group 1
      <b>e(N_2)</b>         number of observations in Group 2
      <b>e(N_clust)</b>     number of clusters
<p>
    Macros    
      <b>e(cmd)</b>         <b>oaxaca9</b>
      <b>e(depvar)</b>      name of dependent variable
      <b>e(by)</b>          name group variable
      <b>e(group_1)</b>     value of group variable for Group 1
      <b>e(group_2)</b>     value of group variable for Group 2
      <b>e(title)</b>       <b>Blinder-Oaxaca decomposition</b>
      <b>e(model)</b>       type of decomposition
      <b>e(weights)</b>     weights specified in the <b>weight()</b> option
      <b>e(refcoefs)</b>    equation name used in <b>e(b0)</b> for the reference
                       coefficients
      <b>e(detail)</b>      <b>detail</b>, if detailed results were requested
      <b>e(legend)</b>      regressor sets defined by the <b>detail()</b> option
      <b>e(adjust)</b>      names of adjustment variables
      <b>e(fixed)</b>       names of fixed variables
      <b>e(suest)</b>       <b>suest</b>, if <b>suest</b> was used
      <b>e(wtype)</b>       weight type
      <b>e(wexp)</b>        weight expression
      <b>e(clustvar)</b>    name of cluster variable
      <b>e(vce)</b>         <i>vcetype</i> specified in <b>vce()</b>
      <b>e(vcetype)</b>     title used to label Std. Err.
      <b>e(properties)</b>  <b>b V</b>
<p>
    Matrices  
      <b>e(b)</b>           decomposition results
      <b>e(V)</b>           variance-covariance matrix of decomposition results
      <b>e(b0)</b>          vector containing coefficients and X-values
      <b>e(V0)</b>          variance-covariance matrix of <b>e(b0)</b>
<p>
    Functions 
      <b>e(sample)</b>      marks estimation sample
<p>
<p>
<b><u>References</u></b>
<p>
    Jann, Ben (2008). The Blinder-Oaxaca decomposition for linear regression
        models. The Stata Journal 8(4): 453-479.
<p>
    Working paper version available from: 
    http://ideas.repec.org/p/ets/wpaper/5.html
<p>
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jannb@ethz.ch
<p>
<p>
<b><u>Also see</u></b>
<p>
</pre>