<pre>
-------------------------------------------------------------------------------
help for <b>metacum</b>
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Cumulative meta-analysis, with graphics</u></b>
<p>
        <b>metacum</b> <i>varlist</i> [<i>if</i>] [<i>in</i>] [<b>,</b> [<i>binary_data_options</i> |
            <i>continuous_data_options</i> | <i>precalculated_effect_estimates_options</i>]
            <i>measure_and_model_option</i> <i>output_options</i> <i>forest_plot_options</i>]
<p>
<p>
<a name="binary"></a>        <i>binary_data_options</i>
<p>
            <b>or</b> <b>rr</b> <b>rd</b> <b>fixed</b> <b>random</b> <b>fixedi</b> <b>randomi</b> <b>peto</b> <b><u>noint</u></b><b>eger</b> <b>cc(</b><i>#</i><b>)</b>
<p>
<p>
<a name="continuous"></a>        <i>continuous_data_options</i>
<p>
            <b>cohen</b> <b>hedges</b> <b>glass</b> <b>nostandard</b> <b>fixed</b> <b>random</b> <b><u>noint</u></b><b>eger</b>
<p>
<p>
<a name="precalculated"></a>        <i>precalculated_effect_estimates_options</i>
<p>
            <b>fixed</b> <b>random</b>
<p>
<p>
<a name="measure"></a>        <i>measure_and_model_option</i>
<p>
            <b>wgt(</b><i>wgtvar</i><b>)</b>
<p>
<p>
<a name="output"></a>        <i>output_options</i>
<p>
            <b>by(</b><i>byvar</i><b>)</b> <b>log</b> <b>eform</b> <b><u>il</u></b><b>evel(</b><i>#</i><b>)</b> <b>sortby(</b><i>varlist</i><b>)</b>
            <b>label(</b>[<b>namevar=</b><i>namevar</i>]<b>,</b> [<b>yearvar=</b><i>yearvar</i>]<b>)</b> <b>notable</b> <b>nograph</b>
<p>
<p>
<a name="forest"></a>        <i>forest_plot_options</i>
<p>
            <b><u>xla</u></b><b>bel(</b><i>#</i><b>,</b>...<b>)</b> <b><u>xt</u></b><b>ick(</b><i>#</i><b>,</b>...<b>)</b> <b><u>texts</u></b><b>ize(</b><i>#</i><b>)</b> <b>nowt</b> <b>nostats</b> <b>counts</b>
            <b>group1(</b><i>string</i><b>)</b> <b>group2(</b><i>string</i><b>)</b> <b>effect(</b><i>string</i><b>)</b> <b>force</b> <b>lcols(</b><i>varlist</i><b>)</b>
            <b>rcols(</b><i>varlist</i><b>)</b> <b>astext(</b><i>#</i><b>)</b> <b>double</b> <b>summaryonly</b> <b>null(</b><i>#</i><b>)</b> <b>nulloff</b>
            <b>favours(</b><i>string</i> # <i>string</i><b>)</b> <b>pointopt(</b><i>marker_options</i> | 
            <i>marker_label_options</i><b>)</b> <b>ciopt(</b><i>line_options</i><b>)</b> <b>olineopt(</b><i>line_options</i><b>)</b>
            <b>classic</b> <b>nowarning</b> <i>graph_options</i>
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>metacum</b> provides cumulative pooled estimates and confidence limits
    obtained from fixed or random effects meta-analysis and plots the
    cumulative pooled estimates in the style of Lau et al. (1992).
<p>
    This updated version requires that <b>metan</b> is installed, for which <b>metacum</b>
    now acts as a wrapper. As such the syntax is very similar, allowing the
    user to supply data in a variety of formats.  Version 9 graphics are
    displayed and most of the options for <b>metan</b>, and many general graphics
    options, are permitted.  This help file is very similar to that of <b>metan</b>,
    although with the omission of some options.
<p>
    <b>metacum</b> requires either two, three, four or six variables to be declared.
    When four variables are specified these correspond to the number of
    events and non-events in the experimental group followed by those of the
    control group, and analysis of binary data is performed on the 2x2 table.
    With six variables, the data are assumed continuous and to be the sample
    size, mean and standard deviation of the experimental group followed by
    those of the control group.  If three variables are specified these are
    assumed to be the effect estimate and its lower and upper confidence
    interval, and it is suggested that these are log transformed for odds
    ratios or risk ratios and the<b> eform</b> option used.  If two variables are
    specified these are assumed to be the effect estimate and standard error;
    again, it is recommended that odds ratios or risk ratios are log
    transformed.
<p>
<p>
<b><u>Options</u></b>
<p>
    <i><u>binary_data_options</u></i>
<p>
    <b>or</b> pools ORs.
<p>
    <b>rr</b> pools RRs; this is the default.
<p>
    <b>rd</b> pools risk differences.
<p>
    <b>fixed</b> specifies a fixed-effect model using the Mantel-Haenszel method;
        this is the default.
<p>
    <b>random</b> specifies a random-effects model using the DerSimonian and Laird
        method, with the estimate of heterogeneity being taken.
<p>
    <b>fixedi</b> specifies a fixed-effect model using the inverse-variance method.
<p>
    <b>randomi</b> specifies a random-effects model using the DerSimonian and Laird
        method, with the estimate of heterogeneity being taken from the
        inverse-variance fixed-effect model.
<p>
    <b>peto</b> specifies that the Peto method is used to pool ORs.
<p>
<a name="binary_nointeger"></a>    <b>nointeger</b> allows the cell counts to be nonintegers. This option may be
        useful when a variable continuity correction is sought for studies
        containing zero cells but also may be used in other circumstances,
        such as where a cluster-randomized trial is to be incorporated and
        the "effective sample size" is less than the total number of
        observations.
<p>
    <b>cc(</b><i>#</i><b>)</b> defines a fixed-continuity correction to add where a study contains
        a zero cell. By default, <b>metan8</b> adds 0.5 to each cell of a trial
        where a zero is encountered when using inverse-variance, DerSimonian
        and Laird, or Mantel-Haenszel weighting to enable finite variance
        estimators to be derived.  However, the <b>cc()</b> option allows the use of
        other constants (including none). See also the <b>nointeger</b> option.
<p>
    <i><u>continuous_data_options</u></i>
<p>
    <b>cohen</b> pools standardized mean differences by the Cohen method; this is
        the default.
<p>
    <b>hedges</b> pools standardized mean differences by the Hedges method.
<p>
    <b>glass</b> pools standardized mean differences by the Glass method.
<p>
    <b>nostandard</b> pools unstandardized mean differences.
<p>
    <b>fixed</b> specifies a fixed-effect model using the Mantel-Haenszel method;
        this is the default.
<p>
    <b>random</b> specifies a random-effects model using the DerSimonian and Laird
        method, with the estimate of heterogeneity being taken.
<p>
    <b>nointeger</b> denotes that the number of observations in each arm does not
        need to be an integer. By default, the first and fourth variables
        specified (containing N_intervention and N_control, respectively) may
        occasionally be noninteger (see <b>nointeger</b> under binary data).
<p>
    <i><u>precalculated_effect_estimates_options</u></i>
<p>
    <b>fixed</b> specifies a fixed-effect model using the Mantel-Haenszel method;
        this is the default.
<p>
    <b>random</b> specifies a random-effects model using the DerSimonian and Laird
        method, with the estimate of heterogeneity being taken.
<p>
    <i><u>measure_and_model_option</u></i>
<p>
    <b>wgt(</b><i>wgtvar</i><b>)</b> specifies alternative weighting for any data type. The effect
        size is to be computed by assigning a weight of <i>wgtvar</i> to the
        studies. When RRs or ORs are declared, their logarithms are weighted.
        This option should be used only if you are satisfied that the weights
        are meaningful.
<p>
    <i><u>output_options</u></i>
<p>
    <b>by(</b><i>byvar</i><b>)</b> specifies that the meta-analysis is to be stratified according
        to the variable declared.
<p>
    <b>log</b> reports the results on the log scale (valid only for ORs and RRs
        analyses from raw data counts).
<p>
    <b>eform</b> exponentiates all effect sizes and confidence intervals (valid only
        when the input variables are log-ORs or log-hazard ratios with
        standard error or confidence intervals).
<p>
    <b>ilevel(</b><i>#</i><b>)</b> specifies the coverage (e.g., 90%, 95%, 99%) for the individual
        trial confidence intervals; the default is <b>$S_level</b>.  See <b>set level</b>.
<p>
    <b>sortby(</b><i>varlist</i><b>)</b> sorts by variable(s) in <i>varlist</i>.
<p>
    <b>label(</b>[<b>namevar=</b><i>namevar</i>]<b>,</b> [<b>yearvar=</b><i>yearvar</i>]<b>)</b> labels the data by its name,
        year, or both. Either or both variable lists may be left blank. For
        the table display, the overall length of the label is restricted to
        20 characters. If the <b>lcols()</b> option is also specified, it will
        override the <b>label()</b> option.
<p>
    <b>notable</b> prevents the display of a results table.
<p>
    <b>nograph</b> prevents the display of a graph.
<p>
    <i><u>forest_plot_options</u></i>
<p>
    <b>xlabel(</b><i>#</i><b>,</b>...<b>)</b> defines x-axis labels. This option has been modified so
        that any number of points may be defined. Also, checks are no longer
        made as to whether these points are sensible, so the user may define
        anything if the <b>force</b> option is used. Points must be comma separated.
<p>
    <b>xtick(</b><i>#</i><b>,</b>...<b>)</b> adds tick marks to the x-axis. Points must be comma
        separated.
<p>
    <b>textsize(</b><i>#</i><b>)</b> specifies the font size for the text display on the graph.
        This option has been modified so that the default is <b>textsize(100)</b>
        (as in 100%) and the percentage may be increased or decreased (e.g.,
        80 or 120 for 20% smaller or larger, respectively).
<p>
    <b>nowt</b> prevents the display of study weight on the graph.
<p>
    <b>nostats</b> prevents the display of study statistics on the graph.
<p>
    <b>counts</b> displays data counts (n/N) for each group when using binary data
        or the sample size, mean, and standard deviation for each group if
        mean differences are used (the latter is a new feature).
<p>
    <b>group1(</b><i>string</i><b>)</b> and <b>group2(</b><i>string</i><b>)</b> may be used with the <b>counts</b> option, and
        the text should contain the names of the two groups.
<p>
    <b>effect(</b><i>string</i><b>)</b> allows the graph to name the summary statistic used when
        the effect size and its standard error are declared.
<p>
    <b>force</b> forces the x-axis scale to be in the range specified by <b>xlabel()</b>.
<p>
    <b>lcols(</b><i>varlist</i><b>)</b> and <b>rcols(</b><i>varlist</i><b>)</b> define columns of additional data to
        the left or right of the graph. The first two columns on the right
        are automatically set to effect size and weight, unless suppressed by
        using the options <b>nostats</b> and <b>nowt</b>. If <b>counts</b> is used, this will be
        set as the third column.  <b>textsize()</b> can be used to fine-tune the
        size of the text to achieve a satisfactory appearance.  The columns
        are labeled with the variable label or the variable name if this is
        not defined. The first variable specified in <b>lcols()</b> is assumed to be
        the study identifier and this is used in the table output.
<p>
    <b>astext(</b><i>#</i><b>)</b> specifies the percentage of the graph to be taken up by text.
        The default is 50%, and the percentage must be in the range 10-90.
<p>
    <b>double</b> allows variables specified in <b>lcols()</b> and <b>rcols()</b> to run over two
        lines in the plot. This option may be of use if long strings are
        used.
<p>
    <b>summaryonly</b> shows only summary estimates in the graph. This option may be
        of use for multiple subgroup analyses.
<p>
    <b>null(</b><i>#</i><b>)</b> displays the null line at a user-defined value rather than at 0
        or 1.
<p>
    <b>nulloff</b> removes the null hypothesis line from the graph.
<p>
    <b>favours(</b><i>string</i> <b>#</b> <i>string</i><b>)</b> applies a label saying something about the
        treatment effect to either side of the graph (strings are separated
        by the <b>#</b> symbol). This option replaces the feature available in
        <b>b1title</b> in the previous version of <b>metan</b>.
<p>
    <b>pointopt(</b><i>marker_options</i><b>)</b>, <b>ciopt(</b><i>line_options</i><b>)</b>, and <b>olineopt(</b><i>line_options</i><b>)</b>
        specify options for the graph routines within the program, allowing
        the user to alter the appearance of the graph. Any options associated
        with a particular graph command may be used, except some that would
        cause incorrect graph appearance. For example, diamonds are plotted
        using the <b>twoway pcspike</b> command, so options for line styles are
        available (see <i>line options</i>); however, altering the x-y orientation
        with the option <b>horizontal</b> or <b>vertical</b> is not allowed. So,
        <b>ciopt(lcolor(green) lwidth(thick))</b> feeds into a command such as
        <b>pcspike(y1 x1 y2 x2, lcolor(green) lwidth(thick))</b>
<p>
        <b>pointopt(</b><i>marker_options</i><b>)</b> controls the point estimate by using marker
        options.  See <i>marker_options</i> and <i>marker_label_options</i>.
<p>
        <b>ciopt(</b><i>line_options</i><b>)</b> controls the confidence intervals for studies by
        using options for <b>twoway pcspike</b> (not horizontal/vertical). See 
        <i>line_options</i>.
<p>
        <b>olineopt(</b><i>line_options</i><b>)</b> controls the overall effect line with options
        for another line (not position). See <i>line_options</i>.
<p>
    <b>classic</b> specifies that solid black boxes without point estimate markers
        are used, as in the previous version of <b>metan</b>.
<p>
    <b>nowarning</b> switches off the default display of a note warning that studies
        are weighted from random-effects analyses.
<p>
    <i>graph_options</i> are any of the options documented in <b>[G]</b> <i>twoway_options</i>.
        These allow the addition of titles, subtitles, captions, etc.;
        control of margins, plot regions, graph size, aspect ratio; and the
        use of schemes.  Because titles may be added with <i>graph_options</i>,
        previous options such as <b>b2title</b> are no longer necessary.
<p>
<p>
<b><u>Remarks on metacum (calling metan)</u></b>
<p>
    For two or three variables, a variance-weighted analysis is performed in
    a similar fashion to the <b>meta</b> command; the two variable syntax is <i>theta</i>
    and <i>SE(theta)</i>. The 3 variable syntax is <i>theta</i>, <i>lower ci (theta)</i>, <i>upper ci</i>
    <i>(theta)</i>. Note that in this situation "<i>theta</i>" is taken to be the logarithm
    of the effect size if the odds ratio or risk ratio is used. <b>This differs</b>
    <b>from the equivalent in the meta command</b>.  This program does not assume
    the three variables need log transformation:  if odds ratios or risk
    ratios are combined, it is up to the user to log-transform them first.
    The <b>eform</b> option may be used to change back to the original scale if
    needed. By default the confidence intervals are assumed symmetric, and
    the studies are pooled by taking the variance to be equal to (CI
    width)/2z.
<p>
    Note that for graphs on the log scale (that is, ORs or RRs), values
    outside the range [10e-8,10e8] are not displayed, and similarly graphs of
    other measures (log ORs, RDs, SMDs) are restricted to the range
    [-10e8,10e8].  A confidence interval which extends beyond this, or the
    specified scale if <b>force</b> is used, will have an arrow added at the end of
    the range.
<p>
<p>
<b><u>Examples</u></b>
<p>
    All examples use a simulated example dataset (Ross Harris 2006)
<p>
        . use http://fmwww.bc.edu/repec/bocode/m/metan_example_data
<p>
    Risk difference from raw cell counts, random effects model, "label"
        specification
<p>
        <b>. metacum tdeath tnodeath cdeath cnodeath,</b>
            <b>rd random label(namevar=id, yearid=year)</b>
            <i>(</i><i>click to run</i><i>)</i>
<p>
    Generate log odds ratio and standard error. Graph has exponential form,
        scale is forced within set limits and ticks added. Data columns
        syntax used and effect label specified.
<p>
        <b>. gen logor = ln( (tdeath*cnodeath)/(tnodeath*cdeath) )</b>
<p>
        <b>. gen selogor = sqrt( (1/tdeath) + (1/tnodeath) + (1/cdeath) +</b>
            <b>(1/cnodeath) )</b>
<p>
        <b>. metacum logor selogor, eform xlabel(0.6, 0.8, 1, 1.2, 1.4, 1.6)</b>
            <b>force xtick(0.7, 0.9, 1.1, 1.3, 1.5) lcols(id year country)</b>
            <b>effect(Odds ratio)</b>
            <i>(</i><i>click to run</i><i>)</i>
<p>
<p>
<b><u>Reference</u></b>
<p>
    Lau, J., E. M. Antman, J. Jimenez-Silva, F. Mosteller, and T. C.
        Chalmers. 1992.  Cumulative meta-analysis of therapeutic trials for
        myocardial infarction.  <i>New England Journal of Medicine</i> 327: 248-254.
<p>
<p>
<b><u>Authors</u></b>
<p>
    <b><u>First version</u></b>
<p>
    Jonathan A. C. Sterne
        Department of Social Medicine, University of Bristol, Canynge Hall,
        Whiteladies Road, Bristol BS8 2PR, UK
<p>
    <b><u>Version 9 update</u></b>
<p>
    Ross J. Harris
        Department of Social Medicine, University of Bristol, Canynge Hall,
        Whiteladies Road, Bristol BS8 2PR, UK
<p>
<p>
<b><u>Also see</u></b>
<p>
       STB:  STB-44 sbe24
<p>
    Online:  <b>metan</b>, <b>metannt</b> (if installed), <b>meta</b> (if installed), <b>metareg</b> (if
             installed), <b>metabias</b> (if installed), <b>metatrim</b> (if installed), 
             <b>metainf</b> (if installed), <b>galbr</b> (if installed), <b>metafunnel</b> (if
             installed)
</pre>