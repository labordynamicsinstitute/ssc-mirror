<pre>
<b>help mata mm_insheet()</b>
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Title</u></b>
<p>
    <b>mm_insheet() -- Read spreadsheet file into string matrix (and vice versa)</b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <i>string matrix</i> <b>mm_insheet(</b><i>filename</i> [<b>,</b> <i>delimiter</i><b>,</b> <i>line1</i><b>,</b> <i>line2</i>]<b>)</b>
<p>
<p>
        <i>string matrix</i> <b>mm_infile(</b><i>filename</i> [<b>,</b> <i>line1</i><b>,</b> <i>line2</i>]<b>)</b>
<p>
<p>
        <i>void</i>          <b>mm_outsheet(</b><i>filename</i> <b>,</b> <i>s</i>[<b>,</b> <i>mode</i><b>,</b> <i>delimiter</i>]<b>)</b>
<p>
<p>
    where
<p>
              <i>filename</i>:  <i>string scalar filename</i>
             <i>delimiter</i>:  <i>string scalar delimiter</i>
                 <i>line1</i>:  <i>real scalar line1</i>
                 <i>line2</i>:  <i>real scalar line2</i>
                     <i>s</i>:  <i>string matrix s</i>
                  <i>mode</i>:  <i>string scalar</i> containing "", "<b><u>r</u></b><b>eplace</b>" or "<b><u>a</u></b><b>ppend</b>"
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>mm_insheet()</b> returns as a string matrix the contents of a spreadsheet
    file (ASCII) in which columns are separated by, e.g., tabs or commas and
    rows are separated by the newline character. <i>filename</i> specifies the
    filename. <i>delimiter</i> specifies the character used to separate the values.
    The default value for <i>delimiter</i> is <b>char(9)</b> (the tab-character).
<p>
    <b>mm_infile()</b> returns as a string matrix the contents of a free-format file
    (ASCII) in which columns are separated by one or more blanks and rows are
    separated by the newline character.
<p>
    Specifying <i>line1</i> (and <i>line2</i>) with <b>mm_insheet()</b> or <b>mm_infile()</b> indicates
    that the file be read starting with line number <i>line1</i> (and ending with
    line number <i>line2</i>).
<p>
    <b>mm_outsheet()</b> writes string matrix <i>s</i> into an ASCII file. Rows are
    separated by the newline character.  Columns are separated by <i>delimiter</i>.
    The default value for <i>delimiter</i> is <b>char(9)</b> (the tab-character).
    <b>mm_outsheet()</b> aborts with error if the file indicated by fn already
    exists and <i>mode</i> is omitted or <i>mode</i>="". Specify <i>mode</i>="<b><u>r</u></b><b>eplace</b>" to replace
    an existing file or <i>mode</i>="<b><u>a</u></b><b>ppend</b>" to append to an existing file.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    <b>mm_outsheet()</b> can only be used with string matrices. To export a real
    matrix, type <b>mm_outsheet(</b><i>filename</i><b>, strofreal(</b><i>R</i><b>))</b> where <i>R</i> is the real
    matrix (see <b>[M-5] strofreal()</b>).
<p>
<p>
<b><u>Conformability</u></b>
<p>
    <b>mm_insheet(</b><i>filename</i><b>,</b> <i>delimiter</i><b>,</b> <i>line1</i><b>,</b> <i>line2</i><b>)</b>:
      <i>filename</i>:  1 <i>x</i> 1
     <i>delimiter</i>:  1 <i>x</i> 1
         <i>line1</i>:  1 <i>x</i> 1
         <i>line2</i>:  1 <i>x</i> 1
        <i>result</i>:  r <i>x</i> c
<p>
    <b>mm_infile(</b><i>filename</i><b>,</b> <i>line1</i><b>,</b> <i>line2</i><b>)</b>:
      <i>filename</i>:  1 <i>x</i> 1
         <i>line1</i>:  1 <i>x</i> 1
         <i>line2</i>:  1 <i>x</i> 1
        <i>result</i>:  r <i>x</i> c
<p>
    <b>mm_outsheet(</b><i>filename</i><b>,</b> <i>s</i><b>,</b> <i>mode</i><b>,</b> <i>delimiter</i><b>)</b>:
      <i>filename</i>:  1 <i>x</i> 1
             <i>s</i>:  r <i>x</i> c
          <i>mode</i>:  1 <i>x</i> 1
     <i>delimiter</i>:  1 <i>x</i> 1
        <i>result</i>:  <i>void</i>
<p>
<p>
<b><u>Diagnostics</u></b>
<p>
    <b>mm_insheet()</b> and <b>mm_infile()</b> abort with error if the file indicated by
    <i>filename</i> does not exist.
<p>
    <b>mm_insheet()</b> and <b>mm_infile()</b> return a 0 x 0 result if the file indicated
    by <i>filename</i> contains 0 bytes.
<p>
    The number of columns in the matrix returned by <b>mm_insheet()</b> or
    <b>mm_infile()</b> is determined by the maximum number of elements per line
    found the input file. If an individual input line contains less than the
    maximum number of elements, an appropriate number of empty elements is
    appended to the right of the row.
<p>
    <b>mm_outsheet()</b> creates a file containing 0 bytes if <i>s</i> is a void string
    matrix (see <b>[M-2] void</b>).
<p>
<p>
<b><u>Source code</u></b>
<p>
    mm_insheet.mata, mm_infile.mata, mm_outsheet.mata
<p>
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jann@soz.gess.ethz.ch
<p>
<p>
<b><u>Also see</u></b>
<p>
</pre>