<pre>
<p>
<b> help mstat , mtest</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>M statistics</b> -- 2 samples M statistics for spatial distribution analysis
<p>
<b><u>Syntax</u></b>
<p>
    2 samples M statistics
<p>
        <b>mstat</b> <b>,</b> x(<i>varname</i>) y(<i>varname</i>) g(<i>varname</i>) [<i>options</i> <i>graphic_options</i>]
<p>
 
    2 samples M statistics and Monte Carlo test
<p>
        <b>mtest</b> <b>,</b> x(<i>varname</i>) y(<i>varname</i>) g(<i>varname</i>) [<i>options</i> <i>graphic_options</i>]
        
        
<b><u>Options for </u></b><b><u>mstat</u></b>
        
    <i>options</i>               Description
    -------------------------------------------------------------------------
    Main
      * <b>x(</b><i>varname</i><b>)</b>        x-coordinates
      * <b>y(</b><i>varname</i><b>)</b>        y-coordinates
      * <b>g(</b><i>varname</i><b>)</b>        group dummy variable
      <b>bins(</b><i>#</i><b>)</b>             choose the number of bins to be used
      <b>chi2</b>                returns the upper tail pvalue of the asymptotic
                            chi2 distribution
      <b><u>sc</u></b><b>atter</b>             plot the spatial distribution of two groups
      <b><u>den</u></b><b>sity</b>             plot the Kernel density for the interpoint
                            distances
      <i>graphic_options</i>     manipulate graphic output
<p>
    -------------------------------------------------------------------------
    * Required option
<p>
<b><u>Options for </u></b><b><u>mtest</u></b>
        
    <i>options</i>               Description
    -------------------------------------------------------------------------
    Main
      * <b>x(</b><i>varname</i><b>)</b>        x-coordinates
      * <b>y(</b><i>varname</i><b>)</b>        y-coordinates
      * <b>g(</b><i>varname</i><b>)</b>        group dummy variable
      <b>bins(</b><i>#</i><b>)</b>             choose the number of bins to be used
      <b>iter(</b><i>#</i><b>)</b>             choose the number of Monte Carlo permutation in the
                            test
      <b>level(</b><i>#</i><b>)</b>            choose the level for the p-value confidence
                            interval to be reported
      <b><u>sc</u></b><b>atter</b>             plot the spatial distribution of two groups
      <b><u>den</u></b><b>sity</b>             plot the Kernel density for the interpoint
                            distances
      <i>graphic_options</i>     manipulate graphic output
    -------------------------------------------------------------------------
    * Required option
<p>
<p>
<p>
<b><u>Description</u></b>
<p>
    The dataset is required to have the following structure:
<p>
                                x-coord         y-coord         group
              --------------------------------------------------
                                        23.4            45.8            0
                                        26.4            41.3            1
                                        71.3            39.2            1
                                        55.0            42.8            0
                                        ...             ...             ...
              --------------------------------------------------
<p>
<b><u>mstat</u></b>
Computes the two samples observed M statistic using <i>k</i> bins (via option <b>bins(</b><i>k</i><b>)</b>)
&gt; .
<p>
<b><u>mtest</u></b>
Computes the two samples observed M statistic using <i>k</i> bins (via option <b>bins(</b><i>k</i><b>)</b>)
&gt;  and executes a Monte Carlo test 
permuting the group variable (option <b>g(</b><i>varname</i><b>)</b>) n times (via option <b>iter(</b><i>n</i><b>)</b>. I
&gt; t returns the upper tail 
p-value=#(M&gt;=M0)/n and a corresponding l% confidence interval (via option <b>level</b>
<b>&gt; (</b><i>l</i><b>)</b>).
<p>
<p>
<b><u>Required options for </u></b><b><u>mstat</u></b><b><u> and </u></b><b><u>mtest</u></b>
<p>
<b>x(</b><i>x-coord</i><b>)</b> variable containing the x-coordinate of the location
<b>y(</b><i>y-coord</i><b>)</b> variable containing the y-coordinate of the location
<b>g(</b><i>group</i><b>)</b> binary variable (0-1) indicating the group
<p>
<b><u>Options for </u></b><b><u>mstat</u></b>
<p>
<b>bins(</b><i>#</i><b>)</b> selects the number of bins. The number must be a positive integer, not 
&gt; larger than the number of distances in the dataset, 
that is (number of observations choose 2). The default is <b>bins(</b><i>20</i><b>)</b>.
For the theoretical implications refer to <i>Forsberg, L., Bonetti, M. and Pagano,</i>
<i>&gt;  M. 2009</i>.
<p>
<b>chi2</b> displays and returns the pvalue for the asymptotic chi2 test (upper tail).
<p>
<b>scatter</b> generates scatter plot of the two groups.
<p>
<b>density</b> generates Kernel density of the interpoint distance distribution for th
&gt; e two groups.
<p>
<b><u>Options for </u></b><b><u>mtest</u></b>
<p>
<b>bins(</b><i>#</i><b>)</b> selects the number of bins. The number must be a positive integer, not 
&gt; larger than the number of distances in the dataset, 
that is (number of observations choose 2). The default is <b>bins(</b><i>20</i><b>)</b>.
For the theoretical implications refer to <i>White, F. L., Bonetti, M. and Pagano,</i>
<i>&gt;  M. 2009</i>.
<p>
<b>iter(</b><i>#</i><b>)</b> set the number of random permutations of the group variable (option <b>g(</b><i>v</i>
<i>&gt; arname</i><b>)</b> to be performed for 
the Monte Carlo test. The default value is <b>iter(</b><i>100</i><b>)</b>.
<p>
<b>level(</b><i>#</i><b>)</b> set the confidence level for the p-value's confidence interval. The de
&gt; fault is <b>level(</b><i>95</i><b>)</b>.
<p>
<b>scatter</b> generates a scatter plot of the two groups.
<p>
<b>density</b> generates a Kernel density of the interpoint distance distribution for 
&gt; the two groups.
<p>
<p>
<a name="graph_opt"></a><b><u>Graphic Options</u></b>
<p>
The graphic options are designed to manipulate the graphic output of the comman
&gt; ds. 
The options are active only if the corresponding option (<b>scatter</b> or <b>density</b>) is
&gt;  specified.
<p>
Options when option <b>scatter</b> is specified
<p>
<b>scolor0(</b><i>colorstyle</i><b>)</b> set the color for the marker of group 0.
<b>scolor1(</b><i>colorstyle</i><b>)</b> set the color for the marker of group 1.
<b>smarker0(</b><i>marker symbol</i><b>)</b> set the symbol for the marker of group 0.
<b>smarker1(</b><i>marker symbol</i><b>)</b> set the symbol for the marker of group 1.
<b>ssize0(</b><i>marker size</i><b>)</b> set the size for the marker of group 0.
<b>ssize1(</b><i>marker size</i><b>)</b> set the size for the marker of group 1.
<b>slabel0(</b><i>string</i><b>)</b> input the label for group 0 in the legend, default: "Group 0".
<b>slabel1(</b><i>string</i><b>)</b> input the label for group 1 in the legend, default: "Group 1".
<b>stitle(</b><i>string</i><b>)</b> specifies the title for the scatter, default: "Spatial Distribut
&gt; ion of the two groups".
<b>sytitle(</b><i>string</i><b>)</b> specifies the title for the y axis, default is the name of the 
&gt; variable in option <b>y(</b><i>y-coord</i><b>)</b>.
<b>sxtitle(</b><i>string</i><b>)</b> specifies the title for the x axis, default is the name of the 
&gt; variable in option <b>x(</b><i>x-coord</i><b>)</b>.
<p>
Options when option <b>density</b> is specified
<p>
<b>dcolor0(</b><i>colorstyle</i><b>)</b> set the color for the line of the density of group 0.
<b>dcolor1(</b><i>colorstyle</i><b>)</b> set the color for the line of the density of group 1.
<b>dpattern0(</b><i>line pattern style</i><b>)</b> set the pattern style for the line of the density
&gt;  of group 0.
<b>dpattern1(</b><i>line pattern style</i><b>)</b> set the pattern style for the line of the density
&gt;  of group 1.
<b>dwidth0(</b><i>line width style</i><b>)</b> set the width for the line of the density of group 0.
<b>dwidth1(</b><i>line width style</i><b>)</b> set the width for the line of the density of group 1.
<b>dlabel0(</b><i>string</i><b>)</b> input the label for group 0 in the legend, default: "Group 0".
<b>dlabel1(</b><i>string</i><b>)</b> input the label for group 1 in the legend, default: "Group 1".
<b>dtitle(</b><i>string</i><b>)</b> specifies the title for the Kernel density, default: "IDD Kernel
&gt;  Densities".
<p>
<p>
<b><u>Saved results</u></b>
<p>
<b>mstat</b> saves the following in <b>r()</b>
<p>
Scalars
        <b>r(M)</b>            observed M statistic
        <b>r(p)</b>            chi-squared p-value (if option <b>chi2</b> is specified)
Matrices
        <b>r(difF)</b>         difference between the ECDFs in the two groups
        <b>r(Sinv)</b>         generalized inverse of the covariance matrix of <b>r(difF)</b>
        <b>r(d)</b>            cutoffs of the equiprobable bins
<p>
<b>mtest</b> saves the following in <b>r()</b>
<p>
Scalars
        <b>r(N)</b>            sample size
<p>
Matrices
        <b>r(M)</b>            observed M statistic
        <b>r(c)</b>            count when M&gt;=M(obs) is true
        <b>r(p)</b>            observed empirical p-value
        <b>r(se)</b>           standard error of empirical p-value
        <b>r(ci)</b>           exact binomial confidence interval of observed p-value
        <b>r(reps)</b>         number of nonmissing results
        <b>r(d)</b>            cutoffs of the equiprobable bins
        <b>r(Sinv)</b>         generalized inverse of the covariance matrix
<p>
<p>
<b><u>Author</u></b>
<p>
    Pietro Tebaldi
    Department of Biostatistics , Harvard School of Public Health
    Bocconi University , Milan - Italy
    pietro.tebaldi@studbocconi.it
<p>
<p>
<b><u>References</u></b>
<p>
    Bonetti, M., and Pagano, M. The interpoint distance distribution as a
        descriptor of point patterns, with an application to spatial disease
        clustering.  <i>Stat Med</i> 2005; 24(5):753-773.
<p>
    Forsberg, L., Bonetti, M. and Pagano, M. 2009. The choice of the number
        of bins for the M statistic.  <i>CSDA</i> 2009; 53(10):3640-3649.
<p>
<p>
    Manjourides, J., and Pagano, M. 2010. An interpoint distance based test
        for the difference between two spatial distribution.  <i>Submitted</i>.
<p>
    Ozonoff, A. , Jeffery, C. , Manjourides, J. , White, L.F., and Pagano, M.
        2007. Effect of spatial resolution on cluster detection: a simulation
        study. <i>Int J Health Geogr</i> 2007; 52(6).
<p>
</pre>