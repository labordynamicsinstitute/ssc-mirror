<pre>
<b>help mata mm_jk()</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>mm_jk() -- Jackknife estimation</b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
           <i>jk</i> = <b>mm_jk(</b><i>f</i><b>,</b> <i>X</i> [<b>,</b> <i>w</i><b>,</b> <i>nodots</i><b>,</b> <i>strata</i><b>,</b> <i>cluster</i><b>,</b> <i>subpop</i><b>,</b> <i>fpcvar</i><b>,</b>
                  <i>stat</i><b>,</b> <i>...</i>]<b>)</b>
<p>
    where
<p>
            <i>f</i>:  <i>pointer scalar</i> containing address of function to be
                  bootstrapped, i.e. <i>f</i> = <b>&amp;</b><i>functionname</i><b>()</b>
            <i>X</i>:  <i>real matrix</i> containing data (rows are observations, columns
                  variables)
            <i>w</i>:  <i>real colvector</i> containing weights
       <i>nodots</i>:  <i>real scalar</i> indicating that replication dots be suppressed
       <i>strata</i>:  <i>real colvector</i> containing (ordered) strata ID variable
      <i>cluster</i>:  <i>real colvector</i> containing (ordered) cluster ID variable
       <i>subpop</i>:  <i>real colvector</i> containing subpopulation identifier
       <i>fpcvar</i>:  <i>real colvector</i> containing sampling fractions for finite
                  population correction
         <i>stat</i>:  <i>real rowvector</i> containing the results of <i>f</i> using the original
                  data, i.e., the "observed" value of <i>f</i>
          <i>...</i>:  up to 10 optional arguments to pass through to <i>f</i>
<p>
<p>
    <i>real matrix</i> <b>mm_jk_report(</b><i>jk</i> [<b>,</b> <i>what</i>, <i>level</i><b>,</b> <i>mse</i><b>,</b> <i>fpc</i>]<b>)</b>
<p>
    where
<p>
         <i>what</i>:  <i>string vector</i> containing statistics to be reported, where the
                  available statistics are:  <b>"b"</b> or <b>"theta"</b> ("observed"
                  value), <b>"pseudo"</b> (jackknife pseudovalues), <b>"mean"</b>
                  (jackknife mean), <b>"bias"</b> (jackknife mean - observed value),
                  <b>"v"</b> (variance-covariance matrix), <b>"se"</b> (standard error; the
                  default), <b>"ci"</b> (confidence interval)
        <i>level</i>:  <i>real scalar</i> containing the confidence level for confidence
                  intervals (default is 95 or as set by <b>set level</b>)
          <i>mse</i>:  <i>real scalar</i> indicating that the mean squared errors formula
                  be used
          <i>fpc</i>:  <i>real vector</i> containing sampling fractions for finite
                  population correction
<p>
    <i>jk</i> is a variable used for communication between <b>mm_jk()</b> and
    <b>mm_jk_report()</b>. If you declare <i>jk</i>, declare it to be <i>transmorphic</i>.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>mm_jk(</b><i>f</i><b>,</b> <i>X</i><b>,</b> <i>w</i><b>)</b> computes the jackknife (leave-one-out) replicates of
    function <i>f</i> applied to the data <i>X</i> (and weights <i>w</i>; omit <i>w</i>, or specify <i>w</i> as
    1 to obtain unweighted results) and returns the results as a structure.
    To be precise, <i>f</i> is a pointer to a function, i.e. <i>f</i> = <b>&amp;</b><i>functionname</i><b>()</b>,
    e.g.  <i>f</i> = <b>&amp;mean()</b> (see <b>[M-2] ftof</b>).  <b>mm_jk()</b> expects function <i>f</i> to return
    a <i>real rowvector</i> of parameter estimates to be jackknifed.  Furthermore,
    function <i>f</i> must take the data as the first argument and weights as the
    second argument. Note that <b>mm_jk()</b> leaves out observations by setting
    their weights to zero. Make sure that function <i>f</i> properly handles these
    observations. The results from <i>f</i> should be the same as if the observation
    would have been deleted.
<p>
    <i>nodots</i>!=0 indicates that replication dots be suppressed.  By default, a
    single dot character is displayed for each successful replication and a
    single red 'x' is displayed for each unsuccessful replication. A
    replication is considered unsuccessful if the replication result contains
    one or more missing values. <b>mm_jk()</b> only returns results from successful
    replications.
<p>
    <i>strata</i> and <i>cluster</i> may be used to specify a strata ID variable and a
    cluster ID variable. <b>mm_jk()</b> will then produce jackknife results for
    stratified and clustered data. Note that <b>mm_jk()</b> does not sort the data:
    A new stratum begins each time <i>strata</i> changes from one row to the next, a
    new cluster begins each time <i>cluster</i> (or <i>strata</i>) changes from one row to
    the next. Omit <i>strata</i> or specify <i>strata</i>=. if the sample is unstratified;
    omit <i>cluster</i> or specify <i>cluster</i>=. if the sample does not contain
    clusters.
<p>
    <i>subpop</i> specifies that estimates be computed for the subpopulation for
    which <i>subpop</i>!=0. Providing only the data for which <i>subpop</i>!=0 and omitting
    <i>subpop</i> produces different results than providing all data and specifying
    <i>subpop</i>. See <b>[SVY] subpopulation estimation</b> for information.  Omit <i>subpop</i>
    or specify <i>subpop</i>=. if the estimates be based on all observations.
<p>
    <i>fpcvar</i> provides sampling fractions to be stored with the jackknife
    replicates. The stored sampling rates are then used by <b>mm_jk_report()</b> for
    finite population correction of variance estimates. Note that <i>fpcvar</i>
    should contain the same number of rows as <i>x</i> and is assumed to be constant
    within each stratum. You may specify <i>fpcvar</i>=. to set the sampling
    fractions to zero (and, therefore, omit finite population correction).
<p>
    By default, <b>mm_jk()</b> first applies <i>f</i> to the original data to obtain the
    "observed" value of <i>f</i> given <i>X</i> and <i>w</i>. Alternatively, the "observed" value
    may be provided as <i>stat</i>, where <i>stat</i> is a<i> real rowvector</i> of point
    estimates.  Omit <i>stat</i> or specify <i>stat</i>=. if you do not want to provide the
    "observed" value.
<p>
    <b>mm_jk_report()</b> is used to analyze the jackknife replicates computed by
    <b>mm_jk()</b>. It returns a matrix of statistics such as jackknife means,
    jackknife standard errors, or jackknife confidence intervals (see the
    <i>what</i> argument above).  Multiple statistics are arranged beneath one
    another in the specified order. For example, <b>mm_jk_report(</b><i>jk</i><b>,</b>
    <b>("b","se","ci"))</b> will return the observed values in the first row, the
    standard errors in the second row, and the lower and upper bounds of the
    confidence intervals in the third and forth row.
<p>
    <i>level</i> specifies the confidence level, as a percentage, for confidence
    intervals.  The default is <i>level</i>=95 or as set by <b>set level</b>.
<p>
    <i>mse</i>!=0 indicates that variances and standard errors be computed using
    deviations of the replicates from the "observed" value. By default,
    variances and standard errors are computed using deviations of the
    pseudovalues from their mean.
<p>
    <i>fpc</i> may be used to provide sampling fractions for finite population
    correction of variance estimates. The length of <i>fpc</i> should equal the
    number of strata. <i>fpc</i> can be omitted if <i>fpcvar</i> was provided to <b>mm_jk()</b>.
<p>
<b><u>Remarks</u></b>
<p>
    The following example illustrates the basic usage of <b>mm_jk()</b> and
    <b>mm_jk_report()</b>:
<p>
        : x = uniform(75,2)
        
        : J = mm_jk(&amp;mean(), x, 1)
        
        Jackknife replications (75)
        ----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
        ..................................................    50
        .........................
<p>
        : mm_jk_report(J, ("b", "se"))
                         1             2
            +-----------------------------+
          1 |  .4512322009   .4951004972  |
          2 |   .032499494   .0333034185  |
            +-----------------------------+
<p>
        : mm_jk_report(J, "ci")
                         1             2
            +-----------------------------+
          1 |  .3864755455   .4287419872  |
          2 |  .5159888562   .5614590071  |
            +-----------------------------+
<p>
    <b>mm_jk()</b> first produces the 75 jackknife leave-one-out estimates of the
    means of the two variables contained in <b>x</b>. <b>mm_jk_report()</b> then reports
    the "observed" values, i.e. the means of the two variables in <b>x</b> (first
    row) and the jackknife standard errors of the means (second row). The
    second call of <b>mm_jk_report()</b> displays the 95% jackknife confidence
    intervals for the two means (lower bound in first row, upper bound in
    second row).
<p>
    Methods and formulas are as described in <b>[R] jackknife</b> and <b>[SVY] variance</b>
    <b>estimation</b>. Delete-<i>k</i> jackknife is not supported.
<p>
<p>
<b><u>Conformability</u></b>
<p>
    <b>mm_jk(</b><i>f</i><b>,</b> <i>X</i><b>,</b> <i>w</i><b>,</b> <i>nodots</i><b>,</b> <i>strata</i><b>,</b> <i>cluster</i><b>,</b> <i>subpop</i><b>,</b> <i>fpcvar</i><b>,</b> <i>stat</i><b>,</b> <i>...</i><b>)</b>:
           <i>f</i>:  1 <i>x</i> 1
           <i>X</i>:  <i>n x k</i>
           <i>w</i>:  <i>n x</i> 1 or 1 <i>x</i> 1
      <i>nodots</i>:  1 <i>x</i> 1
      <i>strata</i>:  <i>n x</i> 1 or <i>strata</i>=.
     <i>cluster</i>:  <i>n x</i> 1 or <i>cluster</i>=.
      <i>subpop</i>:  <i>n x</i> 1 or <i>subpop</i>=.
      <i>fpcvar</i>:  <i>n x</i> 1 or <i>fpcvar</i>=.
        <i>stat</i>:  <i>1 x p</i> or <i>2 x p</i> or <i>stat</i>=.
         <i>...</i>:  (depending on <i>f</i>)
      <i>result</i>:  <i>struct mm_jkstats</i>
<p>
    <b>(*</b><i>f</i><b>)(</b><i>X</i><b>,</b> <i>w</i><b>,</b> <i>...</i><b>)</b>:
           <i>X</i>:  <i>n x k</i>
           <i>w</i>:  <i>n x</i> 1 or 1 <i>x</i> 1
         <i>...</i>:  (depending on <i>f</i>)
      <i>result</i>:  <i>1 x p</i> or <i>2 x p</i>
<p>
    <b>mm_jk_report(</b><i>jk</i><b>,</b> <i>what</i><b>,</b> <i>level</i><b>,</b> <i>mse</i><b>,</b> <i>fpc</i><b>)</b>:
          <i>bs</i>:  <i>struct mm_jkstats</i>
        <i>what</i>:  <i>s x</i> 1 or 1 <i>x s</i>
       <i>level</i>:  1 <i>x</i> 1
         <i>mse</i>:  1 <i>x</i> 1
         <i>fpc</i>:  <i>m x</i> 1 or <i>fpc</i>=. (<i>m</i>: n. of strata)
      <i>result</i>:  <i>r x p</i>
<p>
<p>
<b><u>Diagnostics</u></b>
<p>
    None.
<p>
<p>
<b><u>Source code</u></b>
<p>
    mm_jk.mata
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jann@soz.gess.ethz.ch
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  help for <b>jackknife</b>, <b>svy jackknife</b>, <b>mm_bs()</b>, <b>moremata</b>
</pre>