<pre>
<p>
cmd:help movestay}
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>movestay</b> --    Maximum-likelihood estimation of endogenous switching
                     regression model
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>movestay</b> (<i>depvar0</i> [=] <i>varlist0</i>) (<i>depvar1 [=] varlist1</i>) [<i>if</i>] [<i>in</i>] [
                 <i>weight</i>] <b>,</b> <b><u>sel</u></b><b>ect(</b><i>depvar_s</i> [<b>=</b>] <i>varlist_s</i><b>)</b> [<i>options</i>]
<p>
<p>
<b><u>Syntax for predict</u></b>
<p>
        <b>predict</b> [<i>type</i>] <i>newvar</i> [<i>if</i>] [<i>in</i>] [<b>,</b> <i>statistic</i>]
<p>
    <i>statistic</i>    Description
    -------------------------------------------------------------------------
    Main
      <b><u>ps</u></b><b>el</b>        the probability of being in regime 1
      <b>xb0</b>         fitted values for regime 0
      <b>xb1</b>         fitted values for regime 1
      <b>yc0</b>         fitted values for regime 1
      <b>yc1</b>         fitted values for regime 1
      <b>mills0</b>      Mills' ratio for regime 0
      <b>mills1</b>      Mills' ratio for regime 1
    -------------------------------------------------------------------------
<p>
<p>
<a name="options"></a>    <i>options</i>               Description
    -------------------------------------------------------------------------
    Model
      <b>select()</b>             specify selection equation: dependent and
                            independent variables
      <b><u>col</u></b><b>linear</b>            keep collinear variables
<p>
    SE/Robust
      <b><u>r</u></b><b>obust</b>              robust estimator of variance
      <b><u>cl</u></b><b>uster(</b><i>varname</i><b>)</b>    adjust standard errors for intragroup correlation
<p>
    Reporting
      <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>            set confidence level; default is <b>level(95)</b>
<p>
    Max option
      <i>maximize_options</i>    control the maximization process;
    -------------------------------------------------------------------------
    <b>fweight</b>s, <b>iweight</b>s, and <b>pweight</b>s are allowed;see weight.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>movestay</b> uses the maximum likelihood method to estimate the endogenous
    switching regression model.  It is implemented using the <b>d2</b> evaluator to
    calculate the overall log likelihood together with its first and second
    derivatives.
<p>
    <b>movestay</b> estimates all of the parameters in the model:
<p>
        (regression equation for regime 0: y0 is <i>depvar0</i>, x1 is <i>varlist0</i>)
                y0 = x0 * b0 + e_0
<p>
        (regression equation for regime 1: y1 is <i>depvar1</i>, x1 is <i>varlist1</i>)
                y1 = x1 * b1 + e_1
<p>
        (selection equation: Z is <i>varlist_s</i>)
                y0 observed if Zg + u &lt;= 0
                y1 observed if Zg + u &gt; 0
<p>
<p>
        where:
                e_0 ~ N(0, sigma0)
                e_1 ~ N(0, sigma1)
                u ~ N(0, 1)
                corr(e_0, u) = rho_0
                corr(e_1, u) = rho_1
<p>
    Here <i>depvar0</i>, <i>depvar1</i> and <i>varlist0</i>, <i>varlist1</i> are the dependent variables
    and regressors for the underlying regression models (y0, y1 = xb), and
    <i>varlist_s</i> specifies the variables Z thought to determine which regime is
    observed.
<p>
<p>
<b><u>Options</u></b>
<p>
        +-------+
    ----+ Model +------------------------------------------------------------
<p>
    <b>select()</b> specifies variables in the selection equation. <i>varlist_s</i>
        includes the set of instruments that help identify the model.  This
        option is an integral part of the <b>movestay</b> estimation and is
        required. The selection equation is estimated based on all exogenous
        variables specified in the continuous equations plus instruments.  If
        there are no instrumental variables in the model, <i>depvar_s</i> must be
        specified.  In that case the model will be identified by
        non-linearities and the selection equation will contain all the
        independent variables that enter in the continuous equations.
<p>
    <b>collinear</b> see estimation options.
<p>
        +-----------+
    ----+ SE/Robust +--------------------------------------------------------
<p>
    <b>robust</b> specifies that the Huber/White/sandwich estimator of the variance
        is to be used in place of the conventional MLE variance estimator.
        <b>robust</b> combined with <b>cluster</b> further allows observations which are
        not independent within cluster (although they must be independent
        between clusters).
<p>
        If you specify <b>pweight</b>s, <b>robust</b> is implied.  See <b>[U] 23.14 Obtaining</b>
        <b>robust variance estimates</b>.
<p>
    <b>cluster(</b><i>varname</i><b>)</b> specifies that the observations are independent across
        groups (clusters) but not necessarily within groups.  <i>varname</i>
        specifies to which group each observation belongs; e.g.,
        <b>cluster(</b><i>personid</i><b>)</b> in data with repeated observations on individuals.
        <b>cluster()</b> affects the estimated standard errors and
        variance-covariance matrix of the estimators (VCE), but not the
        estimated coefficients.  <b>cluster()</b> can be used with pweights to
        produce estimates for unstratified cluster-sampled data.  Specifying
        <b>cluster()</b> implies <b>robust</b>.
<p>
        +-----------+
    ----+ Reporting +--------------------------------------------------------
<p>
    <b>level(</b><i>#</i><b>)</b>; see estimation options.
<p>
<a name="maximize_options"></a><p>
        +-------------+
    ----+ Max options +------------------------------------------------------
<p>
    <i>maximize_options</i> control the maximization process; see maximize.  With
        the possible exception of <b>iterate(0)</b> and <b>trace</b>, you should only have
        to specify them if the model is unstable.  The maximization uses
        option <b>difficult</b> by default. This option need not be specified.
<p>
<p>
        +------------------+
    ----+  predict options +-------------------------------------------------
<p>
    <b>psel</b> calculates the probability of being in regime 1.
<p>
    <b>xb0</b> calculates the linear prediction for equation 0.
<p>
    <b>xb1</b> calculates the linear prediction for equation 1.
<p>
    <b>yc0</b> returns the predicted value of the dependent variable(s) in the
        regime 0. For example, if earning function is modeled for two sectors
        (regimes), then this option predicts the wage rate in sector one for
        all individuals in the sample.
<p>
    <b>yc1</b> returns the predicted value of the dependent variable(s) in the
        regime 1.
<p>
    <b>mills0</b> and <b>mills1</b> calculate corresponding Mills' ratios for two regimes
<p>
<p>
<p>
<p>
<b><u>Examples</u></b>
<p>
    To obtain full ML estimates:
<p>
      Using instruments:
<p>
        <b>. movestay y1 x1 x2 x3 x4, select(regime1=z1 z2)</b>
<p>
        <b>. movestay (y1= x1 x2 x3 x4) (y1= x1 x2 x3 x5), select(regime1=z1 z2)</b>
<p>
      Model is identified through non-linearities:
<p>
        <b>. movestay (y1= x1 x2 x3 x4) (y1= x1 x2 x3 x5), select(regime1)</b>
<p>
    To define and use each equation separately:
<p>
        <b>. global wage_eqn y x1 x2 x3 x4</b>
        <b>. global select_eqn regime z1 z2</b>
<p>
        <b>. movestay ($wage_eqn), select($select_equn)</b>
<p>
    To use options:
<p>
        <b>. movestay y= x1 x2 x3 x4 if region=1 [w= hhweight], select(regime=</b>
        <b>z1 z2)</b>
<p>
        <b>. movestay (y= x1 x2 x3 x4) if region=1, select(regime= z1 z2)</b>
        <b>tech("dfp")</b>
<p>
    Prediction:
<p>
        <b>. movestay y x1 x2 x3 x4, select(regime= z1 z2)</b>
<p>
        <b>. predict yexpected, xb</b>
<p>
        <b>. predict mymills1, mills1</b>
<p>
    Example from the <i>Stata Journal</i>:
<p>
        . movestay lmo_wage age age2 edu13 edu4 edu5 reg2 reg3 reg4,
        select(private =m_s1 job_hold)
<p>
<p>
<b><u>Authors</u></b>
<p>
    M. Lokshin (DECRG, The World Bank) and Z. Sajaia (Stanford University).
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  help for regress, heckman, ml
<p>
</pre>