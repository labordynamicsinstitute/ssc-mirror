<pre>
-------------------------------------------------------------------------------
help for <b>onespell</b>
-------------------------------------------------------------------------------
<p>
<b><u>Generate single longest spell for each unit in panel data, listwise</u></b>
<p>
        <b>onespell</b> <i>varlist</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] , <b>saving(</b><i>name</i><b>)</b> [ <b>replace</b> ]
<p>
    <b>onespell</b> is for use with panel data. You must <b>tsset</b> your data before using
    <b>onespell</b>; see help <b>tsset</b>.
<p>
<b><u>Description</u></b>
<p>
    <b>onespell</b> produces a subset of a panel data set in which all observations on
    <b>varlist</b> are non-missing and contiguous in the time dimension. If a panel
    unit contains more than one such subset, the longest "spell" is retained.
<p>
    For instance, if a panel contains up to 20 years of data per firm, and firm
    <i>i</i> contains non-missing values for all variables of interest for years 1-10
    and 12-20, the first subset will be retained as that firm's single "spell"
    and years 12-20 will be discarded.
<p>
    If there are two or more spells of equal length, the latest spell will be
    retained. If firm <i>i</i> has non-missing values for all variables of interest
    for years 1-6, 8-13, 15-20, the spell for years 15-20 will be retained.
<p>
    Although performing this operation for a single variable of interest is
    fairly straightforward, this routine deals with a more challenging task:
    generating the single longest spell in a listwise fashion, across a set of
    variables. This applies the same logic as does, e.g., <b>regress</b>: an
    observation with a missing value in any variable will be deleted from the
    regression sample.  Some matrix software (e.g., DPD for Ox) requires that
    panel data be organized in this fashion, with each unit appearing as a
    single contiguous block of non-missing observations. <b>onespell</b> will produce
    such a dataset, which after conversion to Stata version 6 format (by, e.g.,
    Stat/Transfer) may be read directly by Ox. The routine has been tested with
    the latest version of Ox (3.40) and the DPD package (1.21).
<p>
<b><u>Options</u></b>
<p>
<p>
    <b>saving(</b><i>name</i><b>)</b> (a required option) causes the pruned dataset to be saved as
        <i>name</i>.dta. If that dataset already exists, the <b>replace</b> option must be
        used.
<p>
<b><u>Examples</u></b>
<p>
    . webuse grunfeld, clear
<p>
    . replace invest = . in 28
    . replace mvalue = . in 55
    . replace kstock = . in 87
    . replace kstock = . in 94
<p>
    . onespell invest mvalue kstock, saving(grun1)
<p>
<p>
<b><u>Author</u></b>
<p>
    Christopher F. Baum, Boston College, USA
    baum@bc.edu
<p>
<b><u>Acknowledgements</u></b>
<p>
    Most of the computations in this routine are generated by N.J. Cox's
    <b>tsspell</b> routine. Thanks to David Roodman for assistance with the issues of
    moving data between his <b>xtabond2</b> routine and DPD for Ox.
<p>
<b><u>Also see</u></b>
<p>
    On-line: tsspell
<p>
<p>
</pre>