<pre>
-------------------------------------------------------------------------------
help for <b>distplot</b>
-------------------------------------------------------------------------------
<p>
<b><u>Distribution function plots</u></b> 
<p>
        <b>distplot</b> <i>plottype</i> <i>varname</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b>by(</b><i>byvar</i><b>)</b> {
                 <b><u>freq</u></b><b>uency</b> | <b><u>mid</u></b><b>point</b> } <b><u>miss</u></b><b>ing</b> <b><u>rev</u></b><b>erse</b>
                 <b><u>trsc</u></b><b>ale(</b><i>transformation_syntax</i><b>)</b> <i>graph_options</i> ]
<p>
        <b>distplot</b> <i>plottype</i> <i>varlist</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> { <b><u>freq</u></b><b>uency</b>
                 | <b><u>mid</u></b><b>point</b> } <b><u>rev</u></b><b>erse</b> <b><u>trsc</u></b><b>ale(</b><i>transformation_syntax</i><b>)</b>
                 <i>graph_options</i> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>distplot</b> produces a plot of the cumulative distribution function(s) for
    the variables in <i>varlist</i>. This shows the proportion (or if desired the
    frequency) of values less than or equal to each value.
<p>
    The plot may be one of eight twoway types, namely, <b>area</b>, <b>bar</b>, <b>connected</b>,
    <b>dot</b>, <b>dropline</b>, <b>line</b>, <b>scatter</b> or <b>spike</b>. The <i>plottype</i> must be specified.
<p>
    With the <b>reverse</b> option, <b>distplot</b> produces a plot of the reverse
    cumulative probabilities (or frequencies), a.k.a., or a multiple of, the
    complementary distribution, reliability, survival or survivor function.
    This shows the proportion (or if desired the frequency) of values greater
    than each value.
<p>
    <b>fweight</b>s and <b>aweight</b>s may be specified.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>by()</b> specifies that calculations are to be carried out separately for
        each distinct value of a single variable <i>byvar</i>. <b>by()</b> is only allowed
        with a single <i>varname</i>.
<p>
    <b>frequency</b> specifies calculation of cumulative frequency rather than
        cumulative probability.
<p>
    <b>midpoint</b> specifies the use of midpoints of cumulative probability for
        each distinct value. This is especially appropriate for showing
        distributions of graded (ordinal) data with a relatively small number
        of categories. For more explanation and examples, see the Appendix
        below.
<p>
    <b>frequency</b> and <b>midpoint</b> may not be combined.
<p>
    <b>missing</b>, used only with <b>by()</b>, permits the use of non-missing values of
        <i>varname</i> corresponding to missing values for the variable named by
        <b>by()</b>. The default is to ignore such values.
<p>
    <b>trscale()</b> specifies the use of an alternative transformed scale for
        cumulative probabilities (or frequencies) on the graph. Stata syntax
        should be used with <b>@</b> as placeholder for untransformed values. To
        show probabilities as percents, specify <b>trscale(100 * @)</b>. To show
        probabilities on an inverse normal scale, specify
        <b>trscale(invnorm(@))</b>; on a logit scale, specify <b>trscale(logit(@))</b>; on
        a folded root scale, specify <b>trscale(sqrt(@) - sqrt(1 - @))</b>; on a
        loglog scale, specify <b>trscale(-log(-log(@)))</b>; on a cloglog scale,
        specify <b>trscale(log(-log(1 - @)))</b>. Tools to make associated labels
        and ticks easier are available on SSC: see ssc desc mylabels.
<p>
    <i>graph_options</i> refers to options of graph appropriate to the <i>plottype</i>
        specified.
<p>
<p>
<b><u>Examples</u></b>
<p>
    . distplot scatter mpg
    . distplot line mpg, by(foreign) clp(l _)
<p>
    . distplot connected length width height
<p>
    To sample all possible <i>plottype</i>s:
<p>
    . foreach t in area bar connected dot dropline line scatter spike {
    .         distplot `t' mpg, by(foreign)
    . }
<p>
<p>
<b><u>Author</u></b>
<p>
        Nicholas J. Cox, University of Durham
        n.j.cox@durham.ac.uk
         
<p>
<b><u>Acknowledgments</u></b> 
<p>
        
        Elizabeth Allred, Ronan Conroy and Roger Harbord made helpful comments
        during development of earlier versions of this or related programs.
<p>
<p>
<b><u>Also see</u></b>
<p>
    On-line: help for graph, cumul, quantile, mylabels (if installed)
<p>
    Manual: <b>[R] cumul</b>, <b>[R] diagnostic plots</b>
<p>
<p>
<b><u>Appendix: the midpoint option and graded data</u></b> 
<p>
    The cumulative probability <i>P</i> is defined under the <b>midpoint</b> option as
<p>
        SUM counts in categories below + (1/2) count in this category
        -------------------------------------------------------------.
                       SUM counts in all categories
                   
    With terminology from Tukey (1977, pp.496-497), this could be called a
    `split fraction below'. It is also a `ridit' as defined by Bross (1958):
    see also Fleiss (1981, pp.150-7) or Flora (1988). Yet again, it is also
    the mid-distribution function of Parzen (1993, p.3295). The numerator is
    a `split count'. Using this numerator, rather than
<p>
        SUM counts in categories below 
<p>
    or
<p>
        SUM counts in categories below + count in this category, 
        
    means that more use is made of the information in the data. Either
    alternative would always mean that some probabilities are identically 0
    or 1, which tells us nothing about the data. In addition, there are fewer
    problems in showing the cumulative distribution on any transformed scale
    (e.g. logit) for which the transform of 0 or 1 is not plottable. Using
    this approach for graded data was suggested by Cox (2001).
<p>
    A plot of the complement of this cumulative probability, 1 - <i>P</i>, may be
    obtained through the <b>reverse</b> option.
<p>
    Further information on working with counted fractions and folded
    transformations for probability scales is available in Tukey (1960, 1961,
    1977), Atkinson (1985), Cox and Snell (1989) and Emerson (1991).  Some of
    the possible transformations appear as link functions in the literature
    on generalized linear models (e.g. McCullagh and Nelder 1989; Aitkin et
    al. 1989).
<p>
    <b>Example 1</b>    Aitkin <i>et al.</i> (1989, p.242) reported data from a survey of
    student opinion on the Vietnam War taken at the University of North
    Carolina in Chapel Hill in May 1967. Students were classified by sex,
    year of study and the policy they supported, given choices of
<p>
        A The US should defeat the power of North Vietnam by widespread
          bombing of its industries, ports and harbours and by land invasion.
<p>
        B The US should follow the present policy in Vietnam.
<p>
        C The US should de-escalate its military activity, stop bombing North
          Vietnam, and intensify its efforts to begin negotiation.
<p>
        D The US should withdraw its military forces from Vietnam
          immediately.
<p>
    (They also report response rates (p.243), averaging 26% for males and 17%
    for females.)
<p>
    Suppose that, underneath the labels below, the value labels of <b>sex</b> are
    also called <b>sex</b>.
<p>
                   sex      year    policy          freq 
          1.      male         1         A           175  
          2.      male         1         B           116  
          3.      male         1         C           131  
          4.      male         1         D            17  
          5.      male         2         A           160  
          6.      male         2         B           126  
          7.      male         2         C           135  
          8.      male         2         D            21  
          9.      male         3         A           132  
         10.      male         3         B           120  
         11.      male         3         C           154  
         12.      male         3         D            29  
         13.      male         4         A           145  
         14.      male         4         B            95  
         15.      male         4         C           185  
         16.      male         4         D            44  
         17.      male  Graduate         A           118  
         18.      male  Graduate         B           176  
         19.      male  Graduate         C           345  
         20.      male  Graduate         D           141  
         21.    female         1         A            13  
         22.    female         1         B            19  
         23.    female         1         C            40  
         24.    female         1         D             5  
         25.    female         2         A             5  
         26.    female         2         B             9  
         27.    female         2         C            33  
         28.    female         2         D             3  
         29.    female         3         A            22  
         30.    female         3         B            29  
         31.    female         3         C           110  
         32.    female         3         D             6  
         33.    female         4         A            12  
         34.    female         4         B            21  
         35.    female         4         C            58  
         36.    female         4         D            10  
         37.    female  Graduate         A            19  
         38.    female  Graduate         B            27  
         39.    female  Graduate         C           128  
         40.    female  Graduate         D            13  
<p>
    . distplot connected policy [w=freq] if sex=="male":sex, mid by(year)
        xla(, valuelabel)
    . distplot connected policy [w=freq] if sex=="female":sex, mid by(year)
        xla(, valuelabel)
<p>
    <b>Example 2</b>    Fienberg (1980, pp.54-55) reports data from Duncan, Schuman
    and Duncan (1973) from 1959 and 1971 surveys of a large American city
    asking "Are the radio and TV networks doing a good job, just a fair job,
    or a poor job?". Suppose that, underneath the labels below, <b>opinion</b> runs
    1/3.
<p>
                  group    opinion      freq 
          1. 1959 Black       Good        81  
          2. 1959 Black       Fair        23  
          3. 1959 Black       Poor         4  
          4. 1959 White       Good       325  
          5. 1959 White       Fair       253  
          6. 1959 White       Poor        54  
          7. 1971 Black       Good       224  
          8. 1971 Black       Fair       144  
          9. 1971 Black       Poor        24  
         10. 1971 White       Good       600  
         11. 1971 White       Fair       636  
         12. 1971 White       Poor       158 
<p>
    . tab group opinion [w=freq], row
    . mylabels 20(10)90 95 98 99, myscale(logit(@/100)) local(myla)
    . distplot connected opinion [w=freq], mid by(group) trscale(logit(@))
        xla(1/3, valuelabel) yla(`myla', ang(h)) ytitle(Percent)
<p>
    This shows a clear shift of opinion towards Poor from 1959 to 1971, and a
    narrowing gap between Black and White.
<p>
    <b>Example 3</b>    Clogg and Shihadeh (1994, p.156) give data from the 1988
    General Social Survey on answers to the question "When a marriage is
    troubled and unhappy, do you think it is generally better for the
    children if the couple stays together or gets divorced?". Responses "much
    better to divorce", "better to divorce", "don't know", "worse to divorce"
    and "much worse to divorce" were coded here as 1/5 with shorter value
    labels.
<p>
                  sex      opinion          freq 
          1.     male  much better            84  
          2.     male       better           205  
          3.     male   don't know           135  
          4.     male        worse           121  
          5.     male   much worse            56  
          6.   female  much better           154  
          7.   female       better           330  
          8.   female   don't know           178  
          9.   female        worse            72  
         10.   female   much worse            49 
<p>
    It is not clear that the "don't know"s belong in the middle of the scale.
    The point can be explored by graphs with and without those values. Either
    way, there is a distinct separation between males and females, and a
    logit scale gives a more nearly linear pattern.
<p>
    . distplot connected opinion [w=freq], mid by(sex) xla(, valuelabel)
        xsc(r(0.7,5.3))
    . mylabels 2 5 10(10)90 95 98, myscale(logit(@/100)) local(myla)
    . distplot connected opinion [w=freq], mid by(sex) xla(, valuelabel)
        xsc(r(0.7,5.3)) trscale(logit(@)) yla(`myla', ang(h)) ytitle(Percent)
    . egen opinion2 = group(opinion) if opinion != 3, label
    . distplot connected opinion2 [w=freq], mid by(sex) xla(, valuelabel)
        xsc(r(0.7,4.3)) trscale(logit(@)) yla(`myla', ang(h)) ytitle(Percent)
<p>
    <b>Example 4</b>    Knoke and Burke (1980, p.68) gave data from the 1972 General
    Social Survey on church attendance. Suppose that, underneath the labels
    below, <b>attend</b> runs 1/3.
<p>
                          group    attend          freq 
          1. young non-Catholic       low           322  
          2. young non-Catholic    medium           122  
          3. young non-Catholic      high           141  
          4.   old non-Catholic       low           250  
          5.   old non-Catholic    medium           152  
          6.   old non-Catholic      high           194  
          7.     young Catholic       low            88  
          8.     young Catholic    medium            45  
          9.     young Catholic      high           106  
         10.       old Catholic       low            28  
         11.       old Catholic    medium            24  
         12.       old Catholic      high           119 
<p>
    The <b>reverse</b> option ensures that higher attendance groups plot higher on
    the graph. There are clear age and denomination effects and an indication
    of an interaction between the two.
<p>
    . mylabels 0.05 0.1(0.2)0.9 0.95, myscale(logit(@)) local(myla)
    . distplot connected attend [w=freq], mid by(group) trscale(logit(@))
        reverse xla(1/3, valuelabel) yla(`myla', ang(h))
<p>
    <b>Example 5</b>    Box, Hunter and Hunter (1978, pp.145-9) gave data on five
    hospitals on the degree of restoration (no improvement, partial
    functional restoration, complete functional restoration) of certain
    joints impaired by disease effected by a certain surgical procedure. (It
    is not clear whether these data are real.) Hospital E is a referral
    hospital. Box <i>et al.</i> carry out chi-square analyses, focusing on the
    difference between Hospital E and the others. Suppose that, underneath
    the labels below, <b>restore</b> runs 1/3.
<p>
              hospital    restore      freq 
          1.         A       none        13  
          2.         B       none         5  
          3.         C       none         8  
          4.         D       none        21  
          5.         E       none        43  
          6.         A    partial        18  
          7.         B    partial        10  
          8.         C    partial        36  
          9.         D    partial        56  
         10.         E    partial        29  
         11.         A   complete        16  
         12.         B   complete        16  
         13.         C   complete        35  
         14.         D   complete        51  
         15.         E   complete        10  
<p>
    . mylabels 5 10(20)90 5, myscale(logit(@/100)) local(myla)
    . distplot connected restore [w=freq], mid by(hospital) tsc(logit(@))
        xla(1/3, valuelabel) xsc(r(0.9,3.1)) yla(`myla', ang(h))
        ytitle(Percent)
<p>
<p>
<b><u>References</u></b>
<p>
    Aitkin, M., Anderson, D., Francis, B. and Hinde, J. 1989.  <i>Statistical</i>
    <i>modelling in GLIM.</i> Oxford: Oxford University Press.
<p>
    Atkinson, A.C. 1985. <i>Plots, transformations, and regression.</i>  Oxford:
    Oxford University Press.
<p>
    Box, G.E.P., Hunter, W.G. and Hunter, J.S. 1978.<i>  Statistics for</i>
    <i>experimenters: an introduction to design, data analysis, and model</i>
    <i>building.</i>  New York: John Wiley.
<p>
    Bross, I.D.J. 1958. How to use ridit analysis. <i>Biometrics</i> 14: 38-58.
<p>
    Clogg, C.C. and Shihadeh, E. 1994. <i>Statistical models for ordinal</i>
    <i>variables.</i>  Thousand Oaks, CA: Sage.
<p>
    Cox, D.R. and Snell, E.J. 1989. <i>Analysis of binary data.</i>  London: Chapman
    and Hall.
<p>
    Cox, N.J. 2001. Plotting graded data: a Tukey-ish approach.  Presentation
    to UK Stata users meeting, Royal Statistical Society, London, 14-15 May.
    http://www.stata.com/support/meeting/7uk/cox1.pdf
<p>
    Duncan, O.D., Schuman, H. and Duncan, B. 1973.  <i>Social change in a</i>
    <i>metropolitan community.</i>  New York: Russell Sage Foundation.
<p>
    Emerson, J.D. 1991. Introduction to transformation. In Hoaglin, D.C.,
    Mosteller, F. and Tukey, J.W. (eds) <i>Fundamentals of exploratory analysis</i>
    <i>of variance.</i> New York: John Wiley, 365-400.
<p>
    Fienberg, S.E. 1980.  <i>The analysis of cross-classified categorical data.</i>
    Cambridge, MA: MIT Press.
<p>
    Fleiss, J.L. 1981. <i>Statistical methods for rates and proportions.</i>  New
    York: John Wiley.
<p>
    Flora, J.D. 1988. Ridit analysis. In Kotz, S. and Johnson, N.L. (eds)
    <i>Encyclopedia of statistical sciences.</i> Wiley, New York, 8, 136-139.
<p>
    Knoke, D. and Burke, P.J. 1980. <i>Log-linear models.</i>  Beverly Hills, CA:
    Sage.
<p>
    McCullagh, P. and Nelder, J.A. 1989. <i>Generalized linear models.</i>  London:
    Chapman and Hall.
<p>
    Parzen, E. 1993. Change <i>PP</i> plot and continuous sample quantile function.
    <i>Communications in Statistics, Theory and Methods</i> 22: 3287-3304.
<p>
    Tukey, J.W. 1960. The practical relationship between the common
    transformations of percentages or fractions and of amounts. Reprinted in
    Mallows, C.L. (ed.) 1990.  <i>The collected works of John W. Tukey. Volume</i>
    <i>VI: More mathematical.</i>  Pacific Grove, CA: Wadsworth &amp; Brooks-Cole,
    211-219.
<p>
    Tukey, J.W. 1961. Data analysis and behavioral science or learning to
    bear the quantitative man's burden by shunning badmandments. Reprinted in
    Jones, L.V. (ed.) 1986.  <i>The collected works of John W. Tukey. Volume</i>
    <i>III: Philosophy and principles of data analysis: 1949-1964.</i>  Monterey,
    CA: Wadsworth &amp; Brooks-Cole, 187-389.
<p>
    Tukey, J.W. 1977. <i>Exploratory data analysis.</i>  Reading, MA:
    Addison-Wesley.
<p>
</pre>