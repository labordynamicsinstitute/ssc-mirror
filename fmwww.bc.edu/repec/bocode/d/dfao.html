<pre>
.-
help for ^dfao^          (Statalist distribution, 28 March 2002)
.-
<p>
Augmented Dickey-Fuller unit root test with additive outliers
<p>
  ^dfao^ varname  [^if^ exp] [^in^ range] [, ^M^axlag^(^#^)^ ^LLTC^ | ^NOLA^gte
&gt; st
                                       ^NOAO^test ^NOCON^stant ^NOTR^end
                                       ^GEN^erate(newvar) ^REG^ress ^LEV^el(int
&gt; eger)]
<p>
<p>
^dfao^ is for use with time-series data.  You must ^tsset^ your data before 
using ^dfao^; see help @tsset@.
<p>
^varname^ may contain time-series operators; see help @varlist@.
<p>
<p>
Description
-----------
<p>
^dfao^ performs a Dickey-Fuller (DF 1979, 1981) test for a single unit root in 
&gt; a time series when
one or more additive outliers are present. An additive outlier is a temporary s
&gt; hock or aberration
in the data, as exemplified by the shock to U.S. grain prices in the mid-1990s.
&gt;  The approach used
here follows the method outlined in Vogelsang (1999) and Franses and Haldrup (1
&gt; 994). The presence
of additive outliers induce "in the errors a moving-average component with a ne
&gt; gative coefficient"
(Vogelsang 1999, p. 237). Schwert (1989) showed that MA errors with a negative 
&gt; component result in
oversized unit root tests. Following Franses and Haldrup (1994), Vogelsang adds
&gt;  outlier dummy
variables to the augmented DF regression. The addition of these dummies does no
&gt; t affect the DF dis-
tribution if the number of dummies is not too large (see Franses and Haldrup). 
&gt; Outliers are de-
tected using an iterative method [see Vogelsang (pp. 240-2)]. Note that k+2 dum
&gt; my variables are
added to the DF regression for each outlier found (the contemporaneous dummy an
&gt; d k+1 of its lags,
where k is the lag length) because an additional lagged dummy is needed "to rem
&gt; ove the influence of
the outlier on the [kth lagged difference of the dependent variable].... If the
&gt; re is more than one
outlier and k is moderately large, the degrees of freedom lost ... from outlier
&gt;  removal can be non-
trivial" (Vogelsang 1999, p. 240).
<p>
The data are detrended unless the ^notrend^ option is specified, in which case 
&gt; the data are de-
meaned. If ^noconstant^ is specified, then the data are neither detrended nor d
&gt; emeaned, though this
option cannot be used when testing for additive outliers (see the explanation o
&gt; f the ^noconstant^
option below). The maximum lag order for the test is by default calculated from
&gt;  the sample size using
a rule provided by Schwert (1989, p. 151). The maximum lag order may also be pr
&gt; ovided with the ^maxlag^
option, and may be zero. If the maximum lag order exceeds one, a sequential lag
&gt; -length test is auto-
matically performed for each lag using a user-specified criterion (choices are 
&gt; sequential-t test
[see Ng &amp; Perron (1995)], Akaike, Schwarz, or Hannan-Quinn information criteria
&gt;  [see references]). If
the sequential-t test is chosen, then lag-length testing stops when that coeffi
&gt; cient's p-value is less
than the test size specified by the user (see the explanation of the ^level^ op
&gt; tion below). Note that
the sample size is held constant over lags at the maximum available sample. Aut
&gt; omatic lag selection can
be suppressed using the ^nolagtest^ option.
<p>
Approximate 1%, 5%, and 10% critical values for the ADF unit root test are calc
&gt; ulated using the
response surface equations in Cheung and Lai (1995).
<p>
^dfao^ prints the variable tested, the time period covered by the DF regression
&gt; , the number of
observations used in the DF regression, the value of maxlag and how it was sele
&gt; cted (by the user
or the Schwert criterion), deterministic terms used in the regression (none, co
&gt; nstant, or constant +
trend), the DF test statistic and the 1%, 5%, and 10% critical values, the MacK
&gt; innon (1994)
approximate p-value for the test statistic, the optimal lag order, the RMSE (ca
&gt; lculated from sample
size T), and the outliers together with their respective t-statistics, and crit
&gt; ical values. If the
^regress^ option (see below) is selected, the coefficient table for the DF regr
&gt; ession is also dis-
played. Note that t-statistics from the outlier test are printed as tau# and du
&gt; mmy variables are
printed as d#, where # is the observation number of the outlier. The outlier t-
&gt; statistics and out-
lier dummy variables are printed in the order in which outliers were detected, 
&gt; from most to least
significant. The particular information printed depends of course on the option
&gt; s chosen.
<p>
^dfao^ places in the return array the number of outliers, the t-statistics for 
&gt; each outlier de-
tected in the outlier test, the value of the t-statistic or information criteri
&gt; on and RMSE calcu-
lated at each lag, the number of observations used in the DF regression, the va
&gt; lue of maxlag, the
actual number of lags used in the DF regression, the coefficient of the lagged 
&gt; dependent variable
(rho), the DF test statistic (Zt), and the p-value corresponding to Zt. If outl
&gt; iers are detected,
^dfao^ also returns a macro listing the dates of the outliers in the order in  
&gt; which outliers were
detected (see the discussion of outlier t-statistics and dummy variables in the
&gt;  preceding para-
graph). The particular data returned depends on the options chosen.
<p>
<p>
Options
-------
<p>
^M^axlag(^#^) specifies the maximum lag order to be used in augmenting the Dick
&gt; ey-Fuller regression
and only accepts nonnegative integer values. If omitted, the maximum lag order 
&gt; is calculated as
described above.
 
^LLTC^(^t^|^aic^|^sc^|^hq^) stands for "lag length test criterion." Choices are
&gt;  "t" (sequential
t-test), "aic" (Akaike information criterion), "sc" (Bayesian Schwarz criterion
&gt; ), and "hq"
(Hannan-Quinn criterion). Only one option may be specified. If omitted, ^LLTC^ 
&gt; defaults to the
sequential t-test.
<p>
^NOLA^gtest suppresses automatic lag-length testing. If ^nolagtest^ is specifie
&gt; d and ^maxlag^ is
omitted, then the DF regression is run with the number of lags determined by th
&gt; e Schwert criterion
as described above. ^NOLA^gtest generates an error if ^LLTC^ is also specified.
<p>
^NOAO^test suppresses the test for additive outliers. If this option is used th
&gt; en ^dfao^ works like
^dfuller^, yet and unlike the latter routine, still provides for automatic lag-
&gt; length determination
and response surface critical values.
<p>
^NOCON^stant suppresses the constant in the DF regression. The data are neither
&gt;  demeaned nor de-
trended. Because this option precludes both the inclusion of a trend in the DF 
&gt; regression and the
outlier test, specifying ^NOCON^stant on the command line automatically sets th
&gt; e ^NOTR^end and
^NOAO^test options.
<p>
^NOTR^end means that the data are demeaned rather than detrended. Since many ti
&gt; me series exhibit
trending behavior, the default is to include a trend in the auxiliary and DF re
&gt; gressions.
<p>
^GEN^erate(^newvar^) specifies that the residuals from the DF regression should
&gt;  be saved as a new
variable for subsequent analysis. The residuals correspond to the DF regression
&gt;  using the lag-length
that is specified as an option or computed internally.
<p>
^REG^ress displays the coefficient table for the DF regression.
<p>
^LEV^el(^#^) controls both the width of the confidence intervals for displayed 
&gt; statistics and the test
size used in both outlier testing and lag-length determination. The test size i
&gt; s calculated as
100 - ^level^(^#^). If omitted, ^level^ equals the value contained in the globa
&gt; l macro ^$S_Level^.
<p>
<p>
Examples
--------
<p>
    . ^use http://fmwww.bc.edu/ec-p/data/macro/pervog92^
<p>
    . ^dfao lfiuscpi^
    
    . ^dfao lfiuscpi, notr lev(90)^
    
    . ^dfao lfiuscpi, notr lev(90) lltc(aic)^
<p>
    . ^dfao lfiuscpi, notr lev(90) reg^
    
    . ^dfao lfiuscpi, notr lev(90) m(11) nola^
    
    . ^dfao lfiuscpi, noao^
    
    . ^dfao lfiuscpi, nocon^
<p>
    . ^dfao lfiuscpi, gen(dfaores)^
    . ^wntestq dfaores^
<p>
<p>
References
----------
<p>
Akaike, H. 1973. Information Theory and the Extension of the Maximum Likelihood
&gt;  Principle.
In 2nd International Symposium on Information Theory. eds. B.N. Petrov, and F. 
&gt; Csaki, 267-81.
Budapest: Akailseoniai-Kiudo.
<p>
Akaike, H. 1974. A New Look at the Statistical Identification Model. IEEE: Tran
&gt; s. Auto
Control 19: 716-23
<p>
Baum, C. F. 2000. sts15: Test for stationarity of a time series. Stata Technica
&gt; l Bulletin 57: 36-39.
<p>
Baum, C. F., and R. Sperling. 2000. sts15.1: Tests for stationarity of a time s
&gt; eries: update.
Stata Technical Bulletin 58: 35-36.
<p>
Cheung, Y.-W., and K.S. Lai. 1995. Lag Order and Critical Values of the Augment
&gt; ed Dickey-Fuller
Test. Journal of Business &amp; Economic Statistics 13: 277-80.
<p>
Dickey, D.A., and W.A. Fuller. 1979. Distribution of the Estimators for Autoreg
&gt; ressive Time Series
with a Unit Root. Journal of the American Statistical Association 74: 427-31.
<p>
Dickey, D.A., and W.A. Fuller. 1981. Likelihood Ratio Tests for Autoregressive 
&gt; Time Series with a
Unit Root. Econometrica 49: 1057-72.
<p>
Franses, P.H., and N. Haldrup. 1994. The Effects of Additive Outliers on Tests 
&gt; for Unit Roots and
Cointegration. Journal of Business &amp; Economic Statistics 12: 471-78.
<p>
Hannan, E.J., and B.G. Quinn. 1979. The Determination of the Order of an Autore
&gt; gression. Journal of
the Royal Statistical Society, Series B 41: 190-95.
<p>
MacKinnon, J.G. 1994. Approximate Asymptotic Distribution Functions for Unit Ro
&gt; ot and Cointegration
Tests. Journal of Business &amp; Economic Statistics 12: 167-76.
<p>
Ng, S., and P. Perron. 1995. Unit Root Tests in ARMA Models with Data-Dependent
&gt;  Methods for the
Selection of the Truncation Lag. Journal of the American Statistical Associatio
&gt; n 90: 268-81.
<p>
Schwarz, G. 1978. Estimating the Dimension of a Model. Annals of Statistics 6: 
&gt; 461-64.
<p>
Schwert, G.W. 1989. Test for Unit Roots: A Monte Carlo Investigation. Journal o
&gt; f Business &amp;
Economic Statistics 7: 147-59.
<p>
Vogelsang, T.J. 1999. Two Simple Procedures for Testing for a Unit Root When Th
&gt; ere are Additive
Outliers. Journal of Time Series Analysis 20: 237-52.
<p>
<p>
Acknowledgements
----------------
<p>
Portions of the code were taken from dfuller.ado written by Stata Corp. and ^df
&gt; gls^ by Baum and
Sperling. Nick Cox provided valuable programming assistance. Thanks also to Tim
&gt;  Vogelsang for
clarifying comments. Finally, Kit Baum made several suggestions that significan
&gt; tly improved the
functionality of the program in addition to writing portions of this help file.
&gt;  Remaining errors
are mine.
<p>
<p>
Author
-------
<p>
Richard Sperling, The Ohio State University, USA
rsperling@@boo.net
<p>
<p>
Also see
--------
<p>
Manual:  ^[R] dfuller^
On-line:  help for @dfuller@, @time@, @tsset@, @dfgls@ (if installed)
</pre>