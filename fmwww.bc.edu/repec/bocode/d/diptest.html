<pre>
-------------------------------------------------------------------------------
<b>help diptest</b>
-------------------------------------------------------------------------------
<p>
<b><u>Dip statistic to test for unimodality</u></b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>diptest</b> <i>varname</i> [<i>if</i>] [<i>in</i>] [ <b>,</b> <b>by(</b><i>byvarlist</i><b>)</b> <b><u>r</u></b><b>eps(</b><i>#</i><b>)</b> <i>list_options</i> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>diptest</b> calculates and displays the dip statistic to test for
    unimodality. This statistic is the maximum difference between the
    empirical distribution function and the unimodal distribution function
    that minimises that maximum difference. The dip thus measures departure
    of a sample from unimodality and was proposed by Hartigan and Hartigan
    (1985) as a test statistic for unimodality. Hartigan (1985) published
    Fortran code. Mächler (2003) published corrected C code as part of an R
    package diptest.
<p>
    The reference distribution for calculating the dip statistic is the
    uniform, as a worst case unimodal distribution. P-values are calculated
    by comparing the dip statistic obtained with those for repeated samples
    of the same size from a uniform distribution. If the true distribution is
    not uniform, other methods may be more appropriate or more powerful.  For
    further discussion, see Hartigan and Hartigan (1985) and Cheng and Hall
    (1998).
<p>
<p>
<b><u>Remarks</u></b> 
<p>
    For reproducibility of P-values, set seed beforehand.
<p>
    Hartigan and Hartigan (1985, p.80), and also Hartigan (1985, p.321), give
    a table of percent points (1, 5, 10, 50, 90, 95, 99, 99.5, 99.9%) for the
    null distribution of the dip statistic for sample sizes 4(1)10 15 20 30
    50 100 200 based on 9999 simulations. The R package diptest includes a
    larger table based on 1000001 simulations.
<p>
    For sample sizes 1 to 3 or samples of identical values, the dip is
    returned as 0.
<p>
    Note that this procedure is independent of any density estimation
    procedure.
<p>
    As a side-effect of the calculation, <b>diptest</b> returns low and high ends of
    the modal interval for the best-fitting unimodal distribution
    corresponding to the data. The mean of values in that interval is also
    reported, without warranty of any merits as a summary.
<p>
    <b>diptest</b> uses Mata for its innermost calculations.  Thus Stata 9 up is
    required.
<p>
<p>
<b><u>Options</u></b> 
<p>
    <b>by()</b> specifies that calculations are to be carried out separately for the
        distinct groups defined by <i>byvarlist</i>. The variable(s) in <i>byvarlist</i>
        may be numeric or string.
<p>
    <b>reps()</b> specifies the number of repetitions of sampling from a uniform
        distribution of the same size. The default is 10000. Note that
        <b>reps(0)</b> suppresses P-value calculation.
<p>
    <i>list_options</i> are options of list other than <b>noobs</b> and <b>subvarname</b>. They
        may be specified to tune the display of results.
<p>
<p>
<b><u>Examples</u></b>
<p>
    <b>. diptest quality</b>
<p>
<p>
<b><u>Saved results</u></b> 
<p>
    r(n_1)       number of observations for first group         
    r(dip_1)     dip for first group 
    r(low_1)     low end of modal interval for first group 
    r(high_1)    high end of modal interval for second group 
    r(mean_1)    mean of modal interval for second group 
    r(P_1)       P-value for first group 
<p>
    etc. (suffixes _2 etc. indicating second group etc.)        
<p>
<p>
<b><u>Author</u></b> 
<p>
    Nicholas J. Cox, Durham University, UK
    n.j.cox@durham.ac.uk
<p>
<p>
<b><u>Acknowledgments</u></b> 
<p>
    Mata code is based on Fortran code in Hartigan (1985) and C code in
        Mächler (2003).
<p>
<p>
<b><u>References</u></b>
<p>
    Cheng, M-Y. and P. Hall. 1998. Calibrating the excess mass and dip tests
        of modality. <i>Journal, Royal Statistical Society, Series B</i> 60:
        579-589.
<p>
    Hartigan, J.A. and P.M. Hartigan. 1985. The dip test of unimodality.
        <i>Annals of Statistics</i> 13: 70-84.
<p>
    Hartigan, P.M. 1985. Algorithm AS 217: Computation of the dip statistic
        to test for unimodality. <i>Applied Statistics</i> 34: 320-325.
<p>
    Mächler, M. 2003. diptest 0.25-1.  http://www.r-project.org/
<p>
<p>
<b><u>Also see</u></b>
<p>
    help for kdensity, modes (if installed), hsmode (if installed)
<p>
</pre>