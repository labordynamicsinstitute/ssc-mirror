<pre>
-------------------------------------------------------------------------------
help for <b>dmerge</b>                                              manual:  <b>[R] merge</b>
                                                            dialog:  dmerge    
-------------------------------------------------------------------------------
<p>
<b><u>Merge datasets using a modification of Stata's </u></b><b><u>merge</u></b>
<p>
        <b>dmerge</b> [<i>varlist</i>] <b>using</b> <i>filename</i> [<b>,</b> <b>ukeep(</b><i>varlist</i><b>)</b> <b><u>uniq</u></b><b>ue</b> <b><u>uniqm</u></b><b>aster</b>
              <b><u>uniqu</u></b><b>sing</b> <b><u>nol</u></b><b>abel</b> <b>update</b> <b>replace</b> <b><u>nok</u></b><b>eep</b> <b>_merge(</b><i>varname</i><b>)</b> <b><u>t</u></b><b>able</b>
              <b><u>l</u></b><b>oudly</b> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>dmerge</b> joins corresponding observations from the dataset currently in
    memory (called the master dataset) with those from the Stata-format
    dataset stored as <i>filename</i> (called the using dataset) into single
    observations.  If <i>filename</i> is specified without an extension, <b>.dta</b> is
    assumed.  <b>dmerge</b> is a modification of Stata's official <b>merge</b>
<p>
    In contrast to Stata's <b>merge</b>, <b>dmerge</b> automatically drops <b>_merge()</b> if it
    exists, automatically sorts the master set by the merging variables,
    automatically sorts the using data set if it is not sorted by the merging
    variables, and suppresses Stata's listing of variable labels used in both
    data sets.
<p>
    <b>dmerge</b> does not have the full range of options that <b>mmerge</b> has, but is
    considerably faster than <b>mmerge</b> when the using set is already sorted, as
    <b>mmerge</b> but not <b>dmerge</b> always requires the master set to be preserved and
    the using set to be read into memory and saved.
<p>
    <b>dmerge</b> can perform both one-to-one and match merges.  In either case, the
    variable _merge (or the variable specified in <b>_merge()</b> if provided) is
    added to the data containing
<p>
           _merge==1    obs. from master data                      
           _merge==2    obs. from using data                       
           _merge==3    obs. from both master and using data       
<p>
    If <b>update</b> is specified, the codes for _merge are
<p>
           _merge==1    obs. from master data                      
           _merge==2    obs. from using data                       
           _merge==3    obs. from both, master agrees with using   
           _merge==4    obs. from both, missing in master updated  
           _merge==5    obs. from both, master disagrees with using
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>ukeep(</b><i>varlist</i><b>)</b> specifies the variables to be kept from the using data.
        If <b>ukeep()</b> is not specified, all variables are kept.
<p>
        The <b>ukeep()</b> <i>varlist</i> differs from standard Stata varlists in two ways.
        First, if you type a simple name, it is assumed to be the exact name
        of the variable to be kept; it cannot be an abbreviation.  Second,
        you may not refer to a range of variables; specifying
        <b>ukeep(age-income)</b> is an error.  You may, however, use other standard
        Stata varlist features such as the <b>*</b> and <b>~</b> characters to match one or
        more characters in a variable name; see help varlist.
<p>
    <b>unique</b>, <b>uniqmaster</b>, and <b>uniqusing</b> specify that the match variable(s) in a
        match merge uniquely identify the observations.
<p>
        <b>unique</b> specifies that the match variable(s) uniquely identify the
        observations in the master data and in the using data.  For most
        match merges, you should specify <b>unique</b>.  <b>dmerge</b> does nothing
        differently if you specify the option unless the assumption you were
        making turns out to be false.  In that case, rather than merging the
        data <b>dmerge</b> issues an error message.
<p>
        <b>uniqmaster</b> specifies that the match variable(s) uniquely identify
        observations in memory (the master data) but not necessarily in the
        using data.
<p>
        <b>uniqusing</b> specifies that the match variable(s) uniquely identify
        observations in the using data but not necessarily in the master
        data.
<p>
        <b>unique</b> is equivalent to specifying <b>uniqmaster</b> and <b>uniqusing</b>.  If none
        of the three options are specified, then observations in the using
        and master data are not required to be unique.  In that case, records
        that have the same values of the match variables are joined
        observationwise until all the records one side or the other are
        matched, then the final record on the shorter side is duplicated over
        and over again to match with the remaining records with the same
        match value on the longer side.
<p>
    <b>nolabel</b> prevents Stata from copying the value label definitions from the
        disk dataset.  Even if you do not specify this option, in no event do
        label definitions from disk replace those already in memory.
<p>
    <b>update</b> varies the action <b>dmerge</b> takes when an observation is matched.  By
        default, the master data is held inviolate -- values from the master
        data are retained when the same variables are found in both datasets
        If <b>update</b> is specified, however, the values from the using data are
        retained in cases where the master data contains missing.
<p>
    <b>replace</b>, allowed with <b>update</b> only, specifies that even in the case when
        the master data contains nonmissing values, they are to be replaced
        with corresponding values from the using data when corresponding
        values are not equal.  A nonmissing value, however, will never be
        replaced with a missing value.
<p>
    <b>nokeep</b> causes <b>dmerge</b> to ignore observations in the using data that have
        no corresponding observation in the master.  The default is to add
        these observations to the merged result and mark such observations
        with _merge==2.
<p>
    <b>_merge(</b><i>varname</i><b>)</b> specifies the name of the variable that will mark the
        source of the resulting observation.  The default is <b>_merge(_merge)</b>.
<p>
    <b>table</b> forces <b>dmerge</b> to <b>tabulate _merge</b> at the completion of the merging
        process}.
<p>
    <b>loudly</b> removes <b>quietly</b> from <b>dmerge</b> so that the usual <b>merge</b> descriptions
        are displayed.
<p>
<p>
<b><u>Example:  one-to-one merge</u></b>
<p>
    <b>. use ds1</b>
    <b>. dmerge using ds2, unique</b>
<p>
<p>
<b><u>Example:  match merge</u></b>
<p>
    <b>. use ds2</b>
    <b>. sort recid</b>
    <b>. save ds2, replace</b>
    <b>. use ds1</b>
    <b>. sort recid</b>
    <b>. dmerge recid using ds2</b>
    <b>. tabulate _merge</b>
<p>
<p>
<b><u>Example:  update match merge</u></b>
<p>
    <b>. use original, clear</b>
    <b>. dmerge make using updata, update</b>
    <b>. tabulate _merge</b>
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[U] 25 Commands for combining data</b>,
             <b>[R] merge</b>
<p>
</pre>