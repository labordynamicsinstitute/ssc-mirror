<pre>
<b>help hangroot</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>hangroot</b> -- Hanging rootogram or suspended rootogram comparing an
                  empirical distribution to a theoretcal distribution
<p>
<p>
<b><u>Syntax</u></b>
<p>
    Stand-alone
<p>
        <b>hangroot</b> <i>varname</i> [<i>if</i>] [<i>in</i>] [fweight] [<b>,</b> <b>dist(</b><i>name</i><b>)</b> <i>general_opts</i>
            {<i>continuous_opts</i> | <i>discrete_opts</i>} ]
<p>
<p>
    post-estimation command
<p>
        <b>hangroot</b> [<b>,</b> <i>general_opts</i> {<i>continuous_opts</i> | <i>discrete_opts</i>} ]
<p>
    The post-estimation syntax is available after estimating a model with or
    without covariates using one of the commands listed in this table.
<p>
<a name="options"></a>        <i>general_opts</i>            description 
        -------------------------------------------------------------------
        <b>dist(</b><i>name</i><b>)</b>              specifies theoretical distribution 
        <b>par(</b><i>numlist</i><b>)</b>            specifies the parameters at which the 
                                theoretical distribution is to be fixed
                                These parameters will be estimated if this 
                                option is not specified
        <b><u>susp</u></b><b>ended</b>               specifies that a suspended rootogram is to 
                                be drawn rather than a hanging rootogram
        <b><u>notheor</u></b><b>etical</b>           supresses the disply of the theoretical 
                                distribution
        <b>ci</b>                      draw confidence intervals
        <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>                sets confidence level to <i>#</i>
        <b>sims(</b><i>varlist</i><b>)</b>           overlays the empirical distributions of 
                                all variables in <i>varlist</i>
        <b><u>sp</u></b><b>ike</b>                   draw the empirical distribution as spikes, 
                                the default
        <b>bar</b>                     draw the empirical distribution as bars
        <b>ninter(</b><i>#</i><b>)</b>               governs the smoothness of the theoretical
                                distribution if <b>hangroot</b> is used
                                after an estimation command with covariates
        <b><u>maino</u></b><b>pt(</b><i>graph_options</i><b>)</b>  options governing the look of the 
                                empirical distribution
        <b><u>theoro</u></b><b>pt(</b><i>graph_options</i><b>)</b> options governing the look of the 
                                theoretical distribution
        <b><u>cio</u></b><b>pt(</b><i>graph_options</i><b>)</b>    options governing the look of the 
                                confidence interval
        <b>simsopt(</b><i>graph_options</i><b>)</b>  options governing the look of the 
                                empirical distributions specified in <b>sims()</b>
        <b><u>jitter</u></b><b>sims(</b><i>integer</i><b>)</b>     horizontally jitter the marker positions for th
&gt; e
                                empircal distribution specified in <b>sims()</b>
                                using random noise
        <b>jitterseed()</b>            random number seed for <b>jittersims()</b>
        <b>plot(</b><i>plot</i><b>)</b>              add other plots to the graph
        other options 
        -------------------------------------------------------------------
<p>
<a name="continuous_opts"></a>        <i>continuous_opts</i>         description
        -------------------------------------------------------------------
        <b>bin(</b><i>#</i><b>)</b>                  set number of bins to <i>#</i>
        <b><u>w</u></b><b>idth(</b><i>#</i><b>)</b>                set width of bins to <i>#</i> 
        <b>start(</b><i>#</i><b>)</b>                set lower limit of first bin to <i>#</i>
        -------------------------------------------------------------------
<p>
<a name="discrete_opts"></a>        <i>discrete_opts</i>           description
        -------------------------------------------------------------------
        <b><u>d</u></b><b>iscrete</b>                specify that the data are discrete
        <b><u>w</u></b><b>idth(</b><i>#</i><b>)</b>                set width of bins to <i>#</i>
        <b>start(</b><i>#</i><b>)</b>                set theoretical minimum value to <i>#</i>
        -------------------------------------------------------------------
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>hangroot</b> draws a hanging rootogram or suspended rootogram (Tukey 1965,
    1972, 1977) and (Tukey and Wilk 1965) (Also see: (Wainer 1974) and
    (Friendly 2000)) comparing the empirical distribution of varname to a
    theoretical distribution, as specified in the <b>dist</b> option. Both are an
    alternative for <b>histogram</b> with the theoretical density function plotted
    on top.  The hanging rootogram differs from a histogram in two ways:
<p>
        1) The spikes or bars "hang" from the theoretical distribution
        instead of "standing" on the x-axis.  The deviations are now shown as
        deviations from a horzontal line (y=0) instead of deviations from a
        curve (the density function).  This makes it easier to spot patterns
        in the deviations.
<p>
        2) Instead of showing the freqencies it shows the square root of the
        frequencies.  This way the sampling variation of the length of the
        spikes or bars is stabelized.  These lengths are counts of the number
        of observations that fall within each bin, and larger counts tend to
        have larger sampling variation than smaller counts, making it harder
        to compare the deviations across bins. By taking the square root, the
        sampling variations tends to be approximately equal across bins,
        facilitating the comparison across bins. Moreover, this tends to make
        deviations in the tails, where the counts are small, more visible.
<p>
    The aim of the hanging rootogram and the suspended rootogram is to
    compare an empirical distribution to a theortical distribution. The key
    part of the graph that displays this information are the deviations of
    the bars or spikes in the hanging rootogram from the line y=0, as these
    are the residuals of the empirical distribution fromt the theoretical
    distribution. So, a more direct way of achieving the goal of these graphs
    is to directly display these residuals rather than the raw number of
    observations belonging to each bin. This is what the suspended rootogram
    does. It now makes sense to flip the entire graph upside down, suspending
    the theoretical distribution from the line y=0, because this way positive
    residuals represent too many observations in a bin, and negative
    residuals too few observations in a bin. We can optionally suppress the
    display of the theoretical distribution, focussing entirly on the
    residuals.
<p>
<p>
<b><u>Coefficients of the theoretical distribution</u></b>
<p>
    The parameters of the theoretical can either be estimated or specified by
    the user using the <b>par()</b> option. For many distributions there are two
    ways in which <b>hangroot</b> can obtain estimates, either it computes those
    estimates itself, this happens when the stand-alone syntax is used, or it
    can use the estimates obtained previously, this happens when the
    post-estimation syntax is used. The post-estimation syntax is available
    if in the table below there is an entry in the <i>estimation command</i> column,
    while the stand-alone syntax is available if the entry in the <b>dist(</b><i>name</i><b>)</b>
    column is not marked with an *.
<p>
    In order to use the post-estimation syntax one must first estimate the
    model with or without covariates using one of the estimation commands in
    the table below. If the previous model contained covariates, then the
    theoretical distribution will the marginal distribution of the dependent
    variable implied by the model and distribution of the covariates in the
    data. All the estimation commands are either part of official Stata or
    available from ssc. The <b>if</b> and <b>in</b> qualifiers and the weights will be
    coppied from the last estimation command, so they may not be specified in
    the post-estimation syntax.  This also means that this syntax is only
    availabe if the previous model was estimated either without weights or
    with fweights.
<p>
<a name="coef"></a>        <i>distribution</i>                <i>estimation command</i>   <b>dist(</b><i>name</i><b>)</b>
        -------------------------------------------------------------------
        normal / Gaussian           <b>regress</b>              <i><u>norm</u></i><i>al</i> or <i><u>gaus</u></i><i>sian</i>
        lognormal                   <b>lognfit</b>              <i><u>logn</u></i><i>ormal</i>
        logistic                                         <i><u>logi</u></i><i>stic</i> 
        Weibull                     <b>weibullfit</b>           <i><u>weib</u></i><i>ull</i>*
        Chi square                                       <i>chi2</i> 
        gamma                       <b>gammafit</b>             <i>gamma</i> 
        Gumbel                      <b>gumbelfit</b>            <i><u>gumb</u></i><i>el</i> 
        inverse gamma               <b>invgammafit</b>          <i><u>invg</u></i><i>amma</i> 
        Wald / inverse Gaussian     <b>invgaussfit</b>          <i>wald</i>
        beta                        <b>betafit</b>              <i>beta</i> 
        Pareto                      <b>paretofit</b>            <i><u>pare</u></i><i>to</i>
        Fisk / log-logistic         <b>fiskfit</b>              <i>fisk</i>*
        Dagum                       <b>dagumfit</b>             <i>dagum</i>*
        Singh-Maddala               <b>smfit</b>                <i>sm</i>*
        Generalized Beta II         <b>gb2fit</b>               <i>gb2</i>*
        generalized extreme value   <b>gevfit</b>               <i>gev</i>*
        exponential                                      <i><u>expo</u></i><i>nential</i>
        Laplace                                          <i><u>lapl</u></i><i>ace</i>
        uniform                                          <i><u>unif</u></i><i>orm</i> 
        geometric                                        <i><u>geom</u></i><i>etric</i>
        Poisson                     <b>poisson</b>              <i><u>pois</u></i><i>son</i>
        zero inflated Poisson       <b>zip</b>                  <i>zip</i>*
        negative binomial I         <b>nbreg</b>                <i>nb1</i>* 
        negative binomial II        <b>nbreg</b> and <b>gnbreg</b>     <i>nb2</i>*
        zero inflated negative
        binomial                    <b>zinb</b>                 <i>zinb</i>*
        -------------------------------------------------------------------
        * These distributions cannot be used in the stand-alone syntax.
                
    If the post-estimation syntax is used and the <b>par()</b> option is not
    specified, than the best fitting distribution is retrieved from the last
    estimation command.  If the stand-alone syntax is used and the <b>par()</b>
    option is not specified, than the best fitting distribution is fitted
    using the method specified in the table below. If the method is not
    maximum likelihood, the best fitting distribution in the stand-alone
    syntax may differ from the post-estimation syntax.
<p>
        <i>maximum</i>          <i>method of</i>  
        <i>likelihood</i>       <i>moments</i>    
        -----------------------------------------
        Gaussian         logistic        
        log-normal       Gumbel          
        Wald             inverse gamma   
        Pareto           beta
        exponential      uniform 
        Laplace          
        geometric
        Poisson
        gamma(*)
        -----------------------------------------
        (*) approximate
<p>
    Depending on the distribution specified, <b>hangroot</b> will only use
    observations that meet the following criteria:
<p>
        exponential            <i>varname</i> &gt;= 0
        lognormal              <i>varname</i> &gt;= 0 
        Weibull                <i>varname</i> &gt;= 0
        gamma                  <i>varname</i> &gt;= 0
        Gumbel                 <i>varname</i> &gt;= 0
        inverse gamma          <i>varname</i> &gt; 0
        Pareto                 <i>varname</i> &gt; 0
        wald                   <i>varname</i> &gt; 0
        Fisk                   <i>varname</i> &gt; 0
        Dagum                  <i>varname</i> &gt; 0
        Singh-Maddala          <i>varname</i> &gt; 0
        Generalized Beta II    <i>varname</i> &gt; 0
        Poisson                <i>varname</i> &gt;= 0 &amp; <i>varname</i> = integer 
        zero inflated Poisson  <i>varname</i> &gt;= 0 &amp; <i>varname</i> = integer 
        negative binomial      <i>varname</i> &gt;= 0 &amp; <i>varname</i> = integer 
        zero inflated negative 
        binomial               <i>varname</i> &gt;= 0 &amp; <i>varname</i> = integer 
        geometric              <i>varname</i> &gt;= 0 &amp; <i>varname</i> = integer
        beta                   0 &lt; <i>varname</i> &lt; 1
<p>
    The geometric distribution is parameterized in terms of the number of
    failures before the first succes, instead of the number of trials needed
    to get the first succes.
<p>
<p>
<b><u>General options</u></b>
<p>
    <b>dist(</b><i>name</i><b>)</b> specifies the theoretical distribution with which the
        empirical distribution is compared. This option will be ignored in
        the post-estimation syntax.  The default is Gaussian.
<p>
        The option <b>discrete</b> is implied when specifying the geometric or the
        poisson distribution.
<p>
    <b>par(</b><i>numlist</i><b>)</b> specifies the parameters at which the theoretical
        distribution is to be fixed. If this option is not specified than the
        estimated parematers will be used. The table below identifies which
        parameter is represented by which number in the <i>numlist</i>. The variable
        of interest is represented by y, the first number in numlist is
        represented by a, the second by b, the third by c, and the fourth by
        d.
<p>
        --------------------------------------------------------------------
        <i>distribution</i>                <i>parameterization</i>
        --------------------------------------------------------------------
        normal / Gaussian           normalden(a, b)
<p>
        lognormal                   (1 / (y * b * sqrt(2 * pi))) * 
                                    exp(-(log(y) - a)^2 / (2 * b^2))
<p>
        logistic                    exp(-1*(y - a )/b) /
                                    (b*(1+exp(-1*(y - a )/b))^2)
<p>
        Weibull                     (a/b)*(y/b)^(a - 1)*exp(-(y/b)^a)
<p>
        Chi square                  gammaden(a/2,2,0,y)
<p>
        gamma                       gammaden(a, b, 0, y)
<p>
        Gumbel                      (1 / b) * exp(-(y - a) / b) * 
                                    exp(-exp(-(y - a) / b))
<p>
        inverse gamma               b^a/exp(lngamma(a))*y^(-a-1)*exp(-b/y)
<p>
        Wald / inverse Gaussian     sqrt(b/(2*pi*y^3)) * 
                                    exp(-b*(y-a)^2 / (2*a^2*y))
<p>
        beta                        betaden(a,b,y)
<p>
        Pareto                      b*a^b/y^(b+1)
<p>
        Fisk / log-logistic         a*((b/y)^a)*(1/&lt;)/(1 + (b/y)^a)^2
<p>
        Dagum                       (a*c)*((b/y)^a)*
                                    (1/y)/(1 + (b/y)^a)^(c+1)
<p>
        Singh-Maddala               (a*c/b)*((1 + (y/b)^a)^-(c+1))*
                                    ((y/b)^(a-1))
<p>
        Generalized Beta II         a*y^(a*c-1)*((b^(a*c))* 
                                    exp(lngamma(c) + lngamma(d) - 
                                        lngamma(c + d))* 
                                    (1 + (y/b)^a )^(c+d))^-1
<p>
        generalized extreme value   1/b*(1+c*((y-a)/b))^(-1-1/c)*
                                    exp(-1*(1+c*((y-a)/b))^(-1/c))
<p>
        exponential                 a*exp(-a*y)
<p>
        Laplace                     1/(2*b)*exp(-1*|y-a|/b)
<p>
        uniform                     1/(b-a)
<p>
        geometric                   (1-a)^y*a
<p>
        Poisson                     exp(-a)*a^y/y!
<p>
        zip                         cond(y==0, b + (1-b)*exp(-a),
                                    (1-b)*( exp(-a)*a^y/y! )
<p>
        negative binomial I         exp(lngamma(y + a) - lngamma(y+1) - 
                                        lngamma(a)) * b^y / (1 + b)^(y+a)
<p>
        negative binomial II        exp(lngamma(y + 1/b) - lngamma(y + 1) - 
                                        lngamma(1/b)) * (a/(1/b + a))^y * 
                                    (1/(b*(1/b + a)))^(1/b)
<p>
        zero inflated negative      cond(y==0 , c + (1-c)*(1/(1+a*b))^(1/b),
        binomial                    (1-c) *
                                    exp(lngamma(1/b+y) - lngamma(y+1) -
                                        lngamma(1/b)) *
                                    (1/(1+a*b))^(1/b) * (1-1/(1+a*b))^y ) 
        --------------------------------------------------------------------
<p>
    <b><u>susp</u></b><b>ended</b> specifies that a suspended rootogram is drawn rather than a
        hanging rootogram.
<p>
    <b><u>notheor</u></b><b>etical</b> suppresses the display of the theoretical curve. This
        option is only allowed in combination with the <b>suspended</b> option.
<p>
    <b>ci</b> specifies that confidence intervals are drawn around the bottom of the
        spikes or the bars. These confidence intervals assume that the number
        of observations in a bin follow a multinomial distribution, and use
        Goodman's (1965) approximation of the simultaneous confidence
        interval. These confidence intervals do not take into account that
        the parameters in the theoretical distribution are also estimated.
        These confidence intervals also do not take into account that nearby
        bins are likely to be similar, as was suggested by Vermeesch (2005).
        However, I would consider this latter point a feature, as this
        corresponds with the simple non-parametric logic that is behind the
        histogram and the (hanging) rootogram.
<p>
    <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> specifies the confidence level, in percent, for the confidence
        intervals; see level.
<p>
    <b>sims(</b><i>varlist</i><b>)</b> specifies variables whose empirical distribution will be
        overlaid on top of the graph. The intended use is that these
        variables are a set of random samples from the theoretical
        distribution, thus providing an informal confidence interval.
<p>
    <b><u>sp</u></b><b>ike</b> specifies that the empirical distribution is graphed as spikes.
        This is the default.
<p>
    <b>bar</b> specifies that the empirical distribution is graphed as bars.
<p>
    <b>ninter(</b><i>#</i><b>)</b> specifies the number of points between bin-midpoints for which
        the theoretical distribution is computed. It governs the smoothness
        of the curve representing the theoretical distribution. This option
        is only allowed when <b>hangroot</b> is used after an estimation command
        with covariates. The default is 5, and can be any integer between and
        including 0 and 20.
<p>
    <b><u>maino</u></b><b>pt(</b><i>graph_options</i><b>)</b> specifies options govinging the look of the
        empirical distribution or the residuals are drawn. By default or when
        the <b>spike</b> option is specified, these options can be the options of 
        twoway rspike. When the <b>bar</b> option is specified, these options can be
        the options of twoway rbar. In either case the the <b>by()</b>, <b>horizontal</b>,
        and <b>vertical</b> options are not allowed.  The options that can be
        specified in {opt} can also be directly added as other_options.
<p>
    <b><u>theoro</u></b><b>pt(</b><i>graph_options</i><b>)</b> specifies options govinging the look of the
        theoretical distribution. These options can be the options of twoway
        line. This option is not allowed when the <b>notheoretical</b> option is
        specified.
<p>
    <b><u>cio</u></b><b>pt(</b><i>graph_options</i><b>)</b> specifies options govinging the look of the
        confidence interval. These can be the options of:
<p>
        twoway rbar when the <b>suspended</b> option is not specified and the
        empirical distribution is represented by spikes,
<p>
        twoway rcap when the <b>suspended</b> option is not specified and the
        emprical distribution is represented by bars,
<p>
        twoway rarea when the <b>suspended</b> option is specified.
<p>
    <b>simsopt(</b><i>graph_options</i><b>)</b> specifies options govinging the look of the
        simulated distributions. These options can be the options of twoway
        pcspike. This option is only allowed when the <b>sims()</b> option is
        specified.
<p>
    <b><u>jitter</u></b><b>sims(</b><i>integer</i><b>)</b> adds random noice to the vertical possition of the
        markers representing the simulations, where <i>integer</i> represents the
        size of the noise as a percentage of the distance between the highest
        and lowest marker position for the simulated variables.
<p>
    <b>jitterseed()</b> random number seed for <b>jittersims()</b>
<p>
    <b>plot(</b><i>plot</i><b>)</b> provides a way to add other plots to the generated graph; see:
        addplot_option (Stata 9 and 10) or plot_option (Stata 8).
<p>
<a name="other"></a>    <i>Other options</i> When the option <b>bar</b> is specified all twoway rbar options
        are allowed, except <b>by()</b>, <b>horizontal</b>, and <b>vertical</b>.  Otherwise all 
        twoway rspike options are allowed, with the same exceptions.
<p>
<p>
<b><u>Options for use in the continuous case</u></b>
<p>
    <b>bin(</b><i>#</i><b>)</b> and <b>width(</b><i>#</i><b>)</b> are alternatives.  They specify how the data are to
        be aggregated into bins; <b>bin()</b> by specifying the number of bins (from
        which the width can be derived) and <b>width()</b> by specifying the bin
        width (from which the number of bins can be derived).
<p>
        If neither option is specified, results are the same as if <b>bin(</b><i>k</i><b>)</b>
        were specified, where
<p>
            <i>k</i> = min{sqrt(<i>N</i>), 10*ln(<i>N</i>)/ln(10)}
<p>
        and where <i>N</i> is the number of observations.
<p>
    <b>start(</b><i>#</i><b>)</b> specifies the theoretical minimum of varname.  The default is
        <b>start(</b><i>m</i><b>)</b>, where <i>m</i> is the observed minimum value of <i>varname</i>.
<p>
        Specify <b>start()</b> when you are concerned about sparse data, for
        instance, if you know that <i>varname</i> can have a value of 0, but you are
        concerned that 0 may not be observed.
<p>
        <b>start(</b><i>#</i><b>)</b>, if specified, must be less than or equal to <i>m</i>, or else an
        error will be issued.
<p>
<p>
<b><u>Options for use in the discrete case</u></b>
<p>
    <b>discrete</b> specifies that varname is discrete and that you want each unique
        value of <i>varname</i> to have its own bin (bar of histogram).
<p>
    <b>width(</b><i>#</i><b>)</b> is rarely specified in the discrete case; it specifies the width
        of the bins.  The default is <b>width(</b><i>d</i><b>)</b>, where <i>d</i> is the observed
        minimum difference between the unique values of <i>varname</i>.
<p>
        Specify <b>width()</b> if you are concerned that your data are sparse.  For
        example, in theory <i>varname</i> could take on the values, say, 1, 2, 3,
        ..., 9, but because of the sparseness, perhaps only the values 2, 4,
        7, and 8 are observed.  Here the default width calculation would
        produce <b>width(2)</b> and you would want to specify <b>width(1)</b>.
<p>
    <b>start(</b><i>#</i><b>)</b> is also rarely specified in the discrete case; it specifies the
        theoretical minimum value of varname.  The default is <b>start(</b><i>m</i><b>)</b>, where
        <i>m</i> is the observed minimum value.
<p>
        As with <b>width()</b>, you specify <b>start(</b><i>#</i><b>)</b> if you are concerned that your
        data are sparse.  In the previous example, you might also want to
        specify <b>start(1)</b>.  <b>start()</b> does nothing more than add white space to
        the left side of the graph.
<p>
        The value of <i>#</i> in <b>start()</b> must be less than or equal to <i>m</i>, or an
        error will be issued.
<p>
<p>
<b><u>Examples</u></b>
<p>
    The residuals after a linear regression regress should be normally
    distributed, but in this case it appears to follow a bimodal
    distribution.
<p>
<b>    sysuse nlsw88, clear</b>
<b>    gen ln_w = ln(wage)</b>
<b>    reg ln_w grade age ttl_exp tenure</b>
<b>    predict resid, resid</b>
<b>    hangroot resid</b>
    (click to run)
<p>
    This bimodal distribution appears to be the result of the ommision of the
    variable union.
<p>
<b>    sysuse nlsw88, clear</b>
<b>    gen ln_w = ln(wage)</b>
<b>    reg ln_w grade age ttl_exp tenure union</b>
<b>    predict resid2, resid</b>
<b>    hangroot resid2</b>
    (click to run)
<p>
    The part of the graph that tells us how wel the distribution fits to the
    data is the distance between the bottom of the spikes and the horizontal
    line y=0. So why not explicitly plot these residuals instead? When we do
    that, it would also make sense to flip the entire graph upside down: In
    that case bins with too many cases will receive positive residuals and
    bins with too few cases negative residuals. This is done with the <b>susp</b>
    option
<p>
<b>    hangroot resid2, ci susp theoropt(lpattern(-))</b>
    (click to run)
<p>
    One can focuss more on the residuals by removing the theoretical
    distribution.
<p>
<b>    hangroot resid2, ci susp notheor</b>
    (click to run)
<p>
    <b>hangroot</b> can be used as a post-estimation command. In this case a log
    normal distribution without covariates was fitted using <b>lognfit</b>, which is
    available from ssc.
<p>
<b>    sysuse nlsw88, clear</b>
<b>    lognfit wage</b>
<b>    hangroot, ci</b>
    (click to run)
<p>
    A hanging rootogram can also be used to compare the distribution of two a
    variable across two groups. In the example below the wage distribution of
    those with a college degree is the reference/"theoretical" distribution,
    and the wage distribution of the respondents without a college degree
    hangs from it.
<p>
<b>    sysuse nlsw88, clear</b>
<b>    hangroot wage, dist(theoretical collgrad)</b>
    (click to run)
<p>
    <b>hangroot</b> can also be used to compare an empirical distribution with the
    marginal distribution implied by a regression model. In this case we
    create data that is appropriate for linear regression, but the
    distribution of y looks nothing like a normal distribution.
<p>
    In Stata &gt;= 10 I would have used rnormal() instead of
    <b>invnormal(uniform())</b>, but I have not done so here since <b>hangroot</b> is also
    supposed to work in Stata 9.2.
<p>
<b>    drop _all</b>
<b>    set obs 1000</b>
<b>    gen byte x = _n &lt;= 250</b>
<b>    gen y = -3 + 3*x + invnormal(uniform())</b>
<b>    hangroot y, dist(normal)</b>
    (click to run)
<p>
    However, the distribution of y fits the marginal distribution implied by
    the regression model. In this case we could also have inspected the
    residuals, which should be normally distributed. However, looking at
    residuals won't work for models that imply other distribution, e.g.
    Poisson or beta regression, but in those cases one can still inspect the
    marginal distribution.
<p>
<b>    reg y x</b>
<b>    hangroot </b>
    (click to run)
<p>
    Some deviation from the theoretical distribution is expected, as the data
    are typically random draws from a larger population. A nice way to see
    what kind of variability is still consistent with the model is to create
    a couple variables that are random draws assuming that the model is
    correct, and overlay the distribution of these random draws on top of the
    hanging rootogram.
<p>
    In Stata &gt;= 10 I would have used rnormal(mu,sd) instead of
    <b>invnormal(uniform())*sd + mu</b>, but I have not done so here since <b>hangroot</b>
    is also supposed to work in Stata 9.2.
<p>
<p>
<b>    predict double mu , xb</b>
<b>    scalar sd = e(rmse)</b>
<b>    forvalues i = 1/20 {</b>
<b>        gen sim`i' = invnormal(uniform())*sd + mu</b>
<b>    }</b>
<b>    hangroot, sims(sim*) jitter(5) xlab(-6(3)3) </b>
    (click to run)
<p>
<p>
<b><u>Author</u></b>
<p>
    Maarten L. Buis
    Universitaet Tuebingen
    Institut fuer Soziologie
    maarten.buis@uni-tuebingen.de
<p>
<p>
<b><u>Acknowledgement</u></b>
<p>
    Several programming tricks from dpplot by Nick Cox are incorporated in
        this program.
<p>
<p>
<b><u>References</u></b>
<p>
    Friendly, M. 2000.  Visualizing categorical data.  Cary, NC: SAS
        Institute.
<p>
    Goodman, L.A. 1965, On Simultaneous Confidence Intervals for Multinomial
        Proportions.  <i>Technometrics</i>, 7(2), pp. 247-254.
<p>
    Tukey, J.W. 1965. The future of processes of data analysis. Reprinted in
        Jones, L.V. (ed.) 1986. The collected works of John W. Tukey. Volume
        IV: Philosophy and principles of data analysis: 1965-1986. Monterey,
        CA:  Wadsworth and Brooks/Cole, 517-547.
<p>
    Tukey, J.W. and Wilk, M.B. 1965. Data analysis and statistics:
        principles and practice. Reprinted in Cleveland, W.S. (ed.) 1988. The
        collected works of John W. Tukey. Volume V: Graphics: 1965-1985.
        Pacific Grove, CA: Wadsworth and Brooks/Cole, 23-29.
<p>
    Tukey, J.W. 1972. Some graphic and semigraphic displays. In Bancroft,
        T.A. and Brown, S.A. (eds) Statistical papers in honor of George W.
        Snedecor. Ames, IA: Iowa State University Press, 293-316.
<p>
    Tukey, J.W. 1977, <i>Exploratory Data Analysis</i>, Addison-Wesley.
<p>
    Vermeesch, P. 2005, Statistical uncertainty associated with histograms in
        the Earth Sciences, <i>Journal of Geophysical Research - Solid Earth</i>,
        Vol 110, B02211.
<p>
    Wainer, H. 1974, The Suspended Rootogram and Other Visual Displays:  An
        Empirical Validation.<i>  The American Statistician</i>, 28(4), pp. 143-145.
<p>
<p>
<b><u>Also see:</u></b>
<p>
Estimation commands:
    If installed: lognfit, weibullfit, gammafit, gumbelfit, invgammafit, 
    invgaussfit, betafit, paretofit, fiskfit, dagumfit, smfit, gb2fit gevfit
<p>
<p>
Alternatives:
    Online: spikeplot, histogram, qnorm, pnorm, pchi, and qchi.
<p>
    if installed: dpplot, pbeta, qbeta, pweibull, qweibull, plogn, qlogn, 
    pgamma, qgamma, pgumbel, qgumbel, pinvgauss, qinvgauss, pinvgamma, 
</pre>