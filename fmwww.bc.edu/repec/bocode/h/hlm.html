<pre>
-------------------------------------------------------------------------------
help for <b>hlm, mkmdm, mdmset, hlm2, hlm3, run</b>                    sean f. reardon
-------------------------------------------------------------------------------
<p>
<b><u>Writing and Running HLM v.6 files from within Stata</u></b>
<p>
    <b>hlm mkmdm</b> using &lt;a new file&gt; [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] <b>,</b> <b>id2(</b><i>varname</i><b>)</b>
               [<b><u>t</u></b><b>ype(</b><i>string</i><b>)</b> <b>id3(</b><i>varname</i><b>)</b> <b>l1(</b><i>varlist</i><b>)</b> <b>l2(</b><i>varlist</i><b>)</b> <b>l3(</b><i>varlist</i><b>)</b>
               <b><u>m</u></b><b>iss(now </b><i>or</i><b> analysis)</b> <b>nodta</b> <b>nomdmt</b> <b>nosts</b> <b>replace</b> <b>norun</b>]
<p>
    <b>hlm mdmset</b> <i>existing .mdm filename</i>
<p>
    <b>hlm mdmset</b> <b>_drop</b>
<p>
    <b>hlm hlm2</b> <i>depvar model</i><b>,</b> <b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> [<b><u>mdm</u></b><b>file(</b><i>existing .mdm filename</i><b>)</b>
               <b><u>out</u></b><b>file(</b><i>newfile</i><b>)</b> <b>run</b> <b>replace</b> <b><u>lin</u></b><b>ear</b> <b><u>ber</u></b><b>nouli</b> <b><u>poi</u></b><b>sson</b> <b><u>bin</u></b><b>omial</b>
               <b><u>mul</u></b><b>tinomial</b> <b><u>ord</u></b><b>inal</b> <b><u>nc</u></b><b>at(</b><i>integer</i><b>)</b> <b><u>ev</u></b><b>ar(</b><i>varname</i><b>)</b> <b>fml</b> <b><u>pr</u></b><b>ompt</b>
               <b><u>st</u></b><b>op</b> <b>od</b> <b><u>lap</u></b><b>lace</b> <b>l6</b> <b><u>ln</u></b><b>um(</b><i>integer</i><b>)</b> <b><u>maci</u></b><b>t(</b><i>integer</i><b>)</b> <b><u>mici</u></b><b>t(</b><i>integer</i><b>)</b>
               <b><u>macs</u></b><b>top(</b><i>#</i><b>)</b> <b><u>mics</u></b><b>top(</b><i>#</i><b>)</b> <b>wgt1(</b><i>varname</i><b>)</b> <b>wgt2(</b><i>varname</i><b>)</b>
               <b>pwgt(</b><i>varname</i><b>)</b> <b>fsig(</b><i>real</i><b>)</b> <b><u>te</u></b><b>st(</b><i>test_specification</i><b>)</b>
               <b><u>dev</u></b><b>iance(</b><i>real integer</i><b>)</b> <b><u>st</u></b><b>ore(lin|us|pa|eml|l6)</b> <b>robust</b> <b>noeq</b>
               <b><u>lo</u></b><b>ng</b> <b>res1</b> <b>rv1(</b><i>varlist</i><b>)</b> <b>res2</b> <b>rv2(</b><i>varlist</i><b>)</b> <b><u>ti</u></b><b>tle(</b><i>string</i><b>)</b>
               <b><u>gr</u></b><b>aph(</b><i>newfile</i><b>)</b>]
<p>
    <b>hlm hlm3</b> <i>depvar model</i><b>,</b> <b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> [<b><u>mdm</u></b><b>file(</b><i>existing .mdm filename</i><b>)</b>
               <b><u>out</u></b><b>file(</b><i>newfile</i><b>)</b> <b>run</b> <b>replace</b> <b><u>lin</u></b><b>ear</b> <b><u>ber</u></b><b>nouli</b> <b><u>poi</u></b><b>sson</b> <b><u>bin</u></b><b>omial</b>
               <b><u>mul</u></b><b>tinomial</b> <b><u>ord</u></b><b>inal</b> <b><u>nc</u></b><b>at(</b><i>integer</i><b>)</b> <b><u>ev</u></b><b>ar(</b><i>varname</i><b>)</b> <b>fml</b> <b><u>pr</u></b><b>ompt</b>
               <b><u>st</u></b><b>op</b> <b>od</b> <b><u>lap</u></b><b>lace</b> <b><u>ln</u></b><b>um(</b><i>integer</i><b>)</b> <b><u>maci</u></b><b>t(</b><i>integer</i><b>)</b> <b><u>mici</u></b><b>t(</b><i>integer</i><b>)</b>
               <b><u>macs</u></b><b>top(</b><i>#</i><b>)</b> <b><u>mics</u></b><b>top(</b><i>#</i><b>)</b> <b>wgt1(</b><i>varname</i><b>)</b> <b>wgt2(</b><i>varname</i><b>)</b>
               <b>wgt3(</b><i>varname</i><b>)</b> <b>pwgt(</b><i>varname</i><b>)</b> <b>fsig(</b><i>real</i><b>)</b>
               <b><u>te</u></b><b>st(</b><i>test_specification</i><b>)</b> <b><u>dev</u></b><b>iance(</b><i>real integer</i><b>)</b>
               <b><u>st</u></b><b>ore(lin|us|pa|eml)</b> <b>robust</b> <b>noeq</b> <b><u>lo</u></b><b>ng</b> <b>res1</b> <b>rv1(</b><i>varlist</i><b>)</b> <b>res2</b>
               <b>rv2(</b><i>varlist</i><b>)</b> <b>res3</b> <b>rv3(</b><i>varlist</i><b>)</b> <b><u>ti</u></b><b>tle(</b><i>string</i><b>)</b> <b><u>gr</u></b><b>aph(</b><i>newfile</i><b>)</b>]
<p>
    <b>hlm run</b> <i>existing .hlm filename</i> [, <b>hlm2</b> <b>hlm3</b> <b>mdm(</b><i>mdmfile</i><b>)</b>
               <b><u>st</u></b><b>ore(lin|us|pa|eml|l6)</b> <b>robust</b> <b>noview</b>]
<p>
<p>
In the <b>hlm2</b> command, <i>model</i> is an expression of the form 
<p>
  [int[(<i>L2equation</i>)]] <i>L1var</i>[(<i>L2equation</i>)] [<i>L1var</i>[(<i>L2equation</i>)] ...]] [rand]
<p>
where <i>L2equation</i> is an expression of the form
<p>
  [int] [<i>L2 varlist</i>] [rand]
<p>
If <i>L2equation</i> is not specified, it is assumed to be <b>(int)</b>.  Any level-1
variable may be group-mean centered by preceding the variable name with an <i>#</i>.
Any level-1 or level-2 variable may be grand-mean centered by preceding the
variable name with an <i>%</i>.
<p>
In the <b>hlm3</b> command, <i>model</i> is an expression of the form 
<p>
  [int[(<i>L2equation</i>)]] [<i>L1var</i>[(<i>L2equation</i>)] [<i>L1var</i>[(<i>L2equation</i>)] ...]] [rand]
<p>
where <i>L2equation</i> is an expression of the form
<p>
  [int[(<i>L3equation</i>)]] [<i>L2var</i>[(<i>L3equation</i>)] [<i>L2var</i>[(<i>L3equation</i>)] ...]] [rand]
<p>
If <i>L2equation</i> is not specified, it is assumed to be <b>(int(int))</b>
<p>
where <i>L3equation</i> is an expression of the form
<p>
  [int] [<i>L3 varlist</i>] [rand]
<p>
If <i>L3equation</i> is not specified, it is assumed to be <b>(int)</b>.  Any level-1 or
level-2 variable may be group-mean centered by preceding the variable name
with an <i>#</i>.  Any level-1, level-2, or level-3 variable may be grand-mean
centered by preceding the variable name with an <i>%</i>.
<p>
See the <b>Examples</b> section below for examples of the <i>model</i> expression.
<p>
<b>Note</b>: HLM requires that the level-1 variables in the model be listed in the
order that they appear in the .mdm file.  If <b>int</b> is included in the model, it
must be listed first; likewise, if <b>rand</b> is included in the model, it must be
listed last (<b>rand</b> can be excluded from the level-1 model, since HLM
automatically assumes it is there).  Likewise, within each level-2 and
level-3 equation, the variables must be listed in the order they appear in
the .mdm file.
<p>
<b><u>Description</u></b>
<p>
These commands allow the user to invoke and run HLM v6 from within Stata 8.2
or higher.  In order for this program to run properly, the HLM directory must
be included in the PATH.  To see how to include HLM in the PATH variable, see
this page on how to add HLM to the PATH variable.
<p>
<b>hlm mkmdm</b> creates an MDM file for HLM. HLM uses an MDM file to perform
analysis of univariate hierarchical models and to perform analysis of
multivariate hierarchical models. By default, an MDM file for a 2-level
univariate model is created. You can specify the type of MDM file by using
the <b>type</b> option. After an MDM file is created, use <b>hlm mdmset</b> to set the .mdm
file in memory for use in writing and running HLM command files.  Use <b>hlm</b>
<b>mdmset _drop</b> to drop the current .mdm file from memory.  The commands <b>hlm</b>
<b>hlm2</b> and <b>hlm hlm3</b> are used to write and run HLM command (.hlm) files.
Finally, the command <b>hlm run</b> will run an existing HLM command file.
<p>
<b>hlm hlm2</b>, <b>hlm hlm3</b>, and <b>hlm run</b> are e-class programs.  Saved results can be
obtained after estimation by use of the ereturn commands.
<p>
<b><u>Options</u></b>
<a name="par"></a><p>
<b>        </b>+-----------------------+
<b>    </b>----+<b> options for hlm mkmdm </b>+--------------------------------------------
<p>
<b>id2(</b><i>varname</i><b>)</b> is required.  <i>Varname</i> specifies the level 2 id.
<p>
<b>type(</b><i>string</i><b>)</b> specifies the type of HLM structure. The possible types are HLM2,
    HLM3, HMLM2 and HMLM3.  The default is HLM2.  <b>Note</b>: Currently only the HLM2
    and HLM3 options are enabled.
<p>
<b>id3(</b><i>varname</i><b>)</b> specifies the level 3 id variable if the model is a 3-level model.
<p>
<b>l1(</b><i>varlist</i><b>)</b> specifies the level 1 variables to be included in the MDM file.  If
    omitted, all variables except <i>id2</i> and <i>id3</i> are included at level 1.
<p>
<b>l2(</b><i>varlist</i><b>)</b> specifies the level 2 variables to be included in the MDM file.  If
    omitted, all variables except <i>id2</i> and <i>id3</i> are included at level 2.
<p>
<b>l3(</b><i>varlist</i><b>)</b> specifies the level 3 variables to be included in the MDM file.  If
    omitted, all variables except <i>id2</i> and <i>id3</i> are included at level 3.
<p>
<b>miss(now</b><i> or </i><b>analysis)</b> is optional in HLM2 and HLM3 to indicate how to deal with
    missing data.  <b>miss(now)</b> tells HLM to delete missing data when making the
    MDM file; <b>miss(analysis)</b> tells HLM to delete missing data when running
    analyses.  If <b>miss</b> is not specified, HLM assumes there is no missing data.
<p>
<b>nodta</b> specifies that the stata data file used to create the MDM file should be
    deleted; the default is to save it.
<p>
<b>nomdmt</b> specifies that the mdmt file should be deleted; the default is to save
    it.
<p>
<b>nosts</b> specifies that the summary statistics file should be deleted; the default
    is to save it.
<p>
<b>replace</b> specifies that the MDM file should be overwritten if it already exists.
<p>
<b>norun</b> specifies that the mdmt file should be created, but not run.  This may be
    useful for creating MDM files in batch mode or if the mdmt file needs to be
    manually changed prior to creating the MDM file.  Note that if <b>norun</b> is
    specified, the <b>nomdmt</b>, <b>nosts</b>, and <b>nodta</b> options are ignored (i.e., the
    .mdmt file is saved, the .dta file is saved, since HLM needs it to make the
    .mdm file when the .mdmt file is run later; the <b>nosts</b> option is irrelevant
    in this case.)
<p>
<p>
<a name="par"></a><p>
<b>        </b>+------------------------+
<b>    </b>----+<b> options for hlm mdmset </b>+-------------------------------------------
<p>
<b>hlm mdmset _drop</b> instructs Stata to drop the current mdm file name from memory.
<p>
<p>
<a name="par"></a><p>
<b>        </b>+---------------------------+
<b>    </b>----+<b> options for hlm2 and hlm3 </b>+----------------------------------------
<p>
<b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> is required.  The HLM command file is written to <i>newfile</i>.hlm.
<p>
<b>mdm(</b><i>mdmfile</i><b>)</b> specifies that <i>mdmfile</i> is the MDM file to be used.  If not
    specified, the MDM file specified in the most recent <b>mdmdset</b> command is
    used.
<p>
<b><u>out</u></b><b>file(</b><i>newfile</i><b>)</b> specifies that the HLM output is to be written to <i>newfile</i>.txt.
    If <b><u>out</u></b><b>file(</b><i>newfile</i><b>)</b> is not specified, the HLM output is written to
    <i>filename</i>.txt, where <i>filename</i> is the filename specified in the
    <b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> command.
<p>
<b>run</b> specifies that the HLM command file is to be run immediately; the default
    is not to run the command file.
<p>
<b>replace</b> specifies that the command and output files are to be replaced if they
    already exist.
<p>
<b><u>lin</u></b><b>ear</b> specifies the model is linear.  This is the default.
<p>
<b><u>ber</u></b><b>nouli</b> specifies the model is bernouli (0 or 1).
<p>
<b><u>poi</u></b><b>sson</b> specifies a poisson model (constant or variable exposure).
<p>
<b><u>bin</u></b><b>omial</b> specifies a binomial model.
<p>
<b><u>mul</u></b><b>tinomial</b> specifies a multinomial model.
<p>
<b><u>ord</u></b><b>inal</b> specifies an ordinal model.
<p>
<b><u>nc</u></b><b>at(</b><i>integer</i><b>)</b> specifies the number of categories of the dependent variable in a
    multinomial or ordinal model.  It must be between 3 and 9.
<p>
<b><u>ev</u></b><b>ar(</b><i>varname</i><b>)</b> specifies the exposure variable in a variable-exposure poisson
    model or a binomial (number of trials) model.  If <b>poisson</b> is specified and
    <b>evar:(</b><i>varname</i><b>)</b> is omitted, a constant-exposure poisson model is estimated;
    if <b>evar:(</b><i>varname</i><b>)</b> is specified, a variable-exposure poisson model is
    estimated.
<p>
<b>fml</b> is only available in <b>hlm2</b>.  It specifies that the model is to be estimated
    using full maximum likelihood.  The default in <b>hlm2</b> is to use restricted
    maximum likelihood.
<p>
<b><u>pr</u></b><b>ompt</b> specifies that HLM should prompt the user if the maximum number of
    iterations is reached without convergence.  The default is to continue
    iterating until convergence, regarless of the number of iterations set in
    <b>macit</b>.
<p>
<b><u>st</u></b><b>op</b> specifies that HLM should stop iterating if the maximum number of
    iterations is reached without convergence.  The default is to continue
    iterating until convergence, regarless of the number of iterations set in
    <b>macit</b>.
<p>
<b>od</b> specifies the bernouli or poisson model should be estimated with
    overdispersion of the level-1 variance.  This option is not allowed with
    any other type of model.
<p>
<b><u>lap</u></b><b>lace</b> specifies that a bernouli or constant exposure poisson model should be
    estimated using the EM laplace estimation.  This option cannot be combined
    with the <b>od</b> option.  This option is only available in HLM2.
<p>
<b>l6</b> specifies that a bernouli model should be estimated using a 6-th order
    laplace approximation to maximum likelihood.  This option cannot be
    combined with the <b>od</b> option.
<p>
<b><u>ln</u></b><b>um(</b><i>integer</i><b>)</b> specifies the maximum number of laplace iterations. The default
    is 50.
<p>
<b><u>maci</u></b><b>t(</b><i>integer</i><b>)</b> specifies the maximum number of macro iterations in a non-linear
    model.  In a linear model, this option specifies the maximum number of
    iterations.  The default is 100.  If neither of the <b>prompt</b> or <b>stop</b> options
    are specified, <b>macit:(</b><i>integer</i><b>)</b> is irrelevant, since the default is to
    continue iteration until convergence.
<p>
<b><u>mici</u></b><b>t(</b><i>integer</i><b>)</b> specifies the maximum number of micro iterations in a non-linear
    model.  The default is 14.
<p>
<b><u>macs</u></b><b>top(</b><i>#</i><b>)</b> specifies the stopping criterion for macro iterations.  The default
    is 0.0001.
<p>
<b><u>mics</u></b><b>top(</b><i>#</i><b>)</b> specifies the stopping criterion for micro iterations in a
    non-linear model.  The default is 0.000001.
<p>
<b>wgt1(</b><i>varname</i><b>)</b> specifies the level-1 design weight variable.
<p>
<b>wgt2(</b><i>varname</i><b>)</b> specifies the level-2 design weight variable.
<p>
<b>wgt2(</b><i>varname</i><b>)</b> specifies the level-3 design weight variable.
<p>
<b>pwgt(</b><i>varname</i><b>)</b> specifies the level-1 precision weight variable..
<p>
<b>fsig(</b><i>#</i><b>)</b> specifies that sigma-squared is to be set to <i>#</i>.  Sigma-squared cannot
    be fixed in an over-dispersed bernouli or poisson model.
<p>
<b><u>te</u></b><b>st</b> is used to specify multivariate hypothesis tests.  The syntax for
    <i>test_specification</i> is
<p>
    <b>[</b><i>test</i><b>]</b>[<b>[</b><i>test</i><b>]</b>[<b>[</b><i>test</i><b>]</b>...]]
<p>
    Note: Distinguish between <b>[]</b>, which are to be typed, and [], which
    indicate optional arguments.  In addition, while not shown in the syntax
    diagram, brackets around <i>test</i> are only required with multiple test
    specifications.
<p>
      <i>test</i> is an expression of the form
<p>
        <i>eqn</i>[,<i>eqn</i>[,<i>eqn</i>...]]
<p>
      <i>eqn</i> is an expression of the form
<p>
        <i>exp</i>=<i>exp</i>[=<i>exp</i>...]
<p>
      <i>exp</i> is a linear combination of the variables and/or interactions in the
        model.  It can be any one of
<p>
        0
        [<i>#</i>*][<i>var</i>][+|-[<i>#</i>*]<i>var</i>[+|-[<i>#</i>*]<i>var</i>...]]
<p>
      <i>var</i> is any one of
<p>
        <i>L1var</i>
        <i>L2var</i>
        <i>L3var</i>
        <i>L2var</i>*<i>L1var</i>
        <i>L3var</i>*<i>L1var</i>
        <i>L3var</i>*<i>L2var</i>
        <i>L3var</i>*<i>L2var</i>*<i>L1var</i>
<p>
    For example, to test the null hypothesis that the coefficients on <i>var1</i>
    and <i>var2</i> are both equal to zero, one could write any of the following:
<p>
      test([var1=0, var2=0])
      test([var1=var2=0])
      test([var1-var2=0, var2=0])
<p>
    However, to test the separate null hypotheses that the coefficient on
    <i>var1</i> equals zero and that the coefficient on <i>var2</i> equals zero, one could
    write the following:
<p>
      test([var1=0][var2=0])
<p>
<b><u>dev</u></b><b>iance(</b><i>real integer</i><b>)</b> specifies a deviance test.  The model will be compared
    to a model with deviance <i>real</i> and <i>integer</i> degrees of freedom.  Note that
    the deviance statistic and degrees of freedom from previous models will be
    saved as e-class scalars (see <b>stored results</b> below), and so can be used in
    the <b>deviance</b> option to compare the relative fit of different models.
<p>
<b><u>st</u></b><b>ore(</b><i>name</i><b>)</b> specifies which set of estimates are to be stored in e(b) and e(V).
    See also <b>robust</b> below.  In <b>store</b>, <i>name</i> may be <b>lin</b> (used only with a linear
    model), <b>us</b> (unit-specific estimates, may be used with any non-linear
    model), <b>pa</b> (population-average estimates, may be used with any non-linear
    model), <b>eml</b> (EM laplace estimates, may be used when <b>laplace</b> option is
    specified}, or <b>l6</b> (laplace-6 estimates, may be used when <b>l6</b> option is
    specified}.  If <b>store</b> is omitted, the default depends on the model
    specified.  If <b>laplace</b> is specified, the default is <b>eml</b>; otherwise, if <b>l6</b>
    is specified, the default is <b>l6</b>; otherwise, if the model is any other
    non-linear model, the default is <b>us</b>; finally, if the model is linear, the
    default is <b>lin</b>.
<p>
    Note: The mechanism of storing the estimates is currently a bit clunky --
    HLM saves the estimates in files called "gamvcX.dat" and "tauvcX.dat",
    where X is something like "us" or "eml" and so indicates which estimator
    the estimates come from.  In doing so, HLM writes over any existing files
    with these names, but since not all files are produced by each run of HLM,
    there can be some confusion regarding whether any existing "gamvcX.dat"
    come from the current model.  To deal with this, this program renames any
    existing "gamvcX.dat" and "tauvcX.dat" files to some unused filenams like
    "gamvcX_tempN.dat", etc. before HLM fits the current model.  This program
    then reads the estimates from the newly produced "gamvcX.dat" and
    "tauvcX.dat" files into matrices, stored in e(), and then erases the
    current "gamvcX.dat" and "tauvcX.dat" files.  Finally the
    "gamvcX_tempN.dat" and "tauvcX_tempN.dat" files are renamed to their old
    ("gamvcX_tempN.dat" and "tauvcX_tempN.dat") names.  In principal this works
    fine, but if there is an error in the program and the hlm commands exits
    before completing, it is possible that the "gamvcX_tempN.dat" and
    "tauvcX_tempN.dat" will not be renamed to their original names.  I tell you
    this so you won't wonder if a bunch of "gamvcX_tempN.dat" and
    "tauvcX_tempN.dat" files start populating your hard drive.
<p>
<b>robust</b> specifies that the variance-covariance matrix used to compute the robust
    standard errors should be saved in e(V), when available (robust standard
    errors are not available, for example, with laplace estimation).
<p>
<b>noeq</b> suppresses the writing of the full HLM model equations in stata.  The
    equations are written for users to verify that the model is correctly
    specified; they do not affect the writing of the command file.
<p>
<b><u>lo</u></b><b>ng</b> specifies that HLM should produce a full output file; the default is to
    produce only a reduced output file.
<p>
<b>res1</b> specifies that HLM should produce a level-1 residual file.  The residual
    file is written to a file named <i>filename</i>_res1.dta, where <i>filename</i> is the
    filename specified in the <b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> command.
<p>
<b>res2</b> specifies that HLM should produce a level-2 residual file.  The residual
    file is written to a file named <i>filename</i>_res2.dta, where <i>filename</i> is the
    filename specified in the <b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> command.
<p>
<b>res3</b> specifies that HLM should produce a level-3 residual file.  The residual
    file is written to a file named <i>filename</i>_res3.dta, where <i>filename</i> is the
    filename specified in the <b><u>cmd</u></b><b>file(</b><i>newfile</i><b>)</b> command.
<p>
<b>rv1(</b><i>varlist</i><b>)</b> specifies that the level-1 residual file should include (in
    addition to the variables in the model, which are included by default) the
    variables listed in <i>varlist</i>.
<p>
<b>rv2(</b><i>varlist</i><b>)</b> specifies that the level-2 residual file should include (in
    addition to the variables in the model, which are included by default) the
    variables listed in <i>varlist</i>.
<p>
<b>rv3(</b><i>varlist</i><b>)</b> specifies that the level-3 residual file should include (in
    addition to the variables in the model, which are included by default) the
    variables listed in <i>varlist</i>.
<p>
<b><u>ti</u></b><b>tle(</b><i>string</i><b>)</b> specifies the title to be given to the HLM output file.
<p>
<b><u>gr</u></b><b>aph(</b><i>newfile</i><b>)</b> specifies that HLM should write a graph equations (.geq) file
    named <i>newfile</i>.
<p>
<a name="par"></a><p>
<b>        </b>+---------------------+
<b>    </b>----+<b> options for hlm run </b>+----------------------------------------------
<p>
<b>hlm2</b> is the default.  It specifies that the .hlm command file is an HLM2
    command file.
<p>
<b>hlm3</b> specifies that the .hlm command file is an HLM3 command file.
<p>
<b>mdm(</b><i>mdmfile</i><b>)</b> specifies that <i>mdmfile</i> is the MDM file to be used.  If not
    specified, the MDM file specified in the most recent <b>mdmdset</b> command is
    used.
<p>
<b><u>st</u></b><b>ore(</b><i>name</i><b>)</b> specifies which set of estimates are to be stored in e(b) and e(V).
    See also <b>robust</b> below.  In <b>store</b>, <i>name</i> may be <b>lin</b> (used only with a linear
    model), <b>us</b> (unit-specific estimates, may be used with any non-linear
    model), <b>pa</b> (population-average estimates, may be used with any non-linear
    model), <b>eml</b> (EM laplace estimates, may be used when <b>laplace</b> option is
    specified}, or <b>l6</b> (laplace-6 estimates, may be used when <b>l6</b> option is
    specified}.  If <b>store</b> is omitted, the default depends on the model
    specified.  If <b>laplace</b> is specified, the default is <b>eml</b>; otherwise, if <b>l6</b>
    is specified, the default is <b>l6</b>; otherwise, if the model is any other
    non-linear model, the default is <b>us</b>; finally, if the model is linear, the
    default is <b>lin</b>.
<p>
<b>robust</b> specifies that the variance-covariance matrix used to compute the robust
    standard errors should be saved in e(V), when available (robust standard
    errors are not available, for example, with laplace estimation).
<p>
<b>noview</b> suppresses the viewing of the output file in the viewer window.
<p>
<a name="par"></a><p>
<b><u>Stored Results</u></b>
<p>
Depending on the model specified, HLM will produce several sets of estimated
coefficients and the corresponding variance-covariance matrices.  Each of
these are stored in Stata as e-class results.  In addition, a number of
scalars and macros are srored:
<p>
Scalars:
<p>
     e(sig2)       estimated level-1 residual variance (linear model only)
     e(N_1)        number of level-1 observations
     e(N_2)        number of level-2 observations
     e(N_3)        number of level-3 observations
     e(dev)        deviance statistic from linear model
     e(dev_l6)     deviance statistic from laplace-6 estimates
     e(dev_eml)    deviance statistic from EM laplace estimates
     e(df)         model df (number of parameters estimated)
<p>
Macros:
<p>
     e(esttype)    type of estimates stored in e(b) and e(V)
     e(setype}     type of standard errors stored in e(V)
     e(cmdfile)    name of .hlm command file used
     e(depvar)     dependent variable
     e(model)      model type (distribution of outcome)
     e(cmd)        hlm2 or hlm3
<p>
Matrices:
<p>
     e(b)          1 x K vector of estimated coefficients
     e(V)          K x K variance-covariance matrix
     e(b_lin)      1 x K vector of estimated coefficients from linear model
     e(b_us)       1 x K vector of estimated unit-specific coefficients 
     e(b_pa)       1 x K vector of estimated population-average coefficients
     e(b_eml)      1 x K vector of estimated EM laplace coefficients
     e(b_l6)       1 x K vector of estimated laplace-6 coefficients
     e(V_lin)      K x K variance-covariance matrix, linear model
     e(V_us)       K x K variance-covariance matrix, unit-specific estimates
     e(V_pa)       K x K variance-covariance matrix, population-average estimat
&gt; es
     e(V_eml)      K x K variance-covariance matrix, EM laplace estimates
     e(V_l6)       K x K variance-covariance matrix, laplace-6 estimates
     e(V_r)        K x K robust variance-covariance matrix, linear model
     e(V_usr)      K x K robust variance-covariance matrix, unit-spec. estimate
&gt; s
     e(V_par)      K x K robust variance-covariance matrix, pop-average estimat
&gt; es
     e(se_lin)     1 x K standard error vector, linear model
     e(se_us)      1 x K standard error vector, unit-specific estimates
     e(se_pa)      1 x K standard error vector, population-average estimates
     e(se_eml)     1 x K standard error vector, EM laplace estimates
     e(se_l6)      1 x K standard error vector, laplace-6 estimates
     e(se_r)       1 x K robust standard error vector, linear model
     e(se_usr)     1 x K robust standard error vector, unit-spec. estimates
     e(se_par)     1 x K robust standard error vector, pop-average estimates
     e(tau2)       R x R level-2 tau matrix
     e(tau2_eml)   R x R level-2 tau matrix, EM laplace estimates
     e(tau2_l6)    R x R level-2 tau matrix, laplace-6 estimates
     e(tau3)       R2 x R2 level-3 tau matrix
     e(invtaui)    inverse tau information matrix
     e(invtaui_l6) inverse tau information matrix, laplace-6
     e(se_tau)     vector of standard errors of tau
     e(se_tau_l6)  vector of standard errors of tau, laplace-6
<p>
The type of estimates stored in e(b) and e(V) are determined by the <b>store</b> and
<b>robust</b> options.  In general, all available estimated coefficients,
variance-covariance matrices, and standard errors are stored, but those
stored in e(b) and e(V) will be available for postestimation commands such as
estout, which can then be used to display results of multiple models.
<p>
<p>
<b><u>Examples</u></b>
<p>
Suppose we have a data file with outcome variable <i>score</i>, level-one variables
<i>age</i>, <i>sex</i>, <i>race1</i>, <i>race2</i>, <i>race3</i>, and level-two variable <i>private</i>.  We first sort
the data by the level-two id variable (<i>schoolid</i> here), and then make an mdm
file:
<p>
    sort schoolid
    hlm mkmdm using new_mdm_file, id2(schoolid) l1(score age sex race1 race2
        race3) l2(private) miss(now)
<p>
Next we tell Stata to use this mdm file in subsequent hlm models:
<p>
    hlm mdmset new_mdm_file.mdm
<p>
Now, to estimate the following model:
<p>
    score(ij) = B(0j) + B(1j)*age(ij) + B(2j)*sex(ij) + R(ij)
        B(0j) = G(00) + G(01)*private(j) + U(0j)
        B(1j) = G(10)
        B(2j) = G(20)
<p>
we write the command:
<p>
    hlm hlm2 score int(int private rand) age(int) sex(int) rand, cmd(model01)
        run replace
<p>
alternately, we could write the same command as:
<p>
    hlm hlm2 score int(int private rand) age sex rand, cmd(model01) run
        replace
<p>
Now, to estimate the following model:
<p>
    score(ij) = B(0j) + B(1j)*race1(ij) + B(2j)*race2(ij) + B(3j)*race3(ij) +
R(ij)
        B(0j) = G(00) + G(01)*private(j) + U(0j)
        B(1j) = G(10) + G(11)*private(j)
        B(2j) = G(20) + G(21)*private(j)
        B(3j) = G(30) + G(31)*private(j)
<p>
we write the command:
<p>
    hlm hlm2 score int(int private rand) race1-race3(int private) rand,
        cmd(model02) run replace
<p>
Finally, to test the null hypothesis that the cofficients G(11), G(21), and
G(31) are all equal to 0, we would write:
<p>
    hlm hlm2 score int(int private rand) race1-race3(int private) rand,
        cmd(model02) run replace
        test(private*race1=private*race2=private*race3=0)
<p>
<p>
<b><u>Author</u></b>
<p>
     sean f. reardon
     Stanford University
     sean.reardon@stanford.edu
</pre>