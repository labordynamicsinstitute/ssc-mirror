<pre>
-------------------------------------------------------------------------------
help for <b>jmpierce</b>
-------------------------------------------------------------------------------
<p>
<b><u>Juhn-Murphy-Pierce decomposition</u></b>
<p>
        <b>jmpierce</b> <i>est1</i> <i>est2</i> [ <b>,</b> <b><u>r</u></b><b>eference(0</b>|<b>1</b>|<b>2</b>|<i>estref</i><b>)</b> <b><u>s</u></b><b>tatitics(</b><i>statlist</i><b>)</b>
               <b><u>b</u></b><b>locks(</b><i>blist</i><b>)</b> <b><u>sav</u></b><b>e(</b><i>newvar1</i> <i>newvar2</i>|<i>prefix</i><b>)</b> <b><u>res</u></b><b>iduals(</b><i>newvar</i><b>)</b> ]
<p>
    where <i>blist</i> is
<p>
               <i>name1</i> <b>=</b> <i>varlist1</i> [<b>,</b> <i>name2</i> <b>=</b> <i>varlist2</i> [<b>,</b> <i>...</i>] ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>jmpierce</b> computes the decomposition of differences between two outcome
    distributions introduced by Juhn, Murphy and Pierce (1993; also see Blau
    and Kahn 1996) from models previously fitted and stored by estimates
    store. Examples are the decomposition of changes in the income
    distribution over time, the decomposition of male-female wage
    differentials, or the decomposition of wage inequality differences
    between countries.
<p>
    <i>est1</i> is the name of the estimates related to the first distribution (e.g.
    the distribution in country A, among males, or at time point t), <i>est2</i> is
    the name of the estimates related to the second distribution (e.g. the
    distribution in country B, among females, or at time point t-1). Note
    that the samples underlying <i>est1</i> and <i>est2</i> must be disjunctive.
<p>
    The model estimated last may be indicated by a period (.), even if it has
    not yet been stored.
<p>
    See the oaxaca package and the decompose package (available from the SSC
    archive; type ssc describe oaxaca and ssc describe decompose) for
    programs to compute Oaxaca-Blinder type decompositions. See the jmpierce2
    package for the decomposition of changes of differentials over time (ssc
    describe jmpierce2).
<p>
    <b>Warning:</b> <b>jmpierce</b> is intended for use with models that have been
    estimated by the regress command. Use <b>jmpierce</b> with other models at your
    own risk.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>reference()</b> specifies the reference or benchmark model. The default is
        <b>reference(0)</b>, meaning that the average coefficients from <i>est1</i> and
        <i>est2</i> are used as the reference prices and the average residual
        distribution from <i>est1</i> and <i>est2</i> is used as the reference residual
        distribution. However, <b>reference(1)</b> uses <i>est1</i> and <b>reference(2)</b> uses
        <i>est2</i> as the benchmark, i.e. the coefficients from either <i>est1</i> or <i>est2</i>
        are used as the reference prices and the residuals from <i>est1</i> or <i>est2</i>
        are used to determine the reference residual distribution.
        Alternatively, specify <b>reference(</b><i>estref</i><b>)</b>, where <i>estref</i> is the name of
        the reference model. In this case, the coefficients from <i>estref</i> are
        used as the reference prices and the average residual distribution
        from <i>est1</i> and <i>est2</i> is used as the reference residual distribution.
        See the "Methods and Formulas" section for more details.
<p>
    <b>statistics(</b><i>statlist</i><b>)</b> specifies the summary statistics for which the
        decomposition be displayed. The default is <b>statistics(mean)</b>. Specify,
        for example, <b>statistics(p25 p50 p75)</b> to compute the decomposition for
        the 25th, 50th, and 75th percentile. Available statistics are
<p>
            <i>statname</i>    definition
            --------------------------------------------------
            <b><u>me</u></b><b>an</b>        mean
            <b>sd</b>          standard deviation
            <b><u>med</u></b><b>ian</b>      median (same as <b>p50</b>)
            <b>p5</b>          5th percentile
            <b>p10</b>         10th percentile
            <b>p25</b>         25th percentile
            <b>p50</b>         50th percentile (same as <b>median</b>)
            <b>p75</b>         75th percentile
            <b>p90</b>         90th percentile
            <b>p95</b>         95th percentile
            <b>iqr</b>         interquartile range (same as <b>d7525</b>)
            <b>d9010</b>       p90 - p10
            <b>d7525</b>       p75 - p25 (same as <b>iqr</b>)
            <b>d9050</b>       p90 - p50
            <b>d5010</b>       p50 - p10
            --------------------------------------------------
<p>
    <b>blocks(</b><i>blist</i><b>)</b> reports the quantity effect (Q) of specified blocks of
        variables. Unless the decomposition is conducted at the mean, the
        results will most likely depend on the order of the blocks.
<p>
    <b>save(</b><i>newvar1</i> <i>newvar2</i>|<i>prefix</i><b>)</b> creates a variable reflecting the
        hypothetical outcome distribution under the condition of fixed prices
        and fixed unobservables (called <i>newvar1</i> or <i>prefix</i><b>1</b>, respectively) and
        a variable reflecting the hypothetical outcome distribution under the
        condition of fixed unobservables (called <i>newvar2</i> or <i>prefix</i><b>2</b>,
        respectively).
<p>
    <b>residuals(</b><i>newvar</i><b>)</b> creates a variable containing the hypothetical
        residuals called <i>newvar</i>.
<p>
<p>
<b><u>Examples</u></b>
<p>
    Decomposition of the gender wage gap using the residuals/prices of the
    male model as benchmark:
<p>
        . regress lnwage educ exp exp2 if sex==1
        . estimates store male
        . regress lnwage educ exp exp2 if sex==2
        . estimates store female
        . jmpierce male female, reference(1) statistics(mean median)
        
<p>
    ... subdividing the quantity effect Q between education and experience:
<p>
        . jmpierce male female, reference(1) blocks(educ=educ, exp=exp*)
        
<p>
    ... using a the average residual distribution and the prices of a pooled
    model as benchmark:
<p>
        . regress lnwage educ exp exp2 if sex==1 | sex==2
        . jmpierce male female, ref(.)
        
<p>
<p>
<b><u>Saved Results</u></b>
<p>
    Matrices:
<p>
    <b>r(D)</b>                 The components of the decomposition(s)
    <b>r(stats1)</b>, <b>r(stats2)</b> The summary statistics for the hypothetical and raw
                         distributions
    <b>r(Qblocks)</b>           Quantity effect by (blocks of) variables
<p>
<p>
<b><u>Methods and Formulas</u></b>
<p>
    Closely following Juhn, Murphy and Pierce (1993):  Given are the models
<p>
        <b>y</b>_1 = <b>x</b>_1<b>b</b>_1 + <b>u</b>_1
        <b>y</b>_2 = <b>x</b>_2<b>b</b>_2 + <b>u</b>_2
<p>
    where <b>y</b>_1 and <b>y</b>_2 are the vectors of the values of the dependent variable
    in two samples, <b>x</b>_1 and <b>x</b>_2 are the data matrices (observable
    quantities), <b>b</b>_1 and <b>b</b>_2 are the vectors of estimated coefficients
    (observable prices) and <b>u</b>_1 and <b>u</b>_2 are the residuals (unmeasured prices
    and quantities).
<p>
    Let F_1(.) and F_2(.) denote the cumulative distribution functions of the
    residuals. For example,
<p>
        p_i1 = F_1(u_i1|<b>x</b>_i1)
<p>
    is the percentile of an individual residual in the residual distribution
    of model 1. By definition we can write
<p>
        u_i1 = F_1[-1](p_i1|<b>x</b>_i1)
<p>
    where F_1[-1](.) is the inverse of the cumulative distribution function.
<p>
    Next, assume that F(.) is a reference residual distribution (e.g. the
    average residual distribution over both samples) and that <b>b</b> is an
    estimate of benchmark coefficients (e.g. the coefficients from a pooled
    model over the whole sample). We can then determine hypothetical outcomes
    with varying quantities between the groups but fixed prices
    (coefficients) and a fixed residual distribution as
<p>
        <b>y1</b>_i1 = <b>x</b>_i1<b>b</b> + F[-1](<b>p</b>_i1|<b>x</b>_i1)
        <b>y1</b>_i2 = <b>x</b>_i2<b>b</b> + F[-1](<b>p</b>_i2|<b>x</b>_i2)
<p>
    Furthermore, the hypothetical outcomes with varying quantities and
    varying prices but a fixed residual distribution are given as
<p>
        <b>y2</b>_i1 = <b>x</b>_i1<b>b</b>_1 + F[-1](<b>p</b>_i1|<b>x</b>_i1)
        <b>y2</b>_i2 = <b>x</b>_i2<b>b</b>_2 + F[-1](<b>p</b>_i2|<b>x</b>_i2)
<p>
    Finally, the outcomes with varying quantities, varying prices and a
    varying residual distribution can be determined as
<p>
        <b>y3</b>_i1 = <b>x</b>_i1<b>b</b>_1 + F_1[-1](<b>p</b>_i1|<b>x</b>_i1)
        <b>y3</b>_i2 = <b>x</b>_i2<b>b</b>_2 + F_2[-1](<b>p</b>_i2|<b>x</b>_i2)
<p>
    These last outcomes are obviously nothing else than the originally
    observed values, that is:
<p>
        <b>y3</b>_i1 = <b>y</b>_i1 = <b>x</b>_i1<b>b</b>_1 + <b>u</b>_i1
        <b>y3</b>_i2 = <b>y</b>_i1 = <b>x</b>_i2<b>b</b>_1 + <b>u</b>_i2
<p>
    Let a capital letter stand for a summary statistic of the distribution of
    the variable denoted by the corresponding lower-case letter. For
    instance, Y may be the mean or the interquartile range of the
    distribution of y. The differential Y_1-Y_2 can then be decomposed as
<p>
        Y_1-Y_2 = [Y1_1-Y1_2] + [(Y2_1-Y2_2) - (Y1_1-Y1_2)] +
            [(Y3_1-Y3_2) - (Y2_1-Y2_2)] = T = Q + P + U
<p>
    That is, the total difference (T) can be attributed to differences in
    observable quantities (Q), differences in observable prices (P), and
    differences in unobservable quantities and prices (U).
<p>
<p>
    Technical notes:
<p>
        - <b>jmpierce</b>'s method to invert the empirical distribution function
          uses averages where the function is flat (the same method is used
          by summarize and pctile). Also see the invcdf package (available
          from the SSC archive; type <b>ssc d invcdf</b>). The choice of the
          inversion method may have a significant impact on the decomposition
          results (especially in small samples).
<p>
        - <b>reference(0)</b> (the default) causes <b>jmpierce</b> to use the average
          coefficients from <i>est1</i> and <i>est2</i> as the reference coefficients. The
          "average" coefficients are derived by computing a simple arithmetic
          mean, that is <b>b</b> = (<b>b</b>_1+<b>b</b>_2)/2.
<p>
        - <b>reference(0)</b> or <b>reference(</b><i>estref</i><b>)</b>, where <i>estref</i> is not <i>est1</i> nor
          <i>est2</i>, causes <b>jmpierce</b> to use the average residual distribution from
          <i>est1</i> and <i>est2</i> as the reference residual distribution. The "average"
          residual distribution is computed by pooling the residuals from
          <i>est1</i> and <i>est2</i>.
<p>
<p>
<b><u>References</u></b>
<p>
    Juhn, Chinhui, Kevin M. Murphy, Brooks Pierce (1993). Wage Inequality and
        the Rise in Returns to Skill. Journal of Political Economy 101(3):
        410-442.
<p>
    Blau, Francine D., Lawrence M. Kahn (1996). International Differences in
        Male Wage Inequality: Institutions versus Market Forces.  Journal of
        Political Economy 104(4): 791-837.
<p>
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jann@soz.gess.ethz.ch
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online:  help for regress, estimates, cumul, pctile, oaxaca (if
             installed), decompose (if installed), jmpierce2 (if installed), 
</pre>