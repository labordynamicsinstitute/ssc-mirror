<pre>
-------------------------------------------------------------------------------
help for <b>johans</b>, <b>lrjtest</b>, <b>wjtest</b>                                       [P.Joly]
-------------------------------------------------------------------------------
<p>
<b><u>Johansen's maximum likelihood cointegration rank test</u></b>
<p>
        <b>johans</b> <i>depvarlist</i> [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>l</u></b><b>ags(</b><i>#</i><b>)</b> <b><u>noc</u></b><b>onstant</b> <b><u>t</u></b><b>rend</b>
                           <b><u>ex</u></b><b>og</b>(<i>varlist</i>) <b><u>non</u></b><b>ormal</b> <b><u>stand</u></b><b>ard</b> <b><u>r</u></b><b>egress</b> <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b> ]
<p>
        <b>lrjtest</b> <i>varlist</i>   [<b>,</b> <b><u>c</u></b><b>ir(</b><i>#</i><b>)</b> <b><u>r</u></b><b>estrict</b> ]
<p>
        <b>wjtest</b> <i>varlist</i>    [<b>,</b> <b><u>c</u></b><b>ir(</b><i>#</i><b>)</b> ]
<p>
<p>
<b>johans</b> is for use with time-series data.  You must <b>tsset</b> your data before using
<b>johans</b>; see help tsset.  Your version of Stata must also be up-to-date.  Type
<b>update query</b> to find out whether updating is required; see help update.
<p>
<b>johans</b> may be used with panel data if the estimation sample is restricted to a
single panel.  Observations for which the panel variable is missing are omitted
from the sample.
<p>
<b>by</b> <i>...</i> <b>:</b> may be used with <b>johans</b>; see help by.
<p>
<i>depvarlist</i> and <i>varlist</i> may contain time-series operators; see help varlist.
<p>
<p>
<b><u>Description</u></b>
<p>
<b>johans</b> calculates the eigenvalues and the maximal eigenvalue and trace
statistics for the VAR defined by <i>depvarlist</i>.  These statistics can be used to
test for the number of cointegrating vectors in the system.  If option <i>normal</i>
or <i>standard</i> is specified, maximum likelihood estimates of the cointegrating
vectors and of the matrix of weights are displayed.  <b>johans</b> uses Johansen's
method for computing the estimates and test statistics.  See the references for
more information on the method.
<p>
<b>lrjtest</b> and <b>wjtest</b> are used after <b>johans</b> to test the null hypothesis that one
or more of the variables in the VAR do not enter the cointegrating
relationship(s).  <b>lrjtest</b> calculates the likelihood-ratio test.  <b>wjtest</b>
calculates the Wald test.
<p>
<p>
<b><u>Options</u></b>
<p>
<b>lags(</b><i>#</i><b>)</b> specifies the number of lags in the original VAR (in levels).  The
    default is 1.
<p>
<b>noconstant</b> suppresses the constant in the first stage VAR.
<p>
<b>trend</b> includes a trend term in each equation of the VAR.
<p>
<b>exog(</b><i>varlist</i><b>)</b> specifies exogenous variables that enter each equation of the
    VAR.
<p>
<b>nonormal</b> suppresses the display of the normalized Alpha and Beta' matrices.
<p>
<b>standard</b> requests the display of the standardized Alpha and Beta' matrices
    instead of the normalized matrices.
<p>
<b>regress</b> indicates that the VAR estimates are to be displayed.
<p>
<b>cir(</b><i>#</i><b>)</b> is for use with <b>lrjtest</b> and <b>wjtest</b> and indicates the number of
    cointegrating relationships in the system.  The default is 1.
<p>
<b>restrict</b> is relevant only with <b>lrjtest</b> and requests the display of the
    restricted estimates of the eigenvalues and of the Alpha and Beta'
    matrices.
<p>
<b>level(</b><i>#</i><b>)</b> specifies the confidence level, in percent, for confidence intervals
    of the test statistics.  <i>#</i> must be one of 50, 80, 90, 95, 97.5, or 99; 95
    is the default.
<p>
<p>
<b><u>Methods &amp; Formulas</u></b>
<p>
Consider a vector autoregression of order <i>k</i>, VAR(<i>k</i>),
<p>
            <i>k</i>
    <b>x</b>_<i>t</i> =  SUM <b>B</b>_<i>i</i> * <b>x</b>_<i>t-i</i>  + <b>f</b> * <b>D</b>_<i>t</i>  + <i>m</i><i>_0</i>  + <i>m</i><i>_1</i> * <i>t</i>  + <i>e</i><i>_t</i>
           <i>i</i>=1
<p>
    (<i>t</i> = 1,...,<i>T</i> )
<p>
where
    <b>x</b>_<i>t</i>       (<i>p</i> x1) vector of <i>p</i> stochastic variables;
    <b>B</b>_<i>i</i>       (<i>p</i> x<i>p</i> ) matrix of coefficients;
    <b>D</b>_<i>t</i>       (optional) matrix of zero-mean seasonal dummies with
                  corresponding coefficient vector <b>f</b>; and
    <b>m</b>_<i>0</i>, <b>m</b>_<i>1</i>  (optional) (<i>p</i> x1) vectors of coefficients on intercept and trend
                  terms, respectively.
<p>
Any such VAR(<i>k</i>) may be re-parameterized as
<p>
             <i>k</i>-1
    d.<b>x</b>_<i>t</i> =  SUM <b>G</b>_<i>i</i> * d.<b>x</b>_<i>t-i</i>  + <b>P</b> * <b>x</b>_<i>t-1</i>  + <b>f</b> * <b>D</b>_<i>t</i>  + <b>m</b>_<i>0</i>  + <b>m</b>_<i>1</i> * <i>t</i>  + <b>e</b>_<i>t</i>
             <i>i</i>=1
<p>
        <b>P</b> = <b>ab'</b>
<p>
where "d." represents the first-difference operator and <b>G</b>_<i>i</i>, <b>P</b>, are (<i>p</i> x<i>p</i> )
matrices of coefficients.  As shown above, matrix <b>P</b> can be further decomposed
into the product <b>ab'</b> where <b>b'</b> represents the matrix of (<i>r</i>) cointegrating
vectors and <b>a</b>, the matrix of weights on the vectors in each equation of the
system.  Both <b>a</b> and <b>b</b> are of dimension (<i>p</i> x<i>r</i> ).  (The notation <b>P</b> = <b>ab'</b> is a
departure from the convention of using uppercase (lowercase) letters for
matrices (scalars) but has become embedded in the cointegration literature so
we stick to it.)
<p>
The Johansen cointegration rank test is a test of the rank of the <b>ab'</b> matrix.
If, after inference, the rank is deemed to be (<i>r</i>), then there are (<i>r</i>)
cointegrating relationships or vectors in the system.  The rank of any matrix
can be determined by the number of non-zero eigenvalues for that matrix.
<p>
Two features of the Johansen procedure are worth noting.  First, the test is
really a sequence of tests.  The null hypothesis of rank (r)=0 (i.e. no
cointegrating relationship) is first tested and, if rejected, subsequent null
hypotheses (Ho: r=1, Ho: r=2, etc.) are tested until a null can no longer be
rejected.  This is eminently sensible since we must first enquire whether any
cointegrating relation exists at all, and only in the affirmative are we
interested in finding out exactly how many can be identified.
<p>
The second distinguishing feature of the procedure is that it provides two ways
(two test statistics, that is) of testing the same null hypothesis.  The
difference lies in the alternative hypotheses implied by each.  The
<i>maximum-eigenvalue</i> statistic tests the null hypothesis that there are <b>at most</b>
(r) cointegrating vectors against the alternative of (r+1) vectors.  The <i>trace</i>
statistic tests the same null hypothesis against the alternative that there are
at most <i>p</i> cointegrating relations (where is <i>p</i> is always equal to the number of
variables in the <b>x</b>_<i>t</i> vector).  It is important to note that the two statistics
may lead to conflicting results.
<p>
However, before making inference using the max-lambda and trace statistics,
certain assumptions regarding the deterministic components (intercept, trend
terms) must be made.  These assumptions will determine which table of critical
values should be used.  Following Osterwald-Lenum's notation (see <b>references</b>),
let <b>y</b>_<i>t</i> represent a subset or portion of the re-parameterized VAR (the 2nd
equation above), specifically, let
<p>
    <b>y</b>_<i>t</i> =  <b>ab'</b> * <b>x</b>_<i>t-1</i>   + <b>m</b>_<i>0</i>   + <b>m</b>_<i>1</i> * <i>t</i>
<p>
The precise form of this <b>y</b>_<i>t</i> term depends on the assumptions regarding the
presence of intercept or trend terms and whether such terms appear <i>within</i> or
<i>outside</i> the cointegrating equation(s) (CE).  By <i>outside</i> it is meant that a
deterministic term lies in the <i>remainder</i> of the VAR, that is, that portion of
the VAR other than the CE.  The possible assumptions or cases are:
<p>
    <u>Table/Case 0:</u>  <i> no intercept, no trend</i>
        <b>y</b>_<i>t</i> = <b>ab'</b> * <b>x</b>_<i>t-1</i>
<p>
    <u>Table/Case 1*:</u> <i> intercept in CE only</i>
        <b>y</b>_<i>t</i> = <b>a</b>(<b>b'</b>, <b>b</b>_0) * (<b>x'</b>_<i>t-1</i>, 1)'
<p>
    <u>Table/Case 1:</u>  <i> intercept in VAR</i>
        <b>y</b>_<i>t</i> = <b>ab'</b> * <b>x</b>_<i>t-1</i>  + <b>m</b>_<i>0</i>
<p>
    <u>Table/Case 2*:</u> <i> intercept in VAR, trend in CE only</i>
        <b>y</b>_<i>t</i> = <b>a</b>(<b>b'</b>, <b>b</b>_1) * (<b>x'</b>_<i>t-1</i>, <i>t</i>)'  + <b>m</b>_<i>0</i>
<p>
    <u>Table/Case 2:</u>  <i> intercept in VAR, trend in VAR</i>
        <b>y</b>_<i>t</i> = <b>ab'</b> * <b>x</b>_<i>t-1</i>  + <b>m</b>_<i>0</i>  + <b>m</b>_<i>1</i> * <i>t</i>
<p>
where <b>b</b>_0 and <b>b</b>_1 are of dimension (<i>r</i> x 1).  The case number refers to the
table identifier in Osterwald-Lenum.  The corresponding critical values are
reported by <b>johans</b>.  This may seem confusing but it shouldn't be.  Recall that
a constant (trend) in an equation in difference-form implies a trend (quadratic
trend) in levels.  Therefore, cases 0 and 1* are appropriate when the series in
<b>x</b>_<i>t</i> do not exhibit some apparent trend (when plotted in levels); otherwise
cases 1 and 2* should be used.  Case 2 is rare and only consistent with
explosive series.  Case 1 is the most common and is the default in <b>johans</b>.
<p>
For instance, using the first of the examples provided in the <b>Examples</b> section
below,
<p>
. use http://fmwww.bc.edu/ec-p/data/macro/wgmacro.dta, clear
(Quarterly SA West German macro data, Bil DM, from Lutkepohl 1993 Table E.1)
<p>
. johans investment income consumption, l(4) nonormal
Johansen-Juselius cointegration rank test              Sample: 1960q4 to 1982q4
                                                            Number of obs =  88
                                        H1:
                 H0:    |   Max-lambda        Trace
 Eigenvalues  rank&lt;=(r) |   statistics      statistics
  (lambda)        r     |  (rank&lt;=(r+1))   (rank&lt;=(p=3))
------------------------+--------------------------------
  .21617042       0     |    21.433602       33.527577
  .11390069       1     |     10.64151       12.093974
  .01636981       2     |    1.4524647       1.4524647
<p>
<p>
    Osterwald-Lenum Critical values (95% interval):
<p>
    Table/Case: 1*
    (assumption: intercept in CE)
<p>
                 H0:    |   Max-lambda        Trace
             -----------+--------------------------------
                  0     |      22.00           34.91
                  1     |      15.67           19.96
                  2     |       9.24            9.24
<p>
    Table/Case: 1
    (assumption: intercept in VAR)
<p>
                 H0:    |   Max-lambda        Trace
             -----------+--------------------------------
                  0     |      20.97           29.68
                  1     |      14.07           15.41
                  2     |       3.76            3.76
<p>
<p>
If we believe there is an intercept term in the VAR but not in the CE, we refer
to the quantiles in Table 1 of Osterwald-Lenum.  Using the Max-lambda
statistic, we test the null hypothesis that (r) = 0 against the alternative
that (r) is at most 1.  Our test statistic of 21.43 exceeds the critical value
of 20.97 which leads to the rejection of the hypothesis of no cointegrating
relationship.  The Trace statistic of 33.53 also exceeds its corresponding
critical value of 29.68 which is consistent with the result using the
Max-lambda statistic.
<p>
We now move on to testing the null hypothesis that the rank of <b>ab'</b> is 1.  In
this instance however, the Max-lambda statistic of 10.64 is smaller than the
critical value of 14.07 and we cannot reject the null hypothesis.  The Trace
test leads to the same conclusion.  Therefore, regardless of which statistic is
used, we cannot reject the hypothesis that we have 1 cointegrating vector.
<p>
<p>
<b><u>Examples</u></b>
<p>
        . use http://fmwww.bc.edu/ec-p/data/macro/wgmacro.dta, clear
<p>
        . johans investment income consumption, l(4)
        . lrjtest investment, c(1)
        . wjtest investment, c(1)
        . lrjtest income, c(1)
<p>
        . * generate zero-mean (centered) seasonal dummies
        . forvalues i = 1/4 { gen byte q`i' = 0 }
        . forvalues i = 1/4 { replace q`i' = 1 if quarter(dofq(qtr))==`i' }
        . forvalues i = 1/4 { replace q`i' = q4-q`i' }
        . johans investment income consumption, l(4) exog(q1 q2 q3)
<p>
With longitudinal data, for each unit of a panel,
<p>
        . use http://fmwww.bc.edu/ec-p/data/Greene2000/TBL15-1, clear
<p>
        . tsset firm year, yearly
        . by firm: johans i f c, l(3)
<p>
        . johans i f c if firm==3, l(3)
        . lrjtest i, c(1) restrict
        . lrjtest c, c(1) restrict
<p>
<p>
<b><u>References</u></b>
<p>
Johansen, S. (1988). "Statistical Analysis of Cointegration Vectors".  <i>Journal</i>
  <i>of Economic Dynamics and Control</i>. <b>12</b>. 231-254.
<p>
Johansen, S. and K. Juselius. (1990). "Maximum Likelihood Estimation and
  Inference on Cointegration - With Applications to the Demand for Money".
  <i>Oxford Bulletin of Economics and Statistics</i>. <b>52</b>.  169-210.
<p>
    For inference, the most comprehensive set of critical values can be found
    in:
<p>
Osterwald-Lenum, M. (1992). "A Note with Quantiles of the Asymptotic
  Distribution of the Maximum Likelihood Cointegration Rank Test Statistics".
  <i>Oxford Bulletin of Economics and Statistics</i>.  <b>54</b>. 461-472.
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
Thanks to Richard Sperling for suggestions on the displayed output.
<p>
<p>
<b><u>Author</u></b>
<p>
Ken Heinecke and Charles Morris, Federal Reserve Bank of Kansas City
<p>
Patrick Joly, Industry Canada
pat.joly@utoronto.ca
<p>
<p>
<b><u>Also see</u></b>
<p>
On-line:  help for vecar (if installed), vececm (if installed), dfuller, 
                   pperron
<p>
</pre>