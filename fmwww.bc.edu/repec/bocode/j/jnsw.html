<pre>
<b>help jnsw</b>                                                Version 1.0 2007-02-26
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Title</u></b>
<p>
    <b>jnsw</b> --  Fit Johnson's system of transformations by Wheeler's quantile
             method
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>jnsw</b> <i>varname</i> [<i>if</i>] [<i>in</i>] [<b>,</b> <i>options</i>]
<p>
    <i>options</i>               Description
    -------------------------------------------------------------------------
    Main
      <b><u>g</u></b><b>enerate(</b><i>newvar</i><b>)</b>    create variable named <i>newvar</i> that is the fitted
                            normal transformation of <i>varname</i>
      <b><u>di</u></b><b>stribution(</b><i>type</i><b>)</b>  force fit to a specified Johnson distribution type
      <b><u>lnt</u></b><b>olerance(</b><i>#</i><b>)</b>      tolerance for discriminating from the log-normal
                            line
      <b><u>tbo</u></b><b>neonly</b>           use only the upper quantiles
      <b><u>p</u></b><b>ercentile(</b><i>#</i><b>)</b>       use a subset of the data
      <b><u>ga</u></b><b>mma(</b><i>#</i><b>)</b>            force fit with a specified value for <i>gamma</i>
      <b><u>d</u></b><b>elta(</b><i>#</i><b>)</b>            force fit with a specified value for <i>delta</i>
      <b><u>l</u></b><b>ambda(</b><i>#</i><b>)</b>           force fit with a specified value for <i>lambda</i>
      <b><u>x</u></b><b>i(</b><i>#</i><b>)</b>               force fit with a specified value for <i>xi</i>
    -------------------------------------------------------------------------
    <b>by</b> may be used with <b>jnsw</b>; see <b>by</b>.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>jnsw</b> fits Johnson systems of transformations using the quantile method of
    Wheeler (1980).
<p>
<p>
<b><u>Options</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <b>distribution</b> forces the fit to a user-specified Johnson distribution
        type; acceptable types are <i>SL</i>, <i>SB</i> and <i>SU</i> in upper case, lower case or
        mixed case.  The default is to select the type by reference to the
        log-normal line.
<p>
    <b>lntolerance</b> specifies the tolerance for discriminating <i>SB</i> and <i>SU</i>
        distribution types from <i>SL</i>, based upon difference from the log-normal
        line.  The default is 0.01, acceptable values are 0.0001 to 0.5, with
        smaller values resulting in more fits declared as <i>SL</i> type.
<p>
    <b>tboneonly</b> requests that only the upper tail contribute to the the
        intermediary <i>tb</i> result; the default is to use the average of two <i>tb</i>s
        determined from both tails.
<p>
    <b>percentile(</b><i>#</i><b>)</b> requests that only the values of <i>varname</i> less than or equal
        to the # percentile contribute to the fit; the default is 100.
<p>
    <b>gamma</b> <b>delta</b> <b>lambda</b> <b>delta</b> forces to fit to use user-specified values of
        the parameter.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    <b>jnsw</b> fits parameters of Johnson distributions by the method of quantiles
    (Wheeler, 1980).  The method selects and fits the Johnson distribution on
    the basis of five quantiles, one of which is the median.  Flynn (2006)
    determined that, at least for fitting certain <i>SB</i> distributions, Wheeler's
    quantile method performs better than two other popular percentile methods
    that use only four percentiles.
<p>
    Details of the method for fitting <i>gamma</i> and <i>delta</i> are given in Wheeler
    (1980).  In particular, the default of using both tails to calculate the
    intermediary statistic, <i>tb</i>, is based upon a suggestion in the article
    that this is expected to provide for more accurate results in fitting
    <i>delta</i>.  The article illustrates the method using <i>tb</i> estimated from only
    one tail, however, and the <b>tboneonly</b> option will force this should the
    user desire to follow Wheeler's illustrations.
<p>
    <i>lambda</i> and <i>xi</i> are fit using ordinary least-squares linear regression, as
    suggested in the article.
<p>
    The <b>percentile</b> option is made available for use with censored data, as
    suggested in the article.
<p>
    For the <i>SL</i> Johnson type, <b>jnsw</b> deviates from the article in that (i) <i>gamma</i>
    is explicitly fit (Wheeler combines it into <i>delta</i>, assuming <i>lambda</i> will
    be explicitly fit), (ii) <i>delta</i> is constrained to be positive in
    accordance with convention (Wheeler allows it to be negative for
    negatively skewed data, again, assuming that <i>lambda</i> will be allowed to
    vary freely), and (iii) <i>lambda</i> is set to 1 if the data are positively
    skewed and -1 if the data are negatively skewed.  This latter convention
    of constraining <i>lambda</i> to unity, with its sign reflecting direction of
    skew, follows Hill, Hill and Holder (1976).  That method is implemented
    in jnsn (if installed).  These deviations from Wheeler's article allow
    results between the two methods to be directly comparable.  They also
    allow the results from <b>jnsw</b>, which are returned in return scalars and a
    return macro, to be used in conjunction with ajv (if installed) to
    generate random variates that follow the Johnson distribution fit for 
    <i>varname</i> by <b>jnsw</b>.
<p>
<b><u>References</u></b>
<p>
    M. R. Flynn, Fitting human exposure data with the Johnson SB
    distribution. <i>Journal of Exposure Science and Environmental Epidemiology</i>
    <b>16</b>:56–62, 2006.
<p>
    I. D. Hill, R. Hill and R. L. Holder, Fitting Johnson curves by moments.
    <i>Applied Statistics</i> <b>25</b>:180–89, 1976.
<p>
    R. E. Wheeler, Quantile estimators of Johnson curve parameters.
    <i>Biometrika</i> <b>67</b>:725–28, 1980.
<p>
<b><u>Examples</u></b>
<p>
    <b>. jnsw x</b>
<p>
    <b>. jnsw x, di(sb) p(75) l(101) x(0)</b>
<p>
<p>
<b><u>Author</u></b>
<p>
    Joseph Coveney jcoveney@bigplanet.com
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[R] summarize</b>, <b>[R] boxcox</b>, <b>[R] lnskew0</b>, <b>[R] ladder</b>
<p>
    Online:  <b>jnsn</b>, <b>ajv</b>, <b>transint</b>, <b>summarize</b>, <b>boxcox</b>, <b>lnskew0</b>, <b>ladder</b>, <b>xriml</b>
<p>
<p>
</pre>