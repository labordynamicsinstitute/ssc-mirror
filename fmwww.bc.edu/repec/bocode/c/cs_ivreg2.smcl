{smcl}
{com}{sf}{ul off}{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/Users/baum/doc/Stata devel/ Cert scripts/cs_ivreg2.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}14 Aug 2009, 20:12:06
{txt}r; t=0.00 20:12:06

{com}. di c(version)
{res}11
{txt}r; t=0.00 20:12:06

{com}. query born
{txt}13 Jul 2009
r; t=0.01 20:12:06

{com}. which ivreg2
{txt}/Users/baum/library/application support/stata/ado/plus/i/ivreg2.ado
{res}*! ivreg2 2.2.09  17jul2008
*! authors cfb & mes
*! see end of file for version comments
{txt}r; t=0.01 20:12:06

{com}. which ranktest
{txt}/Users/baum/library/application support/stata/ado/plus/r/ranktest.ado
{res}*! ranktest 1.1.03  4May2008
*! author mes, based on code by fk
{txt}r; t=0.03 20:12:06

{com}. ivreg2, version  
{txt}02.2.09
r; t=0.02 20:12:06

{com}. assert "`e(version)'" == "02.2.09"
{txt}r; t=0.00 20:12:06

{com}. use http://fmwww.bc.edu/ec-p/data/hayashi/griliches76.dta,clear
{txt}(Wages of Very Young Men, Zvi Griliches, J.Pol.Ec. 1976)
r; t=0.36 20:12:06

{com}. * Hayashi Table 3.3 p.255 uses Blackburn-Neumark sample 
. summ

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 9}rns {c |}{res}       758    .2691293    .4438001          0          1
{txt}{space 7}rns80 {c |}{res}       758     .292876    .4553825          0          1
{txt}{space 9}mrt {c |}{res}       758    .5145119    .5001194          0          1
{txt}{space 7}mrt80 {c |}{res}       758    .8984169    .3022988          0          1
{txt}{space 8}smsa {c |}{res}       758    .7044855     .456575          0          1
{txt}{hline 13}{c +}{hline 56}
{space 6}smsa80 {c |}{res}       758    .7124011     .452942          0          1
{txt}{space 9}med {c |}{res}       758    10.91029     2.74112          0         18
{txt}{space 10}iq {c |}{res}       758    103.8562    13.61867         54        145
{txt}{space 9}kww {c |}{res}       758    36.57388    7.302247         12         56
{txt}{space 8}year {c |}{res}       758    69.03166    2.631794         66         73
{txt}{hline 13}{c +}{hline 56}
{space 9}age {c |}{res}       758    21.83509    2.981756         16         30
{txt}{space 7}age80 {c |}{res}       758    33.01187    3.085504         28         38
{txt}{space 11}s {c |}{res}       758    13.40501    2.231828          9         18
{txt}{space 9}s80 {c |}{res}       758    13.70712    2.214693          9         18
{txt}{space 8}expr {c |}{res}       758    1.735429    2.105542          0     11.444
{txt}{hline 13}{c +}{hline 56}
{space 6}expr80 {c |}{res}       758    11.39426    4.210745       .692     22.045
{txt}{space 6}tenure {c |}{res}       758    1.831135     1.67363          0         10
{txt}{space 4}tenure80 {c |}{res}       758    7.362797     5.05024          0         22
{txt}{space 10}lw {c |}{res}       758    5.686739    .4289494      4.605      7.051
{txt}{space 8}lw80 {c |}{res}       758    6.826555    .4099268      4.749      8.032
{txt}r; t=0.02 20:12:06

{com}. assert _N == 758
{txt}r; t=0.00 20:12:06

{com}. xi  i.year
{txt}i.year{col 19}_Iyear_66-73{col 39}(naturally coded; _Iyear_66 omitted)
r; t=0.37 20:12:07

{com}. * line 4 of table via ivreg
. which ivreg
{txt}/Applications/Stata/ado/base/i/ivreg.ado
{res}*! version 5.4.0  17mar2009
{txt}r; t=0.01 20:12:07

{com}. ivreg lw expr tenure rns smsa _I* (iq s = med kww mrt age)

{txt}Instrumental variables (2SLS) regression

      Source {c |}       SS       df       MS              Number of obs ={res}     758
{txt}{hline 13}{char +}{hline 30}           F( 12,   745) ={res}   37.64
    {txt}   Model {char |} {res} 31.7548087    12  2.64623406           {txt}Prob > F      = {res} 0.0000
    {txt}Residual {char |} {res} 107.531341   745  .144337371           {txt}R-squared     = {res} 0.2280
{txt}{hline 13}{char +}{hline 30}           Adj R-squared = {res} 0.2155
    {txt}   Total {char |} {res}  139.28615   757  .183997556           {txt}Root MSE      = {res} .37992

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0047453{col 37}{space 1}   -1.92{col 46}{space 3}0.056{col 55}{space 3}-.0184145{col 67}{space 3} .0002169
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0209182{col 37}{space 1}    8.24{col 46}{space 3}0.000{col 55}{space 3} .1313596{col 67}{space 3}  .213491
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0082254{col 37}{space 1}    5.99{col 46}{space 3}0.000{col 55}{space 3} .0331417{col 67}{space 3} .0654373
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0089197{col 37}{space 1}    4.73{col 46}{space 3}0.000{col 55}{space 3} .0247064{col 67}{space 3} .0597278
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0344734{col 37}{space 1}   -2.95{col 46}{space 3}0.003{col 55}{space 3}  -.16947{col 67}{space 3}-.0341169
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0311961{col 37}{space 1}    4.04{col 46}{space 3}0.000{col 55}{space 3} .0648681{col 67}{space 3} .1873538
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0557758{col 37}{space 1}   -1.07{col 46}{space 3}0.285{col 55}{space 3}-.1691136{col 67}{space 3} .0498794
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2}  .052468{col 37}{space 1}    0.93{col 46}{space 3}0.354{col 55}{space 3}-.0543231{col 67}{space 3} .1516822
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0520109{col 37}{space 1}    2.94{col 46}{space 3}0.003{col 55}{space 3} .0507122{col 67}{space 3} .2549231
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0602767{col 37}{space 1}    2.89{col 46}{space 3}0.004{col 55}{space 3} .0561036{col 67}{space 3} .2927685
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0546144{col 37}{space 1}    1.68{col 46}{space 3}0.094{col 55}{space 3}-.0155504{col 67}{space 3} .1988823
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0576787{col 37}{space 1}    1.62{col 46}{space 3}0.106{col 55}{space 3}-.0199923{col 67}{space 3} .2064718
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3181616{col 37}{space 1}   12.68{col 46}{space 3}0.000{col 55}{space 3}  3.40891{col 67}{space 3}  4.65811
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}iq s{p_end}
{p 0 15 4}Instruments:{space 3}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71 _Iyear_73 med kww mrt age{p_end}
{hline 78}
r; t=0.69 20:12:07

{com}. assert reldif(_b[s],0.172)< 1e-3
{txt}r; t=0.00 20:12:07

{com}. assert reldif(_se[s],0.021)< 1e-3
{txt}r; t=0.00 20:12:07

{com}. assert reldif(e(rmse),0.380)< 1e-3
{txt}r; t=0.00 20:12:07

{com}. savedresults save iv e()
{txt}r; t=0.03 20:12:07

{com}.  
. * line 4 of table via ivreg2, small
. ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) , small

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   37.64
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2280
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 107.5313411{txt}{col 55}Root MSE      = {res}   .3799

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0047453{col 37}{space 1}   -1.92{col 46}{space 3}0.056{col 55}{space 3}-.0184145{col 67}{space 3} .0002169
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0209182{col 37}{space 1}    8.24{col 46}{space 3}0.000{col 55}{space 3} .1313596{col 67}{space 3}  .213491
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0082254{col 37}{space 1}    5.99{col 46}{space 3}0.000{col 55}{space 3} .0331417{col 67}{space 3} .0654373
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0089197{col 37}{space 1}    4.73{col 46}{space 3}0.000{col 55}{space 3} .0247064{col 67}{space 3} .0597278
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0344734{col 37}{space 1}   -2.95{col 46}{space 3}0.003{col 55}{space 3}  -.16947{col 67}{space 3}-.0341169
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0311961{col 37}{space 1}    4.04{col 46}{space 3}0.000{col 55}{space 3} .0648681{col 67}{space 3} .1873538
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0557758{col 37}{space 1}   -1.07{col 46}{space 3}0.285{col 55}{space 3}-.1691136{col 67}{space 3} .0498794
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2}  .052468{col 37}{space 1}    0.93{col 46}{space 3}0.354{col 55}{space 3}-.0543231{col 67}{space 3} .1516822
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0520109{col 37}{space 1}    2.94{col 46}{space 3}0.003{col 55}{space 3} .0507122{col 67}{space 3} .2549231
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0602767{col 37}{space 1}    2.89{col 46}{space 3}0.004{col 55}{space 3} .0561036{col 67}{space 3} .2927685
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0546144{col 37}{space 1}    1.68{col 46}{space 3}0.094{col 55}{space 3}-.0155504{col 67}{space 3} .1988823
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0576787{col 37}{space 1}    1.62{col 46}{space 3}0.106{col 55}{space 3}-.0199923{col 67}{space 3} .2064718
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3181616{col 37}{space 1}   12.68{col 46}{space 3}0.000{col 55}{space 3}  3.40891{col 67}{space 3}  4.65811
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  47.978
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  12.552
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}  13.268
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0013
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.80 20:12:08

{com}. assert reldif(_b[s],0.172)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_se[s],0.021)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_b[iq],-0.009)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_se[iq],0.0047)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_b[expr],0.049)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_se[expr],0.0082)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_b[tenure],0.042)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(_se[tenure],0.0095)<1e-3
{txt}r; t=0.00 20:12:08

{com}. assert reldif(e(rmse),0.379)<1e-3
{txt}r; t=0.00 20:12:08

{com}. * 1.0.6: insts order now differs between ivreg, ivreg2
. * savedresults comp iv e(), include(macros: insts instd depvar scalar: rmse matrix: b V) tol(1e-7) verbose
. savedresults comp iv e(), include(macros: instd depvar scalar: rmse matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(rmse)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:08

{com}. 
. * 1.0.21: perform same comparison with [aw]
. g wt = 1/age
{txt}r; t=0.00 20:12:08

{com}. ivreg lw expr tenure rns smsa _I* (iq s = med kww mrt age) [aw=wt], robust
{txt}(sum of wgt is   3.5357e+01)

Instrumental variables (2SLS) regression               Number of obs ={res}     758
                                                       {txt}F( 12,   745) ={res}   41.70
                                                       {txt}Prob > F      = {res} 0.0000
                                                       {txt}R-squared     = {res} 0.2559
                                                       {txt}Root MSE      = {res} .36861

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0074948{col 26}{space 2} .0045845{col 37}{space 1}   -1.63{col 46}{space 3}0.103{col 55}{space 3}-.0164949{col 67}{space 3} .0015054
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1649811{col 26}{space 2} .0194354{col 37}{space 1}    8.49{col 46}{space 3}0.000{col 55}{space 3} .1268264{col 67}{space 3} .2031357
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0478406{col 26}{space 2} .0078976{col 37}{space 1}    6.06{col 46}{space 3}0.000{col 55}{space 3} .0323364{col 67}{space 3} .0633449
{txt}{space 6}tenure {c |}{col 14}{result}{space 2}  .037868{col 26}{space 2} .0093315{col 37}{space 1}    4.06{col 46}{space 3}0.000{col 55}{space 3} .0195488{col 67}{space 3} .0561872
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.0984184{col 26}{space 2} .0332218{col 37}{space 1}   -2.96{col 46}{space 3}0.003{col 55}{space 3}-.1636379{col 67}{space 3}-.0331989
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1300172{col 26}{space 2} .0302039{col 37}{space 1}    4.30{col 46}{space 3}0.000{col 55}{space 3} .0707223{col 67}{space 3} .1893121
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0662887{col 26}{space 2} .0516902{col 37}{space 1}   -1.28{col 46}{space 3}0.200{col 55}{space 3}-.1677645{col 67}{space 3} .0351871
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0472949{col 26}{space 2} .0485352{col 37}{space 1}    0.97{col 46}{space 3}0.330{col 55}{space 3}-.0479872{col 67}{space 3}  .142577
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1459345{col 26}{space 2} .0460964{col 37}{space 1}    3.17{col 46}{space 3}0.002{col 55}{space 3} .0554403{col 67}{space 3} .2364288
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1619464{col 26}{space 2} .0604136{col 37}{space 1}    2.68{col 46}{space 3}0.008{col 55}{space 3} .0433453{col 67}{space 3} .2805476
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .083768{col 26}{space 2} .0542397{col 37}{space 1}    1.54{col 46}{space 3}0.123{col 55}{space 3}-.0227128{col 67}{space 3} .1902489
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2}  .090334{col 26}{space 2} .0600688{col 37}{space 1}    1.50{col 46}{space 3}0.133{col 55}{space 3}-.0275903{col 67}{space 3} .2082583
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.977557{col 26}{space 2} .3195744{col 37}{space 1}   12.45{col 46}{space 3}0.000{col 55}{space 3} 3.350183{col 67}{space 3}  4.60493
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}iq s{p_end}
{p 0 15 4}Instruments:{space 3}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71 _Iyear_73 med kww mrt age{p_end}
{hline 78}
r; t=0.25 20:12:09

{com}. savedresults save ivaw e()
{txt}r; t=0.00 20:12:09

{com}. ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) [aw=wt], small robust
{txt}(sum of wgt is     3.5357e+01)

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   41.70
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 136.0434966{txt}{col 55}Centered R2   = {res}  0.2559
{txt}Total (uncentered) SS   = {res} 24388.57213{txt}{col 55}Uncentered R2 = {res}  0.9958
{txt}Residual SS             = {res} 101.2247036{txt}{col 55}Root MSE      = {res}   .3686

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0074948{col 26}{space 2} .0045845{col 37}{space 1}   -1.63{col 46}{space 3}0.103{col 55}{space 3}-.0164949{col 67}{space 3} .0015054
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1649811{col 26}{space 2} .0194354{col 37}{space 1}    8.49{col 46}{space 3}0.000{col 55}{space 3} .1268264{col 67}{space 3} .2031357
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0478406{col 26}{space 2} .0078976{col 37}{space 1}    6.06{col 46}{space 3}0.000{col 55}{space 3} .0323364{col 67}{space 3} .0633449
{txt}{space 6}tenure {c |}{col 14}{result}{space 2}  .037868{col 26}{space 2} .0093315{col 37}{space 1}    4.06{col 46}{space 3}0.000{col 55}{space 3} .0195488{col 67}{space 3} .0561872
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.0984184{col 26}{space 2} .0332218{col 37}{space 1}   -2.96{col 46}{space 3}0.003{col 55}{space 3}-.1636379{col 67}{space 3}-.0331989
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1300172{col 26}{space 2} .0302039{col 37}{space 1}    4.30{col 46}{space 3}0.000{col 55}{space 3} .0707223{col 67}{space 3} .1893121
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0662887{col 26}{space 2} .0516902{col 37}{space 1}   -1.28{col 46}{space 3}0.200{col 55}{space 3}-.1677645{col 67}{space 3} .0351871
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0472949{col 26}{space 2} .0485352{col 37}{space 1}    0.97{col 46}{space 3}0.330{col 55}{space 3}-.0479872{col 67}{space 3}  .142577
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1459345{col 26}{space 2} .0460964{col 37}{space 1}    3.17{col 46}{space 3}0.002{col 55}{space 3} .0554403{col 67}{space 3} .2364288
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1619464{col 26}{space 2} .0604136{col 37}{space 1}    2.68{col 46}{space 3}0.008{col 55}{space 3} .0433453{col 67}{space 3} .2805476
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .083768{col 26}{space 2} .0542397{col 37}{space 1}    1.54{col 46}{space 3}0.123{col 55}{space 3}-.0227128{col 67}{space 3} .1902489
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2}  .090334{col 26}{space 2} .0600688{col 37}{space 1}    1.50{col 46}{space 3}0.133{col 55}{space 3}-.0275903{col 67}{space 3} .2082583
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.977557{col 26}{space 2} .3195744{col 37}{space 1}   12.45{col 46}{space 3}0.000{col 55}{space 3} 3.350183{col 67}{space 3}  4.60493
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  44.038
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  12.641
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}  11.636
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0030
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.40 20:12:09

{com}. savedresults comp ivaw e(), include(macros: instd depvar scalar: rmse matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(rmse)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:09

{com}. 
. 
. * line 4 of table to match sargan (large sample stat)
. ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) 

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   37.64
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2280
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 107.5313411{txt}{col 55}Root MSE      = {res}   .3766

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0047044{col 37}{space 1}   -1.93{col 46}{space 3}0.053{col 55}{space 3}-.0183193{col 67}{space 3} .0001216
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0207381{col 37}{space 1}    8.31{col 46}{space 3}0.000{col 55}{space 3} .1317794{col 67}{space 3} .2130712
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0081546{col 37}{space 1}    6.04{col 46}{space 3}0.000{col 55}{space 3} .0333068{col 67}{space 3} .0652722
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0088429{col 37}{space 1}    4.77{col 46}{space 3}0.000{col 55}{space 3} .0248854{col 67}{space 3} .0595488
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0341765{col 37}{space 1}   -2.98{col 46}{space 3}0.003{col 55}{space 3}-.1687781{col 67}{space 3}-.0348088
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0309275{col 37}{space 1}    4.08{col 46}{space 3}0.000{col 55}{space 3} .0654942{col 67}{space 3} .1867277
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0552955{col 37}{space 1}   -1.08{col 46}{space 3}0.281{col 55}{space 3}-.1679942{col 67}{space 3}   .04876
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2} .0520161{col 37}{space 1}    0.94{col 46}{space 3}0.349{col 55}{space 3}-.0532701{col 67}{space 3} .1506292
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2}  .051563{col 37}{space 1}    2.96{col 46}{space 3}0.003{col 55}{space 3}  .051756{col 67}{space 3} .2538792
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0597576{col 37}{space 1}    2.92{col 46}{space 3}0.004{col 55}{space 3} .0573133{col 67}{space 3} .2915588
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2}  .054144{col 37}{space 1}    1.69{col 46}{space 3}0.090{col 55}{space 3}-.0144543{col 67}{space 3} .1977863
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0571819{col 37}{space 1}    1.63{col 46}{space 3}0.103{col 55}{space 3}-.0188347{col 67}{space 3} .2053142
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3154215{col 37}{space 1}   12.79{col 46}{space 3}0.000{col 55}{space 3} 3.415295{col 67}{space 3} 4.651725
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  47.978
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  12.552
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}  13.268
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0013
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.30 20:12:09

{com}. assert reldif(e(sargan),13.3)<1e-2
{txt}r; t=0.00 20:12:09

{com}. assert e(sargandf)==2
{txt}r; t=0.00 20:12:09

{com}. assert reldif(e(sarganp),0.00131)<1e-3
{txt}r; t=0.00 20:12:09

{com}. rcof "noi ivreg2 lw expr tenure rns smsa _I* (iq s med kww = mrt age)" == 481
{err}equation not identified; must have at least as many instruments not in
the regression as there are instrumented variables
{txt}r; t=0.04 20:12:09

{com}. 
. * OLS option
. ivreg2 lw expr tenure rns smsa _I*, small

{txt}OLS estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 10,   747) = {res}   38.68
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.3412
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9963
{txt}Residual SS             = {res} 91.76828166{txt}{col 55}Root MSE      = {res}   .3505

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}expr {c |}{col 14}{result}{space 2} .0089665{col 26}{space 2} .0066419{col 37}{space 1}    1.35{col 46}{space 3}0.177{col 55}{space 3}-.0040724{col 67}{space 3} .0220055
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0479877{col 26}{space 2} .0080046{col 37}{space 1}    6.00{col 46}{space 3}0.000{col 55}{space 3} .0322736{col 67}{space 3} .0637019
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1298922{col 26}{space 2} .0292884{col 37}{space 1}   -4.43{col 46}{space 3}0.000{col 55}{space 3}-.1873896{col 67}{space 3}-.0723947
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1507694{col 26}{space 2} .0284765{col 37}{space 1}    5.29{col 46}{space 3}0.000{col 55}{space 3} .0948658{col 67}{space 3} .2066729
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0407856{col 26}{space 2} .0513652{col 37}{space 1}   -0.79{col 46}{space 3}0.427{col 55}{space 3}-.1416229{col 67}{space 3} .0600518
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .1036177{col 26}{space 2} .0481421{col 37}{space 1}    2.15{col 46}{space 3}0.032{col 55}{space 3} .0091079{col 67}{space 3} .1981276
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .2747202{col 26}{space 2} .0466208{col 37}{space 1}    5.89{col 46}{space 3}0.000{col 55}{space 3} .1831968{col 67}{space 3} .3662435
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .3320339{col 26}{space 2} .0513295{col 37}{space 1}    6.47{col 46}{space 3}0.000{col 55}{space 3} .2312666{col 67}{space 3} .4328012
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .3719771{col 26}{space 2} .0438097{col 37}{space 1}    8.49{col 46}{space 3}0.000{col 55}{space 3} .2859724{col 67}{space 3} .4579818
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .5470091{col 26}{space 2} .0372837{col 37}{space 1}   14.67{col 46}{space 3}0.000{col 55}{space 3} .4738157{col 67}{space 3} .6202025
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 5.286631{col 26}{space 2} .0399539{col 37}{space 1}  132.32{col 46}{space 3}0.000{col 55}{space 3} 5.208195{col 67}{space 3} 5.365066
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
{hline 78}
r; t=0.19 20:12:09

{com}. savedresults save ols e()
{txt}r; t=0.00 20:12:09

{com}. regress lw expr tenure rns smsa _I*

      {txt}Source {c |}       SS       df       MS              Number of obs ={res}     758
{txt}{hline 13}{char +}{hline 30}           F( 10,   747) ={res}   38.68
    {txt}   Model {char |} {res} 47.5178682    10  4.75178682           {txt}Prob > F      = {res} 0.0000
    {txt}Residual {char |} {res} 91.7682817   747  .122849105           {txt}R-squared     = {res} 0.3412
{txt}{hline 13}{char +}{hline 30}           Adj R-squared = {res} 0.3323
    {txt}   Total {char |} {res}  139.28615   757  .183997556           {txt}Root MSE      = {res}  .3505

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}expr {c |}{col 14}{result}{space 2} .0089665{col 26}{space 2} .0066419{col 37}{space 1}    1.35{col 46}{space 3}0.177{col 55}{space 3}-.0040724{col 67}{space 3} .0220055
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0479877{col 26}{space 2} .0080046{col 37}{space 1}    6.00{col 46}{space 3}0.000{col 55}{space 3} .0322736{col 67}{space 3} .0637019
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1298922{col 26}{space 2} .0292884{col 37}{space 1}   -4.43{col 46}{space 3}0.000{col 55}{space 3}-.1873896{col 67}{space 3}-.0723947
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1507694{col 26}{space 2} .0284765{col 37}{space 1}    5.29{col 46}{space 3}0.000{col 55}{space 3} .0948658{col 67}{space 3} .2066729
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0407856{col 26}{space 2} .0513652{col 37}{space 1}   -0.79{col 46}{space 3}0.427{col 55}{space 3}-.1416229{col 67}{space 3} .0600518
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .1036177{col 26}{space 2} .0481421{col 37}{space 1}    2.15{col 46}{space 3}0.032{col 55}{space 3} .0091079{col 67}{space 3} .1981276
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .2747202{col 26}{space 2} .0466208{col 37}{space 1}    5.89{col 46}{space 3}0.000{col 55}{space 3} .1831968{col 67}{space 3} .3662435
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .3320339{col 26}{space 2} .0513295{col 37}{space 1}    6.47{col 46}{space 3}0.000{col 55}{space 3} .2312666{col 67}{space 3} .4328012
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .3719771{col 26}{space 2} .0438097{col 37}{space 1}    8.49{col 46}{space 3}0.000{col 55}{space 3} .2859724{col 67}{space 3} .4579818
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .5470091{col 26}{space 2} .0372837{col 37}{space 1}   14.67{col 46}{space 3}0.000{col 55}{space 3} .4738157{col 67}{space 3} .6202025
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 5.286631{col 26}{space 2} .0399539{col 37}{space 1}  132.32{col 46}{space 3}0.000{col 55}{space 3} 5.208195{col 67}{space 3} 5.365066
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{res}{txt}r; t=0.25 20:12:10

{com}. savedresults comp ols e(), include(macros: depvar scalar: rmse matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(rmse)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:10

{com}. 
. ivreg lw expr tenure rns smsa _I* (iq =  age) in 1/8

{txt}Instrumental variables (2SLS) regression

      Source {c |}       SS       df       MS              Number of obs ={res}       8
{txt}{hline 13}{char +}{hline 30}           F(  7,     0) ={res}       .
    {txt}   Model {char |} {res} 1.68200831     7  .240286902           {txt}Prob > F      = {res}      .
    {txt}Residual {char |} {res} 5.4603e-21     0           .           {txt}R-squared     = {res} 1.0000
{txt}{hline 13}{char +}{hline 30}           Adj R-squared = {res}      .
    {txt}   Total {char |} {res} 1.68200831     7  .240286902           {txt}Root MSE      = {res}      0

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}    .1354{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 8}expr {c |}{col 14}{result}{space 2}-.6815391{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 6}tenure {c |}{col 14}{result}{space 2}-3.384152{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 9}rns {c |}{col 14}{result}  (omitted)
{txt}{space 8}smsa {c |}{col 14}{result}{space 2}-.2554329{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-1.334461{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2}-2.471034{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}  (omitted)
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}  (omitted)
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}  (omitted)
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} 16.10886{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-3.650863{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 55}{space 3}        .{col 67}{space 3}        .
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}iq{p_end}
{p 0 15 4}Instruments:{space 3}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71 _Iyear_73 age{p_end}
{hline 78}
r; t=0.17 20:12:10

{com}. * insuff observations
. rcof "noi ivreg2 lw expr tenure rns smsa _I* (iq =  age) in 1/8" == 2001
{txt}Warning - endogenous variable(s) collinear with instruments
Vars now exogenous:{col 21}iq
Warning - collinearities detected
Vars dropped:{col 21}rns _Iyear_69 _Iyear_70 _Iyear_71 age
{err}Error: number of observations must be greater than number of instruments
       including constant.
insufficient observations
{txt}r; t=0.14 20:12:10

{com}. * ivreg2 lw expr tenure rns smsa _I* (iq=age) in 1/8
. * assert "`e(collin)'" == "rns _Iyear_69 _Iyear_70 _Iyear_71 _Iyear_73"
. 
. * exact id
. ivreg2 lw expr tenure rns smsa _I* (iq =  age)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 11,   746) = {res}    5.81
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res} -4.2804
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9702
{txt}Residual SS             = {res} 735.4927869{txt}{col 55}Root MSE      = {res}    .985

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0798825{col 26}{space 2} .0199793{col 37}{space 1}    4.00{col 46}{space 3}0.000{col 55}{space 3} .0407237{col 67}{space 3} .1190412
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .1075846{col 26}{space 2} .0309323{col 37}{space 1}    3.48{col 46}{space 3}0.001{col 55}{space 3} .0469584{col 67}{space 3} .1682108
{txt}{space 6}tenure {c |}{col 14}{result}{space 2}-.0021097{col 26}{space 2} .0257502{col 37}{space 1}   -0.08{col 46}{space 3}0.935{col 55}{space 3}-.0525792{col 67}{space 3} .0483597
{txt}{space 9}rns {c |}{col 14}{result}{space 2} .1839836{col 26}{space 2} .1137456{col 37}{space 1}    1.62{col 46}{space 3}0.106{col 55}{space 3}-.0389537{col 67}{space 3} .4069208
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .0304411{col 26}{space 2} .0855021{col 37}{space 1}    0.36{col 46}{space 3}0.722{col 55}{space 3}-.1371399{col 67}{space 3} .1980221
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.1296965{col 26}{space 2} .1460597{col 37}{space 1}   -0.89{col 46}{space 3}0.375{col 55}{space 3}-.4159682{col 67}{space 3} .1565752
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0595883{col 26}{space 2} .1357461{col 37}{space 1}    0.44{col 46}{space 3}0.661{col 55}{space 3}-.2064691{col 67}{space 3} .3256457
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2}-.0368177{col 26}{space 2} .1524413{col 37}{space 1}   -0.24{col 46}{space 3}0.809{col 55}{space 3}-.3355971{col 67}{space 3} .2619618
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2}-.2980978{col 26}{space 2} .2136546{col 37}{space 1}   -1.40{col 46}{space 3}0.163{col 55}{space 3} -.716853{col 67}{space 3} .1206574
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}-.2766231{col 26}{space 2} .2036536{col 37}{space 1}   -1.36{col 46}{space 3}0.174{col 55}{space 3}-.6757769{col 67}{space 3} .1225307
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2}-.2688341{col 26}{space 2}  .229381{col 37}{space 1}   -1.17{col 46}{space 3}0.241{col 55}{space 3}-.7184127{col 67}{space 3} .1807444
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-2.739876{col 26}{space 2}  2.01064{col 37}{space 1}   -1.36{col 46}{space 3}0.173{col 55}{space 3}-6.680658{col 67}{space 3} 1.200906
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  15.406
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0001
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  15.476
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}age
{hline 78}
r; t=0.23 20:12:10

{com}. assert reldif(e(sargan),0.0)<1e-3
{txt}r; t=0.00 20:12:10

{com}. 
. * robust option
. ivreg  lw expr tenure rns smsa _I* (iq s = med kww mrt age) , robust

{txt}Instrumental variables (2SLS) regression               Number of obs ={res}     758
                                                       {txt}F( 12,   745) ={res}   40.09
                                                       {txt}Prob > F      = {res} 0.0000
                                                       {txt}R-squared     = {res} 0.2280
                                                       {txt}Root MSE      = {res} .37992

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0049287{col 37}{space 1}   -1.85{col 46}{space 3}0.065{col 55}{space 3}-.0187746{col 67}{space 3} .0005769
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0209196{col 37}{space 1}    8.24{col 46}{space 3}0.000{col 55}{space 3} .1313569{col 67}{space 3} .2134938
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0081197{col 37}{space 1}    6.07{col 46}{space 3}0.000{col 55}{space 3} .0333492{col 67}{space 3} .0652298
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0095458{col 37}{space 1}    4.42{col 46}{space 3}0.000{col 55}{space 3} .0234771{col 67}{space 3} .0609571
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0340034{col 37}{space 1}   -2.99{col 46}{space 3}0.003{col 55}{space 3}-.1685473{col 67}{space 3}-.0350396
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2}  .031079{col 37}{space 1}    4.06{col 46}{space 3}0.000{col 55}{space 3}  .065098{col 67}{space 3} .1871239
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2}  .052163{col 37}{space 1}   -1.14{col 46}{space 3}0.253{col 55}{space 3} -.162021{col 67}{space 3} .0427868
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2}  .050246{col 37}{space 1}    0.97{col 46}{space 3}0.333{col 55}{space 3} -.049961{col 67}{space 3} .1473201
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0483449{col 37}{space 1}    3.16{col 46}{space 3}0.002{col 55}{space 3} .0579093{col 67}{space 3}  .247726
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0616561{col 37}{space 1}    2.83{col 46}{space 3}0.005{col 55}{space 3} .0533956{col 67}{space 3} .2954765
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0559436{col 37}{space 1}    1.64{col 46}{space 3}0.102{col 55}{space 3}-.0181599{col 67}{space 3} .2014918
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0613776{col 37}{space 1}    1.52{col 46}{space 3}0.129{col 55}{space 3}-.0272539{col 67}{space 3} .2137334
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3379434{col 37}{space 1}   11.94{col 46}{space 3}0.000{col 55}{space 3} 3.370075{col 67}{space 3} 4.696945
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}iq s{p_end}
{p 0 15 4}Instruments:{space 3}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71 _Iyear_73 med kww mrt age{p_end}
{hline 78}
r; t=0.26 20:12:11

{com}. savedresults save ivrob e()
{txt}r; t=0.00 20:12:11

{com}. ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) , robust small

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   40.09
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2280
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 107.5313411{txt}{col 55}Root MSE      = {res}   .3799

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0049287{col 37}{space 1}   -1.85{col 46}{space 3}0.065{col 55}{space 3}-.0187746{col 67}{space 3} .0005769
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0209196{col 37}{space 1}    8.24{col 46}{space 3}0.000{col 55}{space 3} .1313569{col 67}{space 3} .2134938
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0081197{col 37}{space 1}    6.07{col 46}{space 3}0.000{col 55}{space 3} .0333492{col 67}{space 3} .0652298
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0095458{col 37}{space 1}    4.42{col 46}{space 3}0.000{col 55}{space 3} .0234771{col 67}{space 3} .0609571
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0340034{col 37}{space 1}   -2.99{col 46}{space 3}0.003{col 55}{space 3}-.1685473{col 67}{space 3}-.0350396
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2}  .031079{col 37}{space 1}    4.06{col 46}{space 3}0.000{col 55}{space 3}  .065098{col 67}{space 3} .1871239
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2}  .052163{col 37}{space 1}   -1.14{col 46}{space 3}0.253{col 55}{space 3} -.162021{col 67}{space 3} .0427868
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2}  .050246{col 37}{space 1}    0.97{col 46}{space 3}0.333{col 55}{space 3} -.049961{col 67}{space 3} .1473201
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0483449{col 37}{space 1}    3.16{col 46}{space 3}0.002{col 55}{space 3} .0579093{col 67}{space 3}  .247726
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0616561{col 37}{space 1}    2.83{col 46}{space 3}0.005{col 55}{space 3} .0533956{col 67}{space 3} .2954765
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0559436{col 37}{space 1}    1.64{col 46}{space 3}0.102{col 55}{space 3}-.0181599{col 67}{space 3} .2014918
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0613776{col 37}{space 1}    1.52{col 46}{space 3}0.129{col 55}{space 3}-.0272539{col 67}{space 3} .2137334
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3379434{col 37}{space 1}   11.94{col 46}{space 3}0.000{col 55}{space 3} 3.370075{col 67}{space 3} 4.696945
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  40.927
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  11.461
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}  11.601
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0030
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.48 20:12:11

{com}. * 1.0.6: same as above
. *savedresults comp ivrob e(), include(macros: insts instd depvar vcetype scalar: rmse matrix: b V) tol(1e-7) verbose
. savedresults comp ivrob e(), include(macros: instd depvar vcetype scalar: rmse matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing macro  e(vcetype)
comparing scalar e(rmse)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:11

{com}. 
. 
. * GMM2S option
. which ivgmm0
{txt}/Users/baum/library/application support/stata/ado/plus/i/ivgmm0.ado
{res}*! ivgmm0 v1.1.11   C F Baum and David Drukker  16Mar2004
{txt}r; t=0.02 20:12:11

{com}. ivgmm0 lw expr tenure rns smsa _I* (iq s = med kww mrt age)

{txt}Instrumental Variables Estimation via GMM           Number of obs  ={res}       758
                                                    Root MSE       =    0.3794
                                                    Hansen J       =   11.6015
                                                    Chi-sq( 2) P-val = 0.00303
{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}                 GMM
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0092862{col 26}{space 2} .0048824{col 37}{space 1}   -1.90{col 46}{space 3}0.057{col 55}{space 3}-.0188555{col 67}{space 3} .0002832
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1757958{col 26}{space 2} .0206766{col 37}{space 1}    8.50{col 46}{space 3}0.000{col 55}{space 3} .1352703{col 67}{space 3} .2163212
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0502828{col 26}{space 2} .0080438{col 37}{space 1}    6.25{col 46}{space 3}0.000{col 55}{space 3} .0345171{col 67}{space 3} .0660484
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0425214{col 26}{space 2} .0094549{col 37}{space 1}    4.50{col 46}{space 3}0.000{col 55}{space 3} .0239901{col 67}{space 3} .0610526
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1040931{col 26}{space 2} .0335239{col 37}{space 1}   -3.11{col 46}{space 3}0.002{col 55}{space 3}-.1697986{col 67}{space 3}-.0383875
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1247512{col 26}{space 2} .0307747{col 37}{space 1}    4.05{col 46}{space 3}0.000{col 55}{space 3} .0644338{col 67}{space 3} .1850686
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0530432{col 26}{space 2} .0514609{col 37}{space 1}   -1.03{col 46}{space 3}0.303{col 55}{space 3}-.1539047{col 67}{space 3} .0478184
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0459546{col 26}{space 2} .0495735{col 37}{space 1}    0.93{col 46}{space 3}0.354{col 55}{space 3}-.0512077{col 67}{space 3} .1431169
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1554801{col 26}{space 2} .0476311{col 37}{space 1}    3.26{col 46}{space 3}0.001{col 55}{space 3} .0621249{col 67}{space 3} .2488352
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1669875{col 26}{space 2} .0610006{col 37}{space 1}    2.74{col 46}{space 3}0.006{col 55}{space 3} .0474285{col 67}{space 3} .2865464
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .0846485{col 26}{space 2} .0554035{col 37}{space 1}    1.53{col 46}{space 3}0.127{col 55}{space 3}-.0239404{col 67}{space 3} .1932373
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0996068{col 26}{space 2} .0607034{col 37}{space 1}    1.64{col 46}{space 3}0.101{col 55}{space 3}-.0193696{col 67}{space 3} .2185833
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.003924{col 26}{space 2} .3348423{col 37}{space 1}   11.96{col 46}{space 3}0.000{col 55}{space 3} 3.347645{col 67}{space 3} 4.660203
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
Instrumented:  iq s
Instruments:   expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70
               _Iyear_71 _Iyear_73 med kww mrt age
------------------------------------------------------------------------------
r; t=0.29 20:12:11

{com}. savedresults save ivgmm e()
{txt}r; t=0.00 20:12:11

{com}. ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age), gmm2s robust

{txt}2-Step GMM estimation
{hline 21}

Estimates efficient for arbitrary heteroskedasticity
Statistics robust to heteroskedasticity

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   41.98
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2168
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 109.0846511{txt}{col 55}Root MSE      = {res}   .3794

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0092862{col 26}{space 2} .0048824{col 37}{space 1}   -1.90{col 46}{space 3}0.057{col 55}{space 3}-.0188555{col 67}{space 3} .0002832
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1757958{col 26}{space 2} .0206766{col 37}{space 1}    8.50{col 46}{space 3}0.000{col 55}{space 3} .1352703{col 67}{space 3} .2163212
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0502828{col 26}{space 2} .0080438{col 37}{space 1}    6.25{col 46}{space 3}0.000{col 55}{space 3} .0345171{col 67}{space 3} .0660484
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0425214{col 26}{space 2} .0094549{col 37}{space 1}    4.50{col 46}{space 3}0.000{col 55}{space 3} .0239901{col 67}{space 3} .0610526
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1040931{col 26}{space 2} .0335239{col 37}{space 1}   -3.11{col 46}{space 3}0.002{col 55}{space 3}-.1697986{col 67}{space 3}-.0383875
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1247512{col 26}{space 2} .0307747{col 37}{space 1}    4.05{col 46}{space 3}0.000{col 55}{space 3} .0644338{col 67}{space 3} .1850686
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0530432{col 26}{space 2} .0514609{col 37}{space 1}   -1.03{col 46}{space 3}0.303{col 55}{space 3}-.1539047{col 67}{space 3} .0478184
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0459546{col 26}{space 2} .0495735{col 37}{space 1}    0.93{col 46}{space 3}0.354{col 55}{space 3}-.0512077{col 67}{space 3} .1431169
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1554801{col 26}{space 2} .0476311{col 37}{space 1}    3.26{col 46}{space 3}0.001{col 55}{space 3} .0621249{col 67}{space 3} .2488352
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1669875{col 26}{space 2} .0610006{col 37}{space 1}    2.74{col 46}{space 3}0.006{col 55}{space 3} .0474285{col 67}{space 3} .2865464
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .0846485{col 26}{space 2} .0554035{col 37}{space 1}    1.53{col 46}{space 3}0.127{col 55}{space 3}-.0239404{col 67}{space 3} .1932373
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0996068{col 26}{space 2} .0607034{col 37}{space 1}    1.64{col 46}{space 3}0.101{col 55}{space 3}-.0193696{col 67}{space 3} .2185833
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.003924{col 26}{space 2} .3348423{col 37}{space 1}   11.96{col 46}{space 3}0.000{col 55}{space 3} 3.347645{col 67}{space 3} 4.660203
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  40.927
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  11.461
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}  11.601
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0030
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.40 20:12:12

{com}. * 1.0.6: same as above; cannot compare W
. * savedresults comp ivgmm e(), include(macros: insts instd depvar scalar: N rmse j matrix: b V W) tol(1e-7) verbose
. * savedresults comp ivgmm e(), include(macros: instd depvar scalar: N rmse j matrix: b V W) tol(1e-7) verbose
. savedresults comp ivgmm e(), include(macros: instd depvar scalar: N rmse j matrix: b V ) tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing scalar e(rmse)
comparing scalar e(j)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:12

{com}. 
. 
. * orthog option
. rcof "noi ivreg2  lw expr tenure rns smsa _I* (iq = med kww mrt ), orthog(s)" == 198
{err}Error: s listed in orthog() but does not appear as exogenous.
invalid syntax
{txt}r; t=0.03 20:12:12

{com}. ivreg2  lw expr tenure rns smsa _I* (iq = med kww mrt ), orthog(expr)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 11,   746) = {res}   31.71
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.1352
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9951
{txt}Residual SS             = {res} 120.4602539{txt}{col 55}Root MSE      = {res}   .3986

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0229555{col 26}{space 2}  .003084{col 37}{space 1}    7.44{col 46}{space 3}0.000{col 55}{space 3} .0169109{col 67}{space 3} .0290002
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0373061{col 26}{space 2} .0084595{col 37}{space 1}    4.41{col 46}{space 3}0.000{col 55}{space 3} .0207258{col 67}{space 3} .0538864
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0335914{col 26}{space 2} .0093074{col 37}{space 1}    3.61{col 46}{space 3}0.000{col 55}{space 3} .0153493{col 67}{space 3} .0518335
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.0396948{col 26}{space 2} .0354474{col 37}{space 1}   -1.12{col 46}{space 3}0.263{col 55}{space 3}-.1091704{col 67}{space 3} .0297808
{txt}{space 8}smsa {c |}{col 14}{result}{space 2}  .116191{col 26}{space 2} .0327198{col 37}{space 1}    3.55{col 46}{space 3}0.000{col 55}{space 3} .0520614{col 67}{space 3} .1803206
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0663356{col 26}{space 2} .0585219{col 37}{space 1}   -1.13{col 46}{space 3}0.257{col 55}{space 3}-.1810365{col 67}{space 3} .0483653
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0909651{col 26}{space 2} .0547817{col 37}{space 1}    1.66{col 46}{space 3}0.097{col 55}{space 3} -.016405{col 67}{space 3} .1983353
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1851946{col 26}{space 2}  .054372{col 37}{space 1}    3.41{col 46}{space 3}0.001{col 55}{space 3} .0786274{col 67}{space 3} .2917618
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1509552{col 26}{space 2} .0632466{col 37}{space 1}    2.39{col 46}{space 3}0.017{col 55}{space 3} .0269941{col 67}{space 3} .2749162
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .1855911{col 26}{space 2} .0557659{col 37}{space 1}    3.33{col 46}{space 3}0.001{col 55}{space 3} .0762919{col 67}{space 3} .2948904
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .3125631{col 26}{space 2} .0528234{col 37}{space 1}    5.92{col 46}{space 3}0.000{col 55}{space 3} .2090312{col 67}{space 3}  .416095
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.980081{col 26}{space 2} .3131961{col 37}{space 1}    9.52{col 46}{space 3}0.000{col 55}{space 3} 2.366228{col 67}{space 3} 3.593934
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 105.893
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  40.272
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 13.91
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  9.08
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.46
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.39
{txt}{col 42}10% maximal IV size{res}{col 73} 22.30
{txt}{col 42}15% maximal IV size{res}{col 73} 12.83
{txt}{col 42}20% maximal IV size{res}{col 73}  9.54
{txt}{col 42}25% maximal IV size{res}{col 73}  7.80
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}  33.392
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}-orthog- option:
Sargan statistic (eqn. excluding suspect orthogonality conditions):{res}{col 71}   8.636
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0033
{help ivreg2##ctest:C statistic}{txt} (exogeneity/orthogonality of suspect instruments): {res}{col 71}  24.756
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0000
{txt}Instruments tested:  {col 23}expr
{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt
{hline 78}
r; t=0.36 20:12:12

{com}. ivreg2  lw expr tenure rns smsa _I* (iq = med kww ), orthog(expr)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 11,   746) = {res}   30.77
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.0915
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9949
{txt}Residual SS             = {res} 126.5404315{txt}{col 55}Root MSE      = {res}   .4086

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0244137{col 26}{space 2} .0031717{col 37}{space 1}    7.70{col 46}{space 3}0.000{col 55}{space 3} .0181973{col 67}{space 3} .0306301
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0391062{col 26}{space 2} .0086764{col 37}{space 1}    4.51{col 46}{space 3}0.000{col 55}{space 3} .0221009{col 67}{space 3} .0561116
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0326769{col 26}{space 2} .0095408{col 37}{space 1}    3.42{col 46}{space 3}0.001{col 55}{space 3} .0139774{col 67}{space 3} .0513765
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.0339654{col 26}{space 2} .0363455{col 37}{space 1}   -0.93{col 46}{space 3}0.350{col 55}{space 3}-.1052012{col 67}{space 3} .0372704
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1139946{col 26}{space 2} .0335377{col 37}{space 1}    3.40{col 46}{space 3}0.001{col 55}{space 3} .0482619{col 67}{space 3} .1797272
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0679585{col 26}{space 2} .0599814{col 37}{space 1}   -1.13{col 46}{space 3}0.257{col 55}{space 3}-.1855199{col 67}{space 3} .0496028
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0901614{col 26}{space 2} .0561474{col 37}{space 1}    1.61{col 46}{space 3}0.108{col 55}{space 3}-.0198854{col 67}{space 3} .2002083
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1795079{col 26}{space 2} .0557366{col 37}{space 1}    3.22{col 46}{space 3}0.001{col 55}{space 3} .0702661{col 67}{space 3} .2887497
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1394529{col 26}{space 2} .0648559{col 37}{space 1}    2.15{col 46}{space 3}0.032{col 55}{space 3} .0123377{col 67}{space 3} .2665682
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .1737518{col 26}{space 2} .0571954{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0616509{col 67}{space 3} .2858527
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .2976709{col 26}{space 2} .0542058{col 37}{space 1}    5.49{col 46}{space 3}0.000{col 55}{space 3} .1914294{col 67}{space 3} .4039124
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.833568{col 26}{space 2} .3220753{col 37}{space 1}    8.80{col 46}{space 3}0.000{col 55}{space 3} 2.202312{col 67}{space 3} 3.464824
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 105.174
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  60.012
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.656
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.4181
{txt}-orthog- option:
Sargan statistic (eqn. excluding suspect orthogonality conditions):{res}{col 71}   0.000
{txt}{col 52}Chi-sq({res}0{txt}) P-val =  {res}{col 73}     .
{help ivreg2##ctest:C statistic}{txt} (exogeneity/orthogonality of suspect instruments): {res}{col 71}   0.656
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.4181
{txt}Instruments tested:  {col 23}expr
{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww
{hline 78}
r; t=0.32 20:12:12

{com}. ivreg2  lw expr tenure rns smsa _I* (iq = med kww ), orthog(med)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 11,   746) = {res}   30.77
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.0915
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9949
{txt}Residual SS             = {res} 126.5404315{txt}{col 55}Root MSE      = {res}   .4086

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0244137{col 26}{space 2} .0031717{col 37}{space 1}    7.70{col 46}{space 3}0.000{col 55}{space 3} .0181973{col 67}{space 3} .0306301
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0391062{col 26}{space 2} .0086764{col 37}{space 1}    4.51{col 46}{space 3}0.000{col 55}{space 3} .0221009{col 67}{space 3} .0561116
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0326769{col 26}{space 2} .0095408{col 37}{space 1}    3.42{col 46}{space 3}0.001{col 55}{space 3} .0139774{col 67}{space 3} .0513765
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.0339654{col 26}{space 2} .0363455{col 37}{space 1}   -0.93{col 46}{space 3}0.350{col 55}{space 3}-.1052012{col 67}{space 3} .0372704
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1139946{col 26}{space 2} .0335377{col 37}{space 1}    3.40{col 46}{space 3}0.001{col 55}{space 3} .0482619{col 67}{space 3} .1797272
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0679585{col 26}{space 2} .0599814{col 37}{space 1}   -1.13{col 46}{space 3}0.257{col 55}{space 3}-.1855199{col 67}{space 3} .0496028
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0901614{col 26}{space 2} .0561474{col 37}{space 1}    1.61{col 46}{space 3}0.108{col 55}{space 3}-.0198854{col 67}{space 3} .2002083
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1795079{col 26}{space 2} .0557366{col 37}{space 1}    3.22{col 46}{space 3}0.001{col 55}{space 3} .0702661{col 67}{space 3} .2887497
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1394529{col 26}{space 2} .0648559{col 37}{space 1}    2.15{col 46}{space 3}0.032{col 55}{space 3} .0123377{col 67}{space 3} .2665682
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .1737518{col 26}{space 2} .0571954{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0616509{col 67}{space 3} .2858527
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .2976709{col 26}{space 2} .0542058{col 37}{space 1}    5.49{col 46}{space 3}0.000{col 55}{space 3} .1914294{col 67}{space 3} .4039124
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.833568{col 26}{space 2} .3220753{col 37}{space 1}    8.80{col 46}{space 3}0.000{col 55}{space 3} 2.202312{col 67}{space 3} 3.464824
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 105.174
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  60.012
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.656
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.4181
{txt}-orthog- option:
Sargan statistic (eqn. excluding suspect orthogonality conditions):{res}{col 71}   0.000
{txt}{col 52}Chi-sq({res}0{txt}) P-val =  {res}{col 73}     .
{help ivreg2##ctest:C statistic}{txt} (exogeneity/orthogonality of suspect instruments): {res}{col 71}   0.656
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.4181
{txt}Instruments tested:  {col 23}med
{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww
{hline 78}
r; t=0.28 20:12:13

{com}. ivreg2  lw expr tenure rns smsa _I* (iq = med kww ), orthog(med kww)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 11,   746) = {res}   30.77
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.0915
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9949
{txt}Residual SS             = {res} 126.5404315{txt}{col 55}Root MSE      = {res}   .4086

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0244137{col 26}{space 2} .0031717{col 37}{space 1}    7.70{col 46}{space 3}0.000{col 55}{space 3} .0181973{col 67}{space 3} .0306301
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0391062{col 26}{space 2} .0086764{col 37}{space 1}    4.51{col 46}{space 3}0.000{col 55}{space 3} .0221009{col 67}{space 3} .0561116
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0326769{col 26}{space 2} .0095408{col 37}{space 1}    3.42{col 46}{space 3}0.001{col 55}{space 3} .0139774{col 67}{space 3} .0513765
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.0339654{col 26}{space 2} .0363455{col 37}{space 1}   -0.93{col 46}{space 3}0.350{col 55}{space 3}-.1052012{col 67}{space 3} .0372704
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1139946{col 26}{space 2} .0335377{col 37}{space 1}    3.40{col 46}{space 3}0.001{col 55}{space 3} .0482619{col 67}{space 3} .1797272
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0679585{col 26}{space 2} .0599814{col 37}{space 1}   -1.13{col 46}{space 3}0.257{col 55}{space 3}-.1855199{col 67}{space 3} .0496028
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0901614{col 26}{space 2} .0561474{col 37}{space 1}    1.61{col 46}{space 3}0.108{col 55}{space 3}-.0198854{col 67}{space 3} .2002083
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1795079{col 26}{space 2} .0557366{col 37}{space 1}    3.22{col 46}{space 3}0.001{col 55}{space 3} .0702661{col 67}{space 3} .2887497
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1394529{col 26}{space 2} .0648559{col 37}{space 1}    2.15{col 46}{space 3}0.032{col 55}{space 3} .0123377{col 67}{space 3} .2665682
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .1737518{col 26}{space 2} .0571954{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0616509{col 67}{space 3} .2858527
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .2976709{col 26}{space 2} .0542058{col 37}{space 1}    5.49{col 46}{space 3}0.000{col 55}{space 3} .1914294{col 67}{space 3} .4039124
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.833568{col 26}{space 2} .3220753{col 37}{space 1}    8.80{col 46}{space 3}0.000{col 55}{space 3} 2.202312{col 67}{space 3} 3.464824
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 105.174
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  60.012
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.656
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.4181

{txt}Collinearity/identification problems in eqn. excl. suspect orthog. conditions:
  C statistic not calculated for -orthog- option
{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww
{hline 78}
r; t=0.29 20:12:13

{com}. 
. * cluster option
. ivreg lw expr tenure rns smsa _I* (iq s = med kww mrt age) , robust cluster(age)

{txt}Instrumental variables (2SLS) regression               Number of obs ={res}     758
                                                       {txt}F( 12,    14) ={res}  344.91
                                                       {txt}Prob > F      = {res} 0.0000
                                                       {txt}R-squared     = {res} 0.2280
                                                       {txt}Root MSE      = {res} .37992

{txt}{ralign 78:(Std. Err. adjusted for {res:15} clusters in age)}
{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0056701{col 37}{space 1}   -1.60{col 46}{space 3}0.131{col 55}{space 3}-.0212599{col 67}{space 3} .0030623
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0241501{col 37}{space 1}    7.14{col 46}{space 3}0.000{col 55}{space 3} .1206284{col 67}{space 3} .2242222
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0078771{col 37}{space 1}    6.26{col 46}{space 3}0.000{col 55}{space 3} .0323948{col 67}{space 3} .0661842
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0101291{col 37}{space 1}    4.17{col 46}{space 3}0.001{col 55}{space 3} .0204922{col 67}{space 3}  .063942
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0365854{col 37}{space 1}   -2.78{col 46}{space 3}0.015{col 55}{space 3}-.1802613{col 67}{space 3}-.0233256
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0275528{col 37}{space 1}    4.58{col 46}{space 3}0.000{col 55}{space 3} .0670161{col 67}{space 3} .1852058
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0730196{col 37}{space 1}   -0.82{col 46}{space 3}0.428{col 55}{space 3}-.2162287{col 67}{space 3} .0969945
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2} .0559102{col 37}{space 1}    0.87{col 46}{space 3}0.399{col 55}{space 3}-.0712359{col 67}{space 3} .1685951
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0394489{col 37}{space 1}    3.87{col 46}{space 3}0.002{col 55}{space 3} .0682082{col 67}{space 3} .2374271
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0548233{col 37}{space 1}    3.18{col 46}{space 3}0.007{col 55}{space 3} .0568517{col 67}{space 3} .2920204
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0603488{col 37}{space 1}    1.52{col 46}{space 3}0.151{col 55}{space 3}-.0377694{col 67}{space 3} .2211014
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0609199{col 37}{space 1}    1.53{col 46}{space 3}0.148{col 55}{space 3}-.0374204{col 67}{space 3} .2238999
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3123382{col 37}{space 1}   12.91{col 46}{space 3}0.000{col 55}{space 3} 3.363611{col 67}{space 3} 4.703409
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}iq s{p_end}
{p 0 15 4}Instruments:{space 3}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71 _Iyear_73 med kww mrt age{p_end}
{hline 78}
r; t=0.30 20:12:13

{com}. savedresults save ivclu e()
{txt}r; t=0.00 20:12:13

{com}. * 1.0.6: should yield 498? If so cannot execute following line
. * rcof "ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) , small robust cluster(age)" == 498
. ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) , small robust cluster(age)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on age

Number of clusters (age) = {res}15  {txt}{col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,    14) = {res}  344.91
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2280
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 107.5313411{txt}{col 55}Root MSE      = {res}   .3799

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0056701{col 37}{space 1}   -1.60{col 46}{space 3}0.131{col 55}{space 3}-.0212599{col 67}{space 3} .0030623
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0241501{col 37}{space 1}    7.14{col 46}{space 3}0.000{col 55}{space 3} .1206284{col 67}{space 3} .2242222
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0078771{col 37}{space 1}    6.26{col 46}{space 3}0.000{col 55}{space 3} .0323948{col 67}{space 3} .0661842
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0101291{col 37}{space 1}    4.17{col 46}{space 3}0.001{col 55}{space 3} .0204922{col 67}{space 3}  .063942
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0365854{col 37}{space 1}   -2.78{col 46}{space 3}0.015{col 55}{space 3}-.1802613{col 67}{space 3}-.0233256
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0275528{col 37}{space 1}    4.58{col 46}{space 3}0.000{col 55}{space 3} .0670161{col 67}{space 3} .1852058
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0730196{col 37}{space 1}   -0.82{col 46}{space 3}0.428{col 55}{space 3}-.2162287{col 67}{space 3} .0969945
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2} .0559102{col 37}{space 1}    0.87{col 46}{space 3}0.399{col 55}{space 3}-.0712359{col 67}{space 3} .1685951
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0394489{col 37}{space 1}    3.87{col 46}{space 3}0.002{col 55}{space 3} .0682082{col 67}{space 3} .2374271
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0548233{col 37}{space 1}    3.18{col 46}{space 3}0.007{col 55}{space 3} .0568517{col 67}{space 3} .2920204
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0603488{col 37}{space 1}    1.52{col 46}{space 3}0.151{col 55}{space 3}-.0377694{col 67}{space 3} .2211014
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2} .0609199{col 37}{space 1}    1.53{col 46}{space 3}0.148{col 55}{space 3}-.0374204{col 67}{space 3} .2238999
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3123382{col 37}{space 1}   12.91{col 46}{space 3}0.000{col 55}{space 3} 3.363611{col 67}{space 3} 4.703409
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   8.395
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0385
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  13.162
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   5.340
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0693
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.42 20:12:14

{com}. * do not compare insts
. savedresults comp ivclu e(), include(macros:  instd depvar scalar: N rmse  matrix: b) verbose tol(1e-7)
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing scalar e(rmse)
comparing matrix e(b)
r; t=0.00 20:12:14

{com}. ivreg lw expr tenure rns smsa (iq s = med kww mrt age) , robust cluster(age)

{txt}Instrumental variables (2SLS) regression               Number of obs ={res}     758
                                                       {txt}F(  6,    14) ={res}   53.69
                                                       {txt}Prob > F      = {res} 0.0000
                                                       {txt}R-squared     = {res} 0.0622
                                                       {txt}Root MSE      = {res} .41705

{txt}{ralign 78:(Std. Err. adjusted for {res:15} clusters in age)}
{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0144337{col 26}{space 2} .0065265{col 37}{space 1}   -2.21{col 46}{space 3}0.044{col 55}{space 3}-.0284316{col 67}{space 3}-.0004358
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1986398{col 26}{space 2} .0253661{col 37}{space 1}    7.83{col 46}{space 3}0.000{col 55}{space 3}  .144235{col 67}{space 3} .2530446
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0460456{col 26}{space 2} .0101647{col 37}{space 1}    4.53{col 46}{space 3}0.000{col 55}{space 3} .0242444{col 67}{space 3} .0678468
{txt}{space 6}tenure {c |}{col 14}{result}{space 2}   .04174{col 26}{space 2} .0110597{col 37}{space 1}    3.77{col 46}{space 3}0.002{col 55}{space 3} .0180192{col 67}{space 3} .0654608
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1129929{col 26}{space 2} .0363809{col 37}{space 1}   -3.11{col 46}{space 3}0.008{col 55}{space 3}-.1910222{col 67}{space 3}-.0349635
{txt}{space 8}smsa {c |}{col 14}{result}{space 2}  .130412{col 26}{space 2} .0318716{col 37}{space 1}    4.09{col 46}{space 3}0.001{col 55}{space 3} .0620542{col 67}{space 3} .1987699
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.305194{col 26}{space 2} .4092365{col 37}{space 1}   10.52{col 46}{space 3}0.000{col 55}{space 3} 3.427469{col 67}{space 3} 5.182919
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}iq s{p_end}
{p 0 15 4}Instruments:{space 3}expr tenure rns smsa med kww mrt age{p_end}
{hline 78}
r; t=0.12 20:12:14

{com}. savedresults save ivclu2 e()
{txt}r; t=0.00 20:12:14

{com}. ivreg2 lw expr tenure rns smsa (iq s = med kww mrt age) , small robust cluster(age)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on age

Number of clusters (age) = {res}15  {txt}{col 55}Number of obs = {res}     758
{txt}{col 55}F(  6,    14) = {res}   53.69
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.0622
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9947
{txt}Residual SS             = {res} 130.6189516{txt}{col 55}Root MSE      = {res}    .417

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0144337{col 26}{space 2} .0065265{col 37}{space 1}   -2.21{col 46}{space 3}0.044{col 55}{space 3}-.0284316{col 67}{space 3}-.0004358
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1986398{col 26}{space 2} .0253661{col 37}{space 1}    7.83{col 46}{space 3}0.000{col 55}{space 3}  .144235{col 67}{space 3} .2530446
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0460456{col 26}{space 2} .0101647{col 37}{space 1}    4.53{col 46}{space 3}0.000{col 55}{space 3} .0242444{col 67}{space 3} .0678468
{txt}{space 6}tenure {c |}{col 14}{result}{space 2}   .04174{col 26}{space 2} .0110597{col 37}{space 1}    3.77{col 46}{space 3}0.002{col 55}{space 3} .0180192{col 67}{space 3} .0654608
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1129929{col 26}{space 2} .0363809{col 37}{space 1}   -3.11{col 46}{space 3}0.008{col 55}{space 3}-.1910222{col 67}{space 3}-.0349635
{txt}{space 8}smsa {c |}{col 14}{result}{space 2}  .130412{col 26}{space 2} .0318716{col 37}{space 1}    4.09{col 46}{space 3}0.001{col 55}{space 3} .0620542{col 67}{space 3} .1987699
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.305194{col 26}{space 2} .4092365{col 37}{space 1}   10.52{col 46}{space 3}0.000{col 55}{space 3} 3.427469{col 67}{space 3} 5.182919
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   7.594
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0552
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  10.754
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   4.011
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.1346
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.25 20:12:14

{com}. * 1.0.6: similar to above
. * savedresults comp ivclu2 e(), include(macros: insts instd depvar scalar: N matrix: b V)  tol(1e-7) verbose
. savedresults comp ivclu2 e(), include(macros: instd depvar scalar: N matrix: b V)  tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:14

{com}. 
. * rcof "noi ivreg2 lw expr tenure rns smsa _I* (iq s = med kww mrt age) , gmm2s robust cluster(age)" == 498
. 
. * replay
. ivreg2  lw expr tenure rns smsa _I* (iq s = med kww mrt age) , robust

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   40.09
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2280
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 107.5313411{txt}{col 55}Root MSE      = {res}   .3766

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0048862{col 37}{space 1}   -1.86{col 46}{space 3}0.063{col 55}{space 3}-.0186757{col 67}{space 3}  .000478
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0207395{col 37}{space 1}    8.31{col 46}{space 3}0.000{col 55}{space 3} .1317767{col 67}{space 3} .2130739
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0080498{col 37}{space 1}    6.12{col 46}{space 3}0.000{col 55}{space 3} .0335122{col 67}{space 3} .0650668
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0094636{col 37}{space 1}    4.46{col 46}{space 3}0.000{col 55}{space 3} .0236687{col 67}{space 3} .0607655
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0337105{col 37}{space 1}   -3.02{col 46}{space 3}0.003{col 55}{space 3}-.1678649{col 67}{space 3} -.035722
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0308114{col 37}{space 1}    4.09{col 46}{space 3}0.000{col 55}{space 3} .0657218{col 67}{space 3} .1865001
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0517137{col 37}{space 1}   -1.15{col 46}{space 3}0.249{col 55}{space 3}-.1609741{col 67}{space 3} .0417399
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2} .0498132{col 37}{space 1}    0.98{col 46}{space 3}0.328{col 55}{space 3}-.0489526{col 67}{space 3} .1463117
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0479285{col 37}{space 1}    3.19{col 46}{space 3}0.001{col 55}{space 3} .0588795{col 67}{space 3} .2467558
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0611251{col 37}{space 1}    2.85{col 46}{space 3}0.004{col 55}{space 3}  .054633{col 67}{space 3} .2942391
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0554618{col 37}{space 1}    1.65{col 46}{space 3}0.098{col 55}{space 3}-.0170372{col 67}{space 3} .2003691
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2}  .060849{col 37}{space 1}    1.53{col 46}{space 3}0.125{col 55}{space 3}-.0260221{col 67}{space 3} .2125016
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3350329{col 37}{space 1}   12.04{col 46}{space 3}0.000{col 55}{space 3} 3.376857{col 67}{space 3} 4.690162
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  40.927
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  11.461
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}  11.601
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0030
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.29 20:12:14

{com}. savedresults save replay e()
{txt}r; t=0.06 20:12:15

{com}. ivreg2

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F( 12,   745) = {res}   40.09
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.2280
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9956
{txt}Residual SS             = {res} 107.5313411{txt}{col 55}Root MSE      = {res}   .3766

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2}-.0090988{col 26}{space 2} .0048862{col 37}{space 1}   -1.86{col 46}{space 3}0.063{col 55}{space 3}-.0186757{col 67}{space 3}  .000478
{txt}{space 11}s {c |}{col 14}{result}{space 2} .1724253{col 26}{space 2} .0207395{col 37}{space 1}    8.31{col 46}{space 3}0.000{col 55}{space 3} .1317767{col 67}{space 3} .2130739
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0492895{col 26}{space 2} .0080498{col 37}{space 1}    6.12{col 46}{space 3}0.000{col 55}{space 3} .0335122{col 67}{space 3} .0650668
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0422171{col 26}{space 2} .0094636{col 37}{space 1}    4.46{col 46}{space 3}0.000{col 55}{space 3} .0236687{col 67}{space 3} .0607655
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1017935{col 26}{space 2} .0337105{col 37}{space 1}   -3.02{col 46}{space 3}0.003{col 55}{space 3}-.1678649{col 67}{space 3} -.035722
{txt}{space 8}smsa {c |}{col 14}{result}{space 2} .1261109{col 26}{space 2} .0308114{col 37}{space 1}    4.09{col 46}{space 3}0.000{col 55}{space 3} .0657218{col 67}{space 3} .1865001
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0596171{col 26}{space 2} .0517137{col 37}{space 1}   -1.15{col 46}{space 3}0.249{col 55}{space 3}-.1609741{col 67}{space 3} .0417399
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0486796{col 26}{space 2} .0498132{col 37}{space 1}    0.98{col 46}{space 3}0.328{col 55}{space 3}-.0489526{col 67}{space 3} .1463117
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .1528176{col 26}{space 2} .0479285{col 37}{space 1}    3.19{col 46}{space 3}0.001{col 55}{space 3} .0588795{col 67}{space 3} .2467558
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1744361{col 26}{space 2} .0611251{col 37}{space 1}    2.85{col 46}{space 3}0.004{col 55}{space 3}  .054633{col 67}{space 3} .2942391
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2}  .091666{col 26}{space 2} .0554618{col 37}{space 1}    1.65{col 46}{space 3}0.098{col 55}{space 3}-.0170372{col 67}{space 3} .2003691
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .0932398{col 26}{space 2}  .060849{col 37}{space 1}    1.53{col 46}{space 3}0.125{col 55}{space 3}-.0260221{col 67}{space 3} .2125016
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  4.03351{col 26}{space 2} .3350329{col 37}{space 1}   12.04{col 46}{space 3}0.000{col 55}{space 3} 3.376857{col 67}{space 3} 4.690162
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  40.927
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  11.461
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 11.04
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  7.56
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  5.57
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  4.73
{txt}{col 42}10% maximal IV size{res}{col 73} 16.87
{txt}{col 42}15% maximal IV size{res}{col 73}  9.93
{txt}{col 42}20% maximal IV size{res}{col 73}  7.54
{txt}{col 42}25% maximal IV size{res}{col 73}  6.28
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}  11.601
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0030
{txt}{hline 78}
Instrumented:{col 23}iq s
Included instruments:{col 23}expr tenure rns smsa _Iyear_67 _Iyear_68 _Iyear_69
{col 23}_Iyear_70 _Iyear_71 _Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.20 20:12:15

{com}. savedresults comp replay e(), include(macros: insts instd depvar scalar: N matrix: b)  tol(1e-7) verbose
{txt}comparing macro  e(insts)
comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
r; t=0.00 20:12:15

{com}. 
. * 1.0.10 test exog regressors
. ivreg2  lw  (iq = med kww mrt age) , nocons

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F(  1,   757) = {res}47152.39
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res} -1.8086
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9841
{txt}Residual SS             = {res} 391.2024131{txt}{col 55}Root MSE      = {res}   .7184

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0546741{col 26}{space 2} .0002516{col 37}{space 1}  217.29{col 46}{space 3}0.000{col 55}{space 3} .0541809{col 67}{space 3} .0551673
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 742.997
{txt}{col 52}Chi-sq({res}4{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}9334.857
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 16.85
{txt}{col 42}10% maximal IV relative bias{res}{col 73} 10.27
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.71
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.34
{txt}{col 42}10% maximal IV size{res}{col 73} 24.58
{txt}{col 42}15% maximal IV size{res}{col 73} 13.96
{txt}{col 42}20% maximal IV size{res}{col 73} 10.26
{txt}{col 42}25% maximal IV size{res}{col 73}  8.31
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}  80.149
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
Instrumented:{col 23}iq
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.09 20:12:15

{com}. 
. * 1.0.12 test smatrix, wmatrix
. qui ivreg2  lw  (iq = med kww mrt age), gmm2s
{txt}r; t=0.10 20:12:15

{com}. savedresults save ivs e()
{txt}r; t=0.00 20:12:15

{com}. mat S=e(S)
{txt}r; t=0.00 20:12:15

{com}. mat W=e(W)
{txt}r; t=0.00 20:12:15

{com}. mat check = trace(W - syminv(S))
{txt}r; t=0.00 20:12:15

{com}. assert check[1,1] == 0
{txt}r; t=0.00 20:12:15

{com}. ivreg2  lw  (iq = med kww mrt age) , gmm2s smatrix(S)

{txt}2-Step GMM estimation
{hline 21}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F(  1,   756) = {res}   84.07
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res} -0.1923
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9933
{txt}Residual SS             = {res} 166.0674253{txt}{col 55}Root MSE      = {res}   .4681

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0285457{col 26}{space 2} .0031091{col 37}{space 1}    9.18{col 46}{space 3}0.000{col 55}{space 3} .0224519{col 67}{space 3} .0346395
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.722091{col 26}{space 2} .3233508{col 37}{space 1}    8.42{col 46}{space 3}0.000{col 55}{space 3} 2.088335{col 67}{space 3} 3.355847
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 122.360
{txt}{col 52}Chi-sq({res}4{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  36.238
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 16.85
{txt}{col 42}10% maximal IV relative bias{res}{col 73} 10.27
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.71
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.34
{txt}{col 42}10% maximal IV size{res}{col 73} 24.58
{txt}{col 42}15% maximal IV size{res}{col 73} 13.96
{txt}{col 42}20% maximal IV size{res}{col 73} 10.26
{txt}{col 42}25% maximal IV size{res}{col 73}  8.31
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71} 118.504
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
Instrumented:{col 23}iq
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.11 20:12:15

{com}. savedresults save ivss e()
{txt}r; t=0.00 20:12:15

{com}. savedresults comp ivs e(),  include(macros: instd depvar scalar: N matrix: b V) verbose tol(1e-7)
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:15

{com}. 
. ivreg2  lw  (iq = med kww mrt age) ,  wmatrix(W)

{txt}GMM estimation with user-supplied weighting matrix
{hline 50}

Efficiency of estimates dependent on weighting matrix
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F(  1,   756) = {res}   84.07
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res} -0.1923
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9933
{txt}Residual SS             = {res} 166.0674253{txt}{col 55}Root MSE      = {res}   .4681

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0285457{col 26}{space 2} .0031091{col 37}{space 1}    9.18{col 46}{space 3}0.000{col 55}{space 3} .0224519{col 67}{space 3} .0346395
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.722091{col 26}{space 2} .3233508{col 37}{space 1}    8.42{col 46}{space 3}0.000{col 55}{space 3} 2.088335{col 67}{space 3} 3.355847
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 122.360
{txt}{col 52}Chi-sq({res}4{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  36.238
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 16.85
{txt}{col 42}10% maximal IV relative bias{res}{col 73} 10.27
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.71
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.34
{txt}{col 42}10% maximal IV size{res}{col 73} 24.58
{txt}{col 42}15% maximal IV size{res}{col 73} 13.96
{txt}{col 42}20% maximal IV size{res}{col 73} 10.26
{txt}{col 42}25% maximal IV size{res}{col 73}  8.31
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71} 118.504
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
Instrumented:{col 23}iq
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.11 20:12:15

{com}. savedresults comp ivs e(),  include(macros: instd depvar scalar: N matrix: b V) verbose tol(1e-7)
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:15

{com}. assert "`e(model)'"=="gmmw"
{txt}r; t=0.00 20:12:15

{com}. savedresults comp ivss e(),  include(macros: instd depvar scalar: N matrix: b V) verbose tol(1e-7)
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:15

{com}. 
. ivreg2 lw (iq=med kww age), gmm2s

{txt}2-Step GMM estimation
{hline 21}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F(  1,   756) = {res}   87.15
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res} -0.2613
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9929
{txt}Residual SS             = {res} 175.6824998{txt}{col 55}Root MSE      = {res}   .4814

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0303929{col 26}{space 2} .0032513{col 37}{space 1}    9.35{col 46}{space 3}0.000{col 55}{space 3} .0240205{col 67}{space 3} .0367652
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.530252{col 26}{space 2} .3381172{col 37}{space 1}    7.48{col 46}{space 3}0.000{col 55}{space 3} 1.867555{col 67}{space 3}  3.19295
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 118.374
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  46.514
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 13.91
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  9.08
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.46
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.39
{txt}{col 42}10% maximal IV size{res}{col 73} 22.30
{txt}{col 42}15% maximal IV size{res}{col 73} 12.83
{txt}{col 42}20% maximal IV size{res}{col 73}  9.54
{txt}{col 42}25% maximal IV size{res}{col 73}  7.80
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71} 102.109
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
Instrumented:{col 23}iq
Excluded instruments:{col 23}med kww age
{hline 78}
r; t=0.18 20:12:15

{com}. scalar J0 = e(j)
{txt}r; t=0.00 20:12:15

{com}. mat S0 = e(S)
{txt}r; t=0.00 20:12:15

{com}. qui ivreg2 lw (iq=kww) med age, gmm2s smatrix(S0)
{txt}r; t=0.05 20:12:15

{com}. test med age

{p 0 7}{space 1}{text:( 1)}{space 1} {res}med = 0{p_end}
{p 0 7}{space 1}{text:( 2)}{space 1} age = 0{p_end}

{txt}{col 12}chi2(  2) ={res}  102.11
{txt}{col 10}Prob > chi2 =  {res}  0.0000
{txt}r; t=0.00 20:12:15

{com}. di J0
{res}102.10909
{txt}r; t=0.00 20:12:15

{com}. assert reldif(r(chi2),J0)<1.0e-7
{txt}r; t=0.00 20:12:15

{com}. qui ivreg2 lw (iq=med) kww age, gmm2s smatrix(S0)
{txt}r; t=0.05 20:12:15

{com}. test kww age

{p 0 7}{space 1}{text:( 1)}{space 1} {res}kww = 0{p_end}
{p 0 7}{space 1}{text:( 2)}{space 1} age = 0{p_end}

{txt}{col 12}chi2(  2) ={res}  102.11
{txt}{col 10}Prob > chi2 =  {res}  0.0000
{txt}r; t=0.00 20:12:15

{com}. assert reldif(r(chi2),J0)<1.0e-7
{txt}r; t=0.00 20:12:15

{com}. qui ivreg2 lw (iq=age) med kww, gmm2s smatrix(S0)
{txt}r; t=0.05 20:12:15

{com}. test med kww

{p 0 7}{space 1}{text:( 1)}{space 1} {res}med = 0{p_end}
{p 0 7}{space 1}{text:( 2)}{space 1} kww = 0{p_end}

{txt}{col 12}chi2(  2) ={res}  102.11
{txt}{col 10}Prob > chi2 =  {res}  0.0000
{txt}r; t=0.00 20:12:15

{com}. assert reldif(r(chi2),J0)<1.0e-7
{txt}r; t=0.00 20:12:15

{com}. 
. * 1.0.10 test xi
. xi: ivreg2  lw  (iq = med kww mrt age) i.year
{txt}i.year{col 19}_Iyear_66-73{col 39}(naturally coded; _Iyear_66 omitted)

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F(  7,   750) = {res}   38.39
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.1319
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9951
{txt}Residual SS             = {res} 120.9175948{txt}{col 55}Root MSE      = {res}   .3994

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0203995{col 26}{space 2} .0027783{col 37}{space 1}    7.34{col 46}{space 3}0.000{col 55}{space 3} .0149542{col 67}{space 3} .0258448
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2} -.127136{col 26}{space 2} .0576377{col 37}{space 1}   -2.21{col 46}{space 3}0.027{col 55}{space 3}-.2401039{col 67}{space 3}-.0141682
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2}-.0049702{col 26}{space 2} .0528723{col 37}{space 1}   -0.09{col 46}{space 3}0.925{col 55}{space 3}-.1085981{col 67}{space 3} .0986577
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .0994354{col 26}{space 2} .0532092{col 37}{space 1}    1.87{col 46}{space 3}0.062{col 55}{space 3}-.0048528{col 67}{space 3} .2037235
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1098624{col 26}{space 2} .0635139{col 37}{space 1}    1.73{col 46}{space 3}0.084{col 55}{space 3}-.0146226{col 67}{space 3} .2343473
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .2062518{col 26}{space 2} .0539419{col 37}{space 1}    3.82{col 46}{space 3}0.000{col 55}{space 3} .1005276{col 67}{space 3}  .311976
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2}  .308092{col 26}{space 2} .0507236{col 37}{space 1}    6.07{col 46}{space 3}0.000{col 55}{space 3} .2086755{col 67}{space 3} .4075085
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.469529{col 26}{space 2} .2759853{col 37}{space 1}   12.57{col 46}{space 3}0.000{col 55}{space 3} 2.928608{col 67}{space 3}  4.01045
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 123.188
{txt}{col 52}Chi-sq({res}4{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  36.240
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 16.85
{txt}{col 42}10% maximal IV relative bias{res}{col 73} 10.27
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.71
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.34
{txt}{col 42}10% maximal IV size{res}{col 73} 24.58
{txt}{col 42}15% maximal IV size{res}{col 73} 13.96
{txt}{col 42}20% maximal IV size{res}{col 73} 10.26
{txt}{col 42}25% maximal IV size{res}{col 73}  8.31
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71} 112.936
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}_Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71
{col 23}_Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.25 20:12:16

{com}. savedresults save ivxi e()
{txt}r; t=0.00 20:12:16

{com}. ivreg2  lw  (iq = med kww mrt age) _I*

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     758
{txt}{col 55}F(  7,   750) = {res}   38.39
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.1319
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9951
{txt}Residual SS             = {res} 120.9175948{txt}{col 55}Root MSE      = {res}   .3994

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0203995{col 26}{space 2} .0027783{col 37}{space 1}    7.34{col 46}{space 3}0.000{col 55}{space 3} .0149542{col 67}{space 3} .0258448
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2} -.127136{col 26}{space 2} .0576377{col 37}{space 1}   -2.21{col 46}{space 3}0.027{col 55}{space 3}-.2401039{col 67}{space 3}-.0141682
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2}-.0049702{col 26}{space 2} .0528723{col 37}{space 1}   -0.09{col 46}{space 3}0.925{col 55}{space 3}-.1085981{col 67}{space 3} .0986577
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .0994354{col 26}{space 2} .0532092{col 37}{space 1}    1.87{col 46}{space 3}0.062{col 55}{space 3}-.0048528{col 67}{space 3} .2037235
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2} .1098624{col 26}{space 2} .0635139{col 37}{space 1}    1.73{col 46}{space 3}0.084{col 55}{space 3}-.0146226{col 67}{space 3} .2343473
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .2062518{col 26}{space 2} .0539419{col 37}{space 1}    3.82{col 46}{space 3}0.000{col 55}{space 3} .1005276{col 67}{space 3}  .311976
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2}  .308092{col 26}{space 2} .0507236{col 37}{space 1}    6.07{col 46}{space 3}0.000{col 55}{space 3} .2086755{col 67}{space 3} .4075085
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.469529{col 26}{space 2} .2759853{col 37}{space 1}   12.57{col 46}{space 3}0.000{col 55}{space 3} 2.928608{col 67}{space 3}  4.01045
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 123.188
{txt}{col 52}Chi-sq({res}4{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  36.240
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 16.85
{txt}{col 42}10% maximal IV relative bias{res}{col 73} 10.27
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.71
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.34
{txt}{col 42}10% maximal IV size{res}{col 73} 24.58
{txt}{col 42}15% maximal IV size{res}{col 73} 13.96
{txt}{col 42}20% maximal IV size{res}{col 73} 10.26
{txt}{col 42}25% maximal IV size{res}{col 73}  8.31
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71} 112.936
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}_Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71
{col 23}_Iyear_73
Excluded instruments:{col 23}med kww mrt age
{hline 78}
r; t=0.18 20:12:16

{com}. savedresults comp ivxi e(), include(macros: instd depvar scalar: N matrix: b V)  tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:16

{com}. 
. * 1.0.14 test HAC with auto bw selection (vs Stata 10 ivregress)
. if c(version)>=10 {c -(}
. webuse lutkepohl, clear
{txt}(Quarterly SA West German macro data, Bil DM, from Lutkepohl 1993 Table E.1)
r; t=0.37 20:12:16
{com}. ivregress 2sls consumption (income=L(1/2).income) qtr L.consumption, vce(hac bartlett opt)
{res}
{txt}{col 1}Instrumental variables (2SLS) regression{col 56}Number of obs{col 70}= {res}     90
{txt}{col 1}{col 56}Wald chi2({res}3{txt}){col 70}={res} 1.9e+05
{txt}{col 1}{col 56}Prob > chi2{col 70}= {res} 0.0000
{txt}{col 1}{col 56}R-squared{col 70}={res}  0.9997
{txt}{col 56}Root MSE{col 70}= {res} 10.769

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}                 HAC
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2} .0667156{col 37}{space 1}    3.53{col 46}{space 3}0.000{col 55}{space 3} .1048534{col 67}{space 3} .3663739
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2648363{col 37}{space 1}    0.69{col 46}{space 3}0.493{col 55}{space 3}-.3375506{col 67}{space 3} .7005887
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0717118{col 37}{space 1}   10.05{col 46}{space 3}0.000{col 55}{space 3} .5804701{col 67}{space 3} .8615752
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 3.015162{col 37}{space 1}    4.15{col 46}{space 3}0.000{col 55}{space 3} 6.613766{col 67}{space 3} 18.43298
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}income{p_end}
{p 0 15 4}Instruments:{space 3}qtr L.consumption L.income L2.income{p_end}
HAC VCE:{col 16}Bartlett kernel with 19 lags
HAC Lags:{col 16}Chosen by Newey-West method
r; t=0.49 20:12:17
{com}. savedresults save ivhacau1 e()
{txt}r; t=0.00 20:12:17
{com}. local ivregressopt `e(vcelagopt)'
{txt}r; t=0.00 20:12:17
{com}. ivreg2 consumption (income=L(1/2).income) qtr L.consumption, bw(auto) robust
{res}
{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Bartlett; bandwidth=    20
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}qtr

{txt}                                   {col 55}Number of obs = {res}      90
{txt}{col 55}F(  3,    86) = {res}61576.19
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 30630397.29{txt}{col 55}Centered R2   = {res}  0.9997
{txt}Total (uncentered) SS   = {res}   156650664{txt}{col 55}Uncentered R2 = {res}  0.9999
{txt}Residual SS             = {res} 10437.12201{txt}{col 55}Root MSE      = {res}   10.77

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2} .0667156{col 37}{space 1}    3.53{col 46}{space 3}0.000{col 55}{space 3} .1048534{col 67}{space 3} .3663739
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2648363{col 37}{space 1}    0.69{col 46}{space 3}0.493{col 55}{space 3}-.3375506{col 67}{space 3} .7005886
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0717118{col 37}{space 1}   10.05{col 46}{space 3}0.000{col 55}{space 3} .5804701{col 67}{space 3} .8615752
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 3.015162{col 37}{space 1}    4.15{col 46}{space 3}0.000{col 55}{space 3} 6.613766{col 67}{space 3} 18.43298
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   3.259
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.1961
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  51.413
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   0.777
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.3781
{txt}{hline 78}
Instrumented:{col 23}income
Included instruments:{col 23}qtr L.consumption
Excluded instruments:{col 23}L.income L2.income
{hline 78}
r; t=6.83 20:12:24
{com}. savedresults compare ivhacau1 e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:24
{com}. assert `ivregressopt' + 1 == `e(bw)'
{txt}r; t=0.00 20:12:24
{com}. 
. ivreg2 consumption (income=L(1/2).income) qtr L.consumption, bw(auto) robust kernel(bartlett)
{res}
{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Bartlett; bandwidth=    20
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}qtr

{txt}                                   {col 55}Number of obs = {res}      90
{txt}{col 55}F(  3,    86) = {res}61576.19
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 30630397.29{txt}{col 55}Centered R2   = {res}  0.9997
{txt}Total (uncentered) SS   = {res}   156650664{txt}{col 55}Uncentered R2 = {res}  0.9999
{txt}Residual SS             = {res} 10437.12201{txt}{col 55}Root MSE      = {res}   10.77

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2} .0667156{col 37}{space 1}    3.53{col 46}{space 3}0.000{col 55}{space 3} .1048534{col 67}{space 3} .3663739
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2648363{col 37}{space 1}    0.69{col 46}{space 3}0.493{col 55}{space 3}-.3375506{col 67}{space 3} .7005886
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0717118{col 37}{space 1}   10.05{col 46}{space 3}0.000{col 55}{space 3} .5804701{col 67}{space 3} .8615752
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 3.015162{col 37}{space 1}    4.15{col 46}{space 3}0.000{col 55}{space 3} 6.613766{col 67}{space 3} 18.43298
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   3.259
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.1961
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  51.413
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   0.777
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.3781
{txt}{hline 78}
Instrumented:{col 23}income
Included instruments:{col 23}qtr L.consumption
Excluded instruments:{col 23}L.income L2.income
{hline 78}
r; t=6.92 20:12:31
{com}. savedresults compare ivhacau1 e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:31
{com}. assert `ivregressopt' + 1 == `e(bw)'
{txt}r; t=0.00 20:12:31
{com}. 
. ivregress 2sls consumption (income=L(1/2).income) qtr L.consumption, vce(hac parzen opt)
{res}
{txt}{col 1}Instrumental variables (2SLS) regression{col 56}Number of obs{col 70}= {res}     90
{txt}{col 1}{col 56}Wald chi2({res}3{txt}){col 70}={res} 1.5e+05
{txt}{col 1}{col 56}Prob > chi2{col 70}= {res} 0.0000
{txt}{col 1}{col 56}R-squared{col 70}={res}  0.9997
{txt}{col 56}Root MSE{col 70}= {res} 10.769

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}                 HAC
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2} .0700729{col 37}{space 1}    3.36{col 46}{space 3}0.001{col 55}{space 3} .0982733{col 67}{space 3}  .372954
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2788468{col 37}{space 1}    0.65{col 46}{space 3}0.515{col 55}{space 3}-.3650106{col 67}{space 3} .7280486
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0750828{col 37}{space 1}    9.60{col 46}{space 3}0.000{col 55}{space 3}  .573863{col 67}{space 3} .8681822
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 3.319315{col 37}{space 1}    3.77{col 46}{space 3}0.000{col 55}{space 3} 6.017636{col 67}{space 3} 19.02911
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}income{p_end}
{p 0 15 4}Instruments:{space 3}qtr L.consumption L.income L2.income{p_end}
HAC VCE:{col 16}Parzen kernel with 19 lags
HAC Lags:{col 16}Chosen by Newey-West method
r; t=0.16 20:12:31
{com}. savedresults save ivhacau2 e()
{txt}r; t=0.00 20:12:31
{com}. local ivregressopt `e(vcelagopt)'
{txt}r; t=0.00 20:12:31
{com}. ivreg2 consumption (income=L(1/2).income) qtr L.consumption, bw(auto) robust kernel(parzen)
{res}
{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Parzen; bandwidth=    20
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}qtr

{txt}                                   {col 55}Number of obs = {res}      90
{txt}{col 55}F(  3,    86) = {res}49349.73
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 30630397.29{txt}{col 55}Centered R2   = {res}  0.9997
{txt}Total (uncentered) SS   = {res}   156650664{txt}{col 55}Uncentered R2 = {res}  0.9999
{txt}Residual SS             = {res} 10437.12201{txt}{col 55}Root MSE      = {res}   10.77

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2} .0700729{col 37}{space 1}    3.36{col 46}{space 3}0.001{col 55}{space 3} .0982733{col 67}{space 3}  .372954
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2788468{col 37}{space 1}    0.65{col 46}{space 3}0.515{col 55}{space 3}-.3650106{col 67}{space 3} .7280486
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0750828{col 37}{space 1}    9.60{col 46}{space 3}0.000{col 55}{space 3}  .573863{col 67}{space 3} .8681822
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 3.319315{col 37}{space 1}    3.77{col 46}{space 3}0.000{col 55}{space 3} 6.017636{col 67}{space 3} 19.02911
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   3.590
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.1661
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  52.508
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   0.760
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.3832
{txt}{hline 78}
Instrumented:{col 23}income
Included instruments:{col 23}qtr L.consumption
Excluded instruments:{col 23}L.income L2.income
{hline 78}
r; t=6.71 20:12:37
{com}. savedresults compare ivhacau2 e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:37
{com}. assert `ivregressopt' + 1 == `e(bw)'
{txt}r; t=0.00 20:12:37
{com}. 
. ivregress 2sls consumption (income=L(1/2).income) qtr L.consumption, vce(hac qua opt)
{res}
{txt}{col 1}Instrumental variables (2SLS) regression{col 56}Number of obs{col 70}= {res}     90
{txt}{col 1}{col 56}Wald chi2({res}3{txt}){col 70}={res} 2.6e+05
{txt}{col 1}{col 56}Prob > chi2{col 70}= {res} 0.0000
{txt}{col 1}{col 56}R-squared{col 70}={res}  0.9997
{txt}{col 56}Root MSE{col 70}= {res} 10.769

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}                 HAC
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2} .0588592{col 37}{space 1}    4.00{col 46}{space 3}0.000{col 55}{space 3} .1202518{col 67}{space 3} .3509756
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2614402{col 37}{space 1}    0.69{col 46}{space 3}0.487{col 55}{space 3}-.3308944{col 67}{space 3} .6939324
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0629648{col 37}{space 1}   11.45{col 46}{space 3}0.000{col 55}{space 3}  .597614{col 67}{space 3} .8444313
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 2.986652{col 37}{space 1}    4.19{col 46}{space 3}0.000{col 55}{space 3} 6.669644{col 67}{space 3}  18.3771
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}income{p_end}
{p 0 15 4}Instruments:{space 3}qtr L.consumption L.income L2.income{p_end}
HAC VCE:{col 16}Quadratic spectral kernel with 19 lags
HAC Lags:{col 16}Chosen by Newey-West method
r; t=0.19 20:12:38
{com}. savedresults save ivhacau3 e()
{txt}r; t=0.00 20:12:38
{com}. local ivregressopt `e(vcelagopt)'
{txt}r; t=0.00 20:12:38
{com}. ivreg2 consumption (income=L(1/2).income) qtr L.consumption, bw(auto) robust kernel(qua)
{res}Computing kernel ...

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Quadratic spectral; bandwidth=    20
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}qtr

{txt}                                   {col 55}Number of obs = {res}      90
{txt}{col 55}F(  3,    86) = {res}81360.41
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 30630397.29{txt}{col 55}Centered R2   = {res}  0.9997
{txt}Total (uncentered) SS   = {res}   156650664{txt}{col 55}Uncentered R2 = {res}  0.9999
{txt}Residual SS             = {res} 10437.12201{txt}{col 55}Root MSE      = {res}   10.77

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text} consumption{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}income {c |}{col 14}{result}{space 2} .2356137{col 26}{space 2}  .058859{col 37}{space 1}    4.00{col 46}{space 3}0.000{col 55}{space 3} .1202521{col 67}{space 3} .3509752
{txt}{space 9}qtr {c |}{col 14}{result}{space 2}  .181519{col 26}{space 2} .2614413{col 37}{space 1}    0.69{col 46}{space 3}0.487{col 55}{space 3}-.3308966{col 67}{space 3} .6939346
{txt}{space 12} {c |}
{space 1}consumption {c |}
{space 9}L1. {c |}{col 14}{result}{space 2} .7210226{col 26}{space 2} .0629646{col 37}{space 1}   11.45{col 46}{space 3}0.000{col 55}{space 3} .5976143{col 67}{space 3} .8444309
{txt}{space 12} {c |}
{space 7}_cons {c |}{col 14}{result}{space 2} 12.52337{col 26}{space 2} 2.986636{col 37}{space 1}    4.19{col 46}{space 3}0.000{col 55}{space 3} 6.669676{col 67}{space 3} 18.37707
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   2.889
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.2358
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  64.365
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   0.934
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.3338
{txt}{hline 78}
Instrumented:{col 23}income
Included instruments:{col 23}qtr L.consumption
Excluded instruments:{col 23}L.income L2.income
{hline 78}
r; t=17.35 20:12:55
{com}. // note lowered tolerance
. savedresults compare ivhacau3 e(), include(macros: depvar scalar: N matrix: b V) tol(1e-4) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:55
{com}. di "`ivregressopt'  `e(bw)'"
{res}19  20
{txt}r; t=0.00 20:12:55
{com}. assert `ivregressopt' + 1 == `e(bw)'
{txt}r; t=0.00 20:12:55
{com}. {c )-}
{txt}r; t=39.04 20:12:55

{com}. 
. * 1.0.10 test by
. webuse grunfeld, clear
{txt}r; t=0.32 20:12:55

{com}. tsset company year
{res}{txt}{col 8}panel variable:  {res}company (strongly balanced)
{txt}{col 9}time variable:  {res}{col 25}year, 1935 to 1954
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.00 20:12:55

{com}. ivreg2 invest (mvalue= kstock)  if company==10

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    0.41
{txt}{col 55}Prob > F      = {res}  0.5320
{txt}Total (centered) SS     = {res} 56.12209548{txt}{col 55}Centered R2   = {res}-27.4772
{txt}Total (uncentered) SS   = {res} 246.4049012{txt}{col 55}Uncentered R2 = {res} -5.4861
{txt}Residual SS             = {res} 1598.199674{txt}{col 55}Root MSE      = {res}   8.939

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2}-.9895471{col 26}{space 2} 1.473032{col 37}{space 1}   -0.67{col 46}{space 3}0.502{col 55}{space 3}-3.876638{col 67}{space 3} 1.897543
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 73.26417{col 26}{space 2} 104.4881{col 37}{space 1}    0.70{col 46}{space 3}0.483{col 55}{space 3}-131.5287{col 67}{space 3}  278.057
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   0.451
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.5019
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   0.415
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}
r; t=0.10 20:12:55

{com}. savedresults save ivby e()
{txt}r; t=0.00 20:12:55

{com}. by company: ivreg2 invest (mvalue= kstock)

{txt}{hline}
-> company = 1

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    5.80
{txt}{col 55}Prob > F      = {res}  0.0270
{txt}Total (centered) SS     = {res} 1820892.502{txt}{col 55}Centered R2   = {res} -1.5535
{txt}Total (uncentered) SS   = {res} 9214658.977{txt}{col 55}Uncentered R2 = {res}  0.4954
{txt}Residual SS             = {res} 4649560.988{txt}{col 55}Root MSE      = {res}   482.2

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .7167992{col 26}{space 2} .2823693{col 37}{space 1}    2.54{col 46}{space 3}0.011{col 55}{space 3} .1633655{col 67}{space 3} 1.270233
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-2498.476{col 26}{space 2} 1228.485{col 37}{space 1}   -2.03{col 46}{space 3}0.042{col 55}{space 3}-4906.263{col 67}{space 3} -90.6903
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   3.753
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0527
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   4.158
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 2

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    0.43
{txt}{col 55}Prob > F      = {res}  0.5226
{txt}Total (centered) SS     = {res}   298775.32{txt}{col 55}Centered R2   = {res}-11.6139
{txt}Total (uncentered) SS   = {res} 3668569.807{txt}{col 55}Uncentered R2 = {res} -0.0273
{txt}Residual SS             = {res} 3768731.669{txt}{col 55}Root MSE      = {res}   434.1

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} 1.636872{col 26}{space 2} 2.381309{col 37}{space 1}    0.69{col 46}{space 3}0.492{col 55}{space 3}-3.030406{col 67}{space 3} 6.304151
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-2817.151{col 26}{space 2} 4696.527{col 37}{space 1}   -0.60{col 46}{space 3}0.549{col 55}{space 3}-12022.17{col 67}{space 3} 6387.872
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   0.386
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.5345
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   0.354
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 3

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    0.27
{txt}{col 55}Prob > F      = {res}  0.6089
{txt}Total (centered) SS     = {res} 44848.61921{txt}{col 55}Centered R2   = {res}-42.4768
{txt}Total (uncentered) SS   = {res} 254113.5003{txt}{col 55}Uncentered R2 = {res} -6.6732
{txt}Residual SS             = {res} 1949873.616{txt}{col 55}Root MSE      = {res}   312.2

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .8034618{col 26}{space 2} 1.463864{col 37}{space 1}    0.55{col 46}{space 3}0.583{col 55}{space 3}-2.065659{col 67}{space 3} 3.672583
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-1457.491{col 26}{space 2} 2842.693{col 37}{space 1}   -0.51{col 46}{space 3}0.608{col 55}{space 3}-7029.067{col 67}{space 3} 4114.086
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   0.280
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.5969
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   0.255
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 4

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    2.39
{txt}{col 55}Prob > F      = {res}  0.1398
{txt}Total (centered) SS     = {res} 34683.98673{txt}{col 55}Centered R2   = {res} -5.3087
{txt}Total (uncentered) SS   = {res} 183029.1333{txt}{col 55}Uncentered R2 = {res} -0.1955
{txt}Residual SS             = {res}  218811.669{txt}{col 55}Root MSE      = {res}   104.6

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .7767249{col 26}{space 2} .4770677{col 37}{space 1}    1.63{col 46}{space 3}0.103{col 55}{space 3}-.1583106{col 67}{space 3}  1.71176
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}  -452.31{col 26}{space 2} 331.5341{col 37}{space 1}   -1.36{col 46}{space 3}0.172{col 55}{space 3}-1102.105{col 67}{space 3} 197.4849
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   1.962
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.1613
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   1.958
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 5

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}   29.69
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 4370.680773{txt}{col 55}Centered R2   = {res}  0.6799
{txt}Total (uncentered) SS   = {res}  80761.6608{txt}{col 55}Uncentered R2 = {res}  0.9827
{txt}Residual SS             = {res} 1399.002862{txt}{col 55}Root MSE      = {res}   8.364

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .1716397{col 26}{space 2} .0298816{col 37}{space 1}    5.74{col 46}{space 3}0.000{col 55}{space 3} .1130727{col 67}{space 3} .2302066
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 22.07306{col 26}{space 2} 7.165074{col 37}{space 1}    3.08{col 46}{space 3}0.002{col 55}{space 3} 8.029776{col 67}{space 3} 36.11635
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  15.124
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0001
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  55.829
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 6

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}  324.34
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res}  23204.8504{txt}{col 55}Centered R2   = {res}  0.9499
{txt}Total (uncentered) SS   = {res} 84612.42832{txt}{col 55}Uncentered R2 = {res}  0.9863
{txt}Residual SS             = {res} 1161.701656{txt}{col 55}Root MSE      = {res}   7.621

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .1590435{col 26}{space 2} .0083779{col 37}{space 1}   18.98{col 46}{space 3}0.000{col 55}{space 3}  .142623{col 67}{space 3} .1754639
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-11.36578{col 26}{space 2} 3.908676{col 37}{space 1}   -2.91{col 46}{space 3}0.004{col 55}{space 3}-19.02665{col 67}{space 3} -3.70492
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  18.497
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71} 221.575
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 7

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    0.01
{txt}{col 55}Prob > F      = {res}  0.9208
{txt}Total (centered) SS     = {res} 6373.822477{txt}{col 55}Centered R2   = {res}-1.3e+03
{txt}Total (uncentered) SS   = {res} 51680.45432{txt}{col 55}Uncentered R2 = {res}-1.6e+02
{txt}Residual SS             = {res} 8340984.543{txt}{col 55}Root MSE      = {res}   645.8

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} 20.21339{col 26}{space 2} 190.2317{col 37}{space 1}    0.11{col 46}{space 3}0.915{col 55}{space 3}-352.6339{col 67}{space 3} 393.0607
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-2980.169{col 26}{space 2} 28495.17{col 37}{space 1}   -0.10{col 46}{space 3}0.917{col 55}{space 3}-58829.68{col 67}{space 3} 52869.35
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   0.011
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.9158
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   0.010
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 8

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}   31.33
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 6938.786873{txt}{col 55}Centered R2   = {res}  0.6703
{txt}Total (uncentered) SS   = {res} 43732.40264{txt}{col 55}Uncentered R2 = {res}  0.9477
{txt}Residual SS             = {res} 2287.765808{txt}{col 55}Root MSE      = {res}    10.7

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .0877782{col 26}{space 2} .0148763{col 37}{space 1}    5.90{col 46}{space 3}0.000{col 55}{space 3} .0586212{col 67}{space 3} .1169352
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-15.99976{col 26}{space 2} 10.26318{col 37}{space 1}   -1.56{col 46}{space 3}0.119{col 55}{space 3}-36.11522{col 67}{space 3} 4.115711
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  11.001
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0009
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  22.004
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 9

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}   12.85
{txt}{col 55}Prob > F      = {res}  0.0021
{txt}Total (centered) SS     = {res} 4207.536721{txt}{col 55}Centered R2   = {res}  0.2039
{txt}Total (uncentered) SS   = {res} 39301.30352{txt}{col 55}Uncentered R2 = {res}  0.9148
{txt}Residual SS             = {res} 3349.675955{txt}{col 55}Root MSE      = {res}   12.94

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2} .2398443{col 26}{space 2} .0634648{col 37}{space 1}    3.78{col 46}{space 3}0.000{col 55}{space 3} .1154555{col 67}{space 3}  .364233
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-38.13504{col 26}{space 2} 21.37186{col 37}{space 1}   -1.78{col 46}{space 3}0.074{col 55}{space 3}-80.02311{col 67}{space 3} 3.753025
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   7.334
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0068
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}  10.422
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}

{hline}
-> company = 10

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}      20
{txt}{col 55}F(  1,    18) = {res}    0.41
{txt}{col 55}Prob > F      = {res}  0.5320
{txt}Total (centered) SS     = {res} 56.12209548{txt}{col 55}Centered R2   = {res}-27.4772
{txt}Total (uncentered) SS   = {res} 246.4049012{txt}{col 55}Uncentered R2 = {res} -5.4861
{txt}Residual SS             = {res} 1598.199674{txt}{col 55}Root MSE      = {res}   8.939

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2}-.9895471{col 26}{space 2} 1.473032{col 37}{space 1}   -0.67{col 46}{space 3}0.502{col 55}{space 3}-3.876638{col 67}{space 3} 1.897543
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 73.26417{col 26}{space 2} 104.4881{col 37}{space 1}    0.70{col 46}{space 3}0.483{col 55}{space 3}-131.5287{col 67}{space 3}  278.057
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   0.451
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.5019
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   0.415
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}
r; t=1.41 20:12:57

{com}. savedresults comp ivby e(), include(macros: instd depvar scalar: N matrix: b V)  tol(1e-7) verbose
{txt}comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:12:57

{com}. 
. * 1.0.10 test bootstrap
. set seed 20070203
{txt}r; t=0.00 20:12:57

{com}. bootstrap, reps(100) saving(ivbs,replace): ivreg invest (mvalue= kstock) 
{txt}(running ivreg on estimation sample)

Bootstrap replications ({res}100{txt})
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
..................................................    50
..................................................   100
{res}
{txt}Instrumental variables (2SLS) regression{col 49}Number of obs{col 68}= {res}      200
{txt}{col 49}Replications{col 68}= {res}      100
{txt}{col 49}Wald chi2({res}1{txt}){col 68}= {res}    93.13
{txt}{col 49}Prob > chi2{col 68}= {res}   0.0000
{txt}{col 49}R-squared{col 68}= {res}   0.4855
{txt}{col 49}Adj R-squared{col 68}= {res}   0.4829
{txt}{col 49}Root MSE{col 68}= {res} 155.9525

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}   Observed{col 26}   Bootstrap{col 55}        Normal-based
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2}  .223687{col 26}{space 2} .0231794{col 37}{space 1}    9.65{col 46}{space 3}0.000{col 55}{space 3} .1782562{col 67}{space 3} .2691178
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-95.99972{col 26}{space 2}  25.9316{col 37}{space 1}   -3.70{col 46}{space 3}0.000{col 55}{space 3}-146.8247{col 67}{space 3}-45.17473
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}mvalue{p_end}
{p 0 15 4}Instruments:{space 3}kstock{p_end}
{hline 78}
r; t=1.32 20:12:58

{com}. set seed 20070203
{txt}r; t=0.00 20:12:58

{com}. bootstrap, reps(100) saving(iv2bs,replace): ivreg2 invest (mvalue= kstock) 
{txt}(running ivreg2 on estimation sample)

Bootstrap replications ({res}100{txt})
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
..................................................    50
..................................................   100
{res}
{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     200
{txt}{col 55}F(  1,   198) = {res}       .
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 9359943.917{txt}{col 55}Centered R2   = {res}  0.4855
{txt}Total (uncentered) SS   = {res} 13620706.07{txt}{col 55}Uncentered R2 = {res}  0.6465
{txt}Residual SS             = {res} 4815592.122{txt}{col 55}Root MSE      = {res}   155.2

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}   Observed{col 26}   Bootstrap{col 55}        Normal-based
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 6}mvalue {c |}{col 14}{result}{space 2}  .223687{col 26}{space 2} .0231794{col 37}{space 1}    9.65{col 46}{space 3}0.000{col 55}{space 3} .1782562{col 67}{space 3} .2691178
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-95.99972{col 26}{space 2}  25.9316{col 37}{space 1}   -3.70{col 46}{space 3}0.000{col 55}{space 3}-146.8247{col 67}{space 3}-45.17473
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  47.767
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  62.127
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 16.38
{txt}{col 42}15% maximal IV size{res}{col 73}  8.96
{txt}{col 42}20% maximal IV size{res}{col 73}  6.66
{txt}{col 42}25% maximal IV size{res}{col 73}  5.53
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.000
{txt}{col 50}(equation exactly identified)
{hline 78}
Instrumented:{col 23}mvalue
Excluded instruments:{col 23}kstock
{hline 78}
r; t=5.32 20:13:03

{com}. use iv2bs,clear
{txt}(bootstrap: ivreg2)
r; t=0.00 20:13:03

{com}. cf _all using ivbs
{txt}r; t=0.21 20:13:04

{com}. 
. * 1.0.10 test jackknife
. webuse grunfeld, clear
{txt}r; t=0.29 20:13:04

{com}. set seed 20070203
{txt}r; t=0.00 20:13:04

{com}. jackknife _b _se, eclass: ivreg invest (mvalue= kstock) 
{txt}(running ivreg on estimation sample)

Jackknife replications ({res}200{txt})
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
{res}
{txt}Jackknife results{col 49}Number of obs{col 68}= {res}      200
{txt}{col 49}Replications{col 68}= {res}      200

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}              Jackknife
{col 14}{text}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{res}b            {txt}{c |}
{space 6}mvalue {c |}{col 14}{result}{space 2}  .223687{col 26}{space 2}  .025994{col 37}{space 1}    8.61{col 46}{space 3}0.000{col 55}{space 3}  .172428{col 67}{space 3}  .274946
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-95.99972{col 26}{space 2} 28.05725{col 37}{space 1}   -3.42{col 46}{space 3}0.001{col 55}{space 3}-151.3274{col 67}{space 3}-40.67205
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{res}se           {txt}{c |}
{space 6}mvalue {c |}{col 14}{result}{space 2} .0172095{col 26}{space 2}   .00521{col 37}{space 1}    3.30{col 46}{space 3}0.001{col 55}{space 3} .0069356{col 67}{space 3} .0274833
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 21.63632{col 26}{space 2} 5.514405{col 37}{space 1}    3.92{col 46}{space 3}0.000{col 55}{space 3} 10.76215{col 67}{space 3} 32.51048
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
r; t=1.57 20:13:06

{com}. savedresults save ivjk e()
{txt}r; t=0.00 20:13:06

{com}. set seed 20070203
{txt}r; t=0.00 20:13:06

{com}. jackknife _b _se, eclass: ivreg2 invest (mvalue= kstock), small
{txt}(running ivreg2 on estimation sample)

Jackknife replications ({res}200{txt})
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
{res}
{txt}Jackknife results{col 49}Number of obs{col 68}= {res}      200
{txt}{col 49}Replications{col 68}= {res}      200

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}              Jackknife
{col 14}{text}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{res}b            {txt}{c |}
{space 6}mvalue {c |}{col 14}{result}{space 2}  .223687{col 26}{space 2}  .025994{col 37}{space 1}    8.61{col 46}{space 3}0.000{col 55}{space 3}  .172428{col 67}{space 3}  .274946
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-95.99972{col 26}{space 2} 28.05725{col 37}{space 1}   -3.42{col 46}{space 3}0.001{col 55}{space 3}-151.3274{col 67}{space 3}-40.67205
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{res}se           {txt}{c |}
{space 6}mvalue {c |}{col 14}{result}{space 2} .0172095{col 26}{space 2}   .00521{col 37}{space 1}    3.30{col 46}{space 3}0.001{col 55}{space 3} .0069356{col 67}{space 3} .0274833
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 21.63632{col 26}{space 2} 5.514405{col 37}{space 1}    3.92{col 46}{space 3}0.000{col 55}{space 3} 10.76215{col 67}{space 3} 32.51048
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
r; t=10.00 20:13:16

{com}. savedresults compare ivjk e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:13:16

{com}. 
. * 1.0.10 test svy (jackknife) FAILS
. // use http://www.stata-press.com/data/r9/hsng2.dta, clear
. // svyset _n
. // set seed 20070203
. // svy: ivreg rent pcturban (hsngval = faminc reg2-reg4), vce(jackknife)
. // savedresults save ivsj e()
. // set seed 20070203
. // svy: ivreg2 rent pcturban (hsngval = faminc reg2-reg4) // , vce(jackknife)
. // savedresults compare ivsj e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
. 
. * 1.0.13 test HAC with aw (vs Stata 10 ivregress) 
. if c(version) >= 10 {c -(}
. use http://fmwww.bc.edu/ec-p/data/wooldridge/phillips.dta, clear
{txt}r; t=0.04 20:13:16
{com}. tsset year,yearly
{res}{txt}{col 9}time variable:  {res}{col 25}year, 1948 to 1996
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.00 20:13:16
{com}. ivregress 2sls cinf unem [aw=year], vce(hac bartlett 2)  small
{txt}(sum of wgt is   9.4680e+04)
{res}
{txt}{col 1}Instrumental variables (2SLS) regression{col 56}Number of obs{col 70}= {res}     48
{txt}{col 1}{col 56}F(  1,    46){col 70}={res}    6.08
{txt}{col 1}{col 56}Prob > F{col 70}= {res} 0.0174
{txt}{col 1}{col 56}R-squared{col 70}={res}  0.1089
{txt}{col 1}{col 56}Adj R-squared{col 70}={res}  0.0895
{txt}{col 56}Root MSE{col 70}= {res} 2.4426

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}                 HAC
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.5439774{col 26}{space 2} .2205366{col 37}{space 1}   -2.47{col 46}{space 3}0.017{col 55}{space 3}-.9878946{col 67}{space 3}-.1000602
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.042442{col 26}{space 2} 1.384731{col 37}{space 1}    2.20{col 46}{space 3}0.033{col 55}{space 3}  .255123{col 67}{space 3} 5.829762
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
(no endogenous regressors)
HAC VCE:{col 16}Bartlett kernel with 2 lags
r; t=0.10 20:13:16
{com}. savedresults save ivhacaw1 e()
{txt}r; t=0.00 20:13:16
{com}. ivreg2 cinf unem [aw=year], bw(3)  robust small
{txt}(sum of wgt is     9.4680e+04)

OLS estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Bartlett; bandwidth=     3
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      48
{txt}{col 55}F(  1,    46) = {res}    6.08
{txt}{col 55}Prob > F      = {res}  0.0174
{txt}Total (centered) SS     = {res} 307.9870366{txt}{col 55}Centered R2   = {res}  0.1089
{txt}Total (uncentered) SS   = {res} 308.5213273{txt}{col 55}Uncentered R2 = {res}  0.1104
{txt}Residual SS             = {res} 274.4525197{txt}{col 55}Root MSE      = {res}   2.443

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.5439774{col 26}{space 2} .2205366{col 37}{space 1}   -2.47{col 46}{space 3}0.017{col 55}{space 3}-.9878946{col 67}{space 3}-.1000602
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.042442{col 26}{space 2} 1.384731{col 37}{space 1}    2.20{col 46}{space 3}0.033{col 55}{space 3}  .255123{col 67}{space 3} 5.829762
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
Included instruments:{col 23}unem
{hline 78}
r; t=0.12 20:13:16
{com}. savedresults compare ivhacaw1 e(), include(macros: depvar scalar: N matrix: b V) tol(1e-6) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:13:16
{com}. 
. use http://fmwww.bc.edu/ec-p/data/wooldridge/phillips.dta, clear
{txt}r; t=0.04 20:13:16
{com}. tsset year,yearly
{res}{txt}{col 9}time variable:  {res}{col 25}year, 1948 to 1996
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.00 20:13:16
{com}. ivregress 2sls cinf (unem=L(1/2).unem) [aw=year], vce(hac bartlett 2)  small
{txt}(sum of wgt is   9.2731e+04)
{res}
{txt}{col 1}Instrumental variables (2SLS) regression{col 56}Number of obs{col 70}= {res}     47
{txt}{col 1}{col 56}F(  1,    45){col 70}={res}    1.59
{txt}{col 1}{col 56}Prob > F{col 70}= {res} 0.2142
{txt}{col 1}{col 56}R-squared{col 70}={res}  0.1378
{txt}{col 1}{col 56}Adj R-squared{col 70}={res}  0.1186
{txt}{col 56}Root MSE{col 70}= {res} 2.0654

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}                 HAC
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.4114151{col 26}{space 2} .3265695{col 37}{space 1}   -1.26{col 46}{space 3}0.214{col 55}{space 3} -1.06916{col 67}{space 3} .2463295
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.467587{col 26}{space 2} 1.983225{col 37}{space 1}    1.24{col 46}{space 3}0.220{col 55}{space 3}-1.526833{col 67}{space 3} 6.462007
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}unem{p_end}
{p 0 15 4}Instruments:{space 3}L.unem L2.unem{p_end}
HAC VCE:{col 16}Bartlett kernel with 2 lags
r; t=0.12 20:13:16
{com}. savedresults save ivhacaw2 e()
{txt}r; t=0.00 20:13:16
{com}. ivreg2 cinf (unem=L(1/2).unem) [aw=year], bw(3)  robust small
{txt}(sum of wgt is     9.2731e+04)

IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Bartlett; bandwidth=     3
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      47
{txt}{col 55}F(  1,    45) = {res}    1.59
{txt}{col 55}Prob > F      = {res}  0.2142
{txt}Total (centered) SS     = {res} 222.6433667{txt}{col 55}Centered R2   = {res}  0.1378
{txt}Total (uncentered) SS   = {res}  223.005221{txt}{col 55}Uncentered R2 = {res}  0.1392
{txt}Residual SS             = {res} 191.9690814{txt}{col 55}Root MSE      = {res}   2.065

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.4114151{col 26}{space 2} .3265695{col 37}{space 1}   -1.26{col 46}{space 3}0.214{col 55}{space 3} -1.06916{col 67}{space 3} .2463295
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.467587{col 26}{space 2} 1.983225{col 37}{space 1}    1.24{col 46}{space 3}0.220{col 55}{space 3}-1.526833{col 67}{space 3} 6.462007
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   6.058
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0484
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  38.172
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   2.899
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0886
{txt}{hline 78}
Instrumented:{col 23}unem
Excluded instruments:{col 23}L.unem L2.unem
{hline 78}
r; t=0.78 20:13:17
{com}. savedresults compare ivhacaw2 e(), include(macros: depvar scalar: N matrix: b V) tol(1e-6) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:13:17
{com}. {c )-}
{txt}r; t=1.25 20:13:17

{com}. 
. * test partial() with TS ops 
. use http://fmwww.bc.edu/ec-p/data/wooldridge/phillips.dta, clear
{txt}r; t=0.04 20:13:17

{com}. tsset year,yearly
{res}{txt}{col 9}time variable:  {res}{col 25}year, 1948 to 1996
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.00 20:13:17

{com}. rcof "noi ivreg2 cinf (unem=L(1/2).unem) L.year, partial(L.year)" == 101
{err}factor variables and time-series operators not allowed
{txt}r; t=0.03 20:13:17

{com}. 
. * test absence of ranktest (specific to Mac OS X file location)
. if "$S_OS" == "MacOSX" & c(version)>=10 {c -(}
.     findfile ranktest.ado
{txt}~/library/application support/stata/ado/plus/r/ranktest.ado
r; t=0.00 20:13:17
{com}.     cd ~
{res}/Users/baum/
{txt}r; t=0.00 20:13:17
{com}.     cd "library/application support/stata/ado/plus/r"
{res}/Users/baum/Library/Application Support/Stata/ado/plus/r/
{txt}r; t=0.00 20:13:17
{com}.     !mv ranktest.ado ranktest.ado.disabled
{txt}
r; t=0.05 20:13:17
{com}.     program drop _all
{txt}r; t=0.00 20:13:17
{com}.     rcof "noi ivreg2 cinf (unem=L(1/2).unem) [aw=year], bw(3)  robust small" == 601
{err}Error: must have ranktest version 01.1.03 or greater installed
To install, from within Stata type {stata ssc install ranktest :ssc install ranktest}
{txt}r; t=0.03 20:13:17
{com}.     !mv ranktest.ado.disabled ranktest.ado
{txt}
r; t=0.01 20:13:17
{com}. {c )-}
{txt}r; t=0.11 20:13:17

{com}. 
. * 1.0.10 test statsby
. use http://fmwww.bc.edu/ec-p/data/wooldridge/phillips.dta, clear
{txt}r; t=0.04 20:13:17

{com}. tsset year,yearly
{res}{txt}{col 9}time variable:  {res}{col 25}year, 1948 to 1996
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.05 20:13:17

{com}. egen quin = cut(year),group(7)
{txt}r; t=0.07 20:13:17

{com}. statsby _b _se, by(quin) saving(quin,replace): ivreg unem (inf=L.inf L2.inf)
{txt}(running ivreg on estimation sample)
{p2colset 7 17 21 2}{...}

{p2col :command:}ivreg unem (inf=L.inf L2.inf){p_end}
           by:  quin

Statsby groups
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
.......
r; t=0.12 20:13:17

{com}. statsby _b _se, by(quin) saving(quin2,replace): ivreg2 unem (inf=L.inf L2.inf), small
{txt}(running ivreg2 on estimation sample)
{p2colset 7 17 21 2}{...}

{p2col :command:}ivreg2 unem (inf=L.inf L2.inf), small{p_end}
           by:  quin

Statsby groups
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
.......
r; t=0.67 20:13:18

{com}. use quin2,clear
{txt}(statsby: ivreg2)
r; t=0.00 20:13:18

{com}. cf _all using quin
{txt}r; t=0.01 20:13:18

{com}. 
. * 1.0.10 test rolling
. use http://fmwww.bc.edu/ec-p/data/wooldridge/phillips.dta, clear
{txt}r; t=0.05 20:13:18

{com}. tsset year,yearly
{res}{txt}{col 9}time variable:  {res}{col 25}year, 1948 to 1996
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.00 20:13:18

{com}. rolling, window(10) saving(rolliv,replace): ivreg unem (inf=L.inf L2.inf)
{txt}(running ivreg on estimation sample)

Rolling replications ({res}40{txt})
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
........................................
file rolliv.dta saved
r; t=0.33 20:13:18

{com}. rolling, window(10) saving(rolliv2,replace): ivreg2 unem (inf=L.inf L2.inf), small
{txt}(running ivreg2 on estimation sample)

Rolling replications ({res}40{txt})
{hline 4}{c +}{hline 3} 1 {hline 3}{c +}{hline 3} 2 {hline 3}{c +}{hline 3} 3 {hline 3}{c +}{hline 3} 4 {hline 3}{c +}{hline 3} 5 
........................................
file rolliv2.dta saved
r; t=1.97 20:13:20

{com}. use rolliv2
{txt}(rolling: ivreg2)
r; t=0.00 20:13:20

{com}. cf _all using rolliv
{txt}r; t=0.00 20:13:20

{com}. 
. * 1.0.7 test fweights
. use http://fmwww.bc.edu/ec-p/data/hayashi/griliches76.dta,clear
{txt}(Wages of Very Young Men, Zvi Griliches, J.Pol.Ec. 1976)
r; t=0.14 20:13:20

{com}. ivreg2 lw80 expr80 tenure80 rns80 smsa80 (s80 = med kww) [fw=age], ffirst gmm2s
{txt}(sum of wgt is     1.6551e+04)


Summary results for first-stage regressions
{hline 43}

Variable    |{col 15}{help ivreg2##partialr2:Shea Partial R2}{col 31}|{col 35}{help ivreg2##partialr2:Partial R2}{col 49}|{col 52}{help ivreg2##partialr2:F}{col 53}({res}{col 54}  2{txt},{res} 16544{txt})    P-value
{res}s80         {col 13}{txt}|{col 17}{res}  0.2305{col 31}{txt}|{col 35}{res}  0.2305{col 49}{txt}|{col 54}{res} 2477.47{col 67}  0.0000

{help ivreg2##idtest:Underidentification tests}
{txt}Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
{res}Anderson canon. corr. N*CCEV LM statistic{txt}{col 45}Chi-sq({res}2{txt})={res}3814.57{col 64}{txt}P-val={res}0.0000
Cragg-Donald N*CDEV Wald statistic{txt}{col 45}Chi-sq({res}2{txt})={res}4957.04{col 64}{txt}P-val={res}0.0000

{help ivreg2##widtest:Weak identification test}
{txt}Ho: equation is weakly identified
{res}Cragg-Donald Wald F-statistic{col 49} 2477.47
{txt}See main output for Cragg-Donald weak id test critical values

{help ivreg2##wirobust:Weak-instrument-robust inference}
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and overidentifying restrictions are valid
{res}Anderson-Rubin Wald test{txt}{col 30}F({res}2{txt},{res}16544{txt})={col 40}{res}936.55 {col 50}{txt}P-val={res}0.0000
Anderson-Rubin Wald test{txt}{col 30}Chi-sq({res}2{txt})={col 40}{res}1873.89{col 50}{txt}P-val={res}0.0000
Stock-Wright LM S statistic{txt}{col 30}Chi-sq({res}2{txt})={col 40}{res}1683.31{col 50}{txt}P-val={res}0.0000

{txt}Number of observations               N  = {res}     16551
{txt}Number of regressors                 K  = {res}         6
{txt}Number of instruments                L  = {res}         7
{txt}Number of excluded instruments       L1 = {res}         2

{txt}2-Step GMM estimation
{hline 21}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}   16551
{txt}{col 55}F(  5, 16545) = {res}  675.08
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 2762.975861{txt}{col 55}Centered R2   = {res}  0.1278
{txt}Total (uncentered) SS   = {res}  776929.016{txt}{col 55}Uncentered R2 = {res}  0.9969
{txt}Residual SS             = {res} 2409.991856{txt}{col 55}Root MSE      = {res}   .3816

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}        lw80{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 9}s80 {c |}{col 14}{result}{space 2} .1306858{col 26}{space 2} .0031105{col 37}{space 1}   42.01{col 46}{space 3}0.000{col 55}{space 3} .1245894{col 67}{space 3} .1367822
{txt}{space 6}expr80 {c |}{col 14}{result}{space 2} .0358413{col 26}{space 2} .0010795{col 37}{space 1}   33.20{col 46}{space 3}0.000{col 55}{space 3} .0337256{col 67}{space 3} .0379571
{txt}{space 4}tenure80 {c |}{col 14}{result}{space 2} .0049926{col 26}{space 2} .0006208{col 37}{space 1}    8.04{col 46}{space 3}0.000{col 55}{space 3} .0037758{col 67}{space 3} .0062094
{txt}{space 7}rns80 {c |}{col 14}{result}{space 2}-.0465008{col 26}{space 2} .0066264{col 37}{space 1}   -7.02{col 46}{space 3}0.000{col 55}{space 3}-.0594883{col 67}{space 3}-.0335134
{txt}{space 6}smsa80 {c |}{col 14}{result}{space 2} .1738141{col 26}{space 2} .0066705{col 37}{space 1}   26.06{col 46}{space 3}0.000{col 55}{space 3} .1607403{col 67}{space 3}  .186888
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.473525{col 26}{space 2} .0520023{col 37}{space 1}   86.03{col 46}{space 3}0.000{col 55}{space 3} 4.371602{col 67}{space 3} 4.575447
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}3814.574
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}2477.473
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.731
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.3926
{txt}{hline 78}
Instrumented:{col 23}s80
Included instruments:{col 23}expr80 tenure80 rns80 smsa80
Excluded instruments:{col 23}med kww
{hline 78}
r; t=0.29 20:13:21

{com}. savedresults save fw e()
{txt}r; t=0.00 20:13:21

{com}. expand age
{txt}(15793 observations created)
r; t=7.22 20:13:28

{com}. ivreg2 lw80 expr80 tenure80 rns80 smsa80 (s80 = med kww), ffirst gmm2s


{txt}Summary results for first-stage regressions
{hline 43}

Variable    |{col 15}{help ivreg2##partialr2:Shea Partial R2}{col 31}|{col 35}{help ivreg2##partialr2:Partial R2}{col 49}|{col 52}{help ivreg2##partialr2:F}{col 53}({res}{col 54}  2{txt},{res} 16544{txt})    P-value
{res}s80         {col 13}{txt}|{col 17}{res}  0.2305{col 31}{txt}|{col 35}{res}  0.2305{col 49}{txt}|{col 54}{res} 2477.47{col 67}  0.0000

{help ivreg2##idtest:Underidentification tests}
{txt}Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
{res}Anderson canon. corr. N*CCEV LM statistic{txt}{col 45}Chi-sq({res}2{txt})={res}3814.57{col 64}{txt}P-val={res}0.0000
Cragg-Donald N*CDEV Wald statistic{txt}{col 45}Chi-sq({res}2{txt})={res}4957.04{col 64}{txt}P-val={res}0.0000

{help ivreg2##widtest:Weak identification test}
{txt}Ho: equation is weakly identified
{res}Cragg-Donald Wald F-statistic{col 49} 2477.47
{txt}See main output for Cragg-Donald weak id test critical values

{help ivreg2##wirobust:Weak-instrument-robust inference}
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and overidentifying restrictions are valid
{res}Anderson-Rubin Wald test{txt}{col 30}F({res}2{txt},{res}16544{txt})={col 40}{res}936.55 {col 50}{txt}P-val={res}0.0000
Anderson-Rubin Wald test{txt}{col 30}Chi-sq({res}2{txt})={col 40}{res}1873.89{col 50}{txt}P-val={res}0.0000
Stock-Wright LM S statistic{txt}{col 30}Chi-sq({res}2{txt})={col 40}{res}1683.31{col 50}{txt}P-val={res}0.0000

{txt}Number of observations               N  = {res}     16551
{txt}Number of regressors                 K  = {res}         6
{txt}Number of instruments                L  = {res}         7
{txt}Number of excluded instruments       L1 = {res}         2

{txt}2-Step GMM estimation
{hline 21}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}   16551
{txt}{col 55}F(  5, 16545) = {res}  675.08
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 2762.975861{txt}{col 55}Centered R2   = {res}  0.1278
{txt}Total (uncentered) SS   = {res}  776929.016{txt}{col 55}Uncentered R2 = {res}  0.9969
{txt}Residual SS             = {res} 2409.991856{txt}{col 55}Root MSE      = {res}   .3816

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}        lw80{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 9}s80 {c |}{col 14}{result}{space 2} .1306858{col 26}{space 2} .0031105{col 37}{space 1}   42.01{col 46}{space 3}0.000{col 55}{space 3} .1245894{col 67}{space 3} .1367822
{txt}{space 6}expr80 {c |}{col 14}{result}{space 2} .0358413{col 26}{space 2} .0010795{col 37}{space 1}   33.20{col 46}{space 3}0.000{col 55}{space 3} .0337256{col 67}{space 3} .0379571
{txt}{space 4}tenure80 {c |}{col 14}{result}{space 2} .0049926{col 26}{space 2} .0006208{col 37}{space 1}    8.04{col 46}{space 3}0.000{col 55}{space 3} .0037758{col 67}{space 3} .0062094
{txt}{space 7}rns80 {c |}{col 14}{result}{space 2}-.0465008{col 26}{space 2} .0066264{col 37}{space 1}   -7.02{col 46}{space 3}0.000{col 55}{space 3}-.0594883{col 67}{space 3}-.0335134
{txt}{space 6}smsa80 {c |}{col 14}{result}{space 2} .1738141{col 26}{space 2} .0066705{col 37}{space 1}   26.06{col 46}{space 3}0.000{col 55}{space 3} .1607403{col 67}{space 3}  .186888
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.473525{col 26}{space 2} .0520023{col 37}{space 1}   86.03{col 46}{space 3}0.000{col 55}{space 3} 4.371602{col 67}{space 3} 4.575447
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}3814.574
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}2477.473
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.731
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.3926
{txt}{hline 78}
Instrumented:{col 23}s80
Included instruments:{col 23}expr80 tenure80 rns80 smsa80
Excluded instruments:{col 23}med kww
{hline 78}
r; t=0.93 20:13:29

{com}. savedresults comp fw e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:13:29

{com}. qui duplicates drop
{txt}r; t=0.37 20:13:29

{com}. 
. * sw option for within estimator
. webuse grunfeld, clear
{txt}r; t=0.31 20:13:30

{com}. center invest mvalue kstock time, casewise double
{txt}r; t=0.07 20:13:30

{com}. ivreg2  c_invest (c_mvalue=c_kstock c_time) , robust sw i(company) nocons dofminus(10)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Stock-Watson heteroskedastic-robust statistics (BETA VERSION)

                                   {col 55}Number of obs = {res}     200
{txt}{col 55}F(  1,   189) = {res}   79.16
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 9359943.917{txt}{col 55}Centered R2   = {res}  0.5883
{txt}Total (uncentered) SS   = {res} 9359943.917{txt}{col 55}Uncentered R2 = {res}  0.5883
{txt}Residual SS             = {res} 3853579.492{txt}{col 55}Root MSE      = {res}   142.4

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}    c_invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 4}c_mvalue {c |}{col 14}{result}{space 2} .2044383{col 26}{space 2} .0229166{col 37}{space 1}    8.92{col 46}{space 3}0.000{col 55}{space 3} .1595225{col 67}{space 3} .2493541
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  10.398
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0055
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  53.782
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   8.089
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0045
{txt}{hline 78}
Instrumented:{col 23}c_mvalue
Excluded instruments:{col 23}c_kstock c_time
{hline 78}
r; t=0.10 20:13:30

{com}. ivreg2  c_invest (c_mvalue=c_kstock c_time) , robust gmm2s sw i(company) nocons dofminus(10)

{txt}2-Step GMM estimation
{hline 21}

Estimates efficient for arbitrary heteroskedasticity
Stock-Watson heteroskedastic-robust statistics (BETA VERSION)

                                   {col 55}Number of obs = {res}     200
{txt}{col 55}F(  1,   189) = {res}   71.84
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 9359943.917{txt}{col 55}Centered R2   = {res}  0.6484
{txt}Total (uncentered) SS   = {res} 9359943.917{txt}{col 55}Uncentered R2 = {res}  0.6484
{txt}Residual SS             = {res} 3290546.276{txt}{col 55}Root MSE      = {res}   131.6

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}    c_invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 4}c_mvalue {c |}{col 14}{result}{space 2} .1897398{col 26}{space 2} .0223263{col 37}{space 1}    8.50{col 46}{space 3}0.000{col 55}{space 3} .1459811{col 67}{space 3} .2334986
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  10.398
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0055
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  53.782
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   8.089
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0045
{txt}{hline 78}
Instrumented:{col 23}c_mvalue
Excluded instruments:{col 23}c_kstock c_time
{hline 78}
r; t=0.10 20:13:30

{com}. 
. * ensure no inappropriate dropping of endog. regressors
. 
. qui {c -(}
{txt}r; t=0.00 20:13:30

{com}. ivreg invest li2 (li1 lk1 dlk1 = lk2 lk3 lk4 lk5)

{txt}Instrumental variables (2SLS) regression

      Source {c |}       SS       df       MS              Number of obs ={res}     150
{txt}{hline 13}{char +}{hline 30}           F(  4,   145) ={res}  553.62
    {txt}   Model {char |} {res} 7901710.45     4  1975427.61           {txt}Prob > F      = {res} 0.0000
    {txt}Residual {char |} {res} 500872.864   145  3454.29561           {txt}R-squared     = {res} 0.9404
{txt}{hline 13}{char +}{hline 30}           Adj R-squared = {res} 0.9387
    {txt}   Total {char |} {res} 8402583.31   149  56393.1766           {txt}Root MSE      = {res} 58.773

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 9}li1 {c |}{col 14}{result}{space 2} .8137191{col 26}{space 2} .4644613{col 37}{space 1}    1.75{col 46}{space 3}0.082{col 55}{space 3}-.1042699{col 67}{space 3} 1.731708
{txt}{space 9}lk1 {c |}{col 14}{result}{space 2} .1494245{col 26}{space 2} .0507281{col 37}{space 1}    2.95{col 46}{space 3}0.004{col 55}{space 3} .0491625{col 67}{space 3} .2496866
{txt}{space 8}dlk1 {c |}{col 14}{result}{space 2}-1.004987{col 26}{space 2} .3609646{col 37}{space 1}   -2.78{col 46}{space 3}0.006{col 55}{space 3}-1.718419{col 67}{space 3}-.2915551
{txt}{space 9}li2 {c |}{col 14}{result}{space 2}  .349771{col 26}{space 2}  .525725{col 37}{space 1}    0.67{col 46}{space 3}0.507{col 55}{space 3}-.6893033{col 67}{space 3} 1.388845
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-23.53724{col 26}{space 2} 10.45931{col 37}{space 1}   -2.25{col 46}{space 3}0.026{col 55}{space 3}-44.20965{col 67}{space 3}-2.864832
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}li1 lk1 dlk1{p_end}
{p 0 15 4}Instruments:{space 3}li2 lk2 lk3 lk4 lk5{p_end}
{hline 78}
r; t=0.09 20:13:30

{com}. overid

{txt}Tests of overidentifying restrictions:
Sargan N*R-sq test {res}{col 25}  4.065{txt}  Chi-sq({res}1{txt}){col 47}P-value = {res}0.0438
{txt}Basmann test {res}{col 25}  4.011{txt}  Chi-sq({res}1{txt}){col 47}P-value = {res}0.0452
{txt}r; t=0.13 20:13:30

{com}. savedresults save fabio1 e() 
{txt}r; t=0.00 20:13:30

{com}. ivreg2 invest li2 (li1 lk1 dlk1 = lk2 lk3 lk4 lk5), small

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     150
{txt}{col 55}F(  4,   145) = {res}  553.62
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res}  8402583.31{txt}{col 55}Centered R2   = {res}  0.9404
{txt}Total (uncentered) SS   = {res} 12450935.38{txt}{col 55}Uncentered R2 = {res}  0.9598
{txt}Residual SS             = {res} 500872.8636{txt}{col 55}Root MSE      = {res}   58.77

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}      invest{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 9}li1 {c |}{col 14}{result}{space 2} .8137191{col 26}{space 2} .4644613{col 37}{space 1}    1.75{col 46}{space 3}0.082{col 55}{space 3}-.1042699{col 67}{space 3} 1.731708
{txt}{space 9}lk1 {c |}{col 14}{result}{space 2} .1494245{col 26}{space 2} .0507281{col 37}{space 1}    2.95{col 46}{space 3}0.004{col 55}{space 3} .0491625{col 67}{space 3} .2496866
{txt}{space 8}dlk1 {c |}{col 14}{result}{space 2}-1.004987{col 26}{space 2} .3609646{col 37}{space 1}   -2.78{col 46}{space 3}0.006{col 55}{space 3}-1.718419{col 67}{space 3}-.2915551
{txt}{space 9}li2 {c |}{col 14}{result}{space 2}  .349771{col 26}{space 2}  .525725{col 37}{space 1}    0.67{col 46}{space 3}0.507{col 55}{space 3}-.6893033{col 67}{space 3} 1.388845
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-23.53724{col 26}{space 2} 10.45931{col 37}{space 1}   -2.25{col 46}{space 3}0.026{col 55}{space 3}-44.20965{col 67}{space 3}-2.864832
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}   6.945
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0310
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   1.748
{txt}Stock-Yogo weak ID test critical values:{col 64}<not available>
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   4.065
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0438
{txt}{hline 78}
Instrumented:{col 23}li1 lk1 dlk1
Included instruments:{col 23}li2
Excluded instruments:{col 23}lk2 lk3 lk4 lk5
{hline 78}
r; t=0.15 20:13:30

{com}. assert "`e(collin)'" == ""
{txt}r; t=0.00 20:13:30

{com}. savedresults compare fabio1 e(), include(macros: inst instd depvar scalar:N matrix: b) tol(1e-7) 
{txt}r; t=0.00 20:13:30

{com}. 
. * HAC option, with explicit and auto bw
. 
. use http://fmwww.bc.edu/ec-p/data/wooldridge/phillips.dta, clear
{txt}r; t=0.21 20:13:31

{com}. tsset year, yearly
{res}{txt}{col 9}time variable:  {res}{col 25}year, 1948 to 1996
{txt}{col 17}delta:  {res}1 year
{txt}r; t=0.05 20:13:31

{com}. which newey
{txt}/Applications/Stata/ado/base/n/newey.ado
{res}*! version 1.5.5  22jun2009
{txt}r; t=0.06 20:13:31

{com}. newey cinf unem, lag(2)

{txt}Regression with Newey-West standard errors{col 53}Number of obs  ={res}        48
{txt}maximum lag: {res}2{col 53}{txt}F(  1,    46){col 68}={res}      6.00
{col 53}{txt}Prob > F       =    {res}0.0182

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}             Newey-West
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.5425869{col 26}{space 2} .2214815{col 37}{space 1}   -2.45{col 46}{space 3}0.018{col 55}{space 3} -.988406{col 67}{space 3}-.0967679
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.030581{col 26}{space 2} 1.389486{col 37}{space 1}    2.18{col 46}{space 3}0.034{col 55}{space 3} .2336905{col 67}{space 3} 5.827471
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
r; t=0.09 20:13:31

{com}. savedresults save newey e()
{txt}r; t=0.00 20:13:31

{com}. ivreg2 cinf unem, bw(3) kernel(bartlett) robust small

{txt}OLS estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and autocorrelation
  kernel=Bartlett; bandwidth=     3
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      48
{txt}{col 55}F(  1,    46) = {res}    6.00
{txt}{col 55}Prob > F      = {res}  0.0182
{txt}Total (centered) SS     = {res} 309.6881289{txt}{col 55}Centered R2   = {res}  0.1078
{txt}Total (uncentered) SS   = {res} 310.2300041{txt}{col 55}Uncentered R2 = {res}  0.1094
{txt}Residual SS             = {res} 276.3051302{txt}{col 55}Root MSE      = {res}   2.451

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.5425869{col 26}{space 2} .2214815{col 37}{space 1}   -2.45{col 46}{space 3}0.018{col 55}{space 3} -.988406{col 67}{space 3}-.0967679
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.030581{col 26}{space 2} 1.389486{col 37}{space 1}    2.18{col 46}{space 3}0.034{col 55}{space 3} .2336905{col 67}{space 3} 5.827471
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
Included instruments:{col 23}unem
{hline 78}
r; t=0.09 20:13:31

{com}. savedresults comp newey e(), include(macros: depvar scalar: N matrix: b V) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:13:31

{com}. 
. ivreg2 cinf (unem=L(1/2).unem), bw(auto) 
{res}
{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to autocorrelation
  kernel=Bartlett; bandwidth=    17
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      47
{txt}{col 55}F(  1,    45) = {res}    3.49
{txt}{col 55}Prob > F      = {res}  0.0683
{txt}Total (centered) SS     = {res} 223.3646815{txt}{col 55}Centered R2   = {res}  0.1362
{txt}Total (uncentered) SS   = {res} 223.7400005{txt}{col 55}Uncentered R2 = {res}  0.1376
{txt}Residual SS             = {res} 192.9432814{txt}{col 55}Root MSE      = {res}   2.026

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.4079928{col 26}{space 2} .2137385{col 37}{space 1}   -1.91{col 46}{space 3}0.056{col 55}{space 3}-.8269125{col 67}{space 3}  .010927
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.447039{col 26}{space 2} 1.248642{col 37}{space 1}    1.96{col 46}{space 3}0.050{col 55}{space 3}-.0002538{col 67}{space 3} 4.894332
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  15.269
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0005
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  29.145
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   3.445
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0635
{txt}{hline 78}
Instrumented:{col 23}unem
Excluded instruments:{col 23}L.unem L2.unem
{hline 78}
r; t=3.08 20:13:34

{com}. ivreg2 cinf (unem=L(1/2).unem), bw(auto) kernel(par)
{res}
{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to autocorrelation
  kernel=Parzen; bandwidth=    18
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      47
{txt}{col 55}F(  1,    45) = {res}    3.60
{txt}{col 55}Prob > F      = {res}  0.0642
{txt}Total (centered) SS     = {res} 223.3646815{txt}{col 55}Centered R2   = {res}  0.1362
{txt}Total (uncentered) SS   = {res} 223.7400005{txt}{col 55}Uncentered R2 = {res}  0.1376
{txt}Residual SS             = {res} 192.9432814{txt}{col 55}Root MSE      = {res}   2.026

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.4079928{col 26}{space 2}  .210372{col 37}{space 1}   -1.94{col 46}{space 3}0.052{col 55}{space 3}-.8203143{col 67}{space 3} .0043287
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.447039{col 26}{space 2} 1.227558{col 37}{space 1}    1.99{col 46}{space 3}0.046{col 55}{space 3} .0410701{col 67}{space 3} 4.853008
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  15.415
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0004
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  29.356
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   3.438
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0637
{txt}{hline 78}
Instrumented:{col 23}unem
Excluded instruments:{col 23}L.unem L2.unem
{hline 78}
r; t=3.25 20:13:37

{com}. ivreg2 cinf unem, bw(auto) kernel(qua)
{res}Computing kernel ...

{txt}OLS estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics robust to autocorrelation
  kernel=Quadratic spectral; bandwidth=    16
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      48
{txt}{col 55}F(  1,    46) = {res}    7.20
{txt}{col 55}Prob > F      = {res}  0.0101
{txt}Total (centered) SS     = {res} 309.6881289{txt}{col 55}Centered R2   = {res}  0.1078
{txt}Total (uncentered) SS   = {res} 310.2300041{txt}{col 55}Uncentered R2 = {res}  0.1094
{txt}Residual SS             = {res} 276.3051302{txt}{col 55}Root MSE      = {res}   2.399

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.5425869{col 26}{space 2} .1980143{col 37}{space 1}   -2.74{col 46}{space 3}0.006{col 55}{space 3}-.9306879{col 67}{space 3} -.154486
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 3.030581{col 26}{space 2} 1.187293{col 37}{space 1}    2.55{col 46}{space 3}0.011{col 55}{space 3} .7035291{col 67}{space 3} 5.357632
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
Included instruments:{col 23}unem
{hline 78}
r; t=0.22 20:13:37

{com}. ivreg2 cinf (unem=L(1/2).unem), bw(auto) kernel(qua)
{res}Computing kernel ...

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to autocorrelation
  kernel=Quadratic spectral; bandwidth=   9.1
  Automatic bw selection according to Newey-West (1994)
  time variable (t):  {res}year

{txt}                                   {col 55}Number of obs = {res}      47
{txt}{col 55}F(  1,    45) = {res}    3.61
{txt}{col 55}Prob > F      = {res}  0.0637
{txt}Total (centered) SS     = {res} 223.3646815{txt}{col 55}Centered R2   = {res}  0.1362
{txt}Total (uncentered) SS   = {res} 223.7400005{txt}{col 55}Uncentered R2 = {res}  0.1376
{txt}Residual SS             = {res} 192.9432814{txt}{col 55}Root MSE      = {res}   2.026

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}        cinf{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}unem {c |}{col 14}{result}{space 2}-.4079928{col 26}{space 2} .2099958{col 37}{space 1}   -1.94{col 46}{space 3}0.052{col 55}{space 3} -.819577{col 67}{space 3} .0035914
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 2.447039{col 26}{space 2} 1.224977{col 37}{space 1}    2.00{col 46}{space 3}0.046{col 55}{space 3} .0461277{col 67}{space 3} 4.847951
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}  15.471
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0004
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  29.505
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   3.457
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0630
{txt}{hline 78}
Instrumented:{col 23}unem
Excluded instruments:{col 23}L.unem L2.unem
{hline 78}
r; t=5.06 20:13:42

{com}. 
. * equivalence of ivendog and orthog option (Wooldridge 2002, pp.59, 61)
. 
. use http://fmwww.bc.edu/ec-p/data/wooldridge/mroz.dta
{txt}r; t=0.16 20:13:43

{com}.  ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}    7.49
{txt}{col 55}Prob > F      = {res}  0.0001
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1556
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7727
{txt}Residual SS             = {res} 188.5780571{txt}{col 55}Root MSE      = {res}   .6638

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0964002{col 26}{space 2} .0814278{col 37}{space 1}    1.18{col 46}{space 3}0.236{col 55}{space 3}-.0631952{col 67}{space 3} .2559957
{txt}{space 7}exper {c |}{col 14}{result}{space 2}  .042193{col 26}{space 2} .0138831{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0149827{col 67}{space 3} .0694033
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008323{col 26}{space 2} .0004204{col 37}{space 1}   -1.98{col 46}{space 3}0.048{col 55}{space 3}-.0016563{col 67}{space 3}-8.33e-06
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.3848718{col 26}{space 2} 1.011551{col 37}{space 1}   -0.38{col 46}{space 3}0.704{col 55}{space 3}-2.367476{col 67}{space 3} 1.597732
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  12.816
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0051
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   4.342
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 13.91
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  9.08
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.46
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.39
{txt}{col 42}10% maximal IV size{res}{col 73} 22.30
{txt}{col 42}15% maximal IV size{res}{col 73} 12.83
{txt}{col 42}20% maximal IV size{res}{col 73}  9.54
{txt}{col 42}25% maximal IV size{res}{col 73}  7.80
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.702
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7042
{txt}{hline 78}
Instrumented:{col 23}educ
Included instruments:{col 23}exper expersq
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=0.21 20:13:43

{com}. // CANNOT EXEC WITH ivreg2--NOT SET UP TO RUN > ivreg2
. /*
>  which ivendog
>  ivendog educ
>  local rdf = r(df)
>  local dwh = r(DWH)
>  local dwhp = r(DWHp)
>  ivreg2 lwage exper expersq educ (=age kidslt6 kidsge6), orthog(educ)
>  assert `rdf' == e(cstatdf)
>  assert reldif(`dwh',e(cstat)) < 1.0e-5
>  assert reldif(`dwhp',e(cstatp)) < 1.0e-5
> */
. 
. * equivalence of coviv+liml and cue options
.  ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6), liml coviv

{txt}LIML estimation
{hline 15}
k               =1.00164
lambda          =1.00164

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}    7.49
{txt}{col 55}Prob > F      = {res}  0.0001
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1555
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7726
{txt}Residual SS             = {res} 188.6105763{txt}{col 55}Root MSE      = {res}   .6638

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0957581{col 26}{space 2} .0814348{col 37}{space 1}    1.18{col 46}{space 3}0.240{col 55}{space 3}-.0638511{col 67}{space 3} .2553674
{txt}{space 7}exper {c |}{col 14}{result}{space 2} .0422292{col 26}{space 2} .0138843{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0150166{col 67}{space 3} .0694419
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008335{col 26}{space 2} .0004204{col 37}{space 1}   -1.98{col 46}{space 3}0.047{col 55}{space 3}-.0016576{col 67}{space 3}-9.48e-06
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.3769294{col 26}{space 2} 1.011638{col 37}{space 1}   -0.37{col 46}{space 3}0.709{col 55}{space 3}-2.359704{col 67}{space 3} 1.605845
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  12.816
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0051
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   4.342
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal LIML size{res}{col 73}  6.46
{txt}{col 42}15% maximal LIML size{res}{col 73}  4.36
{txt}{col 42}20% maximal LIML size{res}{col 73}  3.69
{txt}{col 42}25% maximal LIML size{res}{col 73}  3.32
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.701
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7042
{txt}{hline 78}
{help ivreg2##liml:Anderson-Rubin statistic} (overidentification test of all instruments):{res}{col 72}  0.702
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7040
{txt}{hline 78}
Instrumented:{col 23}educ
Included instruments:{col 23}exper expersq
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=0.13 20:13:43

{com}.  savedresults save limlcov e()
{txt}r; t=0.00 20:13:43

{com}.  ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6), cue

{txt}initial:       neg GMM obj function -J = {res}-.70151243
{txt}rescale:       neg GMM obj function -J = {res}-.70151243
{txt}Iteration 0:{col 16}neg GMM obj function -J = {res}-.70151243{txt}  
Iteration 1:{col 16}neg GMM obj function -J = {res}-.70145365{txt}  
Iteration 2:{col 16}neg GMM obj function -J = {res}-.70145365{txt}  

CUE estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}    7.49
{txt}{col 55}Prob > F      = {res}  0.0001
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1555
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7726
{txt}Residual SS             = {res} 188.6105763{txt}{col 55}Root MSE      = {res}   .6638

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0957581{col 26}{space 2} .0814348{col 37}{space 1}    1.18{col 46}{space 3}0.240{col 55}{space 3}-.0638511{col 67}{space 3} .2553674
{txt}{space 7}exper {c |}{col 14}{result}{space 2} .0422292{col 26}{space 2} .0138843{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0150166{col 67}{space 3} .0694419
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008335{col 26}{space 2} .0004204{col 37}{space 1}   -1.98{col 46}{space 3}0.047{col 55}{space 3}-.0016576{col 67}{space 3}-9.48e-06
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.3769294{col 26}{space 2} 1.011638{col 37}{space 1}   -0.37{col 46}{space 3}0.709{col 55}{space 3}-2.359704{col 67}{space 3} 1.605845
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  12.816
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0051
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   4.342
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal LIML size{res}{col 73}  6.46
{txt}{col 42}15% maximal LIML size{res}{col 73}  4.36
{txt}{col 42}20% maximal LIML size{res}{col 73}  3.69
{txt}{col 42}25% maximal LIML size{res}{col 73}  3.32
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.701
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7042
{txt}{hline 78}
Instrumented:{col 23}educ
Included instruments:{col 23}exper expersq
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=2.85 20:13:46

{com}.  savedresults comp limlcov e(), include(macros: inst instd depvar scalar: N rmse matrix: b V)  tol(1e-7) verbose
{txt}comparing macro  e(inst)
comparing macro  e(instd)
comparing macro  e(depvar)
comparing scalar e(N)
comparing scalar e(rmse)
comparing matrix e(b)
comparing matrix e(V)
r; t=0.00 20:13:46

{com}. * savedresults save ols e()
. ivreg2 lwage exper expersq educ (=age kidslt6 kidsge6),small

{txt}OLS estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}   26.29
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1568
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7730
{txt}Residual SS             = {res} 188.3051489{txt}{col 55}Root MSE      = {res}   .6664

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 7}exper {c |}{col 14}{result}{space 2} .0415665{col 26}{space 2} .0131752{col 37}{space 1}    3.15{col 46}{space 3}0.002{col 55}{space 3} .0156697{col 67}{space 3} .0674633
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008112{col 26}{space 2} .0003932{col 37}{space 1}   -2.06{col 46}{space 3}0.040{col 55}{space 3}-.0015841{col 67}{space 3}-.0000382
{txt}{space 8}educ {c |}{col 14}{result}{space 2} .1074896{col 26}{space 2} .0141465{col 37}{space 1}    7.60{col 46}{space 3}0.000{col 55}{space 3} .0796837{col 67}{space 3} .1352956
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.5220407{col 26}{space 2} .1986321{col 37}{space 1}   -2.63{col 46}{space 3}0.009{col 55}{space 3}-.9124668{col 67}{space 3}-.1316145
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##overidtests:Sargan statistic} (Lagrange multiplier test of excluded instruments):{res}{col 71}   0.722
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.8681
{txt}{hline 78}
Included instruments:{col 23}exper expersq educ
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=0.11 20:13:46

{com}. * savedresults comp ols e(), include(macros: depvar scalar: N df_r matrix: b V) tol(1e-7) verbose
. 
. * 1.0.13 cue with nocons
.  ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6), cue nocons

{txt}initial:       neg GMM obj function -J = {res} -.5040751
{txt}rescale:       neg GMM obj function -J = {res} -.5040751
{txt}Iteration 0:{col 16}neg GMM obj function -J = {res} -.5040751{txt}  
Iteration 1:{col 16}neg GMM obj function -J = {res}-.50406949{txt}  
Iteration 2:{col 16}neg GMM obj function -J = {res}-.50406949{txt}  

CUE estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   425) = {res}  448.37
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1377
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7679
{txt}Residual SS             = {res} 192.5827982{txt}{col 55}Root MSE      = {res}   .6708

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0636867{col 26}{space 2} .0082765{col 37}{space 1}    7.69{col 46}{space 3}0.000{col 55}{space 3} .0474652{col 67}{space 3} .0799083
{txt}{space 7}exper {c |}{col 14}{result}{space 2} .0465055{col 26}{space 2} .0145299{col 37}{space 1}    3.20{col 46}{space 3}0.001{col 55}{space 3} .0180274{col 67}{space 3} .0749835
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0009571{col 26}{space 2} .0004262{col 37}{space 1}   -2.25{col 46}{space 3}0.025{col 55}{space 3}-.0017926{col 67}{space 3}-.0001217
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71} 283.708
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0000
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71} 277.235
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal LIML size{res}{col 73}  6.46
{txt}{col 42}15% maximal LIML size{res}{col 73}  4.36
{txt}{col 42}20% maximal LIML size{res}{col 73}  3.69
{txt}{col 42}25% maximal LIML size{res}{col 73}  3.32
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.504
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7772
{txt}{hline 78}
Instrumented:{col 23}educ
Included instruments:{col 23}exper expersq
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=1.98 20:13:48

{com}.  
. * 1.0.13 b0 option
. ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}    7.49
{txt}{col 55}Prob > F      = {res}  0.0001
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1556
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7727
{txt}Residual SS             = {res} 188.5780571{txt}{col 55}Root MSE      = {res}   .6638

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0964002{col 26}{space 2} .0814278{col 37}{space 1}    1.18{col 46}{space 3}0.236{col 55}{space 3}-.0631952{col 67}{space 3} .2559957
{txt}{space 7}exper {c |}{col 14}{result}{space 2}  .042193{col 26}{space 2} .0138831{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0149827{col 67}{space 3} .0694033
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008323{col 26}{space 2} .0004204{col 37}{space 1}   -1.98{col 46}{space 3}0.048{col 55}{space 3}-.0016563{col 67}{space 3}-8.33e-06
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.3848718{col 26}{space 2} 1.011551{col 37}{space 1}   -0.38{col 46}{space 3}0.704{col 55}{space 3}-2.367476{col 67}{space 3} 1.597732
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Anderson canon. corr. LM statistic):{res}{col 71}  12.816
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.0051
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Cragg-Donald Wald F statistic):{res}{col 71}   4.342
{txt}Stock-Yogo weak ID test critical values:{col 43}5% maximal IV relative bias{res}{col 73} 13.91
{txt}{col 42}10% maximal IV relative bias{res}{col 73}  9.08
{txt}{col 42}20% maximal IV relative bias{res}{col 73}  6.46
{txt}{col 42}30% maximal IV relative bias{res}{col 73}  5.39
{txt}{col 42}10% maximal IV size{res}{col 73} 22.30
{txt}{col 42}15% maximal IV size{res}{col 73} 12.83
{txt}{col 42}20% maximal IV size{res}{col 73}  9.54
{txt}{col 42}25% maximal IV size{res}{col 73}  7.80
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
{hline 78}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.702
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7042
{txt}{hline 78}
Instrumented:{col 23}educ
Included instruments:{col 23}exper expersq
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=0.15 20:13:48

{com}. mat b=e(b)
{txt}r; t=0.00 20:13:48

{com}. savedresults save b0 e()
{txt}r; t=0.00 20:13:48

{com}. ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6), b0(b)

{txt}CUE evaluated at user-supplied parameter vector
{hline 47}

Estimates based on supplied parameter vector
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}    7.49
{txt}{col 55}Prob > F      = {res}  0.0001
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1556
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7727
{txt}Residual SS             = {res} 188.5780571{txt}{col 55}Root MSE      = {res}   .6638

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0964002{col 26}{space 2} .0814278{col 37}{space 1}    1.18{col 46}{space 3}0.236{col 55}{space 3}-.0631952{col 67}{space 3} .2559957
{txt}{space 7}exper {c |}{col 14}{result}{space 2}  .042193{col 26}{space 2} .0138831{col 37}{space 1}    3.04{col 46}{space 3}0.002{col 55}{space 3} .0149827{col 67}{space 3} .0694033
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008323{col 26}{space 2} .0004204{col 37}{space 1}   -1.98{col 46}{space 3}0.048{col 55}{space 3}-.0016563{col 67}{space 3}-8.33e-06
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.3848718{col 26}{space 2} 1.011551{col 37}{space 1}   -0.38{col 46}{space 3}0.704{col 55}{space 3}-2.367476{col 67}{space 3} 1.597732
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##overidtests:Sargan statistic} (overidentification test of all instruments):{res}{col 71}   0.702
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7042
{txt}{hline 78}
Instrumented:{col 23}educ
Included instruments:{col 23}exper expersq
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=0.21 20:13:48

{com}. savedresults comp b0 e(), include(scalar: j) tol(1e-7) verbose
{txt}comparing scalar e(j)
r; t=0.00 20:13:48

{com}. rcof "noi ivreg2 lwage exper expersq (educ=age kidslt6 kidsge6), b0(b) liml" == 198
{err}incompatible options: -b0- and liml
{txt}r; t=0.00 20:13:48

{com}. 
. * ivendog cstat versus ivreg2 cstat
. ivreg lwage exper expersq (educ=age kidslt6 kidsge6)

{txt}Instrumental variables (2SLS) regression

      Source {c |}       SS       df       MS              Number of obs ={res}     428
{txt}{hline 13}{char +}{hline 30}           F(  3,   424) ={res}    7.49
    {txt}   Model {char |} {res} 34.7493942     3  11.5831314           {txt}Prob > F      = {res} 0.0001
    {txt}Residual {char |} {res} 188.578057   424  .444759569           {txt}R-squared     = {res} 0.1556
{txt}{hline 13}{char +}{hline 30}           Adj R-squared = {res} 0.1496
    {txt}   Total {char |} {res} 223.327451   427  .523015108           {txt}Root MSE      = {res}  .6669

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      t{col 46}   P>|t|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 8}educ {c |}{col 14}{result}{space 2} .0964002{col 26}{space 2}  .081811{col 37}{space 1}    1.18{col 46}{space 3}0.239{col 55}{space 3}-.0644053{col 67}{space 3} .2572058
{txt}{space 7}exper {c |}{col 14}{result}{space 2}  .042193{col 26}{space 2} .0139484{col 37}{space 1}    3.02{col 46}{space 3}0.003{col 55}{space 3} .0147764{col 67}{space 3} .0696096
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008323{col 26}{space 2} .0004224{col 37}{space 1}   -1.97{col 46}{space 3}0.049{col 55}{space 3}-.0016625{col 67}{space 3}-2.08e-06
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.3848718{col 26}{space 2} 1.016311{col 37}{space 1}   -0.38{col 46}{space 3}0.705{col 55}{space 3}-2.382508{col 67}{space 3} 1.612764
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{p 0 15 4}Instrumented:{space 2}educ{p_end}
{p 0 15 4}Instruments:{space 3}exper expersq age kidslt6 kidsge6{p_end}
{hline 78}
r; t=0.09 20:13:48

{com}. savedresults save ivendog e()
{txt}r; t=0.00 20:13:48

{com}. ivendog educ

{txt}Tests of endogeneity of: {res}educ
{txt}H0: Regressor is exogenous
    Wu-Hausman F test: {col 39}{res}  0.01892{txt}  F({res}1{txt},{res}423{txt}){col 62}P-value = {res}0.89065
{txt}    Durbin-Wu-Hausman chi-sq test: {col 39}{res}  0.01915{txt}  Chi-sq({res}1{txt}){col 62}P-value = {res}0.88995
{txt}r; t=0.04 20:13:48

{com}. scalar cstat = r(DWH)
{txt}r; t=0.00 20:13:48

{com}. scalar cstatp = r(DWHp)
{txt}r; t=0.00 20:13:48

{com}. scalar cstatdf = r(df)
{txt}r; t=0.00 20:13:48

{com}. ivreg2 lwage exper expersq educ (=age kidslt6 kidsge6), orthog(educ)

{txt}OLS estimation
{hline 14}

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                   {col 55}Number of obs = {res}     428
{txt}{col 55}F(  3,   424) = {res}   26.29
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 223.3274513{txt}{col 55}Centered R2   = {res}  0.1568
{txt}Total (uncentered) SS   = {res}  829.594813{txt}{col 55}Uncentered R2 = {res}  0.7730
{txt}Residual SS             = {res} 188.3051489{txt}{col 55}Root MSE      = {res}   .6633

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 1}{text}       lwage{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 7}exper {c |}{col 14}{result}{space 2} .0415665{col 26}{space 2} .0131135{col 37}{space 1}    3.17{col 46}{space 3}0.002{col 55}{space 3} .0158645{col 67}{space 3} .0672685
{txt}{space 5}expersq {c |}{col 14}{result}{space 2}-.0008112{col 26}{space 2} .0003914{col 37}{space 1}   -2.07{col 46}{space 3}0.038{col 55}{space 3}-.0015783{col 67}{space 3}-.0000441
{txt}{space 8}educ {c |}{col 14}{result}{space 2} .1074896{col 26}{space 2} .0140802{col 37}{space 1}    7.63{col 46}{space 3}0.000{col 55}{space 3} .0798929{col 67}{space 3} .1350864
{txt}{space 7}_cons {c |}{col 14}{result}{space 2}-.5220407{col 26}{space 2} .1977017{col 37}{space 1}   -2.64{col 46}{space 3}0.008{col 55}{space 3}-.9095289{col 67}{space 3}-.1345525
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##overidtests:Sargan statistic} (Lagrange multiplier test of excluded instruments):{res}{col 71}   0.722
{txt}{col 52}Chi-sq({res}3{txt}) P-val =  {res}{col 73}0.8681
{txt}-orthog- option:
Sargan statistic (eqn. excluding suspect orthogonality conditions):{res}{col 71}   0.703
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.7038
{help ivreg2##ctest:C statistic}{txt} (exogeneity/orthogonality of suspect instruments): {res}{col 71}   0.019
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.8899
{txt}Instruments tested:  {col 23}educ
{hline 78}
Included instruments:{col 23}exper expersq educ
Excluded instruments:{col 23}age kidslt6 kidsge6
{hline 78}
r; t=0.15 20:13:49

{com}. savedresults compare ivendog e(), include(macros: depvar scalar: N df_m) tol(1e-7) verbose
{txt}comparing macro  e(depvar)
comparing scalar e(N)
comparing scalar e(df_m)
r; t=0.00 20:13:49

{com}. assert reldif(e(cstat),cstat) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. assert reldif(e(cstatp),cstatp) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. assert cstatdf == e(cstatdf)
{txt}r; t=0.00 20:13:49

{com}. 
. use http://fmwww.bc.edu/ec-p/data/hayashi/griliches76.dta,clear
{txt}(Wages of Very Young Men, Zvi Griliches, J.Pol.Ec. 1976)
r; t=0.15 20:13:49

{com}. assert _N == 758
{txt}r; t=0.00 20:13:49

{com}. xi  i.year
{txt}i.year{col 19}_Iyear_66-73{col 39}(naturally coded; _Iyear_66 omitted)
r; t=0.01 20:13:49

{com}. ivreg2 lw s expr tenure rns _I* (iq=kww age), cluster(year)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on year

Number of clusters (year) = {res}7   {txt}{col 55}Number of obs = {res}     758
{txt}{col 55}F( 11,     6) = {res}   28.08
{txt}{col 55}Prob > F      = {res}  0.0003
{txt}Total (centered) SS     = {res} 139.2861498{txt}{col 55}Centered R2   = {res}  0.4110
{txt}Total (uncentered) SS   = {res} 24652.24662{txt}{col 55}Uncentered R2 = {res}  0.9967
{txt}Residual SS             = {res}  82.0377585{txt}{col 55}Root MSE      = {res}    .329

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0029033{col 26}{space 2} .0044047{col 37}{space 1}    0.66{col 46}{space 3}0.510{col 55}{space 3}-.0057297{col 67}{space 3} .0115362
{txt}{space 11}s {c |}{col 14}{result}{space 2} .0632679{col 26}{space 2} .0176721{col 37}{space 1}    3.58{col 46}{space 3}0.000{col 55}{space 3} .0286312{col 67}{space 3} .0979046
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0303563{col 26}{space 2} .0118331{col 37}{space 1}    2.57{col 46}{space 3}0.010{col 55}{space 3} .0071639{col 67}{space 3} .0535487
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0434166{col 26}{space 2} .0054945{col 37}{space 1}    7.90{col 46}{space 3}0.000{col 55}{space 3} .0326476{col 67}{space 3} .0541855
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1170553{col 26}{space 2} .0410638{col 37}{space 1}   -2.85{col 46}{space 3}0.004{col 55}{space 3} -.197539{col 67}{space 3}-.0365717
{txt}{space 3}_Iyear_67 {c |}{col 14}{result}{space 2}-.0528787{col 26}{space 2} .0179969{col 37}{space 1}   -2.94{col 46}{space 3}0.003{col 55}{space 3} -.088152{col 67}{space 3}-.0176054
{txt}{space 3}_Iyear_68 {c |}{col 14}{result}{space 2} .0809012{col 26}{space 2} .0214341{col 37}{space 1}    3.77{col 46}{space 3}0.000{col 55}{space 3} .0388912{col 67}{space 3} .1229111
{txt}{space 3}_Iyear_69 {c |}{col 14}{result}{space 2} .2007175{col 26}{space 2} .0166742{col 37}{space 1}   12.04{col 46}{space 3}0.000{col 55}{space 3} .1680366{col 67}{space 3} .2333983
{txt}{space 3}_Iyear_70 {c |}{col 14}{result}{space 2}  .235459{col 26}{space 2} .0237865{col 37}{space 1}    9.90{col 46}{space 3}0.000{col 55}{space 3} .1888382{col 67}{space 3} .2820797
{txt}{space 3}_Iyear_71 {c |}{col 14}{result}{space 2} .2151632{col 26}{space 2} .0283299{col 37}{space 1}    7.59{col 46}{space 3}0.000{col 55}{space 3} .1596376{col 67}{space 3} .2706889
{txt}{space 3}_Iyear_73 {c |}{col 14}{result}{space 2} .3302726{col 26}{space 2} .0375734{col 37}{space 1}    8.79{col 46}{space 3}0.000{col 55}{space 3} .2566302{col 67}{space 3} .4039151
{txt}{space 7}_cons {c |}{col 14}{result}{space 2} 4.295046{col 26}{space 2} .3529368{col 37}{space 1}   12.17{col 46}{space 3}0.000{col 55}{space 3} 3.603302{col 67}{space 3} 4.986789
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   5.653
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0592
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  43.005
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{err}Warning: estimated covariance matrix of moment conditions not of full rank.
         overidentification statistic not reported, and
         standard errors and model tests should be interpreted with caution.
Possible causes:
         number of clusters insufficient to calculate robust covariance matrix
         singleton dummy variable (dummy with one 1 and N-1 0s or vice versa)
{help ivreg2##partial:partial} option may address problem.
{txt}{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}s expr tenure rns _Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70
{col 23}_Iyear_71 _Iyear_73
Excluded instruments:{col 23}kww age
{hline 78}
r; t=0.30 20:13:49

{com}. mat bfwl1 = e(b)
{txt}r; t=0.00 20:13:49

{com}. mat Vfwl1 = e(V)
{txt}r; t=0.00 20:13:49

{com}. savedresults save nofwl e()
{txt}r; t=0.04 20:13:49

{com}. ivreg2 lw s expr tenure rns _I* (iq=kww age), cluster(year) partial(_I*)

{txt}IV (2SLS) estimation
{hline 20}

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on year

Number of clusters (year) = {res}7   {txt}{col 55}Number of obs = {res}     758
{txt}{col 55}F(  5,     6) = {res}   84.64
{txt}{col 55}Prob > F      = {res}  0.0000
{txt}Total (centered) SS     = {res} 104.5637465{txt}{col 55}Centered R2   = {res}  0.2154
{txt}Total (uncentered) SS   = {res} 104.5637465{txt}{col 55}Uncentered R2 = {res}  0.2154
{txt}Residual SS             = {res} 82.03775814{txt}{col 55}Root MSE      = {res}    .329

{col 1}{text}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{col 14}{text}{c |}{col 14}               Robust
{col 1}{text}          lw{col 14}{c |}      Coef.{col 26}   Std. Err.{col 37}      z{col 46}   P>|z|{col 55}    [95% Conf. Interval]
{col 1}{text}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{space 10}iq {c |}{col 14}{result}{space 2} .0029033{col 26}{space 2} .0044047{col 37}{space 1}    0.66{col 46}{space 3}0.510{col 55}{space 3}-.0057297{col 67}{space 3} .0115362
{txt}{space 11}s {c |}{col 14}{result}{space 2} .0632679{col 26}{space 2} .0176721{col 37}{space 1}    3.58{col 46}{space 3}0.000{col 55}{space 3} .0286312{col 67}{space 3} .0979046
{txt}{space 8}expr {c |}{col 14}{result}{space 2} .0303563{col 26}{space 2} .0118331{col 37}{space 1}    2.57{col 46}{space 3}0.010{col 55}{space 3} .0071639{col 67}{space 3} .0535487
{txt}{space 6}tenure {c |}{col 14}{result}{space 2} .0434166{col 26}{space 2} .0054945{col 37}{space 1}    7.90{col 46}{space 3}0.000{col 55}{space 3} .0326476{col 67}{space 3} .0541855
{txt}{space 9}rns {c |}{col 14}{result}{space 2}-.1170553{col 26}{space 2} .0410638{col 37}{space 1}   -2.85{col 46}{space 3}0.004{col 55}{space 3} -.197539{col 67}{space 3}-.0365717
{col 1}{text}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 9}{hline 12}{hline 12}
{help ivreg2##idtest:Underidentification test} (Kleibergen-Paap rk LM statistic):{res}{col 71}   5.653
{txt}{col 52}Chi-sq({res}2{txt}) P-val =  {res}{col 73}0.0592
{txt}{hline 78}
{help ivreg2##widtest:Weak identification test} (Kleibergen-Paap rk Wald F statistic):{res}{col 71}  43.005
{txt}Stock-Yogo weak ID test critical values:{col 42}10% maximal IV size{res}{col 73} 19.93
{txt}{col 42}15% maximal IV size{res}{col 73} 11.59
{txt}{col 42}20% maximal IV size{res}{col 73}  8.75
{txt}{col 42}25% maximal IV size{res}{col 73}  7.25
{txt}Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
{hline 78}
{help ivreg2##overidtests:Hansen J statistic} (overidentification test of all instruments):{res}{col 71}   5.251
{txt}{col 52}Chi-sq({res}1{txt}) P-val =  {res}{col 73}0.0219
{txt}{hline 78}
Instrumented:{col 23}iq
Included instruments:{col 23}s expr tenure rns
Excluded instruments:{col 23}kww age
{help ivreg2##partial:Partialled-out}:{col 23}_Iyear_67 _Iyear_68 _Iyear_69 _Iyear_70 _Iyear_71
{col 23}_Iyear_73 _cons
{col 23}nb: small-sample adjustments account for
{col 23}    partialled-out variables
{hline 78}
r; t=0.30 20:13:49

{com}. mat bfwl2 = e(b)
{txt}r; t=0.00 20:13:49

{com}. mat Vfwl2 = e(V)
{txt}r; t=0.00 20:13:49

{com}. savedresults compare nofwl e(), include(scalar: N N_clust rss rmse idstat) tol(1e-7)
{txt}r; t=0.00 20:13:49

{com}. assert reldif(bfwl1[1,1],bfwl2[1,1]) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. assert reldif(bfwl1[1,2],bfwl2[1,2]) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. assert reldif(Vfwl1[1,1],Vfwl2[1,1]) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. assert reldif(Vfwl1[1,2],Vfwl2[1,2]) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. assert reldif(Vfwl1[2,2],Vfwl2[2,2]) < 1e-7
{txt}r; t=0.00 20:13:49

{com}. 
. 
. log close
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/Users/baum/doc/Stata devel/ Cert scripts/cs_ivreg2.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res}14 Aug 2009, 20:13:49
{txt}{.-}
{smcl}
{txt}{sf}{ul off}