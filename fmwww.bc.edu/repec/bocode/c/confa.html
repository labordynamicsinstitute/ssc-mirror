<pre>
<b>help confa</b>                                                       (SJ9-3: st001)
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>confa</b> --
             Confirmatory factor analysis
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>confa</b> <i>factorspec</i> [<i>factorspec ...</i>] [<i>if</i>] [<i>in</i>] [<i>weight</i>] [<b>,</b> <i>options</i>]
<p>
    <i>factorspec</i> is
        <b>(</b><i>factorname</i><b>:</b> <i>varlist</i><b>)</b>
<p>
    <i>options</i>                                      Description
    -------------------------------------------------------------------------
    Model
      <b><u>corr</u></b><b>elated(</b><i>corrspec</i> [<i>corrspec</i> ...]<b>)</b>        correlated measurement
                                                   errors; see below
      <b>unitvar(</b><i>factorlist</i>|<b>_all)</b>                   set variance of the
                                                   factor(s) to 1
      <b>free</b>                                       do not impose any
                                                   constraints by default;
                                                   seldom used
      <b><u>constr</u></b><b>aint(</b><i>numlist</i><b>)</b>                        user-supplied constraints;
                                                   must be used with <b>free</b>
      <b><u>miss</u></b><b>ing</b>                                    full-information
                                                   maximum-likelihood
                                                   estimation with missing
                                                   data
      <b><u>usen</u></b><b>ames</b>                                   alternative coefficient
                                                   labeling
    Variance estimation
      <b>vce(</b><i>vcetype</i><b>)</b>                               <i>vcetype</i> may be <b><u>r</u></b><b>obust</b>,
                                                   <b><u>cl</u></b><b>uster</b> <i>clustvar</i>, <b>oim</b>,
                                                   <b>opg</b>, or <b><u>sb</u></b><b>entler</b>
    Reporting
      <b><u>l</u></b><b>evel(</b><i>#</i><b>)</b>                                   set confidence level;
                                                   default is <b>level(95)</b>
    Other
      <b>svy</b>                                        respect survey settings
      <b>from(ones</b>|<b>2sls</b>|<b>ivreg</b>|<b>smart</b>|<i>ml_init_args</i><b>)</b>   control the starting values
      <b>loglevel(</b><i>#</i><b>)</b>                                specify the details of
                                                   output; programmers only
      <i>ml_options</i>                                 maximization options
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>confa</b> estimates single-level confirmatory factor analysis (CFA) models.
    In a CFA model, each of the variables is assumed to be an indicator of
    underlying unobserved factor(s) with a linear dependence between the
    factors and observed variables:
<p>
                  <i>y_i</i> = <i>m_i</i> + <i>l_i1 f_1</i> + ... + <i>l_iK f_K</i> + <i>e_i</i>
<p>
    where <i>y_i</i> is the <i>i</i>th variable in the <i>varlist</i>, <i>m_i</i> is its mean, <i>l_ik</i> are
    the latent variable loading(s), <i>f_k</i> are the <i>k</i>th latent factor(s) (<i>k</i> =
    1,...,<i>K</i>), and <i>e_i</i> is the measurement error.  Thus the specification
    <b>(</b><i>factorname</i><b>:</b> <i>varlist</i><b>)</b> is interpreted as follows: the latent factor <i>f_k</i> is
    given <i>factorname</i> (for display purposes only); the variables specified in
    the <i>varlist</i> have their loadings, <i>l_ik</i>, estimated; and all other observed
    variables in the model have fixed loadings, <i>l_ik</i> = 0.
<p>
    The model is estimated by the maximum likelihood procedure; see <b>ml</b>.
<p>
    As with all latent variable models, a number of identifying assumptions
    need to be made about the latent variables <i>f_k</i>. They are assumed to have
    mean zero, and their scales are determined by the first variable in the
    <i>varlist</i> (i.e., <i>l_1k</i> is set to equal 1 for all <i>k</i>).  Alternatively,
    identification can be achieved by setting the variance of the latent
    variable to 1 (with option <b>unitvar()</b>). More sophisticated identification
    conditions can be achieved by specifying the <b>free</b> option and then
    providing the necessary constraints in the <b>constraint()</b> option.
<p>
    Please cite this package as Kolenikov (2009). See full bibliographic
    details in References below.
<p>
<p>
<b><u>Options</u></b>
<p>
        +-------+
    ----+ Model +------------------------------------------------------------
<p>
    <b>correlated(</b><i>corrspec</i> [<i>corrspec</i> ...]<b>)</b> specifies the correlated measurement
        errors <i>e_i</i> and <i>e_j</i>.  Here <i>corrspec</i> is of the form
      
        [<b>(</b>]<i>varname_k</i><b>:</b><i>varname_j</i>[<b>)</b>]
      
        where <i>varname_k</i> and <i>varname_j</i> are some of the observed variables in
        the model; that is, they must appear in at least one <i>factorspec</i>
        statement. If there is only one correlation specified, the optional
        parentheses shown above may be omitted. There should be no space
        between the colon and <i>varname_j</i>.
<p>
    <b>unitvar(</b><i>factorlist</i>|<b>_all)</b> specifies the factors (from those named in
        <i>factorspec</i>) that will be identified by setting their variances to 1.
        The keyword <b>_all</b> can be used to specify that all the factors have
        their variances set to 1 (and hence the matrix Phi can be interpreted
        as a correlation matrix).
<p>
    <b>free</b> frees up all the parameters in the model (making it
        underidentified).  It is then the user's responsibility to provide
        identification constraints and adjust the degrees of freedom of the
        tests.  This option is seldom used.
<p>
    <b>constraint(</b><i>numlist</i><b>)</b> can be used to supply additional constraints. There
        are no checks implemented for redundant or conflicting constraints,
        so in some rare cases, the degrees of freedom may be incorrect. It
        might be wise to run the model with the <b>free</b> and <b>iterate(0)</b> options
        and then look at the names in the output of <b>matrix list e(b)</b> to find
        out the specific names of the parameters.
<p>
    <b>missing</b> requests full-information maximum-likelihood estimation with
        missing data.  By default, estimation proceeds by listwise deletion.
<p>
    <b>usenames</b> requests that the parameters be labeled with the names of the
        variables and factors rather than with numeric values (indices of the
        corresponding matrices).  It is a technical detail that does not
        affect the estimation procedure in any way, but it is helpful when
        working with several models simultaneously, tabulating the estimation
        results, and transferring the starting values between models.
<p>
        +---------------------+
    ----+ Variance estimation +----------------------------------------------
<p>
    <b>vce(</b><i>vcetype</i><b>)</b> specifies different estimators of the variance-covariance
        matrix. Common estimators (<b>vce(oim)</b>, observed information matrix, the
        default; <b>vce(robust)</b>, sandwich information matrix; <b>vce(cluster</b>
        <i>clustvar</i><b>)</b>, clustered sandwich estimator with clustering on <i>clustvar</i>)
        are supported, along with their aliases (the <b>robust</b> and
        <b>cluster(</b><i>clustvar</i><b>)</b> options).  See vce_option.
<p>
        An additional estimator specific to structural equation modeling is
        the Satorra-Bentler estimator (Satorra and Bentler 1994). It is
        requested by <b>vce(</b><b><u>sben</u></b><b>tler)</b> or <b>vce(</b><b><u>sat</u></b><b>orrabentler)</b>.  When this option
        is specified, additional Satorra-Bentler scaled and adjusted
        goodness-of-fit statistics are computed and presented in the output.
<p>
        +-----------+
    ----+ Reporting +--------------------------------------------------------
<p>
    <b>level(</b><i>#</i><b>)</b> changes the confidence level for confindence-interval reporting.
        See <b>estimation options</b>.
<p>
        +-------+
    ----+ Other +------------------------------------------------------------
<p>
    <b>svy</b> instructs <b>confa</b> to respect the complex survey design, if one is
        specified. See <b>svyset</b>.
<p>
    <b>from(ones</b>|<b>2sls</b>|<b>ivreg</b>|<b>smart</b>|<i>ml_init_args</i><b>)</b> provides the choice of starting
        values for the maximization procedure.  The <b>ml</b> command's internal
        default is to set all parameters to zero, which leads to a
        noninvertible matrix, Sigma, and <b>ml</b> has to make many changes to those
        initial values to find anything feasible. Moreover, this initial
        search procedure sometimes leads to a domain where the likelihood is
        nonconcave, and optimization might fail there.
<p>
        <b>ones</b> sets all the parameters to values of one except for covariance
        parameters (off-diagonal values of the Phi and Theta matrices), which
        are set to 0.5.  This might be a reasonable choice for data with
        variances of observed variables close to 1 and positive covariances
        (no inverted scales).
<p>
        <b>2sls</b> or <b>ivreg</b> requests that the initial parameters for the freely
        estimated loadings be set to the two-stage least-squares
        instrumental-variable estimates of Bollen (1996). This requires the
        model to be identified by scaling indicators (i.e., setting one of
        the loadings to 1) and to have at least three indicators for each
        latent variable.  The instruments used are all other indicators of
        the same factor. No checks for their validity or search for other
        instruments is performed.
<p>
        <b>smart</b> provides an alternative set of starting values that is often
        reasonable (e.g., assuming that the reliability of observed variables
        is 0.5).
<p>
        Other specification of starting values, <i>ml_init_args</i>, should follow
        the format of <b>ml init</b>. Those typically include the list of starting
        values of the form <b>from(</b><i># #</i> ... <i>#</i><b>, copy)</b> or a matrix of starting
        values <b>from(</b><i>matname</i><b>,</b> [<b>copy</b>|<b>skip</b>]<b>)</b>.  See <b>[R] ml</b>.
<p>
    <b>loglevel(</b><i>#</i><b>)</b> specifies the details of output about different stages of
        model setup and estimation, and is likely of interest only to
        programmers. Higher numbers imply more output.
<p>
    For other options, see <b>maximize</b>.
<p>
<p>
<b><u>Saved results</u></b>
<p>
    Aside from the standard <b>estimation results</b>, <b>confa</b> also performs the
    overall goodness-of-fit test with results saved in <b>e(lr_u)</b>, <b>e(df_u)</b>, and
    <b>e(p_u)</b> for the test statistic, its goodness of fit, and the resulting
    p-value. A test versus the model with the independent data is provided
    with the <b>ereturn</b> results with the <b>indep</b> suffix. Here, under the null
    hypothesis, the covariance matrix is assumed diagonal.
<p>
    When <b>sbentler</b> is specified, Satorra-Bentler standard errors are computed
    and posted as <b>e(V)</b>, with intermediate matrices saved in <b>e(SBU)</b>, <b>e(SBV)</b>,
    <b>e(SBGamma)</b>, and <b>e(SBDelta)</b>.  Also, a number of corrected overall fit test
    statistics is reported and saved: T scaled (<b>ereturn</b> results with the <b>Tsc</b>
    suffix) and T adjusted (<b>ereturn</b> results with the <b>Tadj</b> suffix).  Scalars
    <b>e(SBc)</b> and <b>e(SBd)</b> are the scaling constants, with the latter also being
    the approximate degrees of freedom of the chi-squared test from Satorra
    and Bentler (1994), and T double bar from Yuan and Bentler (1997) (with
    the <b>T2</b> suffix).
<p>
<p>
<b><u>Remarks</u></b>
<p>
<b>confa</b> relies on listutil for some parsing tasks. If it is not installed with
your Stata, <b>confa</b> will try to install it from {SSC:ssc install listutil}. If
installation is unsuccessful, <b>confa</b> will issue an error message and stop.
<p>
In large models, <b>confa</b> may be restricted by Stata limits of 244 characters in
the string expression.  The user might want to rename their variables and give
them shorter names.
<p>
<p>
<b><u>Examples</u></b>
<p>
    Holzinger-Swineford data
        <b>. use http://web.missouri.edu/~kolenikovs/stata/hs-cfa.dta</b>
<p>
    Basic model with different starting values
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9), from(ones)</b>
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9), from(iv)</b>
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9),</b>
            <b>from(smart)</b>
<p>
    Robust and Satorra-Bentler standard errors
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9), from(iv)</b>
            <b>vce(sbentler)</b>
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9), from(iv)</b>
            <b>robust</b>
<p>
    Correlated measurement errors
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9), from(iv)</b>
            <b>corr( x7:x8 )</b>
<p>
    An alternative identification
        <b>. confa (vis: x1 x2 x3) (text: x4 x5 x6) (math: x7 x8 x9), from(ones)</b>
            <b>unitvar(_all) corr(x7:x8)</b>
<p>
    Missing data
        <b>. forvalues k=1/9 {</b>
        <b>.  gen y`k' = cond( uniform()&lt;0.0`k', ., x`k')</b>
        <b>. }</b>
        <b>. confa (vis: y1 y2 y3) (text: y4 y5 y6) (math: y7 y8 y9), from(iv)</b>
        <b>. confa (vis: y1 y2 y3) (text: y4 y5 y6) (math: y7 y8 y9), from(iv)</b>
            <b>missing difficult</b>
<p>
<p>
<b><u>References</u></b>
<p>
    Bollen, K. A. 1996. An alternative two stage least squares (2SLS)
        estimator for latent variable equations. <i>Psychometrika</i> 61: 109-121.
<p>
    Kolenikov, S. 2009. Confirmatory factor analysis using <b>confa</b>. <i>Stata</i>
        <i>Journal</i>, 9(3): 329--373.
<p>
    Satorra, A., and P. M. Bentler. 1994. Corrections to test statistics and
        standard errors in covariance structure analysis. In <i>Latent Variables</i>
        <i>Analysis</i>, ed. A. von Eye and C. C. Clogg, 399-419. Thousand Oaks, CA:
        Sage.
<p>
    Yuan, K.-H., and P. M. Bentler. 1997. Mean and covariance structure
        analysis: Theoretical and practical improvements.  <i>Journal of the</i>
        <i>American Statistical Association</i> 92: 767-774.
<p>
<p>
<b><u>Author</u></b>
<p>
    Stanislav Kolenikov
    Department of Statistics
    University of Missouri
    Columbia, MO
    kolenikovs@missouri.edu
<p>
<p>
<b><u>Also see</u></b>
<p>
    Article: <i>Stata Journal</i>, volume 9, number 3: st0001
<p>
    Online:  <b>factor</b>, <b>bollenstine</b>, <b>confa postestimation</b> (if installed), <b>gllamm</b>
             (if installed).
</pre>