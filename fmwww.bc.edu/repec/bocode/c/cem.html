<pre>
<p>
<b>help cem</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>cem</b> -- Coarsened Exact Matching
<p>
<b><u>Syntax</u></b>
<p>
        <b>cem</b> <i>varname1</i> [<i>(cutpoints1)</i>] [<i>varname2</i> [<i>(cutpoints2)</i>]]<i> ...</i> [<b>,</b> <i>options</i>]
<p>
<p>
<a name="options"></a>    <i>options</i>               Description
    -------------------------------------------------------------------------
      <b><u>tr</u></b><b>eatment(</b><i>varname</i><b>)</b>  name of the treatment variable
      <b><u>sh</u></b><b>owbreaks</b>          display the cutpoints used for each variable
      <b><u>auto</u></b><b>cuts(</b><i>string</i><b>)</b>    method used to automatically generate cutpoints
      <b>k2k</b>                 force <b>cem</b> to return a k2k solution
      <b>imbbreaks(</b><i>string</i><b>)</b>   method used to automatically generate cutpoints for
                            imbalance checks
      <b>miname(</b><i>string</i><b>)</b>      filename root of the imputed datasets, if in
                            separate files
      <b>misets(</b><i>integer</i><b>)</b>     number of imputed datasets, if in separate files
      <b>impvar(</b><i>string</i><b>)</b>      name of imputed dataset variable, if in stack/flong
                            format
      <b><u>noimb</u></b><b>al</b>             do not evaluate the imbalance in the matched
                            solution.
<p>
<b><u>Description</u></b>
<p>
    <b>cem</b> implements the Coarsened Exact Matching method described in Iacus,
    King, and Porro (2008). The main input for <b>cem</b> are the variables to use
    and the cutpoints that define the coarsening. Users can either specify
    cutpoints for a variable or allow <b>cem</b> to automatically coarsen the data
    based on a binning algorithm, chosen by the user.  To specify a set of
    cutpoints for a variable, place a numlist in parentheses after the
    variable's name. To specify an automatic coarsening, place a string
    indicating the binning algorithm to use in parentheses after the
    variable's name. To create a certain number of equally spaced cutpoints,
    say 10, place "<b>#10</b>" in the parentheses (this will include the extreme
    values of the variable). Omitting the parenthetical statement after the
    variable name tells <b>cem</b> to use the default binning algorithm, itself set
    by <b>autocuts</b>. For example,
<p>
    <b>. cem age (10 20 30 40 50) education (scott) re74, treatment(treated)</b>
<p>
    will coarsen the first variable, <b>age</b> into bins of (0-10), (10-20),
    (20-30), (30-40), (40-50) and (50+). The Scott algoritm will be used on
    the second variable, <b>education</b> and the third variable, <b>re74</b>, will use the
    default binning algorithm, Sturge's rule. We could also use
<p>
    <b>. cem age (#6) education (scott) re74, treatment(treated)</b>
<p>
    to coarsen age using 6 equally spaced cutpoints. Using #0 will force <b>cem</b>
    into not coarsening the variable at all. The option <b>autocuts</b> can be used
    to reset the default binning algorithm. For example,
<p>
    <b>. cem age education re74, treatment(treated) autocuts(fd)</b>
<p>
    will coarsen all of variables using the Freedman-Diaconis rule.
<p>
    <b>cem</b> can handle missing data in two ways. If you feed <b>cem</b> data with
    missing values, <b>cem</b> will simply treat the missing value as an additional
    category to match on. If you have multiply imputed data, you can specify
    one of two pieces of information, depending how the imputations are
    stored. First, if the imputations are stored in stacked or <b>flong</b> format
    (the Stata default using the <b>mi</b> commands), then you can simply pass the
    name of the imputation variable to the <b>impvar</b> option. If the imputaed
    datasets are in different files, you can specify the root of the imputed
    filenames ("imputed" if the datasets are named "imputed1.dta",
    "imputed2.dta", etc) in the option <b>miname</b> and the number of imputations
    in the option <b>misets</b>. For example:
<p>
    <b>. cem age education re74, treatment(treated) miname(imputed) misets(5)</b>
<p>
    In either format, <b>cem</b> will includes all imputations in the matching
    process. For observations with imputed values, <b>cem</b> assigns strata by
    finding the strata most often assigned to that observation over the
    imputations (this is like a plurality voting rule with ties broken
    randomly). Distances for the imbalance measure are calculated using the
    mean of imputations. Under either format, <b>cem</b> will result in a stacked or
    <b>flong</b> dataset, which can be directly used with Stata's <b>mi</b> commands.
<p>
    The <b>k2k</b> will force the algorithm to create strata with equal numbers of
    treated and control units. This removes the need to use weights, but at a
    loss of information.  It is recommended that you simply use the output
    <b>cem_weights</b> (see the <b>cem</b> documentation for more information).
<p>
    Note that string variables are ignored by <b>cem</b> and that the ordering of
    value labels is used by <b>cem</b>. If you have an unordered variable, you may
    want to create dummy variables to use them in the matching process.
<p>
<p>
<b><u>Arguments</u></b>
<p>
        +------+
    ----+ Main +-------------------------------------------------------------
<p>
    <i>varname#</i> is a variable to be included as a coviarate.
<p>
    <i>cutpoints#</i> is either a <b>numlist</b> for cutpoints, a string referring to the
        automatic coarsening rule to use, or a pound/hash sign (<b>#</b>) followed
        by a number specifying the number of equally sized bins to use. See
        Description for more information and examples. The binning algorithms
        available are "<b>sturges</b>" for Sturge's rule, "<b>fd</b>" for the
        Freedman-Diaconis rule, "<b>scott</b>" for Scott's rule and "<b>ss</b>" for
        Shimazaki-Shinomoto's rule. Note that cutpoints# only affects
        varname#.
<p>
        +---------+
    ----+ Options +----------------------------------------------------------
<p>
    <i>treatment(varname)</i> sets the treatment variable used for matching. This is
        optional and if omitted, <b>cem</b> will simply sort the observations into
        strata based on the coarsening and not return any output related to
        matching.
<p>
    <i>showcutpoints</i> will have <b>cem</b> display the cutpoints used for each variable
        on the screen.
<p>
    <i>autocuts(string)</i> sets the default automatic coarsening algorithm. The
        default for this is "sturges". Any variable without a <i>cutpoints#</i>
        command after its name will use the autocuts argument.
<p>
    <i>k2k</i> will have <b>cem</b> produce a matching result that has the same number of
        treated and control in each matched strata by randomly dropping
        observations.
<p>
    <i>imbbreaks(string)</i> sets the coarsening method for the imbalance checks
        printed after <b>cem</b> runs. This should match whichever method is used
        for imbalance checks elsewhere.If either <b>cem</b> or <b>imb</b> has been run and
        there is a <b>r(L1_breaks)</b> available, this will be the default.
<p>
    <i>miname(string)</i> is the root of the filenames of the imputed dataset. They
        should be in the working directory. For example, if <b>miname</b> were
        "imputed", then the filenames should be "imputed1.dta","imputed2.dta"
        and so on.
<p>
    <i>misets(integer)</i> is the number of imputed datasets being used for
        matching.
<p>
<b><u>Output</u></b>
<p>
    The following are added as variables to the main Stata dataset. If you
    are using miname() for multiple imputation, <b>cem</b> will save each of these
    to each of the .dta files.
<p>
      <b>cem_strata</b>      the stratum that <b>cem</b> assigned each observation
      <b>cem_weights</b>     the weight assigned to the observation's stratum.
                       Equals 0 if the observation is unmatched and 1 if the
                       observation is treated.
      <b>cem_matched</b>     indicator if the observation was matched.
      <b>cem_treat</b>       when using the multiple imputation features, <b>cem</b>
                       outputs this variable, which is the treatment vector
                       used for matching. <b>cem</b> applies the same combination
                       rule to treatment as to strata.
<p>
<p>
<b><u>Saved Results</u></b>
<p>
    Scalars   
      <b>r(n_strata)</b>     number of strata
      <b>r(n_groups)</b>     number of levels of the treatment variable
      <b>r(n_mstrata)</b>    number of strata with matches
      <b>r(n_matched)</b>    number of matched observations
      <b>r(L1)</b>           multivariate imbalance measure
<p>
<p>
    Matrices  
      <b>r(match_table)</b>  cross tabulation of treatment and matched status
      <b>r(groups)</b>       tabulation of treatment variable
      <b>r(imbal)</b>        matrix of univariate imbalance measures
<p>
    Strings   
      <b>r(varlist)</b>      list of covariate variables used
      <b>r(treatment)</b>    treatment variable used for matching
      <b>r(cem_call)</b>     call to cem
      <b>r(L1_breaks)</b>    break method used for L1 distance
<p>
<b><u>References and Distribution</u></b>
<p>
    <b>cem</b> is licensed under GLP2. For more information, see:
    http://gking.harvard.edu/cem/
<p>
    For a full reference on Coarsened Exact Matching, see:
<p>
    Stefano M. Iacus, Gary King, and Giuseppe Porro, "Matching for Causal
        Inference Without Balance Checking", copy at
        &lt;http://gking.harvard.edu/files/abs/cem-abs.shtml&gt;
<p>
    To report bugs or give comments, please contact Matthew Blackwell
    &lt;blackwel@fas.harvard.edu&gt;.
<p>
</pre>