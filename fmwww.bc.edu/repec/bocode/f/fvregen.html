<pre>
-------------------------------------------------------------------------------
help for <b>fvregen</b>                                                 (Roger Newson)
-------------------------------------------------------------------------------
<p>
<p>
<b><u>Regenerate </u></b><b><u>factor variables</u></b><b><u> in a </u></b><b><u>parmest</u></b><b><u> output dataset</u></b>
<p>
        <b>fvregen</b> [<i>newvarlist</i>] [<i>if</i>] [<i>in</i>] [ <b>,</b> <b><u>fr</u></b><b>om(</b><i>varlist</i><b>)</b> <b><u>do</u></b><b>file(</b><i>dofilename</i><b>)</b>
               <b><u>fm</u></b><b>issing(</b><i>newvarname</i><b>)</b> ]
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>fvregen</b> is intended for use in output datasets (or resultssets) created
    by the programs <b>parmest</b> or <b>parmby</b>.  These are part of the <b>parmest</b>
    package, which can be downloaded from SSC, and which create output
    datasets (or resultssets), with one observation per estimated parameter
    of a model fitted to an original dataset.  <b>fvregen</b> regenerates factor
    variables included in the model, using information from the parameter
    names.  Each regenerated factor variable has non-missing values in
    observations corresponding to parameters corresponding to levels of that
    factor, or to combinations of levels of that factor and other factors in
    products or interactions.  In each observation, the regenerated factors
    with non-missing values are the factors involved in the parameter
    corresponding to that observation, and their values are the values of the
    levels of these factors corresponding to that parameter.  The regenerated
    factors may have the same storage types, display formats, value labels,
    variable labels and variable characteristics as the factor variables of
    the same names in the original dataset, in which the model parameters
    were estimated.  This is made possible by running do-files created by the
    <b>descsave</b> package.  After the factors are generated, they can be listed,
    and/or used in confidence interval plots generated by the <b>eclplot</b>
    package, and/or merged to create a table row variable using the <b>factmerg</b>
    package.  The <b>descsave</b>, <b>eclplot</b> and <b>factmerg</b> package can all be
    downloaded from SSC.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>from(</b><i>varlist</i><b>)</b> specifies a list of one or more input string variables,
        containing parameter names in the form of expanded specific factor
        varlist elements, from which the factors and their values are
        extracted.  If this option is absent, then <b>fvregen</b> attempts to
        extract the factors from a single string variable named <b>parm</b>, which
        is the default name of the parameter name variable produced by the 
        <b>parmest</b> and <b>parmby</b> modules of the <b>parmest</b> package.
<p>
    <b>dofile(</b><i>dofilename</i><b>)</b> specifies a Stata do-file to be called by <b>fvregen</b>
        after the new factors have been created.  This do-file is usually
        created by <b>descsave</b>, and contains commands to reconstruct the new
        factors with the storage types, display formats, value labels,
        variable labels and selected characteristics of the old factors with
        the same names in the original dataset.
<p>
    <b>fmissing(</b><i>newvarname</i><b>)</b> specifies the name of a new binary variable to be
        generated, containing missing values for observations excluded by the
        <b>if</b> and <b>in</b> qualifiers, 1 for other observations in which all the
        generated factors are missing, and 0 for other observations in which
        at least one of the generated factors is nonmissing.
<p>
<p>
<b><u>Remarks</u></b>
<p>
    <b>fvregen</b> is typically used with the <b>parmest</b> and <b>descsave</b> packages to
    create a new dataset with one observation per parameter of the most
    recently fitted model, and data on the estimates, confidence intervals,
    P-values and other attributes of these parameters.  These data are used
    to create tables and/or plots.  Confidence interval plots are often
    produced using the <b>eclplot</b> package.  To merge multiple factor variabless
    and generate string variables containing the factor values, names and/or
    labels, use the <b>factmerg</b> package.  The <b>parmest</b>, <b>descsave</b>, <b>eclplot</b> and 
    <b>factmerg</b> packages can be downloaded from SSC.
<p>
    In Stata versions 7 to 10, factors were included in models using the <b>xi</b>
    command, and factor variables in <b>parmest</b> resultssets were regenerated
    using the <b>factext</b> package, which used information in the variable labels
    of the indicator variables generated by <b>xi</b>.  When Stata version 11 became
    available, it became possible to use factor variable lists in estimation
    commands, and the <b>fvregen</b> package was written to supersede <b>factext</b>.
<p>
<p>
<b><u>Examples</u></b>
<p>
    The following examples will work with the <b>auto</b> data if the SSC packages 
    <b>parmest</b> and <b>eclplot</b> are installed.  They will create confidence interval
    plots of the parameters corresponding to values of the factor <b>rep78</b>.
    Note that the first example produces a plot of mean mileages for each
    repair record group, whereas the second example produces a plot of mean
    differences in mileage between each repair record group and the reference
    repair record group, including a zero-width confidence interval around a
    zero mean difference for the reference repair record group itself.
<p>
                . sysuse auto, clear
                . parmby "regress mpg ibn.rep78, noconst", label norestore
                . fvregen rep78
                . eclplot estimate min95 max95 rep78
<p>
                . sysuse auto, clear
                . regress mpg i.rep78
                . parmest, label norestore
                . fvregen
                . eclplot estimate min95 max95 rep78, yline(0)
<p>
    The following example will work with the <b>auto</b> data if <b>descsave</b> is
    installed in addition to <b>parmest</b> and <b>eclplot</b>.  The reconstructed
    categorical variables <b>rep78</b> and <b>foreign</b> will have the variable and value
    labels belonging to the variables of the same names in the original
    dataset.
<p>
                . sysuse auto, clear
                . tab foreign,gene(orig_) nolab
                . tempfile tf1
                . descsave, do(`"`tf1'"', replace)
                . parmby "regress mpg ibn.foreign i.rep78, noconst", label
                    norestore
                . fvregen, do(`"`tf1'"')
                . describe
                . eclplot estimate min95 max95 rep78, yline(0)
                . eclplot estimate min95 max95 foreign, xlab(0 1)
                . list foreign rep78 estimate min95 max95 p
<p>
    The following example demonstrates higher order interactions.  It will
    work with the <b>auto</b> data if <b>descsave</b> is installed in addition to <b>parmest</b>.
<p>
                . sysuse auto, clear
                . tempfile tf1
                . descsave, do(`"`tf1'"', replace)
                . parmby "regress mpg i.foreign#i.rep78", label norestore
                . fvregen, do(`"`tf1'"')
                . list foreign rep78 parm estimate min95 max95 p, nodisp
<p>
    The <b>parmest</b>, <b>descsave</b> and <b>eclplot</b> packages can be installed from SSC.
<p>
<p>
<b><u>Saved results</u></b>
<p>
    <b>fvregen</b> saves the following results in <b>r()</b>:
<p>
    Macros         
      <b>r(varlist)</b>          list of factor variables created
<p>
<p>
<b><u>Author</u></b>
<p>
    Roger Newson, Imperial College London, UK.  Email:
    r.newson@imperial.ac.uk
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[U] 11.4.3 Factor variables</b>, <b>[P] fvexpand</b>, <b>[D] describe</b>, <b>[D]</b>
             <b>label</b>, <b>[G] graph</b>, <b>[R] xi</b>
<p>
      Help:  <b>[U] 11.4.3 Factor variables</b>, <b>[P] fvexpand</b>, <b>[D] describe</b>, <b>[D]</b>
             <b>label</b>, <b>[G] graph</b>, <b>[R] xi</b>
             <b>parmest</b>, <b>descsave</b>, <b>eclplot</b>, <b>factmerg</b>, <b>factext</b> if installed
</pre>