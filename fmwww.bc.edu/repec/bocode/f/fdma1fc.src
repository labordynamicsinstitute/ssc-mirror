* FDMA1FC******************************************************************* This procedure implements multi-period-ahead dynamic forecasts from* a fractionally differenced series with a MA(1) representation.* The series is observed over range n1 to n2, and forecast for range* n2+1 to n3** series: the series to be forecast* fcser : series for forecast series* d     : fractional differencing parameter* b     : moving average parameter* n1    : first observation of observed series* n2    : last observation of observed series; first obs in forecast*         horizon is (n2+1)* n3    : last observation in forecast horizon** cfb/jb 6731******************************************************************procedure fdma1fc series fcser d b n1 n2 n3type series series *fcsertype real d btype integer n1 n2 n3option switch print 1local series templocal vector weightxx qwtlocal integer ii kkdim weightxx(n3) qwt(n3)*** Calculates binomial expansion terms ****comp weightxx(1) = ddo ii=2,n3comp weightxx(ii) = weightxx(ii-1)*(ii-1-d) / float(ii)end do ii*** Calculate weights ***comp qwt(1)=weightxx(1)+bdo ii=2,n3comp qwt(ii)=weightxx(ii)-b*qwt(ii-1)enddo*** Place series into temp to facilitate dynamic forecasts ***set temp n1 n2 = %if(%valid(series),series,0)*** Calculate one-period ahead forecast series ***set fcser n2+1 n3 = 0.0do ii=n2+1,n3do kk=1,ii-n1set fcser ii ii = fcser(ii) + temp(ii-kk)*qwt(kk)end do kkset temp ii ii = fcserend do iiif print{dis 'forecast series is defined over' n2+1 n3dis ' 'pri n2+1 n3 fcser}end