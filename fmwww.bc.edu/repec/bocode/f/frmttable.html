<pre>
<b>help frmttable</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>frmttable</b> - A programmer's command to write formatted Word or TeX tables
    from a matrix of statistics
   
<p>
<b><u>Syntax</u></b>
<p>
        <b>frmttable</b> [<b>using</b> <i>filename</i>] [<b>,</b> <b><u>s</u></b><b>tatmat(</b><i>string</i><b>)</b> <i>options</i>]
<p>
<b><u>Description</u></b>
<p>
    <b>frmttable</b> is a programmer's command that takes a Stata matrix of
    statistics and creates a fully-formatted Word or TeX table which can be
    written to a file.
<p>
    The <b>frmttable</b> command normally either uses the <b>statmat</b> option with the
    name of a Stata matrix of statistics to be displayed, or the <b>replay</b>
    option, which causes the existing table in memory to be redisplayed, and
    possibly written to disk.
<p>
    <b>frmttable</b> makes available the capability to format Word or TeX tables of
    statistics in myriad ways without the programmer having to write the code
    necessary to do the formatting.  The programmer just needs to write code
    that calculates statistics, and can leave the formatting chores to
    <b>frmttable</b>.
<p>
    Writing formatted tables directly to word processing files can save
    researchers a great deal of time.  What researcher has not found that
    they need to modify their sample in some way after they have already
    prepared the tables in their research paper?  <b>frmttable</b> provides the
    means to automatically create fully formatted tables within Stata, saving
    researchers laborious minutes or hours of manual reformatting each time
    they make modifications.  Automatically formatted tables save time
    principally because researchers usually tweak their tables many times
    before they are ready in their final form.
<p>
    <b>frmttable</b> gives the user as complete control of the final document as
    possible.  Almost every aspect of the table's structure and formatting
    can be specified with options.  Users can change fonts at the table cell
    level, as well as cell spacing and horizontal and vertical lines.
    <b>frmttable</b> can add various text around the table, including titles, notes
    below the table, and paragraphs of text above and below.  Footnotes or
    other text can be interspersed within the statistics.
<p>
    <b>frmttable</b> is the main code behind the <b>outreg</b> command, which creates
    flexible tables of estimation results.
<p>
    If a <b>using</b> <i>filename</i> is specified, <b>frmttable</b> will create a Microsoft Word
    file, or a TeX file using the <b>tex</b> option.  The table created by <b>frmttable</b>
    is displayed in the Results window (minus the fancy fonts) unless the
    <b>nodisplay</b> option is employed.
<p>
    Successive sets of statistics can be <b>merge</b>d or <b>append</b>ed by <b>frmttable</b> into
    a single table.  Additional tables can be written to the same file using
    the <b>addtable</b> option, with paragraphs of text in between.  This makes it
    possible to create a <b>.do</b> file which writes an entire statistical appendix
    in final form to a single Word or TeX file, with no subsequent editing
    required.
<p>
    <b>frmttable</b> converts the Stata matrix of statistics in <b>statmat</b>, along with
    various text additions like titles, into a Mata <b>struct</b> of string matrices
    which persists in memory.  The persistent table data can be reused to
    merge or append new results, or written to a Word or TeX file with new
    formatting directives.  The persistent <b>frmttable</b> data can be assigned
    names, so that multiple tables can be manipulated simultaneously.
<p>
    This help file provides many examples of frmttable in use below the
    description of the options.
<p>
<p>
    Options categories       description
    -----------------------------------------------------------
    <i>statistics</i>                statistics and numerical
                             formatting
    <i>text additions</i>            titles, notes, added rows &amp;
                             columns
    <i>text formatting:</i>         
      <i>column formatting</i>       column widths, justification,
                             etc.
      <i>fonts</i>                   font specifications for table
      <i>lines &amp; spaces</i>          horizontal and vertical lines,
                             cell spacing
    <i>file &amp; display options</i>    tex files, merge, replace, etc.
    <i>brackets options</i>          change brackets around, e.g., <i>t</i>
                             stats
    -----------------------------------------------------------
<p>
    Inline text formatting: superscripts, italics, Greek characters, etc.
    Examples of frmttable in use
<a name="stat_for_opts"></a><p>
<p>
    <i>statistics</i>                   Description
    ---------------------------------------------------------------------------
    <b><u>s</u></b><b>tatmat(</b>Stata matrix name<b>)</b>   matrix of statistics for body of table
    <b><u>sub</u></b><b>stat(</b>#<b>)</b>                   number of substatistics to place below first
                                 statistics
    <b><u>d</u></b><b>oubles(</b><i>Stata matrix name</i><b>)</b>   matrix indicating double statistics
    <b><u>sd</u></b><b>ec(</b>numgrid<b>)</b>                decimal places for all statistics
    <b><u>sf</u></b><b>mt(</b>fmtgrid<b>)</b>                numerical format for all statistics
    <b><u>eq_merge</u></b>                     merge multi-equation statistics into multiple
                                 columns
    <b><u>nobl</u></b><b>ankrows</b>                  drop blank rows in table
    <b><u>fi</u></b><b>ndconst</b>                    put _cons in separate section of table
    ---------------------------------------------------------------------------
<a name="text_add_opts"></a><p>
    <i>text additions</i>               Description
    ---------------------------------------------------------------------------
    <b><u>va</u></b><b>rlabels</b>                    use variable labels as rtitles
    <b><u>t</u></b><b>itle(</b><i>textcolumn</i><b>)</b>            put title above table
    <b><u>ct</u></b><b>itles(</b><i>textgrid</i><b>)</b>            headings at top of columns
    <b><u>rt</u></b><b>itles(</b><i>textgrid</i><b>)</b>            headings to the left of each row
    <b><u>not</u></b><b>e(</b><i>textcolumn</i><b>)</b>             put note below table
    <b><u>pr</u></b><b>etext(</b><i>textcolumn</i><b>)</b>          regular text placed before the table
    <b><u>po</u></b><b>sttext(</b><i>textcolumn</i><b>)</b>         regular text placed after the table
    <b><u>noco</u></b><b>ltitl</b>                    no column titles
    <b><u>noro</u></b><b>wtitl</b>                    no row titles
    <b><u>ad</u></b><b>drows(</b><i>textgrid</i><b>)</b>            add rows at bottom of table
    <b><u>addrt</u></b><b>c(</b><i>#</i><b>)</b>                    number of rtitles columns in addrows
    <b><u>addc</u></b><b>ols(</b><i>textgrid</i><b>)</b>            add columns to right of table
    <b><u>an</u></b><b>notate(</b><i>Stata matrix name</i><b>)</b>  grid of annotation locations
    <b><u>as</u></b><b>ymbol(</b><i>textrow</i><b>)</b>             symbols for annotations
    ---------------------------------------------------------------------------
<a name="col_form_opts"></a><p>
    <i>column formatting</i>                    Description
    ---------------------------------------------------------------------------
    <b><u>colw</u></b><b>idth(</b><i>numlist</i><b>)</b>*                   change column widths
    <b><u>mu</u></b><b>lticol(</b><i>numtriple</i>[;<i>numtriple</i> ...]<b>)</b>  have column titles span multiple
                                         columns
    <b><u>colj</u></b><b>ust(</b><i>cjstring</i>[;<i>cjstring</i> ...]<b>)</b>     column justification: left, center,
                                         right, or decimal
    <b><u>noce</u></b><b>nter</b>                             Don't center table within page
    ---------------------------------------------------------------------------
      * Word-only option
<a name="font_opts"></a><p>
    <i>font specification</i>                 Description
    ---------------------------------------------------------------------------
    <b><u>ba</u></b><b>sefont(</b><i>fontlist</i><b>)</b>                 change the base font for all text
    <b><u>titlf</u></b><b>ont(</b><i>fontcolumn</i><b>)</b>               change font for table title
    <b><u>ctitlf</u></b><b>ont(</b><i>fontgrid</i>[;<i>fontgrid</i>...]<b>)</b>  change font for column titles
    <b><u>rtitlf</u></b><b>ont(</b><i>fontgrid</i>[;<i>fontgrid</i>...]<b>)</b>  change font for row titles
    <b><u>statf</u></b><b>ont(</b><i>fontgrid</i>[;<i>fontgrid</i>...]<b>)</b>   change font for statistics in body of
                                       table
    <b><u>notef</u></b><b>ont(</b><i>fontcolumn</i><b>)</b>               change font for notes below table
    <b><u>addf</u></b><b>ont(</b><i>fontname</i><b>)</b>*                 add a new font type
    <b><u>p</u></b><b>lain</b>                              plain text - one font size, no
                                       justification
    <i>table sections</i>                     explanation of formatted table sections
    ---------------------------------------------------------------------------
      * Word-only option
<a name="lines_spaces_opts"></a><p>
    <i>border lines and spacing</i>   Description
    ---------------------------------------------------------------------------
    <b><u>hl</u></b><b>ines(</b><i>linestring</i><b>)</b>         horizontal lines between rows
    <b><u>vl</u></b><b>ines(</b><i>linestring</i><b>)</b>         vertical lines between columns
    <b><u>hls</u></b><b>tyle(</b><i>lstylelist</i><b>)</b>*       change style of horizontal lines (e.g. double,
                               dashed)
    <b><u>vls</u></b><b>tyle(</b><i>lstylelist</i><b>)</b>*       change style of vertical lines (e.g. double,
                               dashed)
    <b><u>spaceb</u></b><b>ef(</b><i>spacestring</i><b>)</b>      put space above cell contents.
    <b><u>spacea</u></b><b>ft(</b><i>spacestring</i><b>)</b>      put space below cell contents.
    <b><u>spaceht(</u></b><i>#</i><b>)</b>                 change size of <b>spacebef</b> &amp; <b>spaceaft</b>.
    ---------------------------------------------------------------------------
      * Word-only option
<a name="page_fmt_opts"></a><p>
    <i>page formatting</i>          Description
    ---------------------------------------------------------------------------
    <b><u>la</u></b><b>ndscape</b>                pages in landscape orientation
    <b><u>a4</u></b>                       A4 size paper (instead of 8 1/2” x 11”)
    ---------------------------------------------------------------------------
<a name="file_opts"></a><p>
    <i>file and display options</i>   Description
    ---------------------------------------------------------------------------
    <b><u>tex</u></b>                        write a TeX file instead of the default Word
                               file
    <b><u>m</u></b><b>erge</b>[<b>(</b><i>tblname</i><b>)</b>]           merge as new columns to existing table
    <b><u>replace</u></b>                    replace existing file
    <b><u>addt</u></b><b>able</b>                   write a new table below an existing table
    <b><u>ap</u></b><b>pend</b>[<b>(</b><i>tblname</i><b>)</b>]          append as new rows below an existing table
    <b><u>re</u></b><b>play</b>[<b>(</b><i>tblname</i><b>)</b>]          write preexisting table
    <b><u>sto</u></b><b>re(</b><i>tblname</i><b>)</b>             store table with name "<i>tblname</i>"
    <b><u>clear</u></b>[<b>(</b><i>tblname</i><b>)</b>]           clear existing table from memory
    <b><u>fr</u></b><b>agment</b>**                 create TeX code fragment to insert into TeX
                               document
    <b><u>nod</u></b><b>isplay</b>                  don't display table in results window
    <b><u>dw</u></b><b>ide</b>                      display all columns however wide
    ---------------------------------------------------------------------------
      ** TeX-only option
<a name="brack_opts"></a><p>
    <i>brackets options</i>                      Description
    ---------------------------------------------------------------------------
    <b><u>sq</u></b><b>uarebrack</b>                           square brackets instead of
                                          parentheses
    <b><u>br</u></b><b>ackets(</b><i>textpair</i> [ \ <i>textpair</i> ...]<b>)</b>  symbols with which to bracket
                                          substatistics
    <b><u>nobrk</u></b><b>et</b>                               put no brackets on substatistics
    <b><u>dbl</u></b><b>div(</b><i>text</i><b>)</b>                          symbol dividing double statistics
                                          ("-")
    ---------------------------------------------------------------------------
<p>
<a name="stats_formatting"></a><p>
        +-------------------------------------+
    ----+ Statistics and numerical formatting +------------------------------
<a name="statmat"></a><p>
    <b><u>s</u></b><b>tatmat(</b><i>Stata matrix name</i><b>)</b> names the Stata matrix containing the
        statistics making up the body of the table.
<p>
        If the user has filled matrix rownames or colnames for the Stata
        matrix, they become the row titles and column titles of the table
        (unless the <b>rtitles</b> or <b>ctitles</b> options are specified).  If the
        rownames and colnames of the <b>statmat</b> matrix are varnames, the option
        <b>varlabels</b> will replace the variable names with their variable labels,
        if they exist.
<p>
        See an application of <b>statmat</b> in Example 1.
<a name="doubles"></a><p>
    <b><u>d</u></b><b>oubles(</b><i>Stata matrix name</i><b>)</b>}} names the Stata matrix indicating which
        statistics are "double statistics".  Double statistics are statistics
        made up of two numbers like confidence intervals or minimum-maximum
        ranges.  The <b>doubles</b> option allows the lower and upper numbers to be
        placed in different columns of the <b>statmat</b>, to be combined in the
        formatted table.
<p>
        The <b>doubles</b> matrix is a row vector with as many elements as columns
        in <b>statmat</b>.  A 0 specifies that the column is not a second double
        statistic, and a 1 indicates that it is.  Thus if <b>statmat</b> consists of
        a matrix with columns containing the means, lower confidence bounds,
        and upper confidence bounds, of some variables, a <b>doubles</b> matrix of
        (0,0,1) would cause the lower and upper confidence bounds to be
        combined into a single confidence interval.  The default symbol to
        separate the lower and upper statistic of double statistics is a
        dash, but this can be changed with the <b>dbldiv</b> option.
<a name="sdec"></a><p>
    <b>sdec(</b><i>numgrid</i><b>)</b> specifies the decimal places for the statistics in <b>statmat</b>.
        The <b>sdec</b> <i>numgrid</i> correponds to the decimal places for each of the
        statistics in the table. The default number of decimal places is 3.
<p>
        The <i>numgrid</i> can be a single integer applying to the whole table, or
        it can be a grid of integers specifying the decimal places for each
        cell in the table individually.  A <i>numgrid</i> is a grid of intergers
        0-15 in the form used by <b>matrix define</b>.  Commas separate elements
        along a row, and backslashes ("\") separate rows: <i>numgrid</i> has the
        form (#[,#...] [\ #[,#...] [...]]).  For example, if the table of
        statistics has three rows and two columns, the <b>sdec(</b><i>numgrid</i><b>)</b> could be
        <b>sdec(</b>1,2 \ 2,2 \ 1,3<b>)</b>.  If you specify a grid smaller than the table
        of statistics, the last rows and columns of the <b>sdec</b> <i>numgrid</i> will be
        repeated to cover the whole table.  So for a 3 by 2 <b>statmat</b>, <b>sdec(</b>1 \
        2<b>)</b> would have the same effect as <b>sdec(</b>1,1 \ 2,2 \ 2,2<b>)</b>.  Unbalanced
        rows or columns will not cause an error.  They will be filled in, and
        <b>frmttable</b> will display a warning message.
<a name="sfmt"></a><p>
    <b>sfmt(</b><i>fmtgrid</i><b>)</b> specifies the numerical format for statistics in <b>statmat</b>.
        The <b>sdec</b> <i>fmtgrid</i> is a grid of the format types (e, f, g, fc, or gc)
        for each statistic in the table.  The <i>fmtgrid</i> can be a single format
        applying to the whole table, or it can specify formats for each cell
        in the table individually.
<p>
        A <i>fmtgrid</i> is <i>fmt</i>[,<i>fmt</i>...] [\ <i>fmt</i>[,<i>fmt</i>...] ...]] where <i>fmt</i> is either
        e, f, fc, g, or gc:
<p>
          fmt code   format type
          -------------------------------------------------
            <b>e</b>        exponential (scientific) notation
            <b>f</b>        fixed number of decimals
            <b>fc</b>       fixed with commas for thousands, etc.
                                    - the default
            <b>g</b>        "general" format (see <b>format</b>)
            <b>gc</b>       "general" format with commas for
                                    thousands, etc.
          -------------------------------------------------
<p>
        The "g" formats are not likely to be useful for <b>frmttable</b> tables
        because they do not allow the user to control the number of decimal
        places displayed.
<p>
        If the <i>fmtgrid</i> has dimensions smaller or bigger than the <b>statmat</b>
        matrix, the <i>fmtgrid</i> is adjusted just as the <i>numgrid</i> is for <b>sdec</b>.
<a name="substat"></a><p>
    <b><u>sub</u></b><b>stat(</b>#<b>)</b>} indicates the number of "sub"-statistics to be placed in
        separate rows below the principal statistic.  For example, if the
        <b>statmat</b> matrix has 3 rows and 4 columns, a <b>substat(1)</b> option would
        interlace the statistics in <b>statmat</b> column 2 below those of column 1,
        and statistics in column 4 below those of column 3, resulting in a
        final table with six rows and two statistics columns.  This allows
        the programmer to create a <b>statmat</b> with sub-statistics in separate
        columns from the principal statistics and rely on <b>frmttable</b> to
        interlace them (such as <i>t</i> statistics below regression coefficients or
        standard deviations below means).
<p>
        See applications of <b>substat</b> in Example 4 and Example 5.
<a name="eq_merge"></a><p>
    <b>eq_merge</b> merges the columns of a multi-equation <b>statmat</b> matrix into
        multiple columns, one column per equation.  This option is used by 
        <b>outreg</b>, for example, to put the coefficients of each sureg equation
        side by side instead of stacked vertically.  The equation statistics
        are merged as if each of the equations was sequentially combined with
        the <b>merge</b> option.
<p>
        <b>frmttable</b> identifies the equations in <b>statmat</b> by <b>roweq</b> names.  All
        rows of <b>stamat</b> with the same <b>roweq</b> name is considered to be an
        equation.  If no <b>roweq</b>s are assigned, <b>frmttable</b> takes all rows to
        belong to the same (unnamed) equation.  <b>eq_merge</b> is an option whose
        main purpose is to help <b>outreg</b> reorganize multi-equation estimation
        results.
<a name="noblankrows"></a><p>
    <b><u>nobl</u></b><b>ankrows</b> deletes completely blank rows in the body of the formatted
        table.  A blank row is one where the data are missing in every
        column.
<a name="findcons"></a><p>
    <b><u>fi</u></b><b>ndcons</b> finds table rows with a row title of "_cons" and assigns them to
        a separate row section which is kept below the other row sections.
        This option is useful for merging statistical results like regression
        coefficients, where you want to ensure that the constant coefficient
        estimates are reported below all other coefficients even when the
        user merges additional statistics containing new variables.
<p>
        This option is rarely used.
<a name="examples"></a><p>
<p>
<b><u>Examples</u></b>
<p>
   1.  Basic usage.
   2.  Merge and append.
   3.  Multi-column titles, border lines, fonts.
   4.  Add stars for significance to regression output: substatistics and annot
&gt; ate.
   5.  Make a table of summary statistics &amp; merge it with a regression table.
   6.  Create complex tables using merge and append.
   7.  Double statistics.
<a name="xmpl1"></a>   
<p>
<b><u>Example 1: basic usage</u></b>
<p>
    The basic role of <b>frmttable</b> is to take statistics in a Stata matrix and
    organize them in a table that is displayed in the Results window and can
    be written to a file as a Word table or a TeX table.
<p>
    First, we create a 2x2 Stata matrix named A:
<p>
        . mat A = (100,50\0,50)
        . mat list A
        
        A[2,2]
             c1   c2
        r1  100   50
        r2    0   50
        
    The simplest usage of the <b>frmttable</b> command is to display the matrix A:
<p>
        . frmttable, statmat(A)
        
                                   -----------------
                                     100.00  50.00 
                                      0.00   50.00 
                                   -----------------
<p>
    This doesn't get us very far.  The reason <b>frmttable</b> is useful is that it
    can make extensive adjustments to the formatting of the table, and write
    the result to a Word or TeX document.
<p>
    The <b>frmttable</b> command below has a <b>using</b> statement followed by a file name
    ("xmpl1").  This causes the table to be written to a Word document
    "xmpl1.doc".  Word documents are the default; the table would be written
    as a TeX document with the <b>tex</b> option.
<p>
    The <b>frmttable</b> statement below adds a number of options.  The first, <b>sdec</b>,
    sets the number of decimal places displayed for the statistics in <b>statmat</b>
    to 0.  The next three options, <b>title</b>, <b>ctitle</b>, and <b>rtitle</b> add an overall
    title to the table, titles above each column of the table, and titles on
    the left of each row of the table, respectively.  The column and row
    titles are designated with the syntax used for matrices: commas separate
    columns, and backslashes separate rows.
<p>
        . frmttable using xmpl1, statmat(A) sdec(0) title("Payoffs")   ///
             ctitle("","Game 1","Game 2") rtitle("Player 1"\"Player 2")
        
                                        Payoffs
                             ----------------------------
                                         Game 1  Game 2 
                             ----------------------------
                              Player 1    100      50   
                              Player 2     0       50   
                             ----------------------------
<a name="xmpl2"></a><p>
<b><u>Example 2: merge and append</u></b>
<p>
    Once <b>frmttable</b> is run, the table created stays in memory (as a <b>struct</b> of
    Mata string matrices).  Subsequent statistical results can be <b>merge</b>d as
    new columns of the table or <b>append</b>ed as new rows.  The merged columns are
    arranged so that the new row titles are matched with the existing table's
    row titles, and rows with unmatched titles are placed below the other
    statistics (similar to the way the Stata <b>merge</b> command matches
    observations of the merged dataset).
<p>
    The <b>frmttable</b> command below merges a new column of statistics for players
    1 and 3 to the existing <b>frmttable</b> table, already created in the previous
    example.
<p>
        . mat B = (25\75)
        
        . frmttable, statmat(B) sdec(0)   ///
             ctitle("","Game 3") rtitle("Player 1"\"Player 3") merge 
        
                                        Payoffs
                         ------------------------------------
                                     Game 1  Game 2  Game 3 
                         ------------------------------------
                          Player 1    100      50      25   
                          Player 2     0       50           
                          Player 3                     75   
                         ------------------------------------
        
    In this case, the new statistics in matrix B are arranged according to
    the row titles in the <b>rtitle</b> option.  The statistics in the first row of
    B for "Player 1" are lined up with the statistics for "Player 1" in the
    existing table, while the statistics for "Player 3" are placed below
    "Player 2" because "Player 3" is a new row title.
<p>
    The text of the row titles must match exactly for the merged results to
    be placed in the same row.  Row titles of "Player 1" and "player 1" do
    not match, so they would be placed in different rows.
<p>
    Next we add another column to the table for new game results.
<p>
        . mat C = (90\10)
        
        . frmttable, statmat(C) sdec(0) ///
             ctitle("","Game 4") rtitle("Player 2"\"Player 4") merge 
        
                                        Payoffs
                     --------------------------------------------
                                 Game 1  Game 2  Game 3  Game 4 
                     --------------------------------------------
                      Player 1    100      50      25           
                      Player 2     0       50              90   
                      Player 3                     75           
                      Player 4                             10   
                     --------------------------------------------
        
    The statistics for "Player 2" and "Player 4" are merged: the statistics
    for "Player 2" are lined up with previous results for "Player 2" and
    statistics for the new row title, "Player 4", are placed below the other
    rows.
<p>
    Finally, we <b>append</b> new <i>rows</i> to the table, for the total payoffs.
<p>
        . mat D = (100,100,100,100)
        
        . frmttable, statmat(D) sdec(0) rtitle("Total") append
        
                                        Payoffs
                     --------------------------------------------
                                 Game 1  Game 2  Game 3  Game 4 
                     --------------------------------------------
                      Player 1    100      50      25           
                      Player 2     0       50              90   
                      Player 3                     75           
                      Player 4                             10   
                      Total       100     100     100     100   
                     --------------------------------------------
        
    Whereas the <b>merge</b> option created new table columns, the <b>append</b> option
    places new statistics in rows below the existing table.  If the matrix D
    had had more or less than 4 columns, it would still be appended below the
    existing results, but with a warning message.  The arrangement of the
    <b>append</b>ed results does not depend on the column titles (unlike the way
    <b>merge</b> depends on the row titles).  In fact, the <b>ctitles</b> of the appended
    data are ignored if they are specified.
<p>
    An alternative way of adding rows and columns is with the options <b>addrows</b>
    and <b>addcols</b>.  <b>merge</b> and <b>append</b> add matrices of numbers to a previously
    created table; <b>addrow</b> and <b>addcol</b> add on rows and columns of text (which
    can include numbers) to the table currently being created.
<p>
    The following set of commands will create the same table as above, but
    uses the <b>addrows</b> option to attach the column totals as text instead of
    <b>append</b>ing a Stata matrix:
<p>
        . mat E = (100,50,25,. \ 0,50,.,90 \ .,.,75,. \ .,.,.,10)
        
        . frmttable, statmat(E) sdec(0) addrows("Total", "100", "100", "100", "
&gt; 100") ///
             rtitles("Player 1" \ "Player 2" \ "Player 3" \ "Player 4") ///
             ctitles("", "Game 1", "Game 2", "Game 3", "Game 4")               
&gt;       ///
             title("Payoffs")
        
                                        Payoffs
                     --------------------------------------------
                                 Game 1  Game 2  Game 3  Game 4 
                     --------------------------------------------
                      Player 1    100      50      25           
                      Player 2     0       50              90   
                      Player 3                     75           
                      Player 4                             10   
                      Total       100     100     100     100   
                     --------------------------------------------
<a name="xmpl3"></a>        
<b><u>Example 3: multi-column titles, border lines, fonts</u></b>
<p>
    Many formatting options are available in <b>frmttable</b>.  This example makes
    some of the column titles span multiple columns, places a vertical line
    in the table, and changes the font size and typeface.
<p>
    <b>frmttable</b> can change many other aspects of the tables it creates, such as
    footnotes and other annotations among the statistics, justification of
    columns, and spacing above and below table cells.  You can find
    additional information of several <b>frmttable</b> formatting options in
    examples of the <b>outreg</b> command related to fonts, special characters,
    multiple tables in the same document, and footnotes.
<p>
    In the Stata code below, the <b>frmttable</b> table is created from data in the
    matrix F.  Where F contains missing values, the table cells will be
    blank.
<p>
    The table's column titles in the <b>ctitles</b> option have two rows and the
    first row of titles are meant to span two columns each.  They are made to
    span multiple columns with the <b>multicol(</b>1,2,2;1,4,2<b>)</b> option.  The two
    triples of numbers, 1,2,2 and 1,4,2, indicate which table cells span more
    than one column.  1,2,2 indicates that the first row, second column of
    the table should span two columns, and the 1,4,2 indicates that the first
    row, fourth column of the table should span two columns.
<p>
    A dashed vertical line is placed in the table separating the row titles
    from the statistics.  The <b>vlines(</b>010<b>)</b> option where the vertical line or
    lines are placed.  A 0 indicates no line, and a 1 indicates a line.  The
    010 means no line to the left of the first cell (or column), a vertical
    line between the first and second cell and no line between the second the
    third cell.  Since the table has more than two columns, the "no line"
    specification is extended to all the rest of the columns.  The <b>vlstyle(</b>a<b>)</b>
    option changes the line style from the default of a solid line to a
    dashed line.
<p>
    The last option, <b>basefont(</b>arial fs10<b>)</b>, changes the font of the Word table
    to be Arial font, with a base font size of 10 points (the table's title
    has larger text and the notes have smaller text).
<p>
        . mat F = (100,50,25,. \ 0,50,.,90 \ .,.,75,. \ .,.,.,10 \ 100,100,100,
&gt; 100)
        
        . frmttable using xmpl3, statmat(F) sdec(0) title("Payoffs") replace   
&gt;   ///
             ctitles("", "{\ul Day 1}", "", "{\ul Day 2}" ,"" \                
&gt;   ///
                 "", "Game 1", "Game 2", "Game 3", "Game 4")                   
&gt;   ///
             multicol(1,2,2;1,4,2)                                             
&gt;   ///
             rtitles("Player 1" \ "Player 2" \ "Player 3" \ "Player 4" \ "Total
&gt; ") ///
             vlines(010) vlstyle(a) basefont(arial fs10)
        (<i>output omitted</i>)
<p>
    The table created in this example is not shown because most of its
    features (font, vertical lines, etc.) appear correctly only in the Word
    table created, not in the Stata Results window.
<a name="xmpl4"></a><p>
<b><u>Example 4: Add stars for significance to regression output: substatistics and a</u></b>
<b><u>&gt; nnotate</u></b>
<p>
    The following Stata commands create a matrix, <b>b_se</b>, containing regression
    coefficients in the first column and standard errors of estimates in the
    second column:
<p>
        . sysuse auto, clear
        . regress mpg length weight headroom
        (<i>output omitted</i>)
        
        . matrix b_se = get(_b)', vecdiag(cholesky(diag(vecdiag(get(VCE)))))'
        . matrix colnames b_se = mpg mpg_se
        . mat li b_se
        
        b_se[4,2]
                         mpg      mpg_se
          length  -.07849725   .05699153
          weight  -.00385412   .00159743
        headroom  -.05143046   .55543717
           _cons   47.840789   6.1492834
        
<p>
    <b>frmttable</b> will then convert this matrix into a formatted table.  The
    <b>substat(1)</b> option informs <b>frmttable</b> that the second column of statistics,
    the standard errors, should be place below the first column of
    statistics, the coefficients, in the table.  If the option had been
    <b>substat(2)</b>, the second and third columns of statistics would be
    interweaved below the statistics in the first column of <b>statmat</b>.
<p>
    In the absence of <b>rtitles</b> and <b>ctitles</b>, <b>frmttable</b> uses the matrix rownames
    and colnames of <b>b_se</b> as the row and column titles for the table.
<p>
        . frmttable, statmat(b_se) substat(1) sdec(3)
        
                                 ---------------------
                                               mpg   
                                 ---------------------
                                  length     -0.078  
                                             (0.057) 
                                  weight     -0.004  
                                             (0.002) 
                                  headroom   -0.051  
                                             (0.555) 
                                  _cons      47.841  
                                             (6.149) 
                                 ---------------------
        
    Stars indicating significance levels can be placed next to the standard
    errors using the <b>annotate</b> option.  First it is necessary to create a
    Stata matrix indicating the cells to which the stars should be added.
    The matrix, named <b>stars</b> below, has a 1 in the second row, second column,
    and a 2 in the fourth row, second column, since the second and fourth
    coefficients are statistically significant.
<p>
        . local bc = rowsof(b_se)
        . matrix stars = J(`bc',2,0)
        . forvalues k = 1/`bc' {
        .     matrix stars[`k',2] =   ///
                  (abs(b_se[`k',1]/b_se[`k',2]) &gt; invttail(`e(df_r)',0.05/2)) +
&gt;    ///
                  (abs(b_se[`k',1]/b_se[`k',2]) &gt; invttail(`e(df_r)',0.01/2))
        . }
        . mat list stars
        
        stars[4,2]
            c1  c2
        r1   0   0
        r2   0   1
        r3   0   0
        r4   0   2
        
    The entries of 1 and 2 in <b>stars</b> correspond to the first and second entry
    of the <b>asymbol(*,**)</b> option, adding a single star to the cell where the 1
    is, and a double star in the cell where the 2 is.  All the elements in
    <b>stars</b> equal to 0 will have no symbols added.  The dimensions of <b>stars</b>
    (4x2) corresponds to the dimensions of the <b>statmat</b> matrix, not the
    dimensions of the statistics in the final table (8x1), which has a single
    statistics column due to the <b>substat(1)</b> option.
<p>
    The option <b>varlabels</b> causes the variable labels for the variables <b>mpg</b>,
    <b>length</b>, <b>weight</b>, and <b>headroom</b> to be substituted for their names.
<p>
        . frmttable using xmpl4, statmat(b_se) substat(1) sdec(3) ///
             annotate(stars) asymbol(*,**) varlabels
        
                           ---------------------------------
                                             Mileage (mpg) 
                           ---------------------------------
                            Length (in.)        -0.078     
                                                (0.057)    
                            Weight (lbs.)       -0.004     
                                               (0.002)*    
                            Headroom (in.)      -0.051     
                                                (0.555)    
                            Constant            47.841     
                                               (6.149)**   
                           ---------------------------------
        
<p>
    The code above implements the most basic capabilities of <b>outreg</b>, so the
    same table can more easily be created by
<p>
        . outreg, se varlabels
<a name="xmpl5"></a>        
<b><u>Example 5: make a table of summary statistics &amp; merge it with a regression tabl</u></b>
<b><u>&gt; e</u></b>
<p>
    First we create a Stata matrix containing summary statistics for four
    variables, <b>length</b>, <b>weight</b>, <b>headroom</b>, <b>mpg</b>.  The first column of the matrix
    <b>mean_sd</b> contains the means and the second column contains the standard
    deviations.  The statistics are calculated by the <b>summarize</b> command,
    looping over the variables using the <b>foreach</b> command.
<p>
        . mat mean_sd = J(4,2,.)
        . local i = 1
        . foreach v in length weight headroom mpg {
        .         summarize `v' 
        .         mat mean_sd[`i',1] = r(mean)
        .         mat mean_sd[`i',2] = r(sd)
        .         local i = `i' + 1
        . }
        (<i>output omitted</i>)
<p>
        . matrix rownames mean_sd = length weight headroom mpg
        . matrix list mean_sd
        
        mean_sd[4,2]
                         c1         c2
          length  187.93243   22.26634
          weight  3019.4595  777.19357
        headroom  2.9932432  .84599477
             mpg  21.297297  5.7855032
        
    We can create a formatted table with this matrix of statistics, and we
    can also merge these statistics into any other table created by <b>frmttable</b>
    (or by commands which call <b>frmttable</b>, like <b>outreg</b>).  The command below
    <b>merge</b>s the summary statistics with the table of regression coefficients
    created in the previous example.
<p>
        . frmttable, statmat(mean_sd) substat(1) varlabels ///
             ctitles("", Summary statistics) merge
        (note: tables being merged have different numbers of row sections)
<p>
                                     A Regression
                 -----------------------------------------------------
                                   Mileage (mpg)  Summary statistics 
                 -----------------------------------------------------
                  Length (in.)        -0.078            187.93       
                                      (0.057)          (22.27)       
                  Weight (lbs.)       -0.004           3,019.46      
                                     (0.002)*          (777.19)      
                  Headroom (in.)      -0.051             2.99        
                                      (0.555)           (0.85)       
                  Mileage (mpg)                         21.30        
                                                        (5.79)       
                  Constant            47.841                         
                                     (6.149)**                       
                  R2                   0.66                          
                  N                     74                           
                 -----------------------------------------------------
                                  * p&lt;0.05; ** p&lt;0.01
        
        
    This example shows how <b>frmttable</b> works, but a user can already create a
    table similar to this with the following commands:
<p>
        . regress mpg length weight headroom
        . outreg, se varlabels
        . mean length weight headroom mpg
        . outreg, se varlabels merge
<a name="xmpl6"></a>                
<b><u>Example 6: create complex tables using merge and append</u></b>
<p>
    If you use <b>frmttable</b> to handle the output from a new command you write,
    users of your command can build quite complex tables by repeatedly
    executing your command, along with <b>frmttable</b>'s <b>merge</b> and <b>append</b> options.
    In this exercise we use <b>outreg</b> as an example of a <b>frmttable</b>-based command
    to build a table from parts.
<p>
    Say we wanted to create a table showing how a car's weight affects its
    mileage.  We want the table to be broken down by foreign vs. domestic
    cars, and by three categories of headroom.  It is easy with a
    <b>frmttable</b>-based command like <b>outreg</b> to create six separate tables with
    all of these results.  It is also easy to create a single table with six
    columns (or six rows) of coefficients using straightforward application
    of the <b>merge</b> (or <b>append</b>) options.
<p>
    It is more complicated to create a table with three columns of foreign
    estimates above three columns of domestic estimates.  The results for
    foreign cars must be merged across the headroom categories into one
    table, and the results for the domestic cars merged into a <i>separate</i>
    table.  The two tables must then be appended one below the other.
    Creating two separate <b>frmttable</b> tables simultaneously requires the use of
    table names.
<p>
    The statistics for the table in this example are created in a double 
    <b>foreach</b> loop, iterating first over foreign vs. domestic, and then over
    three categories of headroom.  Using data from <b>auto.dta</b>, we first recode
    the variable <b>headroom</b> into a new variable <b>hroom</b> with just 3 levels.
<p>
        . sysuse auto, clear
        (1978 Automobile Data)
<p>
        . recode headroom (1.5=2) (3.5/5=3), gen(hroom)
        (34 differences between headroom and hroom)
<p>
    Ignore the <b>outreg, clear</b> commands below for the moment:
<p>
        . outreg, clear(row1)
        . outreg, clear(row2)
        
    The heart of the table building occurs with a double <b>foreach</b> loop,
    iterating over <b>foreign</b> and <b>hroom</b> values.  We estimate the correlation of
    <b>mpg</b> with <b>weight</b> using the <b>regress</b> command for each category in the double
    loop.  The formatted table is built up using the <b>outreg, merge</b> command
    repeatedly.
<p>
        . foreach f in 0 1 {
             foreach h in 2 2.5 3 {
                regress mpg weight if foreign==`f' &amp; hroom==`h'
                outreg, nocons noautosumm merge(row`f')
             }
          }
        (<i>output omitted</i>)
<p>
    The <b>outreg</b> command has options <b>nocons</b> to suppress the constant
    coefficient and <b>noautosumm</b> to suppress the R-squared and number of
    observations.  The <b>merge</b><b>(row`f')</b> option is the interesting part.  This
    merges the coefficients into two separate tables, named <b>row0</b> and <b>row1</b>,
    each of which contains three columns of estimates for the categories of
    <b>hroom</b>.
<p>
    The first time the <b>merge</b> option is invoked for each table, we want it to
    create the first column: to merge the results onto a table which doesn't
    yet exist.  The <b>merge</b> option allows merging onto a non-existent table,
    for convenience in loops like this.  However, to make this work, it is
    important to clear out any pre-existing table of the same name.
    Particularly, we want to clear out the table from the previous time we
    ran the same <b>.do</b> file.  Otherwise, the table would get larger and larger
    each time the <b>.do</b> file is run.  That is the reason for the two <b>outreg,</b>
    <b>clear</b> commands just before the loop.  An alternative to the <b>outreg, clear</b>
    command, especially if one needs to clear many <b>frmttable</b> tables, is <b>mata:</b>
    <b>mata clear</b> which clears all Mata memory structures, including the tables.
<p>
    Now that the tables for each row are created, we want to append them one
    below the other.  We do this with a combination of the <b>replay</b> and <b>append</b>
    options.  The <b>replay(row0)</b> option displays the named table (and can write
    it to a word processing document if <b>using</b> is specified).  <b>append(row1)</b>
    option appends the table <b>row1</b> containing the second row below the <b>row0</b>
    results.  The rest of the <b>outreg</b> command below adds titles to the final
    table.  Note that the combined table now has table name <b>row0</b>.
<p>
        . outreg, replay(row0) append(row1) replace ///
             rtitle(Domestic \ "" \ Foreign) ///
             ctitle("", "", "Headroom", "" \ "Origin", "&lt;=2.0", "2.5", "&gt;=3.0")
&gt;  ///
             title(Effect of weight on MPG by origin and headroom)
        
                    Effect of weight on MPG by origin and headroom
                      -------------------------------------------
                                             Headroom           
                       Origin       &lt;=2.0      2.5      &gt;=3.0   
                      -------------------------------------------
                       Domestic     -0.006    -0.007    -0.005  
                                   (3.62)**  (7.63)*   (8.00)** 
                       Foreign      -0.018    -0.008    -0.011  
                                    (1.87)    (2.14)   (2.64)*  
                      -------------------------------------------
        
    This example shows how elaborate tables can be created by combining
    smaller parts using the <b>merge</b> and <b>append</b> options and table names.  Other
    useful options for this purpose are <b>addrows</b> and <b>addcols</b>, which add
    columns of text (which may include numbers) rather than statistics from
    Stata matrices.
<a name="xmpl7"></a><p>
<b><u>Example 7: double statistics</u></b>
<p>
    Double statistics are statistics showing two numbers, such as a
    minimum-maximum range, or a confidence interval.  <b>frmttable</b> has the
    <b>doubles</b> option to make it easy to display them.  The lower and upper
    value of double statistics are held in neighboring columns of <b>statmat</b>,
    and the <b>doubles</b> option indicates which columns are the second column of a
    double statistic.  <b>frmttable</b> automatically combines the two numbers into
    as single cell of the formatted table, with a dash in between them.
<p>
    The following code creates a Stata matrix <b>conf_int</b>, containing the mean
    of several variables in the first column, and the lower and upper
    confidence intervals in the second and third columns, respectively.  The
    details are similar to Example 5 above.
<p>
        . mat conf_int = J(4,3,.)
        . local i = 1
        . foreach v in length weight headroom mpg {
             summ `v' 
             mat conf_int[`i',1] = r(mean)
             mat conf_int[`i',2] = r(mean) - invttail(r(N)-1,0.05/2)*sqrt(r(Var
&gt; )/r(N))
             mat conf_int[`i',3] = r(mean) + invttail(r(N)-1,0.05/2)*sqrt(r(Var
&gt; )/r(N))
             local i = `i' + 1
          }
        (<i>output omitted</i>)
<p>
        . matrix rownames conf_int = length weight headroom mpg
        . mat li conf_int
<p>
        conf_int[4,3]
                         c1         c2         c3
          length  187.93243  182.77374  193.09113
          weight  3019.4595  2839.3983  3199.5206
        headroom  2.9932432  2.7972422  3.1892443
             mpg  21.297297  19.956905   22.63769
<p>
    For <b>frmttable</b> to display double statisics, it requires a row vector
    indicating which columns contain the second numbers of double statistics.
    In this example, there are second values of a double statistic in column
    3, so the third element of the <b>doubles</b> option matrix <b>dcols</b> is set to 1.
    The <b>doubles(dcols)</b> option causes the numbers in the second and third
    columns of <b>conf_int</b> (the lower and upper confidence limits) to be
    combined in the final table.
<p>
        . matrix dcols = (0,0,1)
        . frmttable, statmat(conf_int) substat(1) doubles(dcols) varlabels ///
            ctitles("",Summary statistics) sdec(0 \ 0 \ 0 \ 0 \ 2 \ 2 \ 1 \ 1) 
&gt;      
        
                        --------------------------------------
                                          Summary statistics 
                        --------------------------------------
                         Length (in.)            188         
                                             (183 - 193)     
                         Weight (lbs.)          3,019        
                                           (2,839 - 3,200)   
                         Headroom (in.)          2.99        
                                            (2.80 - 3.19)    
                         Mileage (mpg)           21.3        
                                            (20.0 - 22.6)    
                        --------------------------------------
<p>
    Note that there is only one substatistic in <b>substat(1)</b> since the second
    statistic is a double statistic.
<p>
    Confidence intervals have been integrated into the <b>outreg</b> command, making
    use of <b>frmttable</b>'s <b>doubles</b> option, so that the particular table in this
    example is easily created with the following commands:
<p>
        . mean length weight headroom mpg
        . outreg, stats(b,ci) nostars varlabels ctitles("",Summary statistics) 
&gt; bdec(0 0 2 1)
<p>
<b><u>Author</u></b>
<p>
        John Luke Gallup, Portland State University, USA
        jlgallup@pdx.edu
<p>
<b><u>Also see</u></b>
</pre>