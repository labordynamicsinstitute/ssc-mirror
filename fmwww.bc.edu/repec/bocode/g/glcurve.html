<pre>
-------------------------------------------------------------------------------
help for <b>glcurve</b>
 (STB-48: sg107; STB-49: sg107_1; SJ1-1: gr0001; SJ4-4: gr0001_1; SJ6-4: gr0001
&gt; _2; SJ7-2: gr0001_3; ??)
-------------------------------------------------------------------------------
<p>
<b><u>Derivation of generalised Lorenz curve ordinates with unit record data</u></b>
<p>
        <b>glcurve</b> <i>varname</i> [<i>weight</i>] [<b>if</b> <i>exp</i>] [<b>in</b> <i>range</i>] [<b>,</b> <b><u>p</u></b><b>var(</b><i>newvarname</i><b>)</b>
                 <b><u>gl</u></b><b>var(</b><i>newvarname</i><b>)</b> <b><u>so</u></b><b>rtvar(</b><i>varname</i><b>)</b> <b>by(</b><i>varname</i><b>)</b> <b><u>sp</u></b><b>lit</b> <b><u>nogr</u></b><b>aph</b>
                 <b>replace</b> <b><u>l</u></b><b>orenz</b> <b>atip(</b><i>string</i><b>)</b> <b>rtip(</b><i>string</i><b>)</b> <b>plot(</b><i>plot</i><b>)</b>
                 <i>graph_options</i> ]
<p>
    <b>aweight</b>s and <b>fweight</b>s are allowed; see help weights.
<p>
<p>
<b><u>Description</u></b>
<p>
    Given a variable <i>varname</i>, call it x with c.d.f. F(x), <b>glcurve</b> draws its
    Generalised Lorenz curve and/or generates two new variables containing
    the Generalised Lorenz ordinates for x, i.e.  GL(p) at each p = F(x).
    For a population ordered in ascending order of x, a graph of GL(p)
    against p plots the cumulative total of x divided by population size
    against cumulative population share GL(1) = mean(x). <b>glcurve</b> can also be
    used to derive many other related concepts such as Lorenz curves,
    concentration curves and 'Three Is of Poverty' (TIP) curves, with
    appropriate definition of <i>varname</i>, order of cumulation (set with the
    <b>sortvar</b> option), and normalisation (e.g. by the mean of <i>varname</i>).
    Alternatively <b>glcurve</b> with the <b>lorenz</b>, <b>atip</b> or <b>rtip</b> option can be used
    directly to draw the related Lorenz, concentration and TIP curves.
<p>
    Comparisons of pairs of distributions (and dominance checks) can be
    undertaken by using the <b>by()</b> (with or without the <b>split</b>) options.  It can
    also be made manually by 'stacking' the data (see help on stack).
<p>
    The graphs drawn by <b>glcurve</b> are relatively basic. For graphs with full
    user control over formatting and labelling, users are recommended to use
    <b>glcurve</b> to generate the ordinates of the graph required using the
    <b>pvar(</b><i>newvarname</i><b>)</b> and <b>glvar(</b><i>newvarname</i><b>)</b> options, and then to draw the
    graph using graph twoway.
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>pvar(</b><i>pvarname</i><b>)</b> generates the variable <i>pvarname</i> containing the x
        coordinates of the created curve.
<p>
    <b>glvar(</b><i>glvarname</i><b>)</b> generates the variable <i>glvarname</i> containing the y
        coordinates of the created curve.
<p>
    <b>sortvar(</b><i>sname</i><b>)</b> specifies the sort variable.  By default, the data are
        sorted (and cumulated) in ascending order of <i>varname</i>. If the <b>sortvar</b>
        option is specified, sorting and cumulation is in ascending order of
        variable <i>sname</i>. Within tied values of <i>sname</i>, data are sorted in
        ascending order of <i>varname</i>.
<p>
    <b>by(</b><i>groupvar</i><b>)</b> specifies that the coordinates are to be computed separately
        for each subgroup defined by <i>groupvar</i>. <i>groupvar</i> must be an integer
        variable.
<p>
    <b>split</b> specifies that a series of new variables are created containing the
        coordinates for each subgroup specified by <b>by(</b><i>groupvar</i><b>)</b>. <b>split</b> can
        not be used without <b>by()</b>.  If <b>split</b> is specified, then the string
        <i>glname</i> in <b>glvar(</b><i>glname</i><b>)</b> is used as a prefix to create new variables
        <i>glname_X1</i>, <i>glname_X2</i>,... (where X1, X2, ... are the values taken by
        <i>groupvar</i>).
<p>
    <b>nograph</b> avoids the automatic display of a crude graph made out of the
        created variables. <b>nograph</b> is assumed if <b>by()</b> is specified without
        <b>split</b>.
<p>
    <b>replace</b> allows the variables specified in <b>glvar(</b><i>glvarname</i><b>)</b> and
        <b>pvar(</b><i>pvarname</i><b>)</b> to be overwritten if they already exist. Otherwise
        <i>glvarname</i> and <i>pvarname</i> must be new variable names.
<p>
    <b>lorenz</b> requires that the ordinates of the Lorenz curve are computed
        instead of generalised Lorenz ordinates. The Lorenz ordinates of
        variable x, L(p), are GL(p)/mean(x).
<p>
    <b>rtip(</b><i>povline</i><b>)</b> and <b>atip(</b><i>povline</i><b>)</b> require that the ordinates of TIP curves
        are computed instead of generalised Lorenz ordinates.  <i>povline</i>
        specifies the value of the poverty line: it can be either a numeric
        value taken as the poverty line for all observations or a variable
        name containing the value of the poverty line for each observation.
        <b>atip()</b> draws 'absolute' TIP curves (by cumulating max(z-x,0)) and
        <b>rtip()</b> draws 'relative' TIP curves (by cumulating max(1-(x/z),0)).
<p>
    <b>plot(</b><i>plot</i><b>)</b> provides a way to add other plots to the generated graph; see 
        plot option.
<p>
    <i>graph_options</i> are standard twoway scatter options.  Note that
        modifications to the legend labels should be made with the
        <b>legend(order(</b>...<b>)</b> options instead of <b>legend(label(</b>...<b>)</b> (see help 
        legend_option).
<p>
<b><u>Examples</u></b>
<p>
    Many <b>glcurve</b> examples are provided in the downloadable materials provided
    by Jenkins (2006).
<p>
    <b>. * Generalized Lorenz curve ordinates; plot using -graph twoway-</b>
<p>
    <b>. glcurve x, gl(gl1) p(p1) nograph</b>
<p>
    <b>. twoway line gl1 p1</b>
<p>
    <b>. * Lorenz curve ordinates; plot using -glcurve-</b>
<p>
    <b>. glcurve x, lorenz plot(function equality = x)</b>
<p>
    <b>. * Lorenz curve ordinates; plot using -glcurve-; options</b>
<p>
    <b>. glcurve x [fw=wgt] if x &gt; 0, gl(gl2) p(p2) lorenz</b>
<p>
    <b>. * Generalised Lorenz curve ordinates and graphs, by state</b>
<p>
    <b>. glcurve x, gl(gl2) p(p2) replace sort(y) by(state) split</b>
<p>
    <b>. * TIP curve ordinates with graph</b>
<p>
    <b>. glcurve x, gl(gl3) p(p3) atip(10000)</b>
<p>
    <b>. glcurve x, gl(gl3) p(p3) atip(plinevar)</b>
<p>
    <b>. * Lorenz curve ordinates; plot using -graph twoway-</b>
<p>
    <b>. glcurve x, gl(gl) p(p) lorenz nograph</b>
<p>
    <b>. twoway line gl p , sort || line p p , ///</b>
        <b>xlabel(0(.1)1) ylabel(0(.1)1)      ///</b>
        <b>xline(0(.2)1) yline(0(.2)1)        ///</b>
        <b>title("Lorenz curve") subtitle("Example with custom formatting")    ///</b>
        <b>legend(label(1 "Lorenz curve") label(2 "Line of perfect equality")) ///</b>
        <b>plotregion(margin(zero)) aspectratio(1) scheme(economist)</b>
<p>
<p>
<b><u>Notes</u></b>
<p>
    <b>glcurve</b> is designed to be used with individual-level, unit-record data.
    Although <b>glcurve</b> can also be applied mechanically to grouped (`banded')
    income data using <b>fweight</b>s, be aware that the resulting curve is a
    potentially poor estimate, because within-income-band inequality is not
    taken into account.  On the estimation of Lorenz curves and inequality
    indices with grouped data, see e.g. Gastwirth and Glaubermann (1976) or
    Cowell and Mehta (1982).
<p>
    One must also be careful in using the ordinates returned from the option
    <i>pvar</i> for subsequent computation of the Gini or Concentration coefficient
    using the 'convenient covariance' formulae described by e.g. Lerman and
    Yitzhaki (1984, 1989) or Jenkins (1988). The ordinates returned in <i>pvar</i>
    are the curve ordinates (and are equal to estimates obtained from <b>cumul</b>)
    and these are not necessarily the fractional ranks required in the
    covariance formula. The difference is generally negligible with
    continuous unit-record data, but is larger if there are many ties in the
    ranking variable (as in the case, e.g., for the concentration coefficient
    based on an ordinal categorical variable, or when dealing with grouped
    data).
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
    Nicholas J. Cox helped with updating the code for our program from Stata
    7 (glcurve7) to Stata 8. David Demery, Owen O'Donnell, Shehzad Ali made
    useful bug reports. Comments by Zhuo (Adam) Chen lead to introduction of
    'sort stable' estimation for concentration curves.
<p>
<p>
<b><u>Authors</u></b>
<p>
    Philippe Van Kerm, CEPS/INSTEAD, Differdange, G.-D. Luxembourg
    philippe.vankerm@ceps.lu
<p>
    Stephen P. Jenkins, ISER, University of Essex
    stephenj@essex.ac.uk
<p>
<p>
<b><u>References</u></b>
<p>
    Cowell, F.A. 1995. <i>Measuring Inequality</i> (second edition).  Hemel
        Hempstead: Prentice-Hall/Harvester-Wheatsheaf.
<p>
    Cowell, F.A. and Mehta, F. 1982.  The Estimation and Interpolation of
        Inequality Measures.  <i>Review of Economic Studies</i> 49(2): 273-290.
<p>
    Gastwirth, J.L. and Glauberman, M. 1976.  The Interpolation of the Lorenz
        Curve and Gini Index from Grouped Data.  <i>Econometrica</i> 44(3): 479-483.
<p>
    Jenkins, S.P. 1988.  Calculating income distribution indices from
        microdata.  <i>National Tax Journal</i> 61: 139-142.
<p>
    Jenkins, S.P. 2006.  Estimation and interpretation of measures of
        inequality, poverty, and social welfare using Stata. Presentation at
        North American Stata Users' Group Meetings 2006, Boston MA.  
        http://econpapers.repec.org/paper/bocasug06/16.htm.
<p>
    Jenkins, S.P. and Lambert, P.J. 1997.  Three 'I's of poverty curves, with
        an analysis of UK poverty trends.  <i>Oxford Economic Papers</i> 49:
        317-327.
<p>
    Lambert, P.J. 2001.  <i>The Distribution and Redistribution of Income</i> (third
        edition). Manchester: Manchester University Press.
<p>
    Lerman, R.I. and Yitzhaki, S. 1984.  A note on the calculation and
        interpretation of the Gini index.  <i>Economics Letters</i> 15(3-4):
        363-368.
<p>
    Lerman, R.I. and Yitzhaki, S. 1989.  Improving the Accuracy of Estimates
        of Gini Coefficients.  <i>Journal of Econometrics</i> 42(1): 43-47.
<p>
    Shorrocks, A.F. 1983. Ranking income distributions.  <i>Economica</i> 197: 3-17.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Manual:  <b>[R] lorenz</b>
    STB:  <b>STB-48 sg107</b>, <b>STB-49 sg107.1</b>, <b>SJ 1(1) gr0001</b>
    On-line:  help for sumdist, svylorenz (if installed)
<p>
<p>
</pre>