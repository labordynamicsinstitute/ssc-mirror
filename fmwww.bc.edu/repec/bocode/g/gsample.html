<pre>
<b>help gsample</b>
-------------------------------------------------------------------------------
<p>
<b><u>Title</u></b>
<p>
    <b>gsample</b> -- Sampling
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>gsample</b> [<i>#</i>|<i>varname</i>] [<i>if</i>] [<i>in</i>] [<i>weight</i>] [<b>,</b> <i>options</i>]
<p>
<p>
    <i>options</i>                Description
    -------------------------------------------------------------------------
      <b><u>p</u></b><b>ercent</b>              sample size is in percent
      <b>wor</b>                  sample without replacement
      <b><u>str</u></b><b>ata(</b><i>varlist</i><b>)</b>      variables identifying strata
      <b><u>cl</u></b><b>uster(</b><i>varlist</i><b>)</b>     variables identifying resampling clusters
      <b><u>id</u></b><b>cluster(</b><i>newvar</i><b>)</b>    create new cluster ID variable
      <b><u>k</u></b><b>eep</b>                 keep observations that do not meet <i>if</i> and <i>in</i>
      <b><u>g</u></b><b>enerate(</b><i>newvar</i><b>)</b>     store sampling frequencies in <i>newvar</i>
      <b><u>r</u></b><b>eplace</b>              overwrite existing variables
    -------------------------------------------------------------------------
    <b>aweight</b>s are allowed; see weight.
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>gsample</b> draws a random sample from the data in memory. Simple random
    sampling (SRS) is supported, as well as unequal probability sampling
    (UPS), of which sampling with probabilities proportional to size (PPS) is
    a special case. Both methods, SRS and UPS/PPS, provide sampling <i>with</i>
    replacement and sampling <i>without</i> replacement. Furthermore, stratified
    sampling and cluster sampling is supported.
<p>
    <i>#</i> specifies the size of the sample. The default for <b>gsample</b> is to replace
    the data in memory with the sampled observations in random order.
    Alternatively, <b>gsample</b> may store a new variable containing the sampling
    frequencies of the observations (see the <b>generate(</b><i>newvar</i><b>)</b> option). In the
    case of sampling without replacement (see the <b>wor</b> option), the sample
    size must be less than or equal to the number of sampling units in the
    data. Sampling units are either single observations or clusters
    identified by the <b>cluster()</b> option. If <i>#</i> is not specified or if <i>#</i>==., the
    sample size is equal to the observed number of units in the data. For
    stratified sampling, <i>#</i> units will be selected from each stratum
    identified by the <b>strata()</b> option. Alternatively, specify <i>varname</i> instead
    of <i>#</i>, where <i>varname</i> is a variable containing for each stratum a specific
    sample size. <i>varname</i> is assumed to be constant within strata.
<p>
    Specifying <b>aweight</b>s causes unequal probability sampling (UPS/PPS) to be
    performed. The sampling probabilities of the observations will be
    proportional to the specified weights in this case.
<p>
    <b>gsample</b> is implemented as a wrapper for the <b>mm_sample()</b> function from the
    <b>moremata</b> package. See help for <b>mm_sample()</b> for methodical details and
    references. Note that for unequal probability sampling without
    replacement many different algorithms have been proposed in the
    literature and there may be better solutions than the method implemented
    here. In addition, UPS without replacement may fail if the distribution
    of weights is very uneven (see help for <b>mm_sample()</b> for an explanation of
    this problem).
<p>
    If you are serious about sampling, you should first set the random number
    seed; see help <b>generate</b>.
<p>
<p>
<b><u>Dependencies</u></b>
<p>
    <b>gsample</b> requires <b>moremata</b>. Type
<p>
        . ssc describe moremata
<p>
<p>
<b><u>Options</u></b>
<p>
    <b>percent</b> indicates that <i>#</i> (or <i>varname</i>) specifies the percentage of
        observations to be sampled. For example,
<p>
            . gsample 50, percent
<p>
        draws a 50% sample. For stratified sampling, a <i>#</i>-percent sample is
        drawn from each stratum, thus maintaining the proportion of each
        stratum.
<p>
    <b>wor</b> causes the observations to be sampled without replacement (each
        observation may only be drawn once). The default is to sample with
        replacement (observations may be drawn multiple times).
<p>
    <b>strata(</b><i>varlist</i><b>)</b> specifies the variables identifying strata.  If <b>strata()</b>
        is specified, samples are selected within each stratum. The strata
        variables may be numeric or string.
<p>
    <b>cluster(</b><i>varlist</i><b>)</b> specifies the variables identifying sampling clusters.
        If <b>cluster()</b> is specified, the sample drawn is a sample of clusters.
        The cluster variables may be numeric or string.
<p>
    <b>idcluster(</b><i>newvar</i><b>)</b> creates a new variable containing a unique identifier
        for each sampled cluster. This is particularly useful when sampling
        with replacement.
<p>
    <b>keep</b> causes observations that do not meet the optional <i>if</i> and <i>in</i> criteria
        (and observations that are missing on any of the input variables or
        have zero weight) to be kept (sampled at 100%). The default is to
        drop these observations. Alternatively, if <b>generate()</b> is specified,
        <b>keep</b> changes the stored sampling frequencies of these observations
        from zero to one.
<p>
    <b>generate(</b><i>newvar</i><b>)</b> causes a variable containing sampling frequencies to be
        added to the data instead of replacing the data in memory with the
        sampled observations. Note that the original sort order of the data
        will be preserved if <b>generate()</b> is specified.  <i>newvar</i> will either be
        zero or one for observations that do not meet the optional <i>if</i> and <i>in</i>
        criteria (or for observations that are missing on any of the input
        variables or have zero weight) depending on whether <b>keep</b> is specified
        or not.
<p>
    <b>replace</b> permits <b>gsample</b> to overwrite existing variables.
<p>
<p>
<b><u>Examples</u></b>
<p>
    For example,
<p>
        . gsample
<p>
    draws a bootstrap sample of size _N (simple random sample with
    replacement, SRSWR). The data in memory will be replaced by the sampled
    observations. Alternatively
<p>
        . gsample, wor
<p>
    draws a simple random sample without replacement (SRSWOR).
<p>
    Furthermore,
<p>
        . gsample [aw=size]
<p>
    draws a unequal probability sample with sampling probabilities
    proportional to <i>size</i>.
<p>
<p>
<b><u>Author</u></b>
<p>
    Ben Jann, ETH Zurich, jann@soz.gess.ethz.ch
<p>
    You may cite this software as follows:
<p>
        Jann, B. (2006). gsample: Stata module to draw a random sample.
        Available from http://ideas.repec.org/c/boc/bocode/s456716.html.
<p>
<p>
<b><u>Also see</u></b>
<p>
    Online: <b>mm_sample()</b>, <b>sample</b>, <b>bsample</b>, <b>generate</b>, <b>moremata</b>
<p>
</pre>