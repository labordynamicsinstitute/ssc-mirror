<pre>
<b>help for gformula</b>                                                  Rhian Daniel
-------------------------------------------------------------------------------
<p>
<p>
<b><u>G-computation formula routine for estimating causal effects in the presence of</u></b>
<b><u>time-varying confounding or mediation</u></b>
<p>
<p>
<b><u>Syntax</u></b>
<p>
        <b>gformula</b> <i>mainvarlist</i> [<i>if</i>] [<i>in</i>] [<b>,</b> <i>time-varying_options</i>
            <i>mediation_options</i>]
<p>
    <i>options</i>                       Description
    -------------------------------------------------------------------------
    <b>gformula</b> <i>time-varying_options</i>
<p>
      <b><u>out</u></b><b>come(</b><i>varname</i><b>)</b>            the outcome variable
      <b><u>com</u></b><b>mands(</b><i>string</i><b>)</b>            the commands to be used for model-fitting
                                    for each variable to be simulated
      <b><u>eq</u></b><b>uations(</b><i>string</i><b>)</b>           the RHS of the equations for model-fitting
                                    for each variable to be simulated
      <b><u>i</u></b><b>dvar(</b><i>varname</i><b>)</b>              the subject id
      <b><u>t</u></b><b>var(</b><i>varname</i><b>)</b>               the time variable
      <b><u>var</u></b><b>yingcovariates(</b><i>varlist</i><b>)</b>  the time-varying covariates
      <b>intvars(</b><i>varlist</i><b>)</b>            the intervention variables
      <b>interventions(</b><i>string</i><b>)</b>       the interventions to be compared
      <b>dynamic</b>                     for comparing dynamic regimes
      <b>eofu</b>                        the outcome is measured at the end of
                                    follow-up (as opposed to survival)
      <b>pooled</b>                      the model-fitting is to be done by pooling
                                    across time-points
      <b>monotreat</b>                   the time-varying treatment is binary, and
                                    changes at most once (from zero to one)
      <b>death(</b><i>varname</i><b>)</b>              the variable containing data on censoring
                                    due to death
      <b>derived(</b><i>varlist</i><b>)</b>            the derived variables
      <b>derrules(</b><i>string</i><b>)</b>            the rules for deriving the derived
                                    variables
      <b><u>fix</u></b><b>edcovariates(</b><i>varlist</i><b>)</b>    the time-fixed covariates
      <b><u>lag</u></b><b>gedvars(</b><i>varlist</i><b>)</b>         the lagged variables
      <b>lagrules(</b><i>string</i><b>)</b>            the rules for deriving the lagged variables
      <b>msm(</b><i>string</i><b>)</b>                 the marginal structural model
      <b>minsim</b>                      suppresses some unnecessary simulation,
                                    reducing MC error
      <b>impute(</b><i>varlist</i><b>)</b>             the variables with missing values to be
                                    imputed
      <b>imp_cmd(</b><i>string</i><b>)</b>             the commands to be used for imputing each
                                    of the incomplete variables
      <b>imp_eq(</b><i>string</i><b>)</b>              the RHS of the equations to be used for
                                    imputing each of the incomplete variables
      <b>imp_cycles(</b><i>#</i><b>)</b>               the number of cycles to be used when
                                    imputing each of the incomplete variables
                                    using chained equations
      <b><u>sim</u></b><b>ulations(</b><i>#</i><b>)</b>              the number of MC simulations
      <b><u>sam</u></b><b>ples(</b><i>#</i><b>)</b>                  the number of bootstrap samples
      <b>seed(</b><i>#</i><b>)</b>                     the random number seed
      <b>all</b>                         all bootstrap CIs are to be calculated
      <b>graph</b>                       a Kaplan-Meier curve is to be plotted
      <b>saving(</b><i>string</i><b>)</b>              the filename under which the MC simulated
                                    data are to be stored
      <b>replace</b>                     replace the file of the same name if it
                                    exists
<p>
    <b>gformula</b> <i>mediation_options</i>
<p>
      <b>mediation</b>                   the analysis is a mediation analysis (as
                                    opposed to time-varying confounding)
      <b><u>out</u></b><b>come(</b><i>varname</i><b>)</b>            the outcome variable
      <b><u>com</u></b><b>mands(</b><i>string</i><b>)</b>            the commands to be used for model-fitting
                                    for each variable to be simulated
      <b><u>eq</u></b><b>uations(</b><i>string</i><b>)</b>           the RHS of the equations for model-fitting
                                    for each variable to be simulated
      <b>derived(</b><i>varlist</i><b>)</b>            the derived variables
      <b>derrules(</b><i>string</i><b>)</b>            the rules for deriving the derived
                                    variables
      <b>msm(</b><i>string</i><b>)</b>                 the marginal structural model
      <b><u>ex</u></b><b>posure(</b><i>varlist</i><b>)</b>           the exposure(s)
      <b>mediator(</b><i>varlist</i><b>)</b>           the mediator(s)
      <b>control(</b><i>string</i><b>)</b>             the value(s) of the mediator(s) at which
                                    the CDE is to be estimated
      <b>baseline(</b><i>string</i><b>)</b>            the baseline value(s) of the exposure(s)
      <b>obe</b>                         there is only one binary exposure
      <b>oce</b>                         there is only one categorical exposure
      <b>base_confs(</b><i>varlist</i><b>)</b>         the confounders that are not affected by
                                    the exposure(s)
      <b>post_confs(</b><i>varlist</i><b>)</b>         the confounders that are affected by the
                                    exposure(s)
      <b>linexp</b>                      specifies that the exposure is continuous
                                    and its effect assumed to be linear
      <b>minsim</b>                      suppresses some unnecessary simulation,
                                    reducing MC error
      <b>moreMC</b>                      specifies that the number of MC simulations
                                    will be greater than the sample size
      <b>impute(</b><i>varlist</i><b>)</b>             the variables with missing values to be
                                    imputed
      <b>imp_cmd(</b><i>string</i><b>)</b>             the commands to be used for imputing each
                                    of the incomplete variables
      <b>imp_eq(</b><i>string</i><b>)</b>              the RHS of the equations to be used for
                                    imputing each of the incomplete variables
      <b>imp_cycles(</b><i>#</i><b>)</b>               the number of cycles to be used when
                                    imputing each of the incomplete variables
                                    using chained equations
      <b><u>sim</u></b><b>ulations(</b><i>#</i><b>)</b>              the number of MC simulations
      <b><u>sam</u></b><b>ples(</b><i>#</i><b>)</b>                  the number of bootstrap samples
      <b>seed(</b><i>#</i><b>)</b>                     the random number seed
      <b>all</b>                         all bootstrap CIs are to be calculated
      <b>saving(</b><i>string</i><b>)</b>              the filename under which the MC simulated
                                    data are to be stored
      <b>replace</b>                     replace the file of the same name if it
                                    exists
<p>
    -------------------------------------------------------------------------
<p>
<p>
<b><u>Description</u></b>
<p>
    <b>gformula</b> is an implementation of the g-computation procedure, used to
    estimate the causal effect of time-varying exposure(s) (A) on an outcome
    (Y) in the presence of time-varying confounders (L) that are themselves
    also affected by the exposure(s). The procedure can also be used to
    address the related problem of estimating controlled direct effects and
    natural direct/indirect effects when the causal effect of the exposure(s)
    on an outcome is mediated by intermediate variables, and in particular
    when confounders of the mediator-outcome relationships are themselves
    affected by the exposure(s).
<p>
        +--------------------------+
    ----+ Time-varying confounding +-----------------------------------------
<p>
    The g-computation procedure for time-varying confounding works by first
    modelling the relationships between the variables seen in the
    observational data. Using these models, it simulates what would have
    happened to the subjects in the study had the time-varying exposures been
    determined by intervention, rather than been allowed to evolve naturally
    as in the observational data. The modelling and simulation is carried out
    forward in time. That is, it starts by modelling the time 1 data given
    the time 0 data, which allows the time 1 data to be simulated under
    various hypothetical interventions (on the time 0 exposure) to be
    compared. Then it models the time 2 data given the time 0 and time 1 data
    in order to simulate the data at time 2 under the various interventions
    (on time 0 and time 1 exposures), and so on. All post-baseline
    confounders and outcome(s) are simulated under each intervention.
<p>
    Causal inference can then be done by comparing the outcome(s) under
    different interventions as if these had been generated from a randomised
    experiment. This can either be done by comparing the simulated outcomes
    directly, or via a specified marginal structural model.
<p>
        +-----------+
    ----+ Mediation +--------------------------------------------------------
<p>
    A substantively different, yet methodologically highly related, problem
    arises when we wish to decompose the causal effect of an exposure X on an
    outcome Y into an indirect effect, acting through a mediator M, and a
    direct effect not mediated by M. Standard methods cannot be used if there
    are confounders L of the M-Y relationship that are themselves affected by
    X.
<p>
    To discuss precisely what we mean by direct and indirect effects, we use
    some counterfactual notation. Let Y(x,m) be the potential outcome if,
    possibly contrary to fact, X were set (by intervention) to x and M were
    set (by intervention) to m. The <i>controlled direct effect</i> (CDE(m)) is a
    comparison of E{Y(x,m)} for different values of x, whilst keeping m
    fixed. For example, if X is univariate and binary, we might specifically
    consider the controlled direct effect (at m) to be
<p>
        CDE(m)=E[Y(1,m)]-E[Y(0,m)]
<p>
    Now let M(x) be the potential value of the mediator if, possibly contrary
    to fact, X were set to x.
<p>
    The <i>total causal effect</i> (TCE) is a comparison of E(Y[x,M(x)]) for
    different values of x. Again, for binary X, we would have
<p>
        TCE=E(Y[1,M(1)])-E(Y[0,M(0)])
<p>
    It would be desirable to use these quantities to infer an indirect effect
    as the difference between the total effect and the direct effect.  The
    fact that the controlled direct effect is a function of m makes this
    impossible.
<p>
    For this reason, the <i>natural direct effect</i> (NDE(x0)) is defined to be a
    comparison of E(Y[x,M(x0)]) for different values of x, keeping x0 fixed
    (usually at the baseline value of X, if such a natural choice exists). In
    other words, it is the effect of X on Y, were M to take on its natural
    value under the baseline intervention. For binary X, we would have
<p>
        NDE(0)=E(Y[1,M(0)])-E(Y[0,M(0)])
<p>
    Then the <i>natural indirect effect</i> (NIE(x1)) can be defined as the
    difference between the total causal effect and the natural direct effect.
    Then it is a comparison of E(Y[x1,M(x)]) for different values of x,
    whilst keeping x1 fixed (at a natural choice of non-baseline value).
    This is best illustrated by thinking again of a binary X, when the
    natural indirect effect becomes
<p>
        NIE(1)=E(Y[1,M(1)])-E(Y[1,M(0)])
<p>
    The g-computation procedure for the mediation example works in a similar
    way, except that for the natural direct and indirect effects, simulations
    under different hypothetical interventions need to be combined. Suppose
    that X is binary, then M is simulated under both X=1 and X=0, giving M(1)
    and M(0), respectively. To simulate Y[1,M(0)] (needed to estimate the
    natural direct effect), X is set to 1 at the same time as M is set to the
    simulated value under the intervention X=0.
<p>
    If X is not binary and/or if X is multivariate, there may not be a
    natural comparison (such as 1 vs. 0) for calculating the total causal
    effect, controlled direct effect or natural direct/indirect effects. In
    this case, the formulae above are replaced by
<p>
        CDE(m)=E[Y(X,m)]-E[Y(0,m)]
<p>
        TCE=E(Y(X,M(X)))-E(Y(0,M(0)))
<p>
        NDE(0)=E(Y[X,M(0)])-E(Y[0,M(0)])
<p>
    and
<p>
        NIE(X)=E(Y[X,M(X)])-E(Y[X,M(0)])
<p>
    where 0 is still the baseline value(s) of X, but is now compared with the
    distribution of X arising naturally in the observational data.
<p>
<p>
        +----------------+
    ----+ Data structure +---------------------------------------------------
<p>
    The outcome can be binary or continuous, or (in the time-varying
    confounding option) time-to-event.
<p>
    For the time-varying confounding option (as opposed to the mediation
    option---see below), the data must be in long format (see reshape), i.e.
    there should be a separate record for each subject at each time-point. If
    the outcome is time-to-event, the outcome data for each subject should be
    given as a series of binary variables measured at each time-point. No
    records should be included in the dataset for subjects who have been
    censored before that time, due to death or loss to follow-up, or (in the
    case of a time-to-event outcome) due to having experienced the event
    before that time.
<p>
    Any value which is to be imputed (including those at intermittent missing
    visits, for which a record must be included) should be denoted by a full
    stop (.), according to Stata's convention.
<p>
    For the mediation option, there should be exactly one record per subject.
    Again, missing values to be imputed should be denoted by a full stop.
<p>
<p>
<p>
<b><u>Options</u></b>
<p>
        +---------------------------------------------+
    ----+ gformula (time-varying confounding options) +----------------------
<p>
    <b>outcome(</b><i>varname</i><b>)</b> specifies that <i>varname</i> is the outcome variable.
<p>
    <b>commands(</b><i>string</i><b>)</b> specifies which command (either <b>regress</b>, <b>logit</b>, <b>mlogit</b>
        or <b>ologit</b>) should be used when fitting each of the parametric models.
        The variable name is followed by a colon (:), which is followed by
        the command name, with a comma (,) separating the different
        variables.
<p>
        Commands should be specified for the models for the outcome variable,
        time-varying confounders and the time-varying exposure. If there is
        censoring due to death, then the command used for the model for death
        should also be specified.
<p>
        For a survival outcome (and death, if applicable), the command should
        be chosen as <b>logit</b>, since the outcome (or death) is given (and
        simulated) as a sequence of binary variables.
<p>
    <b>equations(</b><i>string</i><b>)</b> specifies the right-hand side of the equations used
        when fitting the models listed above. The name of the dependent
        variable is followed by a colon, which is followed by the list of
        independent variables. A comma (,) should separate the equations for
        the different dependent variables.
<p>
        Since the data are stored in long format, lagged variables will need
        to be used (see below) to incorporate the dependence on data from
        previous visits.
<p>
        The equation for any particular variable, for example a time-varying
        confounder L, must be the same at each visit.
<p>
        The prefix <b>i.</b> should be used for any variable that is to be treated
        as categorical.
<p>
<p>
    <b>idvar(</b><i>varname</i><b>)</b> specifies that varname is the numeric variable identifying
        the subject.
<p>
    <b>tvar(</b><i>varname</i><b>)</b> specifies that varname is the numeric variable identifying
        the time-point.
<p>
    <b>varyingcovariates(</b><i>varlist</i><b>)</b> specifies that varlist are the time-varying
        covariates. If lagged versions of these variables are to be used,
        only the unlagged versions should be included in this list.
<p>
    <b>intvars(</b><i>varlist</i><b>)</b> specifies that varlist are the variables on which
        interventions are to be specified. If lagged versions of these
        variables are to be used, only the unlagged versions should be
        included in this list.
<p>
    <b>interventions(</b><i>string</i><b>)</b> specifies the exact interventions to be compared.
        Different interventions should be separated by a comma (,) and
        different commands within one intervention should be separated by a
        backwards slash (\).
<p>
    <b>dynamic</b> specifies that the regimes to be compared are dynamic. If this
        option is not specified, it is assumed that the regimes to be
        compared (except for the observational regime) are all static.
<p>
    <b>eofu</b> specifies that the outcome is measured only at the end of follow-up.
        If this option is not specified, it is assumed that the outcome is
        time-to-event.
<p>
    <b>pooled</b> specifies that the models defined by the <b>command</b> and <b>equation</b>
        options above (and the imputation models - see below - if relevant)
        should be fitted to data from all visits at once, pooling across
        time-points. If this option is not specified, the models are fitted
        separately at each visit.
<p>
    <b>monotreat</b> specifies that the time-varying exposure in the observational
        data is binary, and changes at most once (from zero to one). Thus the
        exposure data for a given subject consists of a sequence of zeros
        followed by a sequence of ones (or a sequence containing only zeros,
        or only ones). This is common in many settings in which treatment may
        be initiated at some point, but never discontinued. Specifying this
        option only affects the way in which data are simulated under the
        observational regime. When using the <b>monotreat</b> option, the
        corresponding command for simulating the time-varying exposure should
        be specified as <b>logit</b>.
<p>
    <b>death(</b><i>varname</i><b>)</b> gives the name of the variable (a sequence of binary
        variables at each time-point) which takes the value 0 if a subject is
        still alive at that time-point and 1 if a subject died between the
        previous and current time-points. (No further records following death
        will be included in the original dataset.)
<p>
        It is assumed that all censoring (before the final visit) where
        death=0 is due to loss to follow-up. Simulations are then drawn to
        mimic a situation in which there are deaths but no losses to
        follow-up.
<p>
        If the <b>death</b> option is not specified, all censoring (before the final
        visit) is assumed to be due to loss to follow-up and simulations are
        drawn to mimic no losses to follow-up.
<p>
    <b>derived(</b><i>varlist</i><b>)</b> lists all the variables which are to be derived from
        other variables, such as interactions. Lagged variables themselves
        should not be included here, but variables derived using one or more
        lagged variables should be included. The derived variables must exist
        in the original dataset.
<p>
    <b>derrules(</b><i>string</i><b>)</b> describes how the derived variables are to be obtained
        from the other variables. For example, if the variable al is to be
        created as the product of a and l, the code is derrules(al:a*l) (and
        al should be included in <b>derived(</b><i>varlist</i><b>)</b> above). The rules for
        generating more than one derived variable should be separated using a
        comma.
<p>
    <b>fixedcovariates(</b><i>varlist</i><b>)</b> lists the time-fixed covariates. These do not
        depend on the time-varying exposure and thus are not simulated.
<p>
    <b>laggedvars(</b><i>varlist</i><b>)</b> lists the lagged variables. The lagged variables must
        exist in the original dataset.
<p>
    <b>lagrules(</b><i>string</i><b>)</b> gives further details of the lagged variables. For
        example, if the variable a_lag is the lagged version of a, and a_lag2
        is the double-lagged version of a, this would be denoted as
        lagrules(a_lag:a 1, a_lag2:a 2).
<p>
    <b>msm(</b><i>string</i><b>)</b> specifies the form of the marginal structural model, for
        example, msm(regress y a_lag a_lag2) or msm(stcox a_lag a_lag2).
<p>
    <b>minsim</b> suppresses the simulation of the outcome, and uses just the
        predicted means instead. This reduces unnecessary MC error in some
        contexts. Note: categorical outcomes fitted using ologit or mlogit
        are still simulated even with minsim.
<p>
    <b>impute(</b><i>varlist</i><b>)</b> gives a list of the variables that contain missing values
        to be imputed via the method of single stochastic imputation using
        chained equations.
<p>
    <b>imp_cmd(</b><i>string</i><b>)</b> specifies which command (either <b>regress</b>, <b>logit</b>, <b>mlogit</b> or
        <b>ologit</b>) should be used when fitting each of the imputation models.
        The syntax is the same as for the <b>commands</b> option described above.
<p>
    <b>imp_eq(</b><i>string</i><b>)</b> specifies the RHS of each of the equations to be used for
        fitting each of the imputation models.  The syntax is the same as for
        the <b>equations</b> option described above.
<p>
    <b>imp_cycles(</b><i>#</i><b>)</b> specifies the number of cycles of chained equations to be
        used in the imputation procedure. The default is 10.
<p>
    <b>simulations(</b><i>#</i><b>)</b> specifies the size of the Monte Carlo simulated dataset.
        The default is the same size as the observed dataset, but for
        computational reasons, it can be smaller.
<p>
    <b>samples(</b><i>#</i><b>)</b> specifies the number of bootstrap samples. The default is
        1,000.
<p>
    <b>seed(</b><i>#</i><b>)</b> sets the random-number seed to <i>#</i>.
<p>
    <b>all</b> specifies that all bootstrap confidence intervals are to be displayed
        (normal, percentile, bias corrected, and bias corrected and
        accelerated). The default is to give normal-based bootstrap
        confidence intervals only. See bootstrap.
<p>
    <b>graph</b> specifies that a Kaplan-Meier plot of the survival curves under
        each intervention be displayed. This option is only relevant for a
        time-varying confounding analysis with a time-to-event outcome.
<p>
    <b>saving(</b><i>string</i><b>)</b> saves the dataset containing the original observational
        data and all the Monte Carlo simulations in a Stata dataset named
        <b>string</b>. The dataset contains a variable _int which takes the value 0
        for the observational data, the value 1 for the simulations
        corresponding to intervention 1, and so on for each of the n
        specified interventions. Finally, the Monte Carlo simulations under
        the observational regime appear at the end of the dataset, with _int
        taking the value n+1.
<p>
    <b>replace</b> specifies that if the .dta file given in the option
        <b>saving(</b><i>string</i><b>)</b> already exists, it should be overwritten.
<p>
<p>
        +------------------------------+
    ----+ gformula (mediation options) +-------------------------------------
<p>
    <b>mediation</b> specifies that the analysis is a mediation analysis. If this
        option is not specified, then a time-varying confounding analysis is
        assumed.
<p>
    <b>outcome(</b><i>varname</i><b>)</b> specifies that <i>varname</i> is the outcome variable.
<p>
    <b>commands(</b><i>string</i><b>)</b> specifies which command (either <b>regress</b>, <b>logit</b>, <b>mlogit</b>
        or <b>ologit</b>) should be used when fitting the simulation models. The
        variable name is followed by a colon (:), which is followed by the
        command name, with a comma (,) separating the different variables.
<p>
        Models must be specified for the mediator(s), outcome, and the
        post-baseline confounders of the mediator-outcome relationship that
        are affected by the exposure.
<p>
    <b>equations(</b><i>string</i><b>)</b> specifies the right-hand side of the equations used
        when fitting the models listed above. The name of the dependent
        variable is followed by a colon (:), which is followed by the list of
        independent variables. A comma (,) should separate the equations for
        the different dependent variables.
<p>
        The prefix <b>i.</b> should be used for any variable that is to be treated
        as categorical.
<p>
    <b>derived(</b><i>varlist</i><b>)</b> lists all the variables which are to be derived from
        other variables, such as interactions.
<p>
    <b>derrules(</b><i>string</i><b>)</b> describes how the derived variables are to be obtained
        from the other variables. For example, if the variable al is to be
        created as the product of a and l, the code is derrules(al:a*l) (and
        al should be included in <b>derived(</b><i>varlist</i><b>)</b> above). The rules for
        generating more than one derived variable should be separated using a
        comma.
<p>
    <b>msm(</b><i>string</i><b>)</b> specifies the form of the marginal structural model, for
        example, msm(regress y x m) or msm(logit y x m xm).
<p>
    <b>exposure(</b><i>varlist</i><b>)</b> specifies the exposure variable(s).
<p>
    <b>mediator(</b><i>varlist</i><b>)</b> specifies the mediator variable(s).
<p>
    <b>control(</b><i>string</i><b>)</b> specifies the value(s) at which the mediator(s) should be
        controlled for the controlled direct effect.  If this option is not
        specified, only natural direct/indirect effects are estimated.
<p>
    <b>obe</b> specifies that there is only one binary exposure, and that the
        comparisons should be made between X=1 and X=0.  If neither this nor
        <b>oce</b> (see next option) is specified, comparisons are made between the
        distribution of X in the observed data, and the baseline value(s).
<p>
    <b>oce</b> specifies that there is only one categorical exposure, and that the
        comparisons should be made between each non-baseline level of X and
        the baseline level, as specified using the <b>baseline</b> option above. If
        neither this nor <b>obe</b> is specifid, comparisons are made between the
        distribution of X in the observed data, and the baseline value(s).
<p>
    <b>baseline(</b><i>string</i><b>)</b> specifies the value(s) of the exposure(s) to be taken as
        baseline value(s).
<p>
    <b>base_confs(</b><i>varlist</i><b>)</b> specifies the confounder(s) of the exposure-outcome
        relationship(s).
<p>
    <b>post_confs(</b><i>varlist</i><b>)</b> specifies the confounder(s) of the mediator-outcome
        relationship(s).
<p>
    <b>linexp</b> specifies that the exposure is continuous and that its effect is
        assumed to be linear. Thus, the CDE is defined as E{Y(X+1,m)-Y(X,m)},
        and so on.
<p>
    <b>minsim</b> suppresses the simulation of the outcome, and uses just the
        predicted means instead. This reduces unnecessary MC error in some
        contexts. Note: categorical outcomes fitted using ologit or mlogit
        are still simulated even with minsim. In addition, if the option
        <b>linexp</b> has been specified, even fewer outcomes need be simulated, and
        these unnecessary simulations are avoided when this option is
        specified.
<p>
    <b>moreMC</b> specifies that the number of MC simulations will be greater than
        the sample size. This can be useful in reducing MC error.
<p>
    <b>impute(</b><i>varlist</i><b>)</b> gives a list of the variables that contain missing values
        to be imputed via the method of single stochastic imputation using
        chained equations.
<p>
    <b>imp_cmd(</b><i>string</i><b>)</b> specifies which command (either <b>regress</b>, <b>logit</b>, <b>mlogit</b> or
        <b>ologit</b>) should be used when fitting each of the imputation models.
        The syntax is the same as for the <b>commands</b> option described above.
<p>
    <b>imp_eq(</b><i>string</i><b>)</b> specifies the RHS of each of the equations to be used for
        fitting each of the imputation models.  The syntax is the same as for
        the <b>equations</b> option described above.
<p>
    <b>imp_cycles(</b><i>#</i><b>)</b> specifies the number of cycles of chained equations to be
        used in the imputation procedure. The default is 10.
<p>
    <b>simulations(</b><i>#</i><b>)</b> specifies the size of the Monte Carlo simulated dataset.
        The default is the same size as the observed dataset.
<p>
    <b>samples(</b><i>#</i><b>)</b> specifies the number of bootstrap samples. The default is
        1,000.
<p>
    <b>seed(</b><i>#</i><b>)</b> sets the random-number seed to <i>#</i>.
<p>
    <b>all</b> specifies that all bootstrap confidence intervals are to be displayed
        (normal, percentile, bias corrected, and bias corrected and
        accelerated). The default is to give normal-based bootstrap
        confidence intervals only. See bootstrap.
<p>
    <b>saving(</b><i>string</i><b>)</b> saves the dataset containing the original observational
        data and all the Monte Carlo simulations in a Stata dataset named
        <b>string</b>.
<p>
    <b>replace</b> specifies that if the .dta file given in the option
        <b>saving(</b><i>string</i><b>)</b> already exists, it should be overwritten.
<p>
<p>
<b><u>Authors</u></b>
<p>
    Rhian Daniel, Bianca De Stavola and Simon Cousens.
    Centre for Statistical Methodology, London School of Hygiene and Tropical
    Medicine.
    Rhian.Daniel@LSHTM.ac.uk
<p>
<p>
<b><u>Further reading</u></b>
<p>
    Daniel, R. M., De Stavola, B. L., and Cousens, S. N. 2011. gformula:
        Estimating causal effects in the presence of time-varying confounding
        or mediation using the g-computation formula. <i>The Stata Journal</i>
        <b>11</b>(4):479-517.
<p>
    Robins, J. M. 1986. A new approach to causal inference in mortality
        studies with a sustained exposure period - application to control of
        the healthy worker survivor effect. <i>Mathematical Modelling</i>
        <b>7</b>:1393-1512.
<p>
    Robins, J. M., and Hernan, M. A. 2009. <i>Longitudinal Data Analysis</i>, chap.
        23: Estimation of the causal effects of time-varying exposures,
        553-599. New York: Chapman and Hall / CRC Press.
<p>
    Pearl, J. 2001. Direct and Indirect Effects. In <i>Proceedings of the 17th</i>
        <i>Conference on Uncertainty in Artificial Intelligence</i>. 411-420.
<p>
    Didelez, V. 2006. Direct and Indirect Effects of Sequential Treatments.
        In <i>Proceedings of the 22nd Conference on Uncertainty in Artificial</i>
        <i>Intelligence</i>. 138-146.
<p>
<p>
<b><u>Acknowledgements</u></b>
<p>
    <b>gformula</b> makes use of the <b>detangle</b> and <b>formatlist</b> procedures from <b>ice</b>, by
    kind permission of Patrick Royston.
<p>
    This work was supported by the Medical Research Council, UK (Grant
    number: G0701024).
<p>
    We are very grateful to Daniela Zugna, Deborah Ford and Linda Harrison
    for the suggestions they have made to improve this command.
<p>
</pre>